Id,Title,Score,Text,CreationDate
"6855283","refactor function error - ""is not part of the build phase of any targets in the Xcode 3 projects in this workspace and so can't be refactored""","18","refactor function error - ""is not part of the build phase of any targets in the Xcode 3 projects in this workspace and so can't be refactored""","2011-07-28 07:13:03"
"6855283","refactor function error - ""is not part of the build phase of any targets in the Xcode 3 projects in this workspace and so can't be refactored""","18","Trying to rename a function's name via the refactor->rename button in a categoriy's .h file in XCode 4.1 I'm getting this error: (error and body)

UINavigationController+ZG.h is not part of the build phase of any targets in the Xcode 3 projects in this workspace and so can’t be refactored.

Add the file to the build phase of a target in an Xcode 3 project in this workspace, or make a selection in another file.

Not sure what it wants and why it's saying something about xcode 3 when i don't have any xcode 3 projects or anything like that.","2011-07-28 07:13:03"
"6855283","refactor function error - ""is not part of the build phase of any targets in the Xcode 3 projects in this workspace and so can't be refactored""","18","<iphone><objective-c><xcode4>","2011-07-28 07:13:03"
"6855283","refactor function error - ""is not part of the build phase of any targets in the Xcode 3 projects in this workspace and so can't be refactored""","18","<iphone><xcode><xcode4>","2011-09-12 18:50:00"
"25424074","refactor large AngularJS module config into separate files","15","refactor large AngularJS module config into separate files","2014-08-21 10:31:43"
"25424074","refactor large AngularJS module config into separate files","15","### Problem: Large `config()` ###

The config of my AngularJS app is growing quite large. How would you refactor the following into separate files?

    // app.js
    angular.module('myApp')
        .config(function($urlRouterProvider, $stateProvider, $httpProvider) {
            // Configure routing (uiRouter)
            $urlRouterProvider.when('/site', '/site/welcome');
            $stateProvider.state('main', ...
            ...

            // Configure http interceptors
            $httpProvider.interceptors.push(function () {              
                ...
            });
        });


----------


### Option 1. Multiple `config()`s ###

I know that I can have multiple `config()`s and place them in separate files like this:

    // app.js
    angular.module('myApp');

    // routerConfiguration.js
    angular.module('myApp')
        .config(function($urlRouterProvider, $stateProvider) {
            // Configure routing (uiRouter)
            $urlRouterProvider.when('/site', '/site/welcome');
            $stateProvider.state('main', ...
            ...

    // httpInterceptorConfig.js
    angular.module('myApp')
        .config(function($httpProvider) {
            // Configure http interceptors
            $httpProvider.interceptors.push(function () {              
                ...
            });
        });

What I do not like about this, is that in the original app.js, **there is no way of getting an overview** of what is run at startup. 


----------


### Option 2. Inject something ###

I would prefer to do something like this, because it would be easier to see what is configured, directly in the app.js. However I know that this is not possible, since we cannot inject services into `config()`. 

**Can I use providers to solve this? Is there a better way?**

    // app.js
    angular.module('myApp')
        .config(function(routerConfig, httpInterceptorConfig) {
            routerConfig.setup();
            httpInterceptorConfig.setup();
        });

    // routerConfig.js
    angular.module('myApp')
        .factory('routerConfig', function($urlRouterProvider, $stateProvider) {
            return {
                setup: function() {
                    // Configure routing (uiRouter)
                    $urlRouterProvider.when('/site', '/site/welcome');
                    $stateProvider.state('main', ...
                    ...
                }
            };
        });
    });

    // httpInterceptorConfig.js
    angular.module('myApp')
        .factory('httpInterceptorConfig', function($httpProvider) {
            return {
                setup: function() {
                    // Configure http interceptors
                    $httpProvider.interceptors.push(function () {              
                    ...
                }
            };
        });
    });","2014-08-21 10:31:43"
"25424074","refactor large AngularJS module config into separate files","15","<angularjs>","2014-08-21 10:31:43"
"12434127","refactoring to arc results in ""synthesize of 'weak' property is only allowed in arc or gc mode""","8","refactoring to arc results in ""synthesize of 'weak' property is only allowed in arc or gc mode""","2012-09-15 02:48:52"
"12434127","refactoring to arc results in ""synthesize of 'weak' property is only allowed in arc or gc mode""","8","i am using xcode 4.4.1 for iOS target 5.1
i've started my project using ARC, and in the middle of the project I've added some non-arc thirdparty source to my project.
at this point, i've decided to try refactoring in xcode and an error occurs.
it comes from one of my original source code. 

i have a property of (nonatomic, weak) and i've synthesized it ==> synthesize of 'weak' property is only allowed in ARC or GC mode. 

I am puzzeled - i am using arc and it complains that it is only allowed in arc??

At the moment, i've refactored the thirdparty app from other project and copied it for my project to work, but the above is a question I'd still like to understand why .
Thanks! 
(by the way, when i do convert to arc, it says that the target currently uses ARC)","2012-09-15 02:48:52"
"12434127","refactoring to arc results in ""synthesize of 'weak' property is only allowed in arc or gc mode""","8","<iphone><ios4><ios5>","2012-09-15 02:48:52"
"769351","refactoring LINQ IQueryable expression to remove duplicated portions of queries","7","refactoring LINQ IQueryable expression to remove duplicated portions of queries","2009-04-20 17:47:10"
"769351","refactoring LINQ IQueryable expression to remove duplicated portions of queries","7","I have some linq queries that have redundancy I'd like to factor out a single piece of code.  These are join experssions that are IQueryable, and its important I don't cause the query to be evaluated earlier than it would be without the refactoring.

  Here is a simplified query:

    result result = 
    from T in db.Transactions
    join O in db.Orders on T.OrderID equals O.OrderID
    join OD in db.OrderDetails on O.OrderID equals OD.OrderID into OrderDetails
    let FirstProductBought = OrderDetails.First().Select(OD => OD.Product.ProductName)
    select new
    {
      TransactionID = T.TransactionID,
      OrderID = O.OrderID,
      FirstProductBought = FirstProductBought
    };

What I want to factor out is th logic ""given an order, what is the first product bought"".  I am using the same logic in other queries.  How can I factor it out into a shared method?

Generally, for code reuse and IQueryables, what I've been able to do is code that takes an IQueryable going in and produces an IQueryable/IOrderedQueryable as output.  With such functions I can build up LINQ expressions with reusable code that still defer query until the query is fully constructed.  Here, since I only have an int (the orderID) I'm not sure how to make it work.

thanks
","2009-04-20 17:47:10"
"769351","refactoring LINQ IQueryable expression to remove duplicated portions of queries","7","<linq><linq-to-sql><iqueryable>","2009-04-20 17:47:10"
"769351","refactoring LINQ IQueryable expression to remove duplicated portions of queries","7","I have some linq queries that have redundancy I'd like to factor out a single piece of code.  These are join experssions that are IQueryable, and its important I don't cause the query to be evaluated earlier than it would be without the refactoring.

  Here is a simplified query:

    var result = 
    from T in db.Transactions
    join O in db.Orders on T.OrderID equals O.OrderID
    join OD in db.OrderDetails on O.OrderID equals OD.OrderID into OrderDetails
    let FirstProductBought = OrderDetails.First().Select(OD => OD.Product.ProductName)
    select new
    {
      TransactionID = T.TransactionID,
      OrderID = O.OrderID,
      FirstProductBought = FirstProductBought
    };

What I want to factor out is th logic ""given an order, what is the first product bought"".  I am using the same logic in other queries.  How can I factor it out into a shared method?

Generally, for code reuse and IQueryables, what I've been able to do is code that takes an IQueryable going in and produces an IQueryable/IOrderedQueryable as output.  With such functions I can build up LINQ expressions with reusable code that still defer query until the query is fully constructed.  Here, since I only have an int (the orderID) I'm not sure how to make it work.

thanks
","2009-04-21 04:30:40"
"769351","refactoring LINQ IQueryable expression to remove duplicated portions of queries","7","<linq><linq-to-sql><iqueryable><.net>","2009-05-02 01:59:34"
"6033146","refactoring large cursor queries by splitting into multiple cursors","6","refactoring large cursor queries by splitting into multiple cursors","2011-05-17 15:22:08"
"6033146","refactoring large cursor queries by splitting into multiple cursors","6","Another PL/SQL refactoring question!

I have several cursors that are of the general simplified form:

    cursor_1 is
      with X as (select col1, col2 from TAB where col1 = '1'),
           Y as (select col1, col2 from TAB where col2 = '3'),
      /*main select*/
      select ...
      from X, Y,...
      group by rollup...

    cursor_2 is
      with X as (select col1, col2 from TAB where col1 = '7' and col2 = '9' and col3 = 'TEST'),
           Y as (select col1, col2 from TAB where col3 = '6'),
      /*main select*/
      select ...
      from X, Y,...
      group by rollup...


    cursor_2 is
      with X as (select col1, col2 from TAB where col1 IS NULL ),
           Y as (select col1, col2 from TAB where col2 IS NOT NULL ),
      /*main select*/
      select ...
      from X, Y,...
      group by rollup...


    ...
    begin
        for r in cursor_1 loop
           print_report_results(r);
        end loop;

        for r in cursor_2 loop
           print_report_results(r);
        end loop;
        ...
    end;
Basically, all of these cursors (there's more than 3) are the same summary/reporting queries. The difference is in the factored subqueries. There are always 2 factored subqueries, ""X"" and ""Y"", and they always select the same columns to feed into the main reporting query.

The problem is that the main reporting query is VERY large, about 70 lines. This itself isn't so bad, but it was copy-pasted for ALL of the reporting queries (I think there's over a dozen).

Since the only difference is in the factored subqueries (and they all return the same columns, it's really just a difference in the tables they select from and their conditions) I was hoping to find a way to refactor all this so that there is ONE query for the giant report and smaller ones for the various factored subqueries so that when changes are made to the way the report is done, I only have to do it in one place, not a dozen. Not to mention a much easier-to-navigate (and read) file!

I just don't know how to properly refactor something like this. I was thinking pipelined functions? I'm not sure they're appropriate for this though, or if there's a simpler way...

On the other hand, I also wonder if performance would be significantly worse by splitting out the reporting query. Performance (speed) *is* an issue for this system. I'd rather not introduce changes for developer convenience if it adds significant execution time.

(Using Oracle 10g)","2011-05-17 15:22:08"
"6033146","refactoring large cursor queries by splitting into multiple cursors","6","<oracle><plsql><refactoring>","2011-05-17 15:22:08"
"6033146","refactoring large cursor queries by splitting into multiple cursors","6","Another PL/SQL refactoring question!

I have several cursors that are of the general simplified form:

    cursor_1 is
      with X as (select col1, col2 from TAB where col1 = '1'),
           Y as (select col1, col2 from TAB where col2 = '3'),
      /*main select*/
      select ...
      from X, Y,...
      group by rollup...

    cursor_2 is
      with X as (select col1, col2 from TAB where col1 = '7' and col2 = '9' and col3 = 'TEST'),
           Y as (select col1, col2 from TAB where col3 = '6'),
      /*main select*/
      select ...
      from X, Y,...
      group by rollup...


    cursor_2 is
      with X as (select col1, col2 from TAB where col1 IS NULL ),
           Y as (select col1, col2 from TAB where col2 IS NOT NULL ),
      /*main select*/
      select ...
      from X, Y,...
      group by rollup...


    ...
    begin
        for r in cursor_1 loop
           print_report_results(r);
        end loop;

        for r in cursor_2 loop
           print_report_results(r);
        end loop;
        ...
    end;
Basically, all of these cursors (there's more than 3) are the same summary/reporting queries. The difference is in the factored subqueries. There are always 2 factored subqueries, ""X"" and ""Y"", and they always select the same columns to feed into the main reporting query.

The problem is that the main reporting query is VERY large, about 70 lines. This itself isn't so bad, but it was copy-pasted for ALL of the reporting queries (I think there's over a dozen).

Since the only difference is in the factored subqueries (and they all return the same columns, it's really just a difference in the tables they select from and their conditions) I was hoping to find a way to refactor all this so that there is ONE query for the giant report and smaller ones for the various factored subqueries so that when changes are made to the way the report is done, I only have to do it in one place, not a dozen. Not to mention a much easier-to-navigate (and read) file!

I just don't know how to properly refactor something like this. I was thinking pipelined functions? I'm not sure they're appropriate for this though, or if there's a simpler way...

On the other hand, I also wonder if performance would be significantly worse by splitting out the reporting query. Performance (speed) *is* an issue for this system. I'd rather not introduce changes for developer convenience if it adds significant execution time.

***
I guess what I'd ultimately like is something that looks sort of like this (I'm just not sure how to do this so that it will actually compile):

    cursor main_report_cursor (in_X, in_Y) is
        with X as (select * from in_X),
             Y as (select * from in_Y)
      /*main select*/
      select ...
      from X, Y,...
      group by rollup...

    cursor x_1 is
         select col1, col2 from TAB where col1 = '1';
    cursor y_1 is
         select col1, col2 from TAB where col2 = '3'

    ...
    begin
    for r in main_report_cursor(x_1,y_1) loop
       print_report_results(r);
    end loop;

    for r in main_report_cursor(x_2,y_2) loop
       print_report_results(r);
    end loop;
    ...

(Using Oracle 10g)","2011-05-17 17:44:58"
"6033146","refactoring large cursor queries by splitting into multiple cursors","6","Another PL/SQL refactoring question!

I have several cursors that are of the general simplified form:

    cursor_1 is
      with X as (select col1, col2 from TAB where col1 = '1'),
           Y as (select col1, col2 from TAB where col2 = '3'),
      /*main select*/
      select count(X.col1), ...
      from X inner join Y on...
      group by rollup (X.col1, ...

    cursor_2 is
      with X as (select col1, col2 from TAB where col1 = '7' and col2 = '9' and col3 = 'TEST'),
           Y as (select col1, col2 from TAB where col3 = '6'),
      /*main select*/
      select count(X.col1), ...
      from X inner join Y on...
      group by rollup (X.col1, ...


    cursor_2 is
      with X as (select col1, col2 from TAB where col1 IS NULL ),
           Y as (select col1, col2 from TAB where col2 IS NOT NULL ),
      /*main select*/
      select count(X.col1), ...
      from X inner join Y on...
      group by rollup (X.col1, ...


    ...
    begin
        for r in cursor_1 loop
           print_report_results(r);
        end loop;

        for r in cursor_2 loop
           print_report_results(r);
        end loop;
        ...
    end;
Basically, all of these cursors (there's more than 3) are the same summary/reporting queries. The difference is in the factored subqueries. There are always 2 factored subqueries, ""X"" and ""Y"", and they always select the same columns to feed into the main reporting query.

The problem is that the main reporting query is VERY large, about 70 lines. This itself isn't so bad, but it was copy-pasted for ALL of the reporting queries (I think there's over a dozen).

Since the only difference is in the factored subqueries (and they all return the same columns, it's really just a difference in the tables they select from and their conditions) I was hoping to find a way to refactor all this so that there is ONE query for the giant report and smaller ones for the various factored subqueries so that when changes are made to the way the report is done, I only have to do it in one place, not a dozen. Not to mention a much easier-to-navigate (and read) file!

I just don't know how to properly refactor something like this. I was thinking pipelined functions? I'm not sure they're appropriate for this though, or if there's a simpler way...

On the other hand, I also wonder if performance would be significantly worse by splitting out the reporting query. Performance (speed) *is* an issue for this system. I'd rather not introduce changes for developer convenience if it adds significant execution time.

***
I guess what I'd ultimately like is something that looks sort of like this (I'm just not sure how to do this so that it will actually compile):

    cursor main_report_cursor (in_X, in_Y) is
        with X as (select * from in_X),
             Y as (select * from in_Y)
      /*main select*/
      select count(X.col1), ...
      from X inner join Y on...
      group by rollup (X.col1, ...

    cursor x_1 is
         select col1, col2 from TAB where col1 = '1';
    cursor y_1 is
         select col1, col2 from TAB where col2 = '3'

    ...
    begin
    for r in main_report_cursor(x_1,y_1) loop
       print_report_results(r);
    end loop;

    for r in main_report_cursor(x_2,y_2) loop
       print_report_results(r);
    end loop;
    ...

(Using Oracle 10g)","2011-05-17 17:55:05"
"6823936","refactoring a whole class name in whole xcode project","6","refactoring a whole class name in whole xcode project","2011-07-26 00:17:53"
"6823936","refactoring a whole class name in whole xcode project","6","I just changed my class name from Group.h to CVGroup.h and therefore everything is affected in my code. Is it possible to refactor the whole project so that Group is refactored into CVGroup?","2011-07-26 00:17:53"
"6823936","refactoring a whole class name in whole xcode project","6","<iphone><objective-c><xcode>","2011-07-26 00:17:53"
"1409432","refactoring Java arrays and primitives (double[][]) to Collections and Generics (List<List<Double>>)","5","refactoring Java arrays and primitives (double[][]) to Collections and Generics (List<List<Double>>)","2009-09-11 07:15:28"
"1409432","refactoring Java arrays and primitives (double[][]) to Collections and Generics (List<List<Double>>)","5","I have been refactoring throwaway code which I wrote some years ago in a FORTRAN-like style. Most of the code is now much more organized and readable. However the heart of the algorithm (which is performance-critical) uses 1- and 2-dimensional Java arrays and is typified by:

           for (int j = 1; j < len[1]+1; j++) {
            int jj = (cont == BY_TYPE) ? seq[1][j-1] : j-1;
            for (int i = 1; i < len[0]+1; i++) {
                matrix[i][j] = matrix[i-1][j] + gap;
                double m = matrix[i][j-1] + gap;
                if (m > matrix[i][j]) {
                    matrix[i][j] = m;
                    pointers[i][j] = UP;
                }

For clarity, maintainability and interfacing with the rest of the code I would like to refactor it. However on reading [Java Generics Syntax for arrays][1] and   [Java Generics and number][2]s I have the following concerns:

 - Performance. The code is planned to use about 10^8 - 10^9 secs/yr and this is just about manageable. My reading suggests that changing double to Double can sometimes add a factor of 3 in performance. I'd like other experience on this. I would also expect that moving from foo[] to List<Foo> would be a hit as well. I have no first-hand knowledge and again experience would be useful. 

 - Array-bound checking. Is this treated differently in double[] and List<Double> and does it matter? I expect some problems to violate bounds as the algorithm is fairly simple and has only been applied to a few data sets.

 - If I don't refactor then the code has an ugly and possibly fragile intermixture of the two approaches. I am already trying to write things such as:

    List&lt;double[]&gt; and
    List&lt;Double&gt;[]

and understand that the erasure does not make this pretty and at best gives rise to compiler warnings. It seems difficult to do this without very convoluted constructs.

 - Obsolescence. One poster suggested that Java arrays should be obsoleted. I assume this isn't going to happen RSN but I would like to move away from outdated approaches.

  [1]: http://stackoverflow.com/questions/185594/java-generics-syntax-for-arrays
  [2]: http://stackoverflow.com/questions/877897/java-generics-and-numbers

","2009-09-11 07:15:28"
"1409432","refactoring Java arrays and primitives (double[][]) to Collections and Generics (List<List<Double>>)","5","<java><generics><collections><arrays>","2009-09-11 07:15:28"
"1409432","refactoring Java arrays and primitives (double[][]) to Collections and Generics (List<List<Double>>)","5","I have been refactoring throwaway code which I wrote some years ago in a FORTRAN-like style. Most of the code is now much more organized and readable. However the heart of the algorithm (which is performance-critical) uses 1- and 2-dimensional Java arrays and is typified by:

        for (int j = 1; j < len[1]+1; j++) {
            int jj = (cont == BY_TYPE) ? seq[1][j-1] : j-1;
            for (int i = 1; i < len[0]+1; i++) {
                matrix[i][j] = matrix[i-1][j] + gap;
                double m = matrix[i][j-1] + gap;
                if (m > matrix[i][j]) {
                    matrix[i][j] = m;
                    pointers[i][j] = UP;
                }
                //...
            }
        }

For clarity, maintainability and interfacing with the rest of the code I would like to refactor it. However on reading [Java Generics Syntax for arrays][1] and   [Java Generics and number][2]s I have the following concerns:

 - Performance. The code is planned to use about 10^8 - 10^9 secs/yr and this is just about manageable. My reading suggests that changing double to Double can sometimes add a factor of 3 in performance. I'd like other experience on this. I would also expect that moving from foo[] to List<Foo> would be a hit as well. I have no first-hand knowledge and again experience would be useful. 

 - Array-bound checking. Is this treated differently in double[] and List<Double> and does it matter? I expect some problems to violate bounds as the algorithm is fairly simple and has only been applied to a few data sets.

 - If I don't refactor then the code has an ugly and possibly fragile intermixture of the two approaches. I am already trying to write things such as:

    List&lt;double[]&gt; and
    List&lt;Double&gt;[]

and understand that the erasure does not make this pretty and at best gives rise to compiler warnings. It seems difficult to do this without very convoluted constructs.

 - Obsolescence. One poster suggested that Java arrays should be obsoleted. I assume this isn't going to happen RSN but I would like to move away from outdated approaches.

  [1]: https://stackoverflow.com/questions/185594/java-generics-syntax-for-arrays
  [2]: https://stackoverflow.com/questions/877897/java-generics-and-numbers


**SUMMARY** The consensus so far:

 - Collections have a significant performance hit over primitive arrays, especially for constructs such as matrices. This is incurred in auto(un)boxing numerics and in accessing list items

 - For tight numerical (scientific) algorithms the array notation [][] is actually easier to read but the variables should named as helpfully as possible

 - Generics and arrays do not mix well. It may be useful to wrap the arrays in classes to transport them in/out of the tight algorithm.

There is little objective reason to make the change

**QUESTION** @SeanOwen has suggested that it would be useful to take constant values out of the loops. Assuming I haven't goofed this would look like:


     int len1 = len[1];
     int len0 = len[0];
     int seq1 = seq[1];
     int[] pointersi;
     double[] matrixi;
     for (int i = 1; i < len0+1; i++) {
         matrixi = matrix[i];
         pointersi = pointers[i];
     }
     for (int j = 1; j < len1+1; j++) {
        int jj = (cont == BY_TYPE) ? seq1[j-1] : j-1;
        for (int i = 1; i < len0+1; i++) {
            matrixi[j] = matrixi[j] + gap;
            double m = matrixi[j-1] + gap;
            if (m > matrixi[j]) {
                matrixi[j] = m;
                pointersi[j] = UP;
            }
            //...
        }
    }

I thought compilers were meant to be smart at doing this sort of thing. Do we need to still do this?
","2017-05-23 12:07:46"
"1409432","refactoring Java arrays and primitives (double[][]) to Collections and Generics (List<List<Double>>)","5","I have been refactoring throwaway code which I wrote some years ago in a FORTRAN-like style. Most of the code is now much more organized and readable. However the heart of the algorithm (which is performance-critical) uses 1- and 2-dimensional Java arrays and is typified by:

        for (int j = 1; j < len[1]+1; j++) {
            int jj = (cont == BY_TYPE) ? seq[1][j-1] : j-1;
            for (int i = 1; i < len[0]+1; i++) {
                matrix[i][j] = matrix[i-1][j] + gap;
                double m = matrix[i][j-1] + gap;
                if (m > matrix[i][j]) {
                    matrix[i][j] = m;
                    pointers[i][j] = UP;
                }
                //...
            }
        }

For clarity, maintainability and interfacing with the rest of the code I would like to refactor it. However on reading [Java Generics Syntax for arrays][1] and   [Java Generics and number][2]s I have the following concerns:

 - Performance. The code is planned to use about 10^8 - 10^9 secs/yr and this is just about manageable. My reading suggests that changing double to Double can sometimes add a factor of 3 in performance. I'd like other experience on this. I would also expect that moving from foo[] to List<Foo> would be a hit as well. I have no first-hand knowledge and again experience would be useful. 

 - Array-bound checking. Is this treated differently in double[] and List<Double> and does it matter? I expect some problems to violate bounds as the algorithm is fairly simple and has only been applied to a few data sets.

 - If I don't refactor then the code has an ugly and possibly fragile intermixture of the two approaches. I am already trying to write things such as:

    List&lt;double[]&gt; and
    List&lt;Double&gt;[]

and understand that the erasure does not make this pretty and at best gives rise to compiler warnings. It seems difficult to do this without very convoluted constructs.

 - Obsolescence. One poster suggested that Java arrays should be obsoleted. I assume this isn't going to happen RSN but I would like to move away from outdated approaches.

  [1]: http://stackoverflow.com/questions/185594/java-generics-syntax-for-arrays
  [2]: http://stackoverflow.com/questions/877897/java-generics-and-numbers


","2009-09-11 07:37:44"
"1409432","refactoring Java arrays and primitives (double[][]) to Collections and Generics (List<List<Double>>)","5","I have been refactoring throwaway code which I wrote some years ago in a FORTRAN-like style. Most of the code is now much more organized and readable. However the heart of the algorithm (which is performance-critical) uses 1- and 2-dimensional Java arrays and is typified by:

        for (int j = 1; j < len[1]+1; j++) {
            int jj = (cont == BY_TYPE) ? seq[1][j-1] : j-1;
            for (int i = 1; i < len[0]+1; i++) {
                matrix[i][j] = matrix[i-1][j] + gap;
                double m = matrix[i][j-1] + gap;
                if (m > matrix[i][j]) {
                    matrix[i][j] = m;
                    pointers[i][j] = UP;
                }
                //...
            }
        }

For clarity, maintainability and interfacing with the rest of the code I would like to refactor it. However on reading [Java Generics Syntax for arrays][1] and   [Java Generics and number][2]s I have the following concerns:

 - Performance. The code is planned to use about 10^8 - 10^9 secs/yr and this is just about manageable. My reading suggests that changing double to Double can sometimes add a factor of 3 in performance. I'd like other experience on this. I would also expect that moving from foo[] to List<Foo> would be a hit as well. I have no first-hand knowledge and again experience would be useful. 

 - Array-bound checking. Is this treated differently in double[] and List<Double> and does it matter? I expect some problems to violate bounds as the algorithm is fairly simple and has only been applied to a few data sets.

 - If I don't refactor then the code has an ugly and possibly fragile intermixture of the two approaches. I am already trying to write things such as:

    List&lt;double[]&gt; and
    List&lt;Double&gt;[]

and understand that the erasure does not make this pretty and at best gives rise to compiler warnings. It seems difficult to do this without very convoluted constructs.

 - Obsolescence. One poster suggested that Java arrays should be obsoleted. I assume this isn't going to happen RSN but I would like to move away from outdated approaches.

  [1]: http://stackoverflow.com/questions/185594/java-generics-syntax-for-arrays
  [2]: http://stackoverflow.com/questions/877897/java-generics-and-numbers


**SUMMARY** The consensus so far:

 - Collections have a significant performance hit over primitive arrays, especially for constructs such as matrices. This is incurred in auto(un)boxing numerics and in accessing list items

 - For tight numerical (scientific) algorithms the array notation [][] is actually easier to read but the variables should named as helpfully as possible

 - Generics and arrays do not mix well. It may be useful to wrap the arrays in classes to transport them in/out of the tight algorithm.

There is little objective reason to make the change","2009-09-11 13:27:57"
"1409432","refactoring Java arrays and primitives (double[][]) to Collections and Generics (List<List<Double>>)","5","I have been refactoring throwaway code which I wrote some years ago in a FORTRAN-like style. Most of the code is now much more organized and readable. However the heart of the algorithm (which is performance-critical) uses 1- and 2-dimensional Java arrays and is typified by:

        for (int j = 1; j < len[1]+1; j++) {
            int jj = (cont == BY_TYPE) ? seq[1][j-1] : j-1;
            for (int i = 1; i < len[0]+1; i++) {
                matrix[i][j] = matrix[i-1][j] + gap;
                double m = matrix[i][j-1] + gap;
                if (m > matrix[i][j]) {
                    matrix[i][j] = m;
                    pointers[i][j] = UP;
                }
                //...
            }
        }

For clarity, maintainability and interfacing with the rest of the code I would like to refactor it. However on reading [Java Generics Syntax for arrays][1] and   [Java Generics and number][2]s I have the following concerns:

 - Performance. The code is planned to use about 10^8 - 10^9 secs/yr and this is just about manageable. My reading suggests that changing double to Double can sometimes add a factor of 3 in performance. I'd like other experience on this. I would also expect that moving from foo[] to List<Foo> would be a hit as well. I have no first-hand knowledge and again experience would be useful. 

 - Array-bound checking. Is this treated differently in double[] and List<Double> and does it matter? I expect some problems to violate bounds as the algorithm is fairly simple and has only been applied to a few data sets.

 - If I don't refactor then the code has an ugly and possibly fragile intermixture of the two approaches. I am already trying to write things such as:

    List&lt;double[]&gt; and
    List&lt;Double&gt;[]

and understand that the erasure does not make this pretty and at best gives rise to compiler warnings. It seems difficult to do this without very convoluted constructs.

 - Obsolescence. One poster suggested that Java arrays should be obsoleted. I assume this isn't going to happen RSN but I would like to move away from outdated approaches.

  [1]: http://stackoverflow.com/questions/185594/java-generics-syntax-for-arrays
  [2]: http://stackoverflow.com/questions/877897/java-generics-and-numbers


**SUMMARY** The consensus so far:

 - Collections have a significant performance hit over primitive arrays, especially for constructs such as matrices. This is incurred in auto(un)boxing numerics and in accessing list items

 - For tight numerical (scientific) algorithms the array notation [][] is actually easier to read but the variables should named as helpfully as possible

 - Generics and arrays do not mix well. It may be useful to wrap the arrays in classes to transport them in/out of the tight algorithm.

There is little objective reason to make the change

**QUESTION** @SeanOwen has suggested that it would be useful to take constant values out of the loops. Assuming I haven't goofed this would look like:


     int len1 = len[1];
     int len0 = len[0];
     int seq1 = seq[1];
     int[] pointersi;
     double[] matrixi;
     for (int i = 1; i < len0+1; i++) {
         matrixi = matrix[i];
         pointersi = pointers[i];
     }
     for (int j = 1; j < len1+1; j++) {
        int jj = (cont == BY_TYPE) ? seq1[j-1] : j-1;
        for (int i = 1; i < len0+1; i++) {
            matrixi[j] = matrixi[j] + gap;
            double m = matrixi[j-1] + gap;
            if (m > matrixi[j]) {
                matrixi[j] = m;
                pointersi[j] = UP;
            }
            //...
        }
    }

I thought compilers were meant to be smart at doing this sort of thing. Do we need to still do this?
","2009-09-15 14:50:21"
"1367876","refactor conditions within haml view","5","refactor conditions within haml view","2009-09-02 13:59:43"
"1367876","refactor conditions within haml view","5","beside the fact that accessibility standards discourage the use
of a link pointing to the current page, how I am supposed to 
refactor the following view code?

    #navigation
      %ul.tabbed
        - if current_page?(new_profile_path)
          %li{:class => ""current_page_item""}
            = link_to t(""new_profile""), new_profile_path
        - else
          %li
            = link_to t(""new_profile""), new_profile_path
    
        - if current_page?(profiles_path)
          %li{:class => ""current_page_item""}
            = link_to t(""profiles""), profiles_path
        - else
          %li
            = link_to t(""profiles""), profiles_path
        ...

Thank you.","2009-09-02 13:59:43"
"1367876","refactor conditions within haml view","5","<haml><ruby><ruby-on-rails>","2009-09-02 13:59:43"
"6696469","refactor this basic code that determines if number is in tens, hundreds, thousands etc","4","refactor this basic code that determines if number is in tens, hundreds, thousands etc.","2011-07-14 16:13:09"
"6696469","refactor this basic code that determines if number is in tens, hundreds, thousands etc","4","     if (n>10 && n<100) {
         x = 10;
     } else if (n>100 && n<1000) {
         x = 100;
     } else if (n>1000 && n<10000) {
         x = 1000;
     } else if (n....

etc. etc. 

Is there a nice concise, scalable method for this type of problem? My brain has decided to stop working. ","2011-07-14 16:13:09"
"6696469","refactor this basic code that determines if number is in tens, hundreds, thousands etc","4","<javascript><refactoring>","2011-07-14 16:13:09"
"6696469","refactor this basic code that determines if number is in tens, hundreds, thousands etc","4","     if (n<100) {
         x = 10;
     } else if (n<1000) {
         x = 100;
     } else if (n<10000) {
         x = 1000;
     } else if (n....

etc. etc. 

Is there a nice concise, scalable method for this type of problem? My brain has decided to stop working. ","2011-07-14 16:22:52"
"7412535","refactoring long methods with fluent interfaces","4","refactoring long methods with fluent interfaces","2011-09-14 07:11:07"
"7412535","refactoring long methods with fluent interfaces","4","	

I'd like to know your opinion about using the fluent interface pattern to refactor a long method.

http://en.wikipedia.org/wiki/Fluent_interface


The fluent pattern is not included in the refactoring books.


for example, say you have this long method (with a long name as it 
does many things)

    class TravelClub {
    
       Receipt buyAndAddPointsAndGetReceipt(long amount, long cardNumber) {
    	buy(amount);
    	accumulatePoints(cardNumber);
    	return generateReceipt();
    	
       }
    
       void buy(int amount) {...}
    
       void accumlatePoints(int cardNumber) {...}
    
       void generateRecepit() {...}
    
    }

called as:

    Receipt myReceipt = myTravelClub.buyAndAddPointsAndGetReceipt(543L,12345678L);


That could be refactored to:

    class TravelClub {
    
       TravelClub buy(long amount) {
    	buy(amount);
    	return this;
       }
    
       TravelClub accumulatePoints(long cardNumber) {
    	buy(amount);
    	return this;
       }
    
       Receipt generateReceipt() {
    	return new Receipt(...);
       }
    
    
    }

and called as:

    Receipt myReceipt = myTravelClub.buy(543L).accumulatePoints(12345678L).generateReceipt();



from my point of view this is a quite good manner to decompose a long method and
also to decompose its name.



what do you think?




","2011-09-14 07:11:07"
"7412535","refactoring long methods with fluent interfaces","4","<java><refactoring><fluent><fluent-interface>","2011-09-14 07:11:07"
"7412535","refactoring long methods with fluent interfaces","4","	

I'd like to know your opinion about using the fluent interface pattern to refactor a long method.

http://en.wikipedia.org/wiki/Fluent_interface


The fluent pattern is not included in the refactoring books.


for example, say you have this long method (with a long name as it 
does many things)

    class TravelClub {
    
       Receipt buyAndAddPointsAndGetReceipt(long amount, long cardNumber) {
    	buy(amount);
    	accumulatePoints(cardNumber);
    	return generateReceipt();
    	
       }
    
       void buy(int amount) {...}
    
       void accumlatePoints(int cardNumber) {...}
    
       void generateRecepit() {...}
    
    }

called as:

    Receipt myReceipt = myTravelClub.buyAndAddPointsAndGetReceipt(543L,12345678L);


That could be refactored to:

    class TravelClub {
    
       TravelClub buy(long amount) {
    	//buy stuff
    	return this;
       }
    
       TravelClub accumulatePoints(long cardNumber) {
    	//accumulate stuff
    	return this;
       }
    
       Receipt generateReceipt() {
    	return new Receipt(...);
       }
    
    
    }

and called as:

    Receipt myReceipt = myTravelClub.buy(543L).accumulatePoints(12345678L).generateReceipt();



from my point of view this is a quite good manner to decompose a long method and
also to decompose its name.



what do you think?




","2011-09-14 08:37:53"
"9084397","refactoring jquery selector expression","4","refactoring jquery selector expression","2012-01-31 17:48:53"
"9084397","refactoring jquery selector expression","4","Is there a way that I can write the following selector in a less verbose fashion (the parent id is being repeated again and again).

#parent_id .class1 , #parent_id .class2,....

Thanx!","2012-01-31 17:48:53"
"9084397","refactoring jquery selector expression","4","<jquery><selector>","2012-01-31 17:48:53"
"9084397","refactoring jquery selector expression","4","Is there a way that I can write the following selector in a less verbose fashion (the parent id is being repeated again and again).

    $(""#parent_id .class1 , #parent_id .class2,...."")

Thanx!","2012-01-31 17:51:50"
"1215207","refactoring multiple if-else conditionals in a method","3","refactoring mulitple if-else conditionals in a method","2009-07-31 22:37:28"
"1215207","refactoring multiple if-else conditionals in a method","3","I am in the process of refactoring my existing code. It actually works fine, but it is a bit cluttered with multiple if-else conditionals checking the value of one variable and change the value of a second variable to an updated value taken from a fixed enumeration structure.

    else if (var1 == 'valueX')
	{
		if (var2 == MyEnum.A)
			var2 = MyEnum.B;
		else if (var2 == MyEnum.B)
			var2 = MyEnum.C;
		else if (var2 == MyEnum.C)
			var2 = MyEnum.D;
		else if (var2 == MyEnum.D)
			var2 = MyEnum.A;
	}

    else if (....)
    {
    ..similar block of conditionals
    }

I am a bit confused as to what is the best way to refactor and clean-up this code. Would you suggest the use of a switch perhaps? Or something more elegant?

Thanks in advance!","2009-07-31 22:37:28"
"1215207","refactoring multiple if-else conditionals in a method","3","<refactoring><java><conditional>","2009-07-31 22:37:28"
"1215207","refactoring multiple if-else conditionals in a method","3","refactoring multiple if-else conditionals in a method","2009-07-31 23:16:33"
"1215207","refactoring multiple if-else conditionals in a method","3","I am in the process of refactoring my existing code. It actually works fine, but it is a bit cluttered with multiple if-else conditionals checking the value of one variable and change the value of a second variable to an updated value taken from a fixed enumeration structure.

    else if (var1 == 'valueX')
	{
		if (var2 == MyEnum.A)
			var2 = MyEnum.B;
		else if (var2 == MyEnum.B)
			var2 = MyEnum.C;
		else if (var2 == MyEnum.C)
			var2 = MyEnum.D;
		else if (var2 == MyEnum.D)
			var2 = MyEnum.A;
	}

    else if (....)
    {
    ..similar block of conditionals
    }

I am a bit confused as to what is the best way to refactor and clean-up this code. Would you suggest the use of a switch perhaps? Or something more elegant?

Thanks in advance!","2009-07-31 23:16:33"
"7707673","refactoring javascript. decouple markup or separate modules","3","refactoring javascript. decouple markup or separate modules","2011-10-10 01:10:01"
"7707673","refactoring javascript. decouple markup or separate modules","3","I'm trying to make a large (~10K lines) javascript code base more maintainable.  Pretty much all of the code is contained in one massive class.  I want to do some refactoring, but I don't want to completely rewrite the code.  

I have two ideas for how to re-organize the code, but I'm not sure which one is best. (I'm very open to other ideas too)  What do you think about each of these approaches?  How would you decide which is best?


Idea 1 – Decouple markup from business logic.
We have a somewhat complicated set of rules for what and how things should be displayed to users.  This approach would split that into ""What do we display?"" and ""How do we display it?""


Idea 2 – Break apart separate components into their own class. 
There are several somewhat disjoint components in this code.  If this code base were Facebook's – this approach would involve pulling apart the code for photos and the newsfeed.
","2011-10-10 01:10:01"
"7707673","refactoring javascript. decouple markup or separate modules","3","<javascript><refactoring>","2011-10-10 01:10:01"
"9463245","refactor LINQ function","3","refactor LINQ function","2012-02-27 10:12:31"
"9463245","refactor LINQ function","3","How could I refactor this function so it could take any many to many parameters?

Program has many to many parameters as in Age, Color, etc...
  
So I have this function:

    public int GetAgesOnProgram(IEnumerable<Program> ProgramList)
    {
        return (from x in ProgramList
            where x.Ages.Any()
            select x.Ages).Count();
    }

but I also need this one:

    public int GetColorsOnProgram(IEnumerable<Program> ProgramList)
    {
        return (from x in ProgramList
            where x.Colors.Any()
            select x.Colors).Count();
    }

As I have up to 10 many to many relationships in Program, I guess it makes sense to have a single function that handles that?","2012-02-27 10:12:31"
"9463245","refactor LINQ function","3","<c#><linq>","2012-02-27 10:12:31"
"9463245","refactor LINQ function","3","How could I refactor this function so it could take any many to many parameters?

Program has many to many parameters as in Age, Color, etc...
  
So I have this function:

    public int GetAgesOnProgram(IEnumerable<Program> ProgramList)
    {
        return (from x in ProgramList
            where x.Ages.Any()
            select x.Ages).Count();
    }

but I also need this one:

    public int GetColorsOnProgram(IEnumerable<Program> ProgramList)
    {
        return (from x in ProgramList
            where x.Colors.Any()
            select x.Colors).Count();
    }

As I have up to 10 many to many relationships in Program, I guess it makes sense to have a single function that handles that?

EDIT:
How could I return the Age or Color List, rather than an int as in:

    public Colors GetColorsOnProgram(IEnumerable<Program> ProgramList)
    {
        return (from x in ProgramList
            where x.Colors.Any()
            select x.Colors);
    }","2012-02-27 10:31:48"
"9463245","refactor LINQ function","3","How could I refactor this function so it could take any many to many parameters?

Program has many to many parameters as in Age, Color, etc...
  
So I have this function:

    public int GetAgesOnProgram(IEnumerable<Program> ProgramList)
    {
        return (from x in ProgramList
            where x.Ages.Any()
            select x.Ages).Count();
    }

but I also need this one:

    public int GetColorsOnProgram(IEnumerable<Program> ProgramList)
    {
        return (from x in ProgramList
            where x.Colors.Any()
            select x.Colors).Count();
    }

As I have up to 10 many to many relationships in Program, I guess it makes sense to have a single function that handles that?

EDIT:
How could I return the Age or Color List, rather than an int as in:

    public IEnumerable<Color> GetColorsOnProgram(IEnumerable<Program> ProgramList)
    {
        return (from x in ProgramList
            where x.Colors.Any()
            select x.Colors);
    }","2012-02-27 10:47:52"
"494881","refactor this dictionary-to-xml converter in python","3","refactor this python code","2009-01-30 08:33:12"
"494881","refactor this dictionary-to-xml converter in python","3","It's a small thing, really: I have this function that converts dict objects to xml.

Here's the function:

    def dictToXml(d):
        from xml.sax.saxutils import escape

        def unicodify(o):
            if o is None:
                return u'';
            return unicode(o)

        lines = []
        def addDict(node, offset):
            for name, value in node.iteritems():
                if isinstance(value, dict):
                    lines.append(offset + u""<%s>"" % name)
                    addDict(value, offset + u"" "" * 4)
                    lines.append(offset + u""</%s>"" % name)
                elif isinstance(value, list):
                    for item in value:
                        if isinstance(item, dict):
                            lines.append(offset + u""<%s>"" % name)
                            addDict(item, offset + u"" "" * 4)
                            lines.append(offset + u""</%s>"" % name)
                        else:
                            lines.append(offset + u""<%s>%s</%s>"", (name, escape(unicodify(item)), name)
                else:
                    lines.append(offset + u""<%s>%s</%s>"" % (name, escape(unicodify(value)), name))

        addDict(d, u"""")
        lines.append(u"""")
        return u""\n"".join(lines)

For example, it converts this dictionary

    { 'site': { 'name': 'stackoverflow', 'blogger': [ 'Jeff', 'Joel' ] } }
to:

    <site>
        <name>stackoverflow</name>
        <blogger>jeff</blogger>
        <blogger>joel</blogger>
    </site>

It works, but the `addDict` function looks a little too repetitive. I'm sure there's a way to refactor it into 3 co-recursive functions named `addDict`, `addList` and `addElse`, but my brain is stuck. Any help?

Also, any way to get rid of the `offset +` thing in every line would be nice.

(Also, any idea for a better title...)","2009-01-30 08:33:12"
"494881","refactor this dictionary-to-xml converter in python","3","<python><refactoring><dry>","2009-01-30 08:33:12"
"494881","refactor this dictionary-to-xml converter in python","3","refactor this python code","2009-01-30 08:37:07"
"494881","refactor this dictionary-to-xml converter in python","3","refactor this dictionary-to-xml converter in python","2009-01-31 07:00:00"
"494881","refactor this dictionary-to-xml converter in python","3","Can someone please help me refactor this python code?","2009-01-30 08:37:06"
"494881","refactor this dictionary-to-xml converter in python","3","It's a small thing, really: I have this function that converts dict objects to xml.

Here's the function:

    def dictToXml(d):
        from xml.sax.saxutils import escape

        def unicodify(o):
            if o is None:
                return u'';
            return unicode(o)

        lines = []
        def addDict(node, offset):
            for name, value in node.iteritems():
                if isinstance(value, dict):
                    lines.append(offset + u""<%s>"" % name)
                    addDict(value, offset + u"" "" * 4)
                    lines.append(offset + u""</%s>"" % name)
                elif isinstance(value, list):
                    for item in value:
                        if isinstance(item, dict):
                            lines.append(offset + u""<%s>"" % name)
                            addDict(item, offset + u"" "" * 4)
                            lines.append(offset + u""</%s>"" % name)
                        else:
                            lines.append(offset + u""<%s>%s</%s>"" % (name, escape(unicodify(item)), name))
                else:
                    lines.append(offset + u""<%s>%s</%s>"" % (name, escape(unicodify(value)), name))

        addDict(d, u"""")
        lines.append(u"""")
        return u""\n"".join(lines)

For example, it converts this dictionary

    { 'site': { 'name': 'stackoverflow', 'blogger': [ 'Jeff', 'Joel' ] } }
to:

    <site>
        <name>stackoverflow</name>
        <blogger>jeff</blogger>
        <blogger>joel</blogger>
    </site>

It works, but the `addDict` function looks a little too repetitive. I'm sure there's a way to refactor it into 3 co-recursive functions named `addDict`, `addList` and `addElse`, but my brain is stuck. Any help?

Also, any way to get rid of the `offset +` thing in every line would be nice.

(Also, any idea for a better title...)","2009-01-30 08:37:07"
"494881","refactor this dictionary-to-xml converter in python","3","It's a small thing, really: I have this function that converts dict objects to xml.

Here's the function:

    def dictToXml(d):
        from xml.sax.saxutils import escape

        def unicodify(o):
            if o is None:
                return u'';
            return unicode(o)

        lines = []
        def addDict(node, offset):
            for name, value in node.iteritems():
                if isinstance(value, dict):
                    lines.append(offset + u""<%s>"" % name)
                    addDict(value, offset + u"" "" * 4)
                    lines.append(offset + u""</%s>"" % name)
                elif isinstance(value, list):
                    for item in value:
                        if isinstance(item, dict):
                            lines.append(offset + u""<%s>"" % name)
                            addDict(item, offset + u"" "" * 4)
                            lines.append(offset + u""</%s>"" % name)
                        else:
                            lines.append(offset + u""<%s>%s</%s>"" % (name, escape(unicodify(item)), name))
                else:
                    lines.append(offset + u""<%s>%s</%s>"" % (name, escape(unicodify(value)), name))

        addDict(d, u"""")
        lines.append(u"""")
        return u""\n"".join(lines)

For example, it converts this dictionary

    { 'site': { 'name': 'stackoverflow', 'blogger': [ 'Jeff', 'Joel' ] } }
to:

    <site>
        <name>stackoverflow</name>
        <blogger>jeff</blogger>
        <blogger>joel</blogger>
    </site>

It works, but the `addDict` function looks a little too repetitive. I'm sure there's a way to refactor it into 3 co-recursive functions named `addDict`, `addList` and `addElse`, but my brain is stuck. Any help?

Also, any way to get rid of the `offset +` thing in every line would be nice.

**NOTE**: I chose these semantics because I'm trying to match the behavior of the [json-to-xml converter][1] in [org.json][2], which I use in a different part of my project. If you got to this page just looking for a dictionary to xml converter, there are some [really](#494905) good [options](#495512) in some of the answers. (Especially [pyfo][3]).


  [1]: http://www.json.org/javadoc/org/json/XML.html#toString(java.lang.Object)
  [2]: http://www.json.org/java/index.html
  [3]: http://foss.cpcc.edu/pyfo/","2009-01-31 07:00:00"
"494881","refactor this dictionary-to-xml converter in python","3","<python><dry><xml>","2009-01-31 07:00:00"
"494881","refactor this dictionary-to-xml converter in python","3","<python><refactoring><dry>","2009-01-30 10:59:54"
"494881","refactor this dictionary-to-xml converter in python","3","<python><refactoring><dry><xml>","2009-01-30 13:48:09"
"18876149","refactoring mandatory map.get java code","3","refactoring mandatory map.get java code","2013-09-18 15:17:29"
"18876149","refactoring mandatory map.get java code","3","Please, any ideas on how to refactor this java code so I don't have to repeat those code blocks 3 (or more) times?

    
    Integer id = null;
    try {
        id = (Integer)extradata.get(""id"");
    }
    catch(Exception e) {
        logger.error(e);
    }

    if (id == null) {
        logger.error(""no id set"");
        task.setStatus(Status.ERROR);
        DBService.updateTaskStatus(conn, false, task);
        conn.commit();
        return;
    }

    String name = null;
    try {
        name = (String)extradata.get(""name"");
    }
    catch(Exception e) {
        logger.error(e);
    }

    if (name == null) {
        logger.error(""no name set"");
        task.setStatus(Status.ERROR);
        DBService.updateTaskStatus(conn, false, task);
        conn.commit();
        return;
    }

    String city = null;
    try {
        city = (String)extradata.get(""city"");
    }
    catch(Exception e) {
        logger.error(e);
    }

    if (city == null) {
        logger.error(""no city set"");
        task.setStatus(Status.ERROR);
        DBService.updateTaskStatus(conn, false, task);
        conn.commit();
        return;
    }
","2013-09-18 15:17:29"
"18876149","refactoring mandatory map.get java code","3","<java>","2013-09-18 15:17:29"
"5233063","refactor/rename script for rails 3","3","refactor/rename script for rails 3","2011-03-08 13:23:43"
"5233063","refactor/rename script for rails 3","3","Is there a refactor/rename script similar to https://github.com/hiroshi/script-refactor that works with rails 3?","2011-03-08 13:23:43"
"5233063","refactor/rename script for rails 3","3","<ruby-on-rails><ruby-on-rails-3>","2011-03-08 13:23:43"
"1582256","refactoring in iSeries (RPG), is it realistic","3","refactoring in iSeries (RPG), is it realistic","2009-10-17 13:50:37"
"1582256","refactoring in iSeries (RPG), is it realistic","3","implementing agile in projects, requires to be able to do refactoring. it is not really a must, but code refactoring has proven to be a good engineering practice.

in an agile (scrum) project on iSeries platform, which requires development (new code and modifications to legacy code) in RPG, RPG LE, is it possible to implement refactoring? if so what are the techniques to do it?

may be if someone that has tried it could share experience or just point references. 

I will greatly appreciate.","2009-10-17 13:50:37"
"1582256","refactoring in iSeries (RPG), is it realistic","3","<refactoring><ibm-midrange><agile><agile-processes>","2009-10-17 13:50:37"
"1582256","refactoring in iSeries (RPG), is it realistic","3","Implementing agile in projects requires the ability to do refactoring. It is not really a must, but code refactoring has proven to be a good engineering practice.

In an agile (Scrum) project on the iSeries platform, which requires development (new code and modifications to legacy code) in RPG, RPG LE, is it possible to implement refactoring? If so what are the techniques to do it?

If someone who has tried it could share their experience or just point to references, I would greatly appreciate it.","2009-10-17 14:41:27"
"1582256","refactoring in iSeries (RPG), is it realistic","3","<refactoring><ibm-midrange><agile><agile-processes><rpgle>","2009-10-17 14:41:27"
"39163040","refactoring postgres join vs except","3","refactoring postgres join vs except","2016-08-26 09:31:58"
"39163040","refactoring postgres join vs except","3","I'm trying to refactor one of my queries and I'm just not doing something quite right.

I would like to combine two queries and make one, but I'm confused on how it works with a LEFT JOIN.

# Old query (which data is correct)


    SELECT first_name, last_name, email
    FROM quiz_masters
    WHERE quiz_masters.state = 'active' # (175 rows)
    
    EXCEPT

    SELECT first_name, last_name, email
    FROM quiz_masters
    LEFT JOIN events ON events.quiz_master_id = quiz_masters.id
    WHERE quiz_masters.state = 'active'
    AND EXTRACT(dow FROM events.start_at::timestamp::date) = 3 AND events.state = 'active'
    GROUP BY first_name, last_name, email # (- 20 rows)
    
Total of 155 rows match the query.

# Combined query which doesn't work

I would like to combine them into something like:

    SELECT first_name, last_name, email
    FROM quiz_masters
    LEFT JOIN events ON events.quiz_master_id = quiz_masters.id
    WHERE quiz_masters.state = 'active'
    AND events.quiz_master_id IS null
    OR (EXTRACT(dow FROM events.start_at::timestamp::date) <> 3 AND events.state = 'active')
    GROUP BY first_name, last_name, email

144 Rows (missing 11 rows)

But I'm not sure how to keep all the rows from some `quiz_masters` who are active but have no event whatsoever.  It still removes them.  Maybe I need some other kind of join?","2016-08-26 09:31:58"
"39163040","refactoring postgres join vs except","3","<sql><postgresql><left-join><postgresql-9.4>","2016-08-26 09:31:58"
"39163040","refactoring postgres join vs except","3","I'm trying to refactor one of my queries and I'm just not doing something quite right.

I would like to combine two queries and make one, but I'm confused on how it works with a LEFT JOIN.

> All QuizMasters who have a state of ""active""

**Minus (-)**

> QuizMasters who have an ""active"" event on a given day (not all QuizMasters have events only ~25%).

**Definitions**

> * **Events** store days of the week for a given event, eg Monday-Sunday (albeit as a DateTime, only the wday and time are relevant).
> * **Events** and **QuizMasters** have states which are either *""active""* or not.

# Old query (which data is correct)


    SELECT first_name, last_name, email
    FROM quiz_masters
    WHERE quiz_masters.state = 'active' # (175 rows)
    
    EXCEPT

    SELECT first_name, last_name, email
    FROM quiz_masters
    LEFT JOIN events ON events.quiz_master_id = quiz_masters.id
    WHERE quiz_masters.state = 'active'
    AND EXTRACT(dow FROM events.start_at::timestamp::date) = 3 AND events.state = 'active'
    GROUP BY first_name, last_name, email # (- 20 rows)
    
Total of 155 rows match the query.

# Combined query which doesn't work

I would like to combine them into something like:

    SELECT first_name, last_name, email
    FROM quiz_masters
    LEFT JOIN events ON events.quiz_master_id = quiz_masters.id
    WHERE quiz_masters.state = 'active'
    AND events.quiz_master_id IS null
    OR (EXTRACT(dow FROM events.start_at::timestamp::date) <> 3 AND events.state = 'active')
    GROUP BY first_name, last_name, email

144 Rows (missing 11 rows)

But I'm not sure how to keep all the rows from some `quiz_masters` who are active but have no event whatsoever.  It still removes them.  Maybe I need some other kind of join?","2016-08-26 14:17:41"
"39163040","refactoring postgres join vs except","3","I'm trying to refactor one of my queries and I'm just not doing something quite right.

I would like to combine two queries and make one, but I'm confused on how it works with a LEFT JOIN.

> All QuizMasters who have a state of ""active""

**Minus (-)**

> QuizMasters who have an ""active"" event on a given day (not all QuizMasters have events only ~25%).

**Definitions**

> * **Events** store `start_at` dow/wday for a given event, eg Monday-Sunday (albeit as a DateTime, only the wday and time are relevant).
> * **Events** and **QuizMasters** have states which are either *""active""* or not.

# Old query (which data is correct)


    SELECT first_name, last_name, email
    FROM quiz_masters
    WHERE quiz_masters.state = 'active' # (175 rows)
    
    EXCEPT

    SELECT first_name, last_name, email
    FROM quiz_masters
    LEFT JOIN events ON events.quiz_master_id = quiz_masters.id
    WHERE quiz_masters.state = 'active'
    AND EXTRACT(dow FROM events.start_at::timestamp::date) = 3 AND events.state = 'active'
    GROUP BY first_name, last_name, email # (- 20 rows)
    
Total of 155 rows match the query.

# Combined query which doesn't work

I would like to combine them into something like:

    SELECT first_name, last_name, email
    FROM quiz_masters
    LEFT JOIN events ON events.quiz_master_id = quiz_masters.id
    WHERE quiz_masters.state = 'active'
    AND events.quiz_master_id IS null
    OR (EXTRACT(dow FROM events.start_at::timestamp::date) <> 3 AND events.state = 'active')
    GROUP BY first_name, last_name, email

144 Rows (missing 11 rows)

But I'm not sure how to keep all the rows from some `quiz_masters` who are active but have no event whatsoever.  It still removes them.  Maybe I need some other kind of join?","2016-08-26 14:23:22"
"29726494","refactor two $.each() loops to one","3","refactor two $.each() loops to one","2015-04-19 06:17:15"
"29726494","refactor two $.each() loops to one","3","I have a JSON object like this...

    {  
       ""tasks"":[  
          {  
             ""id"":""task_3"",
             ""taskName"":""Task A"",
             ""assignee"":""Barrack Obama"",
             ""timeReqOptimisitic"":""4"",
             ""timeReqNormal"":""8"",
             ""timeReqPessimistic"":""14"",
             ""timeUnit"":""Days"",
             ""timeReq"":""8.33"",
             ""positionX"":493,
             ""positionY"":101,
             ""lockStatus"":""unlocked""
          }
       ],
       ""milestones"":[  
          {  
             ""id"":""task_1"",
             ""milestoneName"":""Start"",
             ""positionX"":149,
             ""positionY"":109,
             ""lockStatus"":""unlocked"",
             ""milestoneDate"":""2015-04-07""
          },
          {  
             ""id"":""task_2"",
             ""milestoneName"":""Finish"",
             ""positionX"":989,
             ""positionY"":367,
             ""lockStatus"":""unlocked"",
             ""milestoneDate"":""2015-04-22""
          }
       ],
       ""connections"":[  
          {  
             ""connectionId"":""con_10"",
             ""pageSourceId"":""task_1"",
             ""pageTargetId"":""task_3""
          },
          {  
             ""connectionId"":""con_20"",
             ""pageSourceId"":""task_3"",
             ""pageTargetId"":""task_2""
          }
       ]
    }

...this is a minimal version. In practice, there are numerous items in ""tasks"", ""milestones"" and ""connections"". 

I need to iterate through the object and determine the ""id"" of the ""milestones"" item with the lowest/earliest ""milestoneDate"", then identify the ""connections"" item that has the same value for its ""pageSourceId"" and return its ""pageTargetId"".

So in the above example:

Step 1)  Iterate through the object and determine the ""id"" of the ""milestones"" item with the lowest/earliest ""milestoneDate"".

`Answer: milestones.id = ""task_1""`

Step 2) Identify the ""connections"" item that has the same value for its ""pageSourceId"".

`Answer: connections.pageSourceId = ""task_1""`

Step 3) Return its ""pageTargetId"".

`Answer: ""task_3""`

I have a working example [here][1]. However, I would like to know if there is a way to accomplish this without using the extremely high start date and also in one loop.

  [1]: http://jsfiddle.net/sruvtwre/","2015-04-19 06:17:15"
"29726494","refactor two $.each() loops to one","3","<javascript><jquery><json>","2015-04-19 06:17:15"
"4869800","refactoring generated action code in the controller","2","refactoring generated action code in the controller","2011-02-02 01:12:28"
"4869800","refactoring generated action code in the controller","2","If I generate a scaffold I get the standard actions index, new, show, create .... all of which contain a line e.g. like  
   
    @comment = Comment.find(params[:id])

Does it make sense to put this line in a seperate method into the controller like

    def load
    @comment = Comment.find(params[:id])
    end
Is this an advantage? Thx for your time","2011-02-02 01:12:28"
"4869800","refactoring generated action code in the controller","2","<ruby-on-rails><ruby-on-rails-3>","2011-02-02 01:12:28"
"30064986","refactoring static member functions with same parameters","2","refactoring static member functions with same parameters","2015-05-05 23:36:04"
"30064986","refactoring static member functions with same parameters","2","I have a static helper class, which has several functions that are using same parameters:

    class helper {
    public:
      static double getValue(const CString &a, const CString &b, const CString &c, ... );
    private:
      static double foo(const CString &a, const CString &b, const CString &c, ... );
      static bool bar(const CString &a, const CString &b, const CString &c, ... );
      static bool qux(const CString &a, const CString &b, const CString &c, ... );
      static double wad(const CString &a, const CString &b, const CString &c, ... );
      static int xyz(const CString &a, const CString &b, const CString &c, ... );
    };

use it like:

    double value = helper::getValue(a, b, c, k, ...);

`getValue()` will call `foo()`, which will call `bar()`, `qux()` and `wad()`, etc.<br>
They all need the same data set of a, b, c.

As you can see, there are many duplicated parameters that looks a little messy.

Is there any way to refactor it?

","2015-05-05 23:36:04"
"30064986","refactoring static member functions with same parameters","2","<c++><class><static-methods>","2015-05-05 23:36:04"
"8962394","refactor ""render format"" in multiple controllers","2","refactor ""render format"" in multiple controllers","2012-01-22 16:00:59"
"8962394","refactor ""render format"" in multiple controllers","2","so i've got a view method in multiple controllers which mostly looks exactly the same:

      def show
        show! do |format|
          format.json do
            if @text.activated?
              @text.log
              render_for_api :texts_all, :json => @text
            else
              render :nothing => true
            end
          end
          format.pdf do
            pdf = QrPdf.new(@text)
            send_data pdf.render, filename: ""text_#{@text.id}.pdf"", type: ""application/pdf""
          end
        end
      end

the models for this are different, but they all have the same attributes that are used in this method (`activated`, `log`, `id`). i also could change the `render_for_api` given hash from which is currently `texts_all`, `documents_all` etc to a hash that its everywhere the same.

is there a way to use this code in multiple models without having this enormous duplication?

i'm thankful for every hint!
especially i find it hard to deal with the `do |format|` block. but also i'm not sure where to put the code and how to use it with different types of models. 

thank you.
","2012-01-22 16:00:59"
"8962394","refactor ""render format"" in multiple controllers","2","<ruby-on-rails><ruby><ruby-on-rails-3><refactoring><controller>","2012-01-22 16:00:59"
"375014","refactoring the OrderBy expression","2","refactoring the OrderBy expression","2008-12-17 15:56:20"
"375014","refactoring the OrderBy expression","2","I would like to be able to refactor out the **OrderBy** clause in a linq expression. 

Here is an example of a refactor of the **where** clause  

before:

    results = ctx.ActiveUsers
        .Where(u => u.CompanyID != 1 &&
               (u.LastName.ToLower().Contains(searchString)
               || u.Email.ToLower().Contains(searchString)
               || u.Company.Name.ToLower().Contains(searchString)))
        .OrderBy(u =>  u.LastName ).ThenBy(u => u.FirstName)
        .Select(u => new Employee {
          ID = u.ID
          , FirstName = u.FirstName
          , LastName = u.LastName
          , Email = u.Email
          , CompanyName = u.Company.Name
          , CompanyID = u.CompanyID.ToString() });


----------
after:


    results = ctx.ActiveUsers
        .Where(Employee.GetExpression(searchString))
        .OrderBy(u =>  u.LastName ).ThenBy(u => u.FirstName)
        .Select(u => new Employee {
          ID = u.ID
          , FirstName = u.FirstName
          , LastName = u.LastName
          , Email = u.Email
          , CompanyName = u.Company.Name
          , CompanyID = u.CompanyID.ToString() });


----------


    private static Expression<Func<User, bool>> GetExpression(string searchString)
    { 
        Expression<Func<User, bool>> p = (u => u.CompanyID != 1 &&
                           (u.LastName.ToLower().Contains(searchString)
                           || u.Email.ToLower().Contains(searchString)
                           || u.Company.Name.ToLower().Contains(searchString)));
        return p;
    }


I was wondering if the same type of thing would be possible except I would like to refactor the **Orderby** expression.

Thank you in advance


","2008-12-17 15:56:20"
"375014","refactoring the OrderBy expression","2","<linq><lambda><c#>","2008-12-17 15:56:20"
"2415027","refactoring this function in Java","2","refactoring this function in Java","2010-03-10 06:49:43"
"2415027","refactoring this function in Java","2","I'm learning Java, and I know one of the big complaints about newbie programmers is that we make really long and involved methods that should be broken into several.  Well here is one I wrote and is a perfect example. :-D.

    public void buildBall(){
    		
    		/* sets the x and y value for the center of the canvas */
    		double i = ((getWidth() / 2));
    		double j = ((getHeight() / 2));
    		
    		/* randomizes the start speed of the ball */
    		vy = 3.0;
    		vx = rgen.nextDouble(1.0, 3.0);
    		if (rgen.nextBoolean(.05)) vx = -vx;	
    			
    		/* creates the ball */
    		GOval ball = new GOval(i,j,(2 *BALL_RADIUS),(2 * BALL_RADIUS));		
    		ball.setFilled(true);
    		ball.setFillColor(Color.RED);
    		add(ball);
    		
    		
    		/* animates the ball */	
    		while(true){
    			i = (i + (vx* 2));
    			j = (j + (vy* 2));	
    			if (i > APPLICATION_WIDTH-(2 * BALL_RADIUS)){
    				vx = -vx;		
    			}
    			
    			if (j > APPLICATION_HEIGHT-(2 * BALL_RADIUS)){
    				vy = -vy;
    			}
    			
    			if (i < 0){
    				vx = -vx;
    			}
    			
    			if (j < 0){
    				vy = -vy;
    			}
    				
    			ball.move(vx + vx, vy + vy);
    			pause(10);
    						
    			/* checks the edges of the ball to see if it hits an object */
    			colider = getElementAt(i, j);
    			
    			if (colider == null){
    				colider = getElementAt(i + (2*BALL_RADIUS), j);	
    				}
    			if (colider == null){
    				colider = getElementAt(i + (2*BALL_RADIUS), j + (2*BALL_RADIUS));	
    				}
    			if (colider == null){
    				colider = getElementAt(i, j + (2*BALL_RADIUS));	
    				}
    			
    			/* If the ball hits an object it reverses direction */
    			if (colider != null){
    				vy = -vy;
    				
    				
    			 /* removes bricks when hit but not the paddle */
    				if (j < (getHeight() -(PADDLE_Y_OFFSET + PADDLE_HEIGHT))){
    				remove(colider);
    				}
    				
    			}
    			
    		}

You can see from the title of the method that I started with good intentions of ""building the ball"".

There are a few issues I ran up against:

The problem is that then I needed to move the ball, so I created that while loop.  I don't see any other way to do that other than just keep it ""true"", so that means any other code I create below this loop won't happen.  I didn't make the while loop a different function because I was using those variables `i and j`.

So I don't see how I can refactor beyond this loop.  

So my main question is:

How would I pass the values of `i and j` to a new method: ""animateBall"" and how would I use 
`ball.move(vx + vx, vy + vy);` in that new method if ball has been declared in the buildBall method?

I understand this is probably a simple thing of better understanding variable scope and passing arguments, but I'm not quite there yet...


	
","2010-03-10 06:49:43"
"2415027","refactoring this function in Java","2","<java><newbie><methods><scope>","2010-03-10 06:49:43"
"2415027","refactoring this function in Java","2","<java><methods><scope>","2010-04-16 18:50:42"
"30659537","refactor 'execute and log' pattern","2","refactor 'execute and log' pattern","2015-06-05 06:14:58"
"30659537","refactor 'execute and log' pattern","2","I found myself keep following the same pattern again and again:

    if((return_code = doFoo1(...)) != CODE_OK) {
        log(""useful log message based on return code"");
        // very likely to return an error code. 
    }

    // continue
    
    if((return_code = doFoo2(...)) != CODE_OK) {
        log(""useful log message based on return code"");
        // very likely to return an error code. 
    }

Any insight how to avoid this annoying pattern and keep the logic clean?","2015-06-05 06:14:58"
"30659537","refactor 'execute and log' pattern","2","<c++><c><function><logging><refactoring>","2015-06-05 06:14:58"
"42900040","refactor MANY functions to receive any type of parameter elegantly (template<any>)","2","refactor parameter of MANY functions from ""int*"" to anything that have operator[]","2017-03-20 09:34:03"
"42900040","refactor MANY functions to receive any type of parameter elegantly (template<any>)","2","I have a custom datastructure.   

    template<class T> class MyArray3D{
        public: void setElement(const int* index,const T& t){
            //do something about ""index[0,1,2]""
        }
        public: T& get(const int* index){
            //do something about ""index[0,1,2]""
        }
        public: void reserve(const int* index1,const int* index2){
            //do something about ""index1,2[0,1,2]"" (e.g. index can be negative)
        }
        //about 20 functions, and some fields
    };

Everything is good.        It is currently used by many classes.         
Then I want those functions to accept anything (`index`) that has `operator[]`.

My poor solution
----

Here is a correct (but not good) way to do.     
I change `const int*` to `template INT_ARRAY`:-

    template<class T> class MyArray3D{
        public: template<class IARRAY> void setElement(IARRAY index,const T& t){
            //do something about ""index[0,1,2]""
        }
        public: template<class IARRAY> T& get(IARRAY index){
            //do something about ""index[0,1,2]""
        }
        public: template<class IARRAY1,class IARRAY2> 
          void reserve(IARRAY1 index1,IARRAY2 index2){
            //do something about ""index1,2[0,1,2]"" (e.g. index can be negative)
        }
        //about 20 functions, and some fields
    };

The above refactoring is tedious.     I have to do that for all functions.     

If a function has 4 `const int*`, it will be prefixed as `template<class IARRAY1,class IARRAY2,class IARRAY3,class IARRAY4>` - so ugly.    

Question
----
How to refactor above function elegantly (less repetitive & shorter code)? 

Here are the related questions :-      

- http://stackoverflow.com/questions/37642158/multiple-functions-using-the-same-template   : but the functions has no parameter      
- http://stackoverflow.com/questions/8627625/is-it-possible-to-make-function-that-will-accept-multiple-data-types-for-given-a : the template solution is same as my poor approach, and I don't think union is suitable for my case
","2017-03-20 09:34:03"
"42900040","refactor MANY functions to receive any type of parameter elegantly (template<any>)","2","<c++><function><templates>","2017-03-20 09:34:03"
"42900040","refactor MANY functions to receive any type of parameter elegantly (template<any>)","2","refactor MANY functions to receive any type of parameter elegantly (template<any>)","2017-03-20 09:54:44"
"42900040","refactor MANY functions to receive any type of parameter elegantly (template<any>)","2","I have a custom datastructure.   

    template<class T> class MyArray3D{
        public: void setElement(const int* index,const T& t){
            //do something about ""index[0,1,2]""
        }
        public: T& get(const int* index){
            //do something about ""index[0,1,2]""
        }
        public: void reserve(const int* index1,const int* index2){
            //do something about ""index1,2[0,1,2]"" (e.g. index can be negative)
        }
        //about 20 functions, and some fields
    };

Everything is good.        It is currently used by many classes.         
Then I want those functions to accept anything (`index`) that has `operator[]`.

My poor solution
----

Here is a correct (but not good) way to do.     
I change `const int*` to `template INT_ARRAY`:-

    template<class T> class MyArray3D{
        public: template<class IARRAY> void setElement(IARRAY index,const T& t){
            //do something about ""index[0,1,2]""
        }
        public: template<class IARRAY> T& get(IARRAY index){
            //do something about ""index[0,1,2]""
        }
        public: template<class IARRAY1,class IARRAY2> 
          void reserve(IARRAY1 index1,IARRAY2 index2){
            //do something about ""index1,2[0,1,2]"" (e.g. index can be negative)
        }
        //about 20 functions, and some fields
    };

The above refactoring is tedious.     I have to do that for all functions.     

If a function has 4 `const int*`, it will be prefixed as `template<class IARRAY1,class IARRAY2,class IARRAY3,class IARRAY4>` - so ugly.    

Question
----
How to refactor above function elegantly (less repetitive & shorter code)? 

I am dreaming about something like :- 

    template<class T> class MyArray3D{
        using IARRAY1 = please don't care about my type; ????
        public: void setElement(IARRAY1 index,const T& t);
        public: T& get(IARRAY1 index);
        public: void reserve(IARRAY1 index1,IARRAY1 index2);
    };

**Here are the related questions :-**      

- https://stackoverflow.com/questions/37642158/multiple-functions-using-the-same-template   : but the functions has no parameter      
- https://stackoverflow.com/questions/8627625/is-it-possible-to-make-function-that-will-accept-multiple-data-types-for-given-a : the template solution is same as my poor approach, and I don't think union is suitable for my case
","2017-05-23 10:29:58"
"42900040","refactor MANY functions to receive any type of parameter elegantly (template<any>)","2","I have a custom datastructure.   

    template<class T> class MyArray3D{
        public: void setElement(const int* index,const T& t){
            //do something about ""index[0,1,2]""
        }
        public: T& get(const int* index){
            //do something about ""index[0,1,2]""
        }
        public: void reserve(const int* index1,const int* index2){
            //do something about ""index1,2[0,1,2]"" (e.g. index can be negative)
        }
        //about 20 functions, and some fields
    };

Everything is good.        It is currently used by many classes.         
Then I want those functions to accept anything (`index`) that has `operator[]`.

My poor solution
----

Here is a correct (but not good) way to do.     
I change `const int*` to `template INT_ARRAY`:-

    template<class T> class MyArray3D{
        public: template<class IARRAY> void setElement(IARRAY index,const T& t){
            //do something about ""index[0,1,2]""
        }
        public: template<class IARRAY> T& get(IARRAY index){
            //do something about ""index[0,1,2]""
        }
        public: template<class IARRAY1,class IARRAY2> 
          void reserve(IARRAY1 index1,IARRAY2 index2){
            //do something about ""index1,2[0,1,2]"" (e.g. index can be negative)
        }
        //about 20 functions, and some fields
    };

The above refactoring is tedious.     I have to do that for all functions.     

If a function has 4 `const int*`, it will be prefixed as `template<class IARRAY1,class IARRAY2,class IARRAY3,class IARRAY4>` - so ugly.    

Question
----
How to refactor above function elegantly (less repetitive & shorter code)? 

I am dreaming about something like :- 

    template<class T> class MyArray3D{
        using IARRAY1 = please don't care about my type; ????
        public: void setElement(IARRAY1 index,const T& t);
        public: T& get(IARRAY1 index);
        public: void reserve(IARRAY1 index1,IARRAY1 index2);
    };

**Here are the related questions :-**      

- http://stackoverflow.com/questions/37642158/multiple-functions-using-the-same-template   : but the functions has no parameter      
- http://stackoverflow.com/questions/8627625/is-it-possible-to-make-function-that-will-accept-multiple-data-types-for-given-a : the template solution is same as my poor approach, and I don't think union is suitable for my case
","2017-03-20 09:42:44"
"16810328","refactor rails if else statement with to a single line with return?","2","refactor rails if else statement with to a single line with return?","2013-05-29 09:33:57"
"16810328","refactor rails if else statement with to a single line with return?","2","Im refactoring my older code parts, have lots of returns with multi line like:

    if ...
     return false
    else
     return true
    end

How could one refactor to use a single line and return true or false?","2013-05-29 09:33:57"
"16810328","refactor rails if else statement with to a single line with return?","2","<ruby-on-rails><ruby-on-rails-3><if-statement><refactoring><if-then>","2013-05-29 09:33:57"
"16810328","refactor rails if else statement with to a single line with return?","2","<ruby-on-rails><ruby-on-rails-3><if-statement><refactoring>","2013-06-10 12:46:28"
"8031895","refactor to ARC gives error implicit error [picture]","2","refactor to ARC gives error implicit error [picture]","2011-11-07 01:34:35"
"8031895","refactor to ARC gives error implicit error [picture]","2","I am refactoring to use ARC in my project and can not figure out this problem for the life of me! 

I don't know where I got the code from.

![screenshot of error](http://img341.imageshack.us/img341/972/xcode.png)""screenshot of error""
http://img341.imageshack.us/img341/972/xcode.png","2011-11-07 01:34:35"
"8031895","refactor to ARC gives error implicit error [picture]","2","<objective-c><ios><automatic-ref-counting>","2011-11-07 01:34:35"
"7525594","refactoring: swicthing from custom data access layer to Entity Framework","2","refactoring: swicthing from custom data access layer to Entity Framework","2011-09-23 07:22:58"
"7525594","refactoring: swicthing from custom data access layer to Entity Framework","2","I am a .NET Developer and as part of a refactoring project, I have a few questions.

Our software is currently using an Active Record pattern (one to one mapping between the data objects and the business objects). The bad thing is that the business objects inherits from the data objects, inducing highly couple between the layers.

Our goal is to switch from our custom data access layer (based on ADO.NET) to Entity Framework. The constraint we have is not to break the code so that our older applications will still compile and run using the old data access layer while allowing us to use EF for the new projects.

My first idea to do so is to break the inheritance and have the data object as an attribute of the business object (and use an interface or abstract class in order to inject the data object, whether it is our custom layer or Entity Framework). The properties would be migrated from the Data objects to the business objects which would act like some kind of ""proxy"" to access the properties of the data objects.
 
Would that be a viable solution ? That would still use the active record pattern (and I don't like this a lot, since our business layer has become quite large) so if you have any other idea, please don't hesitate.

My other question is about the Entity framework generation. We need the entities properties to have the same name as the old data objects (we would use an abstract class in order to allow the business objects to call the properties of the data object, whether it is our custom data object or the EF entities). What would be the best way to accomplish that ? Using T4 to generate the entities or have an EF Code first approach ?

I am very open to any suggestion, so please do not hesitate to propose other approaches. Thanks for your time.","2011-09-23 07:22:58"
"7525594","refactoring: swicthing from custom data access layer to Entity Framework","2","<.net><frameworks><entity><record><active>","2011-09-23 07:22:58"
"7525594","refactoring: swicthing from custom data access layer to Entity Framework","2","<.net><entity-framework><activerecord><migration>","2011-09-23 07:30:41"
"7075972","refactoring PL/SQL","2","refactoring PL/SQL","2011-08-16 09:14:43"
"7075972","refactoring PL/SQL","2","I encountered the following PL/SQL code(variables modified) at work:

    PROCEDURE test(i_w IN a.w%type,o_result IN OUT resu_cur_type) IS
    BEGIN
        IF i_w IS NULL THEN
          open o_result for SELECT a.x, b.y FROM a,b WHERE a.z=b.z;
        ELSE
          open o_result for SELECT a.x, b.y FROM a,b WHERE a.z=b.z AND a.w=i_w;
        END IF;
    END test;

I think the above is equivalent to the following:

    PROCEDURE test(i_w IN a.w%type,o_result IN OUT resu_cur_type) IS
    BEGIN
          open o_result for SELECT a.x, b.y FROM a,b WHERE a.z=b.z AND a.w=NVL(i_w,a.w);
    END test;

Won't it be the same?. Could somebody please explain is there any reason to use the
original version?. 
Please note that the original cursor is a 50 line query, so refactoring might improve its readability and keep it simple.","2011-08-16 09:14:43"
"7075972","refactoring PL/SQL","2","<oracle><plsql><refactoring>","2011-08-16 09:14:43"
"7075972","refactoring PL/SQL","2","I encountered the following PL/SQL code(variables modified) at work:

    PROCEDURE test(i_w IN a.w%type,o_result IN OUT resu_cur_type) IS
    BEGIN
        IF i_w IS NULL THEN
          open o_result for SELECT a.x, b.y FROM a,b WHERE a.z=b.z;
        ELSE
          open o_result for SELECT a.x, b.y FROM a,b WHERE a.z=b.z AND a.w=i_w;
        END IF;
    END test;

I think the above is equivalent to the following:

    PROCEDURE test(i_w IN a.w%type,o_result IN OUT resu_cur_type) IS
    BEGIN
          open o_result for SELECT a.x, b.y FROM a,b WHERE a.z=b.z AND NVL(a.w,1)=NVL(NVL(i_w,a.w),1);
    END test;

Won't it be the same?. Could somebody please explain is there any reason to use the
original version?. 
Please note that the original cursor is a 50 line query, so refactoring might improve its readability and keep it simple.

Edit:

To address the problem in Kevin Burton's answer, I've updated the WHERE condition.","2011-08-16 09:29:11"
"14466683","refactoring dot jsp dot html and other non dot java files","2","refactoring dot jsp dot html and other non dot java files","2013-01-22 19:40:15"
"14466683","refactoring dot jsp dot html and other non dot java files","2","Refactoring for Java ee web apps for example renaming a page name , is not done well by most ides like e.g netbeans , where I observe that the renaming (refactoring) (in this example) does not reflect the change of that name in other parts of the applicaion . eg. in froms and other pages that have links to the renamed page.  

(this is contrary to normal .java files.) Is my observation correct? and what is the solution if so?  Thats my usuall practice for .java files. but thats not the case with .jsp or html or other files , even I rename  (refactor) a .java file. its not reflected in .jsp . html files. I have alot of files pointing to that renamed file... then what

well how to properly reafactor in the first place. do tell me","2013-01-22 19:40:15"
"14466683","refactoring dot jsp dot html and other non dot java files","2","<java><java-ee><netbeans>","2013-01-22 19:40:15"
"14466683","refactoring dot jsp dot html and other non dot java files","2","Refactoring for Java ee web apps for example renaming a page name , is not done well by most ides like e.g netbeans , where I observe that the renaming (refactoring) (in this example) does not reflect the change of that name in other parts of the applicaion . eg. in froms and other pages that have links to the renamed page.  

(this is contrary to normal .java files.) Is my observation correct? and what is the solution if so?  Thats my usuall practice for .java files. but thats not the case with .jsp or html or other files , even I rename  (refactor) a .java file. its not reflected in .jsp . html files. I have alot of files pointing to that renamed file... then what

well how to properly reafactor in the first place. do tell me

**Global search and replace is the last thing I and most devs want to do**","2013-01-22 21:43:30"
"14466683","refactoring dot jsp dot html and other non dot java files","2","{""Voters"":[{""Id"":1094597,""DisplayName"":""Nambari""},{""Id"":680925,""DisplayName"":""Perception""},{""Id"":683261,""DisplayName"":""Sameer""},{""Id"":1317935,""DisplayName"":""TheShiftExchange""},{""Id"":54506,""DisplayName"":""Jayan""}]}","2013-01-23 05:38:30"
"41528654","refactor filtering and search result","2","Filtering search results for apartment and car rentals","2017-01-08 01:52:40"
"41528654","refactor filtering and search result","2","I am developing an app which is somewhat similar to airbnb. There are two search function, one for searching apartment and other for searching car rental. When searching apartment, the result page shows the searched result along with some filtering options like filter from range of price and filter from various options like amenities, services. The result page of car rental is same as apartment result page. I mean car result shows the searched result regarding car that are available as rent and filtering categories.

I have attached an image for explaining the feature:
[![enter image description here][1]][1]


  [1]: https://i.stack.imgur.com/3fGLU.png

Here is my reducer and actions for such feature. This is a working code. I am trying to code it in best way as much as i can to train my coding skill. I want help of other expert programmers on how can i refactor this code to much better? 

actions.js

    export function showResultofCar(cityFrom, cityTo, date, paisFrom, paisTo) {
          return (dispatch) => {
            dispatch({ type: 'CAR_FETCH_START' });
            const token = localStorage.getItem('token');
            return axios.get(`${API_URL}/car/....`)
              .then((response) => {
                setTimeout(() => {
                  dispatch({ type: 'CAR_FETCH_SUCCESS', payload: response.data });
                }, 1000);
              })
              .catch((err) => {
                dispatch({ type: 'CAR_FETCH_FAILURE', payload: err });
              });
          };
        }
        
    
    export function showResultofApartment(people, city, dateFrom, dateTo, pais) {
      console.log('people', people, city, dateFrom, dateTo, pais);
      return (dispatch) => {
        dispatch({ type: 'APARTMENT_FETCH_START' });
        const token = localStorage.getItem('token');
        return axios.get(`${API_URL}/apartment/...`)
        .then((response) => {
          console.log('response apart', response.data);
            dispatch({ type: 'APARTMENT_FETCH_SUCCESS', payload: response.data });
        })
        .catch((err) => {
          dispatch({ type: 'APARTMENT_FETCH_FAILURE', payload: err });
        });
      };
    }
    
    export function getFilteredResults(price) {
      console.log('price', price);
      return function (dispatch) {
        dispatch({ type: 'CAR_FETCH_WITH_FILTER', payload: price });
      };
    }
    
    export function getTimeFilteredResults(time) {
      console.log('time', time);
      return function (dispatch) {
        dispatch({ type: 'CAR_FETCH_WITH_TIME_FILTER', payload: time });
      };
    }
    
    export function sortCarByPrice(price) {
      console.log('price is', price);
      return function (dispatch) {
        dispatch({ type: 'SORT_CAR_BY_PRICE', payload: price });
      };
    }
    
    export function getApartmentFromPrice(price) {
      return function (dispatch) {
        dispatch({ type: 'APARTMENT_FILTER_BY_PRICE', payload: price });
      };
    }
    
    export function getApartmentFromCategories(filter) {
      return function (dispatch) {
        dispatch({ type: 'APARTMENT_FILTER_BY_CATEGORIES', payload: filter });
      };
    }


**reducers.js**


    let cars = [];
    const initialState = {
      fetching: false,
      fetched: true,
      cars: [],
      error: null
    };
    
    function carFilterFromPrice(price) {
      return cars.filter(car => car.price > price.min && car.price < price.max);
    }
    
    function carFilterFromTime(time) {
      return cars.filter(function (car) {
        const departure = car.departure;
        const isValidDate = moment(departure).isValid();
        const departureWithDayandTime = isValidDate ?
          moment(departure).format('hh.mm') : '';
          return departureWithDayandTime > time.min && departureWithDayandTime < time.max;
      });
    }
    
    function carSortFromPrice(price) {
      return cars.sort((a, b) => {
        if (price === 'descending') {
          return parseFloat(a.price) - parseFloat(b.price);
        }
          return parseFloat(b.price) - parseFloat(a.price);
      });
    }
    
    export function getCarResult(state = initialState, action) {
      switch (action.type) {
        case 'CAR_FETCH_START':
          return { ...state, fetching: true };
        case 'CAR_FETCH_SUCCESS':
          cars = action.payload;
          return {
                  ...state,
                  fetched: true,
                  fetching: false,
                  cars: action.payload,
                 };
        case 'CAR_FETCH_WITH_FILTER':
          return { ...state, fetched: true, fetching: false, cars: carFilterFromPrice(action.payload) };
        case 'CAR_FETCH_WITH_TIME_FILTER':
          return { ...state, fetched: true, fetching: false, cars: carFilterFromTime(action.payload) };
        case 'SORT_CAR_BY_PRICE':
          return { ...state, fetched: true, fetching: false, cars: carSortFromPrice(action.payload) };
        case 'CAR_FETCH_FAILURE':
          return { ...state, error: action.payload };
        default:
          return state;
      }
    }
    
    let apartments = [];
    const apartmentInitialState = {
      fetching: false,
      fetched: true,
      apartments: [],
      error: null
    };
    
    function apartmentFilterFromPrice(price) {
      return apartments.filter(apartment =>
        apartment.price > price.min && apartment.price < price.max
      );
    }
    
    function apartmentFilterFromCategory(filter) {
      console.log('filter', filter);
    }
    
    export function getApartmentResult(state = apartmentInitialState, action) {
      switch (action.type) {
        case 'APARTMENT_FETCH_START':
          console.log('action', action);
          return { ...state, fetching: true };
        case 'APARTMENT_FETCH_SUCCESS':
        apartments = action.payload;
        return { ...state, fetched: true, fetching: false, apartments: action.payload };
        case 'APARTMENT_FILTER_BY_PRICE':
          return { ...state,
                  fetched: true,
                  fetching: false,
                  apartments: apartmentFilterFromPrice(action.payload)
                };
        case 'APARTMENT_FILTER_BY_CATEGORIES':
          return { ...state,
                  fetched: true,
                  fetching: false,
                  apartments: apartmentFilterFromCategory(action.payload)
                 };
        case 'APARTMENT_FETCH_FAILURE':
          return { ...state, error: action.payload };
        default:
          return state;
      }
    }","2017-01-08 01:52:40"
"41528654","refactor filtering and search result","2","<javascript><reactjs><ecmascript-6><redux><react-redux>","2017-01-08 01:52:40"
"41528654","refactor filtering and search result","2","refactor filtering and search result","2017-01-10 00:16:39"
"41528654","refactor filtering and search result","2","I am developing an app which is somewhat similar to airbnb. There are two search function, one for searching apartment and other for searching car rental. When searching apartment, the result page shows the searched result along with some filtering options like filter from range of price and filter from various options like amenities, services. The result page of car rental is same as apartment result page. I mean car result shows the searched result regarding car that are available as rent and filtering categories.

Here is my reducer and actions for such feature. This is a working code. I am trying to code it in best way as much as i can to train my coding skill. I want help of other expert programmers on how can i refactor this code to much better? 

actions.js

    export function showResultofCar(cityFrom, cityTo, date, paisFrom, paisTo) {
          return (dispatch) => {
            dispatch({ type: 'CAR_FETCH_START' });
            const token = localStorage.getItem('token');
            return axios.get(`${API_URL}/car/....`)
              .then((response) => {
                setTimeout(() => {
                  dispatch({ type: 'CAR_FETCH_SUCCESS', payload: response.data });
                }, 1000);
              })
              .catch((err) => {
                dispatch({ type: 'CAR_FETCH_FAILURE', payload: err });
              });
          };
        }
        
    
    export function showResultofApartment(people, city, dateFrom, dateTo, pais) {
      console.log('people', people, city, dateFrom, dateTo, pais);
      return (dispatch) => {
        dispatch({ type: 'APARTMENT_FETCH_START' });
        const token = localStorage.getItem('token');
        return axios.get(`${API_URL}/apartment/...`)
        .then((response) => {
          console.log('response apart', response.data);
            dispatch({ type: 'APARTMENT_FETCH_SUCCESS', payload: response.data });
        })
        .catch((err) => {
          dispatch({ type: 'APARTMENT_FETCH_FAILURE', payload: err });
        });
      };
    }
    
    export function getFilteredResults(price) {
      console.log('price', price);
      return function (dispatch) {
        dispatch({ type: 'CAR_FETCH_WITH_FILTER', payload: price });
      };
    }
    
    export function getTimeFilteredResults(time) {
      console.log('time', time);
      return function (dispatch) {
        dispatch({ type: 'CAR_FETCH_WITH_TIME_FILTER', payload: time });
      };
    }
    
    export function sortCarByPrice(price) {
      console.log('price is', price);
      return function (dispatch) {
        dispatch({ type: 'SORT_CAR_BY_PRICE', payload: price });
      };
    }
    
    export function getApartmentFromPrice(price) {
      return function (dispatch) {
        dispatch({ type: 'APARTMENT_FILTER_BY_PRICE', payload: price });
      };
    }
    
    export function getApartmentFromCategories(filter) {
      return function (dispatch) {
        dispatch({ type: 'APARTMENT_FILTER_BY_CATEGORIES', payload: filter });
      };
    }


**reducers.js**


    let cars = [];
    const initialState = {
      fetching: false,
      fetched: true,
      cars: [],
      error: null
    };
    
    function carFilterFromPrice(price) {
      return cars.filter(car => car.price > price.min && car.price < price.max);
    }
    
    function carFilterFromTime(time) {
      return cars.filter(function (car) {
        const departure = car.departure;
        const isValidDate = moment(departure).isValid();
        const departureWithDayandTime = isValidDate ?
          moment(departure).format('hh.mm') : '';
          return departureWithDayandTime > time.min && departureWithDayandTime < time.max;
      });
    }
    
    function carSortFromPrice(price) {
      return cars.sort((a, b) => {
        if (price === 'descending') {
          return parseFloat(a.price) - parseFloat(b.price);
        }
          return parseFloat(b.price) - parseFloat(a.price);
      });
    }
    
    export function getCarResult(state = initialState, action) {
      switch (action.type) {
        case 'CAR_FETCH_START':
          return { ...state, fetching: true };
        case 'CAR_FETCH_SUCCESS':
          cars = action.payload;
          return {
                  ...state,
                  fetched: true,
                  fetching: false,
                  cars: action.payload,
                 };
        case 'CAR_FETCH_WITH_FILTER':
          return { ...state, fetched: true, fetching: false, cars: carFilterFromPrice(action.payload) };
        case 'CAR_FETCH_WITH_TIME_FILTER':
          return { ...state, fetched: true, fetching: false, cars: carFilterFromTime(action.payload) };
        case 'SORT_CAR_BY_PRICE':
          return { ...state, fetched: true, fetching: false, cars: carSortFromPrice(action.payload) };
        case 'CAR_FETCH_FAILURE':
          return { ...state, error: action.payload };
        default:
          return state;
      }
    }
    
    let apartments = [];
    const apartmentInitialState = {
      fetching: false,
      fetched: true,
      apartments: [],
      error: null
    };
    
    function apartmentFilterFromPrice(price) {
      return apartments.filter(apartment =>
        apartment.price > price.min && apartment.price < price.max
      );
    }
    
    function apartmentFilterFromCategory(filter) {
      console.log('filter', filter);
    }
    
    export function getApartmentResult(state = apartmentInitialState, action) {
      switch (action.type) {
        case 'APARTMENT_FETCH_START':
          console.log('action', action);
          return { ...state, fetching: true };
        case 'APARTMENT_FETCH_SUCCESS':
        apartments = action.payload;
        return { ...state, fetched: true, fetching: false, apartments: action.payload };
        case 'APARTMENT_FILTER_BY_PRICE':
          return { ...state,
                  fetched: true,
                  fetching: false,
                  apartments: apartmentFilterFromPrice(action.payload)
                };
        case 'APARTMENT_FILTER_BY_CATEGORIES':
          return { ...state,
                  fetched: true,
                  fetching: false,
                  apartments: apartmentFilterFromCategory(action.payload)
                 };
        case 'APARTMENT_FETCH_FAILURE':
          return { ...state, error: action.payload };
        default:
          return state;
      }
    }","2017-01-10 00:16:39"
"10512040","refactor nested switch to objects","2","refactor nested switch to objects","2012-05-09 07:57:46"
"10512040","refactor nested switch to objects","2","I'd like some advice on refactoring the following method:

    public boolean makeDecision(String group, int level, int primaryAmount, int secondaryAmount)
    {
        if (group.equals(""A""))
        {
            switch (level)
            {
                case 0 : return primaryAmount > 10000;break;
                case 1 : return primaryAmount > 20000;break;
                default : return secondaryAmount > 30000; break;
            }
        }
        else if (group.equals(""B""))
        {
             switch (level)
             {
                  case 0 : return primaryAmount > 40000;break;
                  case 1 : return primaryAmount > 50000;break;
                  default : return secondaryAmount > 60000; break;
             }
               
        }
        else if (group.equals(""C""))
        {
            switch(level)
            {
                case 0 : return primaryAmount > 70000;break;
                case 1 : return primaryAmount > 80000;break;
                default : return secondaryAmount > 90000; break;
            }

        }
        return false;
    } 

What I'd like to achieve:

- Allow the code to follow the open/closed principle as there will be more groups / levels in time. 
- Remove the duplication in the 'level' switch statement. 
- Ideally remove the 'group' top level switch statement.

","2012-05-09 07:57:46"
"10512040","refactor nested switch to objects","2","<java><design-patterns><refactoring>","2012-05-09 07:57:46"
"17007194","refactor PHP legacy code to REST API","2","refactor PHP legacy code to REST API","2013-06-09 06:51:50"
"17007194","refactor PHP legacy code to REST API","2","I have a big PHP legacy codebase and I was planning to move it to a MVC based pattern. Not because I want, but if I could separate the views, It would be easier to give the views/layouts with a mockup backend to designers. 

Our application is really complicated to setup locally (we are working to make it easier, but its not easy, because it runs on a specific OS, read-only FS, etc). 

So my first idea was. Move the whole view logic to templates and then with the time migrate the rest of the code to models and controllers. However now, I'm considering to pack my code in a REST API (no view logic on the server side, just JSON being delivered. View I want to render with backbone.js).  

Questions that I'm still don't have answers are:

* Anyone has an experience similar to share with me? 
* PHP rest API lib that I should use? (I'm thinking about SLIM Framework)
* Is it a good approach?","2013-06-09 06:51:50"
"17007194","refactor PHP legacy code to REST API","2","<php><refactoring><legacy>","2013-06-09 06:51:50"
"17007194","refactor PHP legacy code to REST API","2","I have a big PHP legacy codebase and I was planning to move it to a MVC based pattern. Not because I want, but if I could separate the views, It would be easier to give the views/layouts with a mockup backend to designers. 

Our application is really complicated to setup locally (we are working to make it easier, but its not easy, because it runs on a specific OS, read-only FS, etc). 

So my first idea was. Move the whole view logic to templates and then with the time migrate the rest of the code to models and controllers. However now, I'm considering to pack my code in a REST API (no view logic on the server side, just JSON being delivered. View I want to render with backbone.js).  

Questions that I still don't have answers are:

* Anyone has an experience similar to share with me? 
* PHP rest API lib that I should use? (I'm thinking about SLIM Framework)
* Is it a good approach?","2013-06-09 12:20:17"
"17007194","refactor PHP legacy code to REST API","2","I have a big PHP legacy codebase and I was planning to move it to a MVC based pattern. Not because I want, but if I could separate the views, It would be easier to give the views/layouts with a mockup backend to designers. 

Our application is really complicated to setup locally (we are working to make it easier, but its not easy, because it runs on a specific OS, read-only FS, etc). 

So my first idea was: Move the whole view logic to templates and then with the time migrate the rest of the code to models and controllers. However now, I'm considering to pack my code in a REST API (no view logic on the server side, just JSON being delivered. View I want to render with backbone.js).  

Questions that I still don't have answers are:

* Anyone has an experience similar to share with me? 
* PHP rest API lib that I should use? (I'm thinking about SLIM Framework)
* Is it a good approach?","2017-02-12 19:28:21"
"1160132","refactor help - strategy pattern","2","refactor help - strategy pattern","2009-07-21 15:56:36"
"1160132","refactor help - strategy pattern","2","The object here is to update the UI. I normally do this on the client however this application uses the code behind. Anyways my question is I am trying to clean up these if else statements and I thought the strategy pattern may be appropriate. I don't need everything done for me but if you could give me a couple pointers to get going. Do I create an interface first and then each strategy implement the interface? Are generics helpful here? What types of methods should be in the interface? Any thing to get me going would be very much appreciated.

    if (someObject.Status == 'A') {
                        btnRecordCall.Enabled = false;
                        btnAddMailOrStatusAction.Enabled = false;
                        btnPayments.Enabled = false;
                        btnAddressMaint.Enabled = false;
                        btnFilter.Enabled = false;
                        btnAddCoverage.Enabled = false;
                        btnPolicyForms.Enabled = false;
                        lblIsArchived.Text = ""********** THIS CLAIM HAS BEEN ARCHIVED **********"";
                    } else if (someObject.Status == 'D') {
                        btnRecordCall.Enabled = false;
                        btnAddMailOrStatusAction.Enabled = false;
                        btnPayments.Enabled = false;
                        btnAddressMaint.Enabled = false;
                        btnFilter.Enabled = false;
                        btnAddCoverage.Enabled = false;
                        btnPolicyForms.Enabled = false;
                        lblIsArchived.Text = ""- De-archive Request Pending"";
                    } else {
                        btnRecordCall.Enabled = true;
                        btnAddMailOrStatusAction.Enabled = true;
                        btnPayments.Enabled = true;
                        btnAddressMaint.Enabled = true;
                        btnFilter.Enabled = true;
                        btnAddCoverage.Enabled = true;
                        btnPolicyForms.Enabled = true;
                        lblIsArchived.Text = """";
                    }

Thanks,
~ck","2009-07-21 15:56:36"
"1160132","refactor help - strategy pattern","2","<refactoring><strategy-pattern><design-patterns>","2009-07-21 15:56:36"
"4481660","refactor my array sorting function","2","check order in array","2010-12-19 04:55:54"
"4481660","refactor my array sorting function","2","So, how to make it more compact?


       public static boolean isDirectOrder( int[] data )
       {
          boolean answer = true;
    
          if ( ( data != null ) && ( data.length > 1 ) )
          {
             int last = data[0];
    
             for (int i = 0; i < data.length; i++)
             {
                if ( last <= data[i] )
                {
                   last = data[i];
                }
                else
                {
                   answer = false;
                   break;
                }
             }
          }
    
          return answer;
       }


maybe exist standard tools for same checking?
","2010-12-19 04:55:54"
"4481660","refactor my array sorting function","2","<java><algorithm><order>","2010-12-19 04:55:54"
"4481660","refactor my array sorting function","2","refactor my array sorting function","2010-12-19 05:01:28"
"28676668","refactoring rails redirects with multiple ifs","2","refactoring rails redirects with multiple ifs","2015-02-23 15:00:58"
"28676668","refactoring rails redirects with multiple ifs","2","In the app I am working on, the user can get to a new form from several different places. I need to redirect them back to where they came from. I solved it by passing a parameter in the link on the view, for example

    = link_to ""create a new post »"", new_user_post_path(@current_user, :return_to => 'dashboard')

then in the new action in the controller like so

    if params[:return_to] == 'dashboard'
      session[:return_to]= 'dashboard'
    end

now I am looking at the controller. what I need to do I can achieve by being really verbose, but I'm looking for a more elegant solution. Here is what I have now

    if @user_post.save
      flash[:notice] = ""New Post Created""
      if session[:return_to] == 'dashboard'
        session.delete(:return_to)
        redirect_to dashboard_path and return
      else
      redirect_to user_hub_path(@user)
    end
    else
      flash[:error] = ""Could not save post""
      redirect_to new_user_post_path(@user)
    end

This does what I need but I was hoping to tidy it up a little. I started looking at 1 line enumerators to see if I could do something like this...

    if @user_post.save
      flash[:notice] = ""New post Created""
      session[:return_to] == 'dashboard' ? redirect_to ""#{session.delete(:return_to)}_path"" : redirect_to user_hub_path(@user)
    else
      flash[:error] = ""Could not save post""
      redirect_to new_user_post_path(@user)
    end

but it really doesn't like this part....redirect_to ""#{session.delete(:return_to)}_path""

any advice? Guess I'm trying to get it to redirect and delete the session in one line and this is beyond my knowledge...","2015-02-23 15:00:58"
"28676668","refactoring rails redirects with multiple ifs","2","<ruby-on-rails><ruby>","2015-02-23 15:00:58"
"28676668","refactoring rails redirects with multiple ifs","2","In the app I am working on, the user can get to a new form from several different places. I need to redirect them back to where they came from. I solved it by passing a parameter in the link on the view, for example

    = link_to ""create a new post »"", new_user_post_path(@current_user, :return_to => 'dashboard')

then in the new action in the controller like so

    if params[:return_to] == 'dashboard'
      session[:return_to]= 'dashboard'
    end

now I am looking at the controller. what I need to do I can achieve by being really verbose, but I'm looking for a more elegant solution. Here is what I have now

    if @user_post.save
      flash[:notice] = ""New Post Created""
      if session[:return_to] == 'dashboard'
        session.delete(:return_to)
        redirect_to dashboard_path and return
      else
      redirect_to user_hub_path(@user)
     end
    else
      flash[:error] = ""Could not save post""
      redirect_to new_user_post_path(@user)
    end

This does what I need but I was hoping to tidy it up a little. I started looking at 1 line enumerators to see if I could do something like this...

    if @user_post.save
      flash[:notice] = ""New post Created""
      session[:return_to] == 'dashboard' ? redirect_to ""#{session.delete(:return_to)}_path"" : redirect_to user_hub_path(@user)
    else
      flash[:error] = ""Could not save post""
      redirect_to new_user_post_path(@user)
    end

but it really doesn't like this part....redirect_to ""#{session.delete(:return_to)}_path""

any advice? Guess I'm trying to get it to redirect and delete the session in one line and this is beyond my knowledge...","2015-02-23 15:17:15"
"219395","refactoring stored procedure","2","refactoring stored procedure","2008-10-20 18:29:18"
"219395","refactoring stored procedure","2","I have a stored procedure currently executing a complicated fetch that is frequently timing out when used. The proposed solution in my department has been to simply increase the timeout time length; which I don't really want to do. I'd like to refactor this sproc, but because it's so complicated and undocumented (yay legacy systems) I'm concerned my refactoring my not result in the same functionality executing more efficiently. Are there any strategies to use when refactoring a stored procedure to ensure the same functions are being performed in less time?","2008-10-20 18:29:18"
"219395","refactoring stored procedure","2","<refactoring><stored-procedures><performance>","2008-10-20 18:29:18"
"219395","refactoring stored procedure","2","I have a stored procedure currently executing a complicated fetch that is frequently timing out when used. The proposed solution in my department has been to simply increase the timeout time length; which I don't really want to do. I'd like to refactor this sproc, but because it's so complicated and undocumented (yay legacy systems) I'm concerned my refactoring my not result in the same functionality executing more efficiently. Are there any strategies to use when refactoring a stored procedure to ensure the same functions are being performed in less time?

This is a Microsoft SQL Server 2005 stored procedure.","2008-10-20 18:41:00"
"8898779","refactoring #ifndef __OBJC_GC_ in arc enabled app","2","refactoring #ifndef __OBJC_GC_ in arc enabled app","2012-01-17 17:11:07"
"8898779","refactoring #ifndef __OBJC_GC_ in arc enabled app","2","I'm writing an app in an ARC environment, and I'm trying to use a 3rd party library that was written before ARC. I'm using the -fno-objc-arc flags on all the relevant files, so it's compiling, but the project uses #ifndef __OBJC_GC_ blocks to release memory, which is causing memory allocation errors. I'm trying to determine the right solution, and so far I have the following:

1.) find a different library or write my own - this is the only free library of it's kind, so this is obviously not ideal, and I'm new enough that I don't feel comfortable tackling that

2.) remove the #ifndef blocks and cross my fingers - not able to work on the project today, but that's my next plan

3.) refactor the code to be ARC compliant and remove the -fno-objc-arc flags

is #2 likely to work? How hard would #3 be, andwould it actually cause the compiler to define __OBJC_GC_? (there's about 4-5 classes that I'm planning on using, but they're pretty sizeable)

","2012-01-17 17:11:07"
"8898779","refactoring #ifndef __OBJC_GC_ in arc enabled app","2","<iphone><ios5><automatic-ref-counting>","2012-01-17 17:11:07"
"15412265","refactoring modular structures in D","2","refactoring modular structures in D","2013-03-14 14:37:56"
"15412265","refactoring modular structures in D","2","Here's how I usually develop an application:

 * I start with having all the code in a single source file.
 * When it grows enough to be modularised, I break the code into several modules.
 * When the modules grow enough, I split them again. And so on, iteratively.
 * Over time, some modules get shrunk, deleted or merged with others.

This workflow implies the need to move source files between modules sometimes. And here comes the problem:

*When I move a module to another location, it changes the module's name, so I have to walk through all the other files renaming imports by hand.*

Is there some organisational technique to avoid that annoying procedure? Or that's the way it goes and I just have to look into some automation utilities instead?","2013-03-14 14:37:56"
"15412265","refactoring modular structures in D","2","<refactoring><d><modularisation>","2013-03-14 14:37:56"
"15412265","refactoring modular structures in D","2","Here's how I usually develop an application:

 * I start with having all the code in a single source file.
 * When it grows enough to be modularised, I break the code into several modules.
 * When the modules grow enough, I split them again. And so on, iteratively.
 * Over time, some modules get shrunk, deleted or merged with others.

This workflow implies the need to move source files between modules sometimes. And here comes the problem:

*When I move a module to another location, it changes the module's name, so I have to walk through all the other files renaming imports by hand.*

Is there some organisational technique to avoid that annoying procedure? Or is that the way it goes and I just have to look into some automation utilities instead?","2013-09-12 09:42:59"
"15412265","refactoring modular structures in D","2","<refactoring><d><modularization>","2013-09-12 09:42:59"
"9083767","refactor code in order to use 3 values to make plot & tuple indices must be integers, not float","1","refactor code in order to use 3 values to make plot & tuple indices must be integers, not float","2012-01-31 17:07:33"
"9083767","refactor code in order to use 3 values to make plot & tuple indices must be integers, not float","1","I have a code in which for 3 different values of D ,i have 3 different values of dx and so,3 different plots.

I want to do a plot which will have all 3 plots in one.


    ...
    D=(0.133e-4,0.243e-4,0.283e-4)
    
    dx=sc.zeros(3)
        for i in D:
            dx[i]=sc.sqrt(D[i]*dt/M)
            
            plt.ion()
            while n<N:
                Vw_n=Vw_n1
                C_n=C_n1
                R2=(Vw_n+B1)/(Vw_0+B1)
                Cc=C_n1[0]/C0
                F2_1=10000/3*Pw*A*(C0*Vw_0/Vw_n1-C_n[1])
                dV=F2_1*dt
                Vw_n1=Vw_n+dV
                C_n1[0]=C0*Vw_0/Vw_n1
                F_i_2=-D[i]/dx[i]*(C_n[1:7]-C_n[0:6])
                C_n1[0:6]=C_n[0:6]-F_i_2*A*dt/(L/(V0/A)*V0/5)
                n+=1
                ttime=n*0.02*1000

                #-----PLOT AREA---------------------------------#

                mylabels=('T=273','T=293','T=298')
                colors=('-b','or','+k')

                if x==1:
                    plt.plot(ttime,R2,mylabels[i],colors[i])
                elif x==2:
                    plt.plot(ttime,Cc,mylabels[i],colors[i])
                plt.draw()
                plt.show()

My problem is that i want to plot (ttime,R2) and (ttime,Cc).
But i can't figure how to call R2 and Cc for the 3 different values of D (and dx).

Also, i am taking an error: tuple indices must be integers, not float

at dx[i]=sc.sqrt(D[i]*dt/M).

Thanks!
","2012-01-31 17:07:33"
"9083767","refactor code in order to use 3 values to make plot & tuple indices must be integers, not float","1","<python><matplotlib>","2012-01-31 17:07:33"
"9083767","refactor code in order to use 3 values to make plot & tuple indices must be integers, not float","1","I have a code in which for 3 different values of D ,i have 3 different values of dx and so,3 different plots.

I want to do a plot which will have all 3 plots in one.


 

 

      
    ...
    D=(0.133e-4,0.243e-4,0.283e-4)
        
    dx=sc.zeros(3)
        for i in D:
            dx[i]=sc.sqrt(D[i]*dt/M)
            
            plt.ion()
            while n<N:
                Vw_n=Vw_n1
                C_n=C_n1
                R2=(Vw_n+B1)/(Vw_0+B1)
                Cc=C_n1[0]/C0
                F2_1=10000/3*Pw*A*(C0*Vw_0/Vw_n1-C_n[1])
                dV=F2_1*dt
                Vw_n1=Vw_n+dV
                C_n1[0]=C0*Vw_0/Vw_n1
                F_i_2=-D[i]/dx[i]*(C_n[1:7]-C_n[0:6])
                C_n1[0:6]=C_n[0:6]-F_i_2*A*dt/(L/(V0/A)*V0/5)
                n+=1
                ttime=n*0.02*1000

                #-----PLOT AREA---------------------------------#

                mylabels=('T=273','T=293','T=298')
                colors=('-b','or','+k')

                if x==1:
                    plt.plot(ttime,R2,mylabels[i],colors[i])
                elif x==2:
                    plt.plot(ttime,Cc,mylabels[i],colors[i])
                plt.draw()
                plt.show()

    if __name__==""__main__"":
        flag=False
        while not flag:
            try:
                x=int(raw_input(""Give a choice 1 (ceil volume ratio) or 2 (solute concentration) : ""))
                flag=True
                if x==1:
                    plt.title('Change in cell volume ratio as a function of time \n\
                    at various temperatures')
                    plt.xlabel('Time')
                    plt.ylabel('Ceil volume ratio (V/V0)')
                    graph(x)
                if x==2:
                    plt.title('Increase of solute concentration at various temperatures')
                    plt.xlabel('Time')
                    plt.ylabel('Solute concentration in the Ceil (Cc)')
                    graph(x)
                else:
                    flag=False
                    print(""You must input 1 or 2"")
            except ValueError:
                print(""You must input 1 or 2"")

My problem is that i want to plot (ttime,R2) and (ttime,Cc).
But i can't figure how to call R2 and Cc for the 3 different values of D (and dx).

Also, i am taking an error: tuple indices must be integers, not float

at dx[i]=sc.sqrt(D[i]*dt/M).

Thanks!
","2012-01-31 17:24:06"
"9083767","refactor code in order to use 3 values to make plot & tuple indices must be integers, not float","1","I have a code in which for 3 different values of D ,i have 3 different values of dx and so,3 different plots.

I want to do a plot which will have all 3 plots in one.


 

 

      
    ...
    D=(0.133e-4,0.243e-4,0.283e-4)
        
    dx=sc.zeros(3)
        for i in D:
            dx[i]=sc.sqrt(D[i]*dt/M)
            
            plt.ion()
            while n<N:
                Vw_n=Vw_n1
                C_n=C_n1
                R2=(Vw_n+B1)/(Vw_0+B1)
                Cc=C_n1[0]/C0
                F2_1=10000/3*Pw*A*(C0*Vw_0/Vw_n1-C_n[1])
                dV=F2_1*dt
                Vw_n1=Vw_n+dV
                C_n1[0]=C0*Vw_0/Vw_n1
                F_i_2=-D[i]/dx[i]*(C_n[1:7]-C_n[0:6])
                C_n1[0:6]=C_n[0:6]-F_i_2*A*dt/(L/(V0/A)*V0/5)
                n+=1
                ttime=n*0.02*1000

                #-----PLOT AREA---------------------------------#

                mylabels=('T=273','T=293','T=298')
                colors=('-b','or','+k')

                if x==1:
                    plt.plot(ttime,R2,mylabels[i],colors[i])
                elif x==2:
                    plt.plot(ttime,Cc,mylabels[i],colors[i])
                plt.draw()
                plt.show()

    

----------RUNNABLE--------------------------

    import scipy as sc
    import matplotlib.pyplot as plt
    
    
    def graph(x):
        
        A=1.67e-6  
        V0=88e-12 
        Vw_n1=71.7/100*V0 
        Pw=0.22   
        L=4e-4
        B1=V0-Vw_n1   
       
        C7=0.447e-3  
       
       
        
        dt=0.2e-4
        M=0.759e-1
        
        C_n1=sc.zeros(7)
        C_n1[0:6]=0.290e-3
        C_n1[6]=0.447e-3
        
        
        C0=C_n1[0]
        Vw_0=Vw_n1
        
        N=2000 
        n =1
        D = ,0.243e-4
        dx = sc.sqrt(D*dt/M)
    
            plt.ion()
            while n<N:
                Vw_n=Vw_n1
                C_n=C_n1
                R2=(Vw_n+B1)/(Vw_0+B1)
                Cc=C_n1[0]/C0
                F2_1=10000/3*Pw*A*(C0*Vw_0/Vw_n1-C_n[1])
                dV=F2_1*dt
                Vw_n1=Vw_n+dV
                C_n1[0]=C0*Vw_0/Vw_n1
                F_i_2=-D/dx*(C_n[1:7]-C_n[0:6])
                C_n1[0:6]=C_n[0:6]-F_i_2*A*dt/(L/(V0/A)*V0/5)
                n+=1
                ttime=n*0.02*1000
    
                #-----PLOT AREA---------------------------------#
    
                
                if x==1:
                    plt.plot(ttime,R2)
                elif x==2:
                    plt.plot(ttime,Cc)
                plt.draw()
                plt.show()
    
       
    if __name__==""__main__"":
        flag=False
        while not flag:
            try:
                x=int(raw_input(""Give a choice 1  or 2  : ""))
                flag=True
                if x==1:
                    plt.title('Change in cell volume ratio as a function of time \n\
                    at various temperatures')
                    plt.xlabel('Time')
                    plt.ylabel('Ceil volume ratio (V/V0)')
                    graph(x)
                if x==2:
                    plt.title('Increase of solute concentration at various temperatures')
                    plt.xlabel('Time')
                    plt.ylabel('Solute concentration in the Ceil (Cc)')
                    graph(x)
                else:
                    flag=False
                    print(""You must input 1 or 2"")
            except ValueError:
                print(""You must input 1 or 2"")

My problem is that i want to plot (ttime,R2) and (ttime,Cc).
But i can't figure how to call R2 and Cc for the 3 different values of D (and dx).

Also, i am taking an error: tuple indices must be integers, not float

at dx[i]=sc.sqrt(D[i]*dt/M).

Thanks!
","2012-01-31 20:37:04"
"9083767","refactor code in order to use 3 values to make plot & tuple indices must be integers, not float","1","I have a code in which for 3 different values of D ,i have 3 different values of dx and so,3 different plots.

I want to do a plot which will have all 3 plots in one.


 

 

      
    ...
    D=(0.133e-4,0.243e-4,0.283e-4)
        
    dx=sc.zeros(3)
        for i in D:
            dx[i]=sc.sqrt(D[i]*dt/M)
            
            plt.ion()
            while n<N:
                Vw_n=Vw_n1
                C_n=C_n1
                R2=(Vw_n+B1)/(Vw_0+B1)
                Cc=C_n1[0]/C0
                F2_1=10000/3*Pw*A*(C0*Vw_0/Vw_n1-C_n[1])
                dV=F2_1*dt
                Vw_n1=Vw_n+dV
                C_n1[0]=C0*Vw_0/Vw_n1
                F_i_2=-D[i]/dx[i]*(C_n[1:7]-C_n[0:6])
                C_n1[0:6]=C_n[0:6]-F_i_2*A*dt/(L/(V0/A)*V0/5)
                n+=1
                ttime=n*0.02*1000

                #-----PLOT AREA---------------------------------#

                mylabels=('T=273','T=293','T=298')
                colors=('-b','or','+k')

                if x==1:
                    plt.plot(ttime,R2,mylabels[i],colors[i])
                elif x==2:
                    plt.plot(ttime,Cc,mylabels[i],colors[i])
                plt.draw()
                plt.show()

    

----------RUNNABLE--------------------------

    import scipy as sc
    import matplotlib.pyplot as plt
    
    
    def graph(x):
        
        A=1.67e-6  
        V0=88e-12 
        Vw_n1=71.7/100*V0 
        Pw=0.22   
        L=4e-4
        B1=V0-Vw_n1   
       
        C7=0.447e-3  
       
       
        
        dt=0.2e-4
        M=0.759e-1
        
        C_n1=sc.zeros(7)
        C_n1[0:6]=0.290e-3
        C_n1[6]=0.447e-3
        
        
        C0=C_n1[0]
        Vw_0=Vw_n1
        
        N=2000 
        n =1
        D = ,0.243e-4
        dx = sc.sqrt(D*dt/M)
    
            plt.ion()
            while n<N:
                Vw_n=Vw_n1
                C_n=C_n1
                R2=(Vw_n+B1)/(Vw_0+B1)
                Cc=C_n1[0]/C0
                F2_1=10000/3*Pw*A*(C0*Vw_0/Vw_n1-C_n[1])
                dV=F2_1*dt
                Vw_n1=Vw_n+dV
                C_n1[0]=C0*Vw_0/Vw_n1
                F_i_2=-D/dx*(C_n[1:7]-C_n[0:6])
                C_n1[0:6]=C_n[0:6]-F_i_2*A*dt/(L/(V0/A)*V0/5)
                n+=1
                ttime=n*0.02*1000
    
                #-----PLOT AREA---------------------------------#
    
                
                if x==1:
                    plt.plot(ttime,R2)
                elif x==2:
                    plt.plot(ttime,Cc)
                plt.draw()
                plt.show()
    
       
    

My problem is that i want to plot (ttime,R2) and (ttime,Cc).
But i can't figure how to call R2 and Cc for the 3 different values of D (and dx).

Also, i am taking an error: tuple indices must be integers, not float

at dx[i]=sc.sqrt(D[i]*dt/M).

Thanks!
","2012-01-31 21:52:01"
"25504751","refactor legacy python code: from u'...' to '...'","1","refactor legacy python code: from u'...' to '...'","2014-08-26 11:28:58"
"25504751","refactor legacy python code: from u'...' to '...'","1","I have a legacy code project which uses a lot of unicode strings like this: `u'...'`

I want to update the code to use `from __future__ import unicode_literals`

Any automated help from pycharm or an other tool?","2014-08-26 11:28:58"
"25504751","refactor legacy python code: from u'...' to '...'","1","<python><unicode><pycharm><automated-refactoring>","2014-08-26 11:28:58"
"25504751","refactor legacy python code: from u'...' to '...'","1","I have a legacy code project which uses a lot of unicode strings like this: `u'...'`

I want to update the code to use `from __future__ import unicode_literals`

Any automated help from pycharm or an other tool?

**Update**

A simple search+replace does not work, since the code could contain strings like `'fuu'` and I don't want that to be replace to `'fu'`.","2014-08-26 11:59:26"
"10184290","refactoring code in rails controller","1","refactoring code in rails controller","2012-04-17 02:28:17"
"10184290","refactoring code in rails controller","1","i have two actions in my controller

	def up_vote
		lesson = Lesson.find(params[:id])
		current_user.up_vote!(lesson)
		flash[:message] = 'Thanks for voting!'
		redirect_to lesson_path(lesson)
	end

	def down_vote
		lesson = Lesson.find(params[:id])
		current_user.down_vote!(lesson)
		flash[:message] = 'Thanks for voting!'
		redirect_to lesson_path(lesson)
	end

i was wondering what would be a good way to refactor this (keeping DRY in mind)? i read online that i shouldn't be trying to abuse the before_filter. what else could i use then? thanks!","2012-04-17 02:28:17"
"10184290","refactoring code in rails controller","1","<ruby-on-rails><controller><refactoring>","2012-04-17 02:28:17"
"4096481","refactor XML with XSL","1","refactor XML with XSL","2010-11-04 12:09:57"
"4096481","refactor XML with XSL","1","I need to move the `<sectionid/>` and the `<sponsor/>` elements inside the corresponding `<amendment/>`.

Here is an example:

From :

    <root>
          <sectionid>1</sectionid>
          <sponsor>john</sponsor>
          <sponsor>paul</paul>
          <amendment>
                <id>1</id>
                <text>some text</text>
          </amendment>
          <sectionid>2</sectionid>
          <sponsor>peter</sponsor>
          <amendment>
                <id>5</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <id>4</id>
                <text>some text</text>
          </amendment>
    </root>

to:

    <root>
          <amendment>
                <sectionid>1</sectionid>
                <sponsor>john</sponsor>
                <sponsor>paul</paul>
                <id>1</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>2</sectionid>
                <sponsor>peter</sponsor>
                <id>5</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>2</sectionid>
                <sponsor>peter</sponsor>
                <id>4</id>
                <text>some text</text>
          </amendment>
    </root>

Note 1: the `<section/>` and `<sponsor>` elements apply to all the amendments before the next `<sectionid/>`.

Note 2: The values of `//amendment/id` are not sequential.

How can this transformation be done with XSLT 1.0.","2010-11-04 12:09:57"
"4096481","refactor XML with XSL","1","<xml><xslt>","2010-11-04 12:09:57"
"4096481","refactor XML with XSL","1","I need to move the `<sectionid/>` and the `<sponsor/>` elements inside the corresponding `<amendment/>`.

Here is an example:

From :

    <root>
          <sectionid>1</sectionid>
          <sponsor>john</sponsor>
          <sponsor>paul</paul>
          <amendment>
                <id>1</id>
                <text>some text</text>
          </amendment>
          <sectionid>2</sectionid>
          <sponsor>peter</sponsor>
          <amendment>
                <id>5</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <id>4</id>
                <text>some text</text>
          </amendment>
          <sponsor>max</sponsor>
          <amendment>
                <id>6</id>
                <text>some text</text>
          </amendment>
    </root>

to:

    <root>
          <amendment>
                <sectionid>1</sectionid>
                <sponsor>john</sponsor>
                <sponsor>paul</paul>
                <id>1</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>2</sectionid>
                <sponsor>peter</sponsor>
                <id>5</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>2</sectionid>
                <sponsor>peter</sponsor>
                <id>4</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>2</sectionid>
                <sponsor>max</sponsor>
                <id>6</id>
                <text>some text</text>
          </amendment>

    </root>

Note 1: the `<section/>` element applies to all the `<amendments/>` before the next `<sectionid/>`

Note 2: the `<sponsor/>` element applies to all the `<amendments/>` before the next `<sponsor/>` list.

Note 3: The values of `//amendment/id` are not sequential.

How can this transformation be done with XSLT 1.0.","2010-11-04 12:17:50"
"4096481","refactor XML with XSL","1","I need to move the `<sectionid/>` and the `<sponsor/>` elements inside the corresponding `<amendment/>`.

Here is an example:

From :

    <root>
          <sectionid>A</sectionid>
          <sponsor>john</sponsor>
          <sponsor>paul</paul>
          <amendment>
                <id>1</id>
                <text>some text</text>
          </amendment>
          <sectionid>B</sectionid>
          <sponsor>peter</sponsor>
          <amendment>
                <id>5</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <id>4</id>
                <text>some text</text>
          </amendment>
          <sponsor>max</sponsor>
          <amendment>
                <id>6</id>
                <text>some text</text>
          </amendment>
    </root>

to:

    <root>
          <amendment>
                <sectionid>A</sectionid>
                <sponsor>john</sponsor>
                <sponsor>paul</paul>
                <id>1</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>B</sectionid>
                <sponsor>peter</sponsor>
                <id>5</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>B</sectionid>
                <sponsor>peter</sponsor>
                <id>4</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>B</sectionid>
                <sponsor>max</sponsor>
                <id>6</id>
                <text>some text</text>
          </amendment>

    </root>

Note 1: the `<section/>` element applies to all the `<amendments/>` before the next `<sectionid/>`

Note 2: the `<sponsor/>` element applies to all the `<amendments/>` before the next `<sponsor/>` list.

Note 3: The values of `//amendment/id` are not sequential.

How can this transformation be done with XSLT 1.0.","2010-11-04 12:23:45"
"4096481","refactor XML with XSL","1","I need to move the `<sectionid/>` and the `<sponsor/>` elements inside the corresponding `<amendment/>`.

Here is an example:

From :

    <root>
          <sectionid>A</sectionid>
          <sponsor>john</sponsor>
          <sponsor>paul</sponsor>
          <amendment>
                <id>1</id>
                <text>some text</text>
          </amendment>
          <sectionid>B</sectionid>
          <sponsor>peter</sponsor>
          <amendment>
                <id>5</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <id>4</id>
                <text>some text</text>
          </amendment>
          <sponsor>max</sponsor>
          <amendment>
                <id>6</id>
                <text>some text</text>
          </amendment>
    </root>

to:

    <root>
          <amendment>
                <sectionid>A</sectionid>
                <sponsor>john</sponsor>
                <sponsor>paul</paul>
                <id>1</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>B</sectionid>
                <sponsor>peter</sponsor>
                <id>5</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>B</sectionid>
                <sponsor>peter</sponsor>
                <id>4</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>B</sectionid>
                <sponsor>max</sponsor>
                <id>6</id>
                <text>some text</text>
          </amendment>

    </root>

Note 1: the `<section/>` element applies to all the `<amendments/>` before the next `<sectionid/>`

Note 2: the `<sponsor/>` element applies to all the `<amendments/>` before the next `<sponsor/>` list.

Note 3: The values of `//amendment/id` are not sequential.

How can this transformation be done with XSLT 1.0.","2010-12-07 09:40:47"
"4096481","refactor XML with XSL","1","I need to move the `<sectionid/>` and the `<sponsor/>` elements inside the corresponding `<amendment/>`.

Here is an example:

From :

    <root>
          <sectionid>A</sectionid>
          <sponsor>john</sponsor>
          <sponsor>paul</sponsor>
          <amendment>
                <id>1</id>
                <text>some text</text>
          </amendment>
          <sectionid>B</sectionid>
          <sponsor>peter</sponsor>
          <amendment>
                <id>5</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <id>4</id>
                <text>some text</text>
          </amendment>
          <sponsor>max</sponsor>
          <amendment>
                <id>6</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <id>7</id>
                <text>some text</text>
          </amendment>

    </root>

to:

    <root>
          <amendment>
                <sectionid>A</sectionid>
                <sponsor>john</sponsor>
                <sponsor>paul</paul>
                <id>1</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>B</sectionid>
                <sponsor>peter</sponsor>
                <id>5</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>B</sectionid>
                <sponsor>peter</sponsor>
                <id>4</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>B</sectionid>
                <sponsor>max</sponsor>
                <id>6</id>
                <text>some text</text>
          </amendment>
          <amendment>
                <sectionid>B</sectionid>
                <sponsor>max</sponsor>
                <id>7</id>
                <text>some text</text>
          </amendment>

    </root>

Note 1: the `<section/>` element applies to all the `<amendments/>` before the next `<sectionid/>`

Note 2: the `<sponsor/>` element applies to all the `<amendments/>` before the next `<sponsor/>` list.

Note 3: The values of `//amendment/id` are not sequential.

How can this transformation be done with XSLT 1.0.","2010-12-07 10:19:32"
"7998937","refactoring and removing 'for' statements when circling over many enum structures","1","refactoring and removing 'for' statements when circling over many enum structures","2011-11-03 17:04:41"
"7998937","refactoring and removing 'for' statements when circling over many enum structures","1","My class have an Emun as attribute.
It uses a String to set this attr.
There are many Enum classes.
How can I refactor it?

    public void setType(String s) {  

    for (MyEnum1 e : MyEnum1.values()) {  
        if (e.name().equalsIgnoreCase(s))  
        this.type = e;  
    }  
    for (MyEnum2 e : MyEnum2.values()) {  
        if (e.name().equalsIgnoreCase(s))  
        this.type = e;  
    }  
    for ...  

Thanks in advance.","2011-11-03 17:04:41"
"7998937","refactoring and removing 'for' statements when circling over many enum structures","1","<java><enums><refactoring>","2011-11-03 17:04:41"
"7998937","refactoring and removing 'for' statements when circling over many enum structures","1","My class have an Enum as attribute.
It uses a String to set this attr.
There are many Enum classes.
How can I refactor it?

    public void setType(String s) {  

    for (MyEnum1 e : MyEnum1.values()) {  
        if (e.name().equalsIgnoreCase(s))  
        this.type = e;  
    }  
    for (MyEnum2 e : MyEnum2.values()) {  
        if (e.name().equalsIgnoreCase(s))  
        this.type = e;  
    }  
    for ...  

Thanks in advance.","2011-11-03 20:47:47"
"13501039","refactor maybe stack in Yesod","1","refactor maybe stack in Yesod","2012-11-21 19:53:53"
"13501039","refactor maybe stack in Yesod","1","Using Yesod, I want to show the user's profile name in the navigation bar of every page and want to link, with the `ProfileId`, to the profile-page of a user. `config/models` contains:

    User
        ident Text
        password Text Maybe
        UniqueUser ident
    Profile
        username Text
        user UserId
        UniqueProfile user
        UniqueUsername username

Snippet from `Foundation.hs`:


    defaultLayout widget = do
        master <- getYesod
        mmsg <- getMessage

        maid <- maybeAuthId

With the user-id I can query for the profile, but it's burried in `Maybe`'s.
[This Stack Overflow question][1] gives a good hint how to handle all those `Maybe`'s... but, with my little experience of Haskell, I'm still struggling with it.

I came up with:

        mpid <- runMaybeT $ do
                        ouid <- MaybeT maybeAuthId
                        (Entity pid _) <- MaybeT . runDB . getBy $ UniqueProfile ouid
                        return pid

        mprofilename <- runMaybeT $ do
                        ouid <- MaybeT maybeAuthId
                        (Entity _ p) <- MaybeT . runDB . getBy $ UniqueProfile ouid
                        return $ profileUsername p

This works, but is not optimal - repeating code and double database hits. How can I refactor this code?

I thought this would work:

        (mpid, mprofilename) <- runMaybeT $ do
                        ouid <- MaybeT maybeAuthId
                        (Entity pid p) <- MaybeT . runDB . getBy $ UniqueProfile ouid
                        return (pid, profileUsername p)

but, alas, a no-go:

    Foundation.hs:91:9:
        Couldn't match expected type `Maybe (t0, Text)'
                    with actual type `(t1, t2)'
        In the pattern: (mpid, mprofilename)
        In a stmt of a 'do' block:
          (mpid, mprofilename) <- runMaybeT
                                  $ do { ouid <- MaybeT maybeAuthId;
                                         (Entity pid p) <- MaybeT . runDB . getBy $ UniqueProfile ouid;
                                         return (pid, profileUsername p) }
        In the expression:
          do { master <- getYesod;
               mmsg <- getMessage;
               maid <- maybeAuthId;
               (mpid, mprofilename) <- runMaybeT
                                       $ do { ouid <- MaybeT maybeAuthId;
                                              (Entity pid p) <- MaybeT . runDB . getBy
                                                                $ UniqueProfile ouid;
                                              .... };
               .... }

I understand the error, but I don't get it solved.

Enlighten me!

  [1]: http://stackoverflow.com/questions/12130732/deep-maybe-stack-with-yesod","2012-11-21 19:53:53"
"13501039","refactor maybe stack in Yesod","1","<haskell><yesod>","2012-11-21 19:53:53"
"13501039","refactor maybe stack in Yesod","1","Using Yesod, I want to show the user's profile name in the navigation bar of every page and want to link, with the `ProfileId`, to the profile-page of a user. `config/models` contains:

    User
        ident Text
        password Text Maybe
        UniqueUser ident
    Profile
        username Text
        user UserId
        UniqueProfile user
        UniqueUsername username

Snippet from `Foundation.hs`:


    defaultLayout widget = do
        master <- getYesod
        mmsg <- getMessage
        maid <- maybeAuthId

With the user-id I can query for the profile, but it's burried in `Maybe`s.
[This Stack Overflow question][1] gives a good hint how to handle all those `Maybe`s... but, with my little experience of Haskell, I'm still struggling with it.

I came up with:


    mpid <- runMaybeT $ do
        ouid <- MaybeT maybeAuthId
        (Entity pid _) <- MaybeT . runDB . getBy $ UniqueProfile ouid
        return pid

    mprofilename <- runMaybeT $ do
        ouid <- MaybeT maybeAuthId
        (Entity _ p) <- MaybeT . runDB . getBy $ UniqueProfile ouid
        return $ profileUsername p

This works, but is not optimal - repeating code and double database hits. How can I refactor this code?

I thought this would work:

    (mpid, mprofilename) <- runMaybeT $ do
        ouid <- MaybeT maybeAuthId
        (Entity pid p) <- MaybeT . runDB . getBy $ UniqueProfile ouid
        return (pid, profileUsername p)

but, alas, a no-go:

    Foundation.hs:91:9:
        Couldn't match expected type `Maybe (t0, Text)'
                    with actual type `(t1, t2)'
        In the pattern: (mpid, mprofilename)
        In a stmt of a 'do' block:
            (mpid, mprofilename) <- runMaybeT
                $ do { ouid <- MaybeT maybeAuthId;
                    (Entity pid p) <- MaybeT . runDB . getBy $ UniqueProfile ouid;
                    return (pid, profileUsername p) }
        In the expression:
            do { master <- getYesod;
                 mmsg <- getMessage;
                 maid <- maybeAuthId;
                 (mpid, mprofilename) <- runMaybeT
                     $ do { ouid <- MaybeT maybeAuthId;
                     (Entity pid p) <- MaybeT . runDB . getBy
                         $ UniqueProfile ouid;
                                              .... };
               .... }

I understand the error, but I don't get it solved.

Enlighten me!

  [1]: https://stackoverflow.com/questions/12130732/deep-maybe-stack-with-yesod
","2017-05-23 12:12:22"
"13501039","refactor maybe stack in Yesod","1","Using Yesod, I want to show the user's profile name in the navigation bar of every page and want to link, with the `ProfileId`, to the profile-page of a user. `config/models` contains:

    User
        ident Text
        password Text Maybe
        UniqueUser ident
    Profile
        username Text
        user UserId
        UniqueProfile user
        UniqueUsername username

Snippet from `Foundation.hs`:


    defaultLayout widget = do
        master <- getYesod
        mmsg <- getMessage
        maid <- maybeAuthId

With the user-id I can query for the profile, but it's burried in `Maybe`s.
[This Stack Overflow question][1] gives a good hint how to handle all those `Maybe`s... but, with my little experience of Haskell, I'm still struggling with it.

I came up with:


    mpid <- runMaybeT $ do
        ouid <- MaybeT maybeAuthId
        (Entity pid _) <- MaybeT . runDB . getBy $ UniqueProfile ouid
        return pid

    mprofilename <- runMaybeT $ do
        ouid <- MaybeT maybeAuthId
        (Entity _ p) <- MaybeT . runDB . getBy $ UniqueProfile ouid
        return $ profileUsername p

This works, but is not optimal - repeating code and double database hits. How can I refactor this code?

I thought this would work:

    (mpid, mprofilename) <- runMaybeT $ do
        ouid <- MaybeT maybeAuthId
        (Entity pid p) <- MaybeT . runDB . getBy $ UniqueProfile ouid
        return (pid, profileUsername p)

but, alas, a no-go:

    Foundation.hs:91:9:
        Couldn't match expected type `Maybe (t0, Text)'
                    with actual type `(t1, t2)'
        In the pattern: (mpid, mprofilename)
        In a stmt of a 'do' block:
            (mpid, mprofilename) <- runMaybeT
                $ do { ouid <- MaybeT maybeAuthId;
                    (Entity pid p) <- MaybeT . runDB . getBy $ UniqueProfile ouid;
                    return (pid, profileUsername p) }
        In the expression:
            do { master <- getYesod;
                 mmsg <- getMessage;
                 maid <- maybeAuthId;
                 (mpid, mprofilename) <- runMaybeT
                     $ do { ouid <- MaybeT maybeAuthId;
                     (Entity pid p) <- MaybeT . runDB . getBy
                         $ UniqueProfile ouid;
                                              .... };
               .... }

I understand the error, but I don't get it solved.

Enlighten me!

  [1]: http://stackoverflow.com/questions/12130732/deep-maybe-stack-with-yesod
","2012-11-22 01:30:38"
"4776687","refactor a method with a block that contains multiple blocks itself","1","refractor a method with a block that contains multiple blocks itself","2011-01-23 21:37:24"
"4776687","refactor a method with a block that contains multiple blocks itself","1","I'm using Ruby 1.9.2

I have a class method called search that takes a block

e.g.

    class MyClass
      def self.search do
        if criteria1
          keywords ""abcde"", fields: :c1 do
            minimum_match(1)
          end
        end
      
        if criteria2
          keywords ""defghi"", fields: :c2 do
            minimum_match(1)
          end
        end
      end
    end

What I'd like to do is refractor the MyClass.search method and have a simple one-line method for each if/end statement

e.g. it would look something like this:

    class MyClass
    
      def self.search do
        c1_method
        c2_method
      end
    
      def self.c1_method
        if criteria1
          return keywords ""abcde"", fields: :c1 do
            minimum_match(1)
          end
        end
      end
    
      def self.c2_method
        if criteria2
          return keywords ""defghi"", fields: :c2 do
            minimum_match(1)
          end
        end
      end
    end

But the refactoring that I show above doesn't quite work.  It looks like the ""blocks"" that I'm returning in c1_method and c2_method aren't really being returned and evaluated in the search method, but I'm not sure how to do that.



","2011-01-23 21:37:24"
"4776687","refactor a method with a block that contains multiple blocks itself","1","<ruby-on-rails><ruby><lambda><block>","2011-01-23 21:37:24"
"4776687","refactor a method with a block that contains multiple blocks itself","1","refactor a method with a block that contains multiple blocks itself","2011-01-23 21:45:39"
"4776687","refactor a method with a block that contains multiple blocks itself","1","I'm using Ruby 1.9.2

I have a class method called search that takes a block

e.g.

    class MyClass
      def self.search do
        if criteria1
          keywords ""abcde"", fields: :c1 do
            minimum_match(1)
          end
        end
      
        if criteria2
          keywords ""defghi"", fields: :c2 do
            minimum_match(1)
          end
        end
      end
    end

What I'd like to do is refactor the MyClass.search method and have a simple one-line method for each if/end statement

e.g. it would look something like this:

    class MyClass
    
      def self.search do
        c1_method
        c2_method
      end
    
      def self.c1_method
        if criteria1
          return keywords ""abcde"", fields: :c1 do
            minimum_match(1)
          end
        end
      end
    
      def self.c2_method
        if criteria2
          return keywords ""defghi"", fields: :c2 do
            minimum_match(1)
          end
        end
      end
    end

But the refactoring that I show above doesn't quite work.  It looks like the ""blocks"" that I'm returning in c1_method and c2_method aren't really being returned and evaluated in the search method, but I'm not sure how to do that.



","2011-01-23 21:45:39"
"35249984","refactoring $rootScope.$apply in Angular","1","refactoring $rootScope.$apply in Angular","2016-02-07 05:11:38"
"35249984","refactoring $rootScope.$apply in Angular","1","my `MusicPlayer.js` Angular service  has a callback function wrapped in `$rootScope.$apply` that updates a specific object (`musicPlayer.currentPlaybackTime`) and is shared to all other controllers ( via applying to `$rootScope`).  

I understand that you'll ideally want to limit any `$rootScope` pollution, so i'm looking at possible refactoring options that take away calling apply methods to `$rootScope` but allows my updated object to be shared across multiple controllers.  

My research indicates that i'll need to register the other controllers (i.e. `PlayerDashboardCtrl.js`, `PlaylistCtrl.js` and `AlbumListCtrl.js`) that  need my `currentPlaybackTime` object, but i'd like to understand what's the most efficient way of doing this.  

Thank you.


    

     var setSong = function(song) {

        currentBuzzObject = new buzz.sound(song.audioUrl, {
            formats: ['mp3'],
            preload: true
        });
        
        currentBuzzObject.bind('timeupdate', function() {
            $rootScope.$apply(function() {
              musicPlayer.currentPlaybackTime = currentBuzzObject.getTime();  
            });
        });
        
        musicPlayer.currentSong = song;
    };
","2016-02-07 05:11:38"
"35249984","refactoring $rootScope.$apply in Angular","1","<javascript><angularjs>","2016-02-07 05:11:38"
"26266552","refactoring Ruby scraping code","1","refactoring Ruby scraping code","2014-10-08 21:13:09"
"26266552","refactoring Ruby scraping code","1","Basically, I will have multiple `.main_entry` blocks on each page and I will need to pull a couple of pieces of data from each. How can this be properly refactored into methods? 

    require 'open-uri'
    require 'nokogiri'
    
     
    url = #url
    doc = Nokogiri::HTML(open(url))
    
    doc.css("".main_entry"").each do |item|
      artist = item.at_css("".list_artist"").text
      title = item.at_css("".list_album"").text
      puts ""#{artist} - #{title}""
    end

I have arrived at this mess below, which throws the `undefined local variable or method 'release'` error that seems to be related to methods being over-written. Could you explain to me what process the code below goes through, why it breaks down and what I should turn to for the fix? Should each `.main_entry` block be saved into some kind of a cache or an array first, before instantiating? 

    require 'open-uri'
    require 'nokogiri'
    
    class Scraper
      def initialize(url)
        @url = url
      end
    
      def release
        @release ||= doc.css("".main_entry"") || []
      end
    
      release.each do |item|
        define_method(:artist) do
          @artist ||= item.at_css("".list_artist"").text
        end
    
        define_method(:title) do
          @title ||= item.at_css("".list_album"").text
        end
      end
    
      private
      attr_reader :url
    
      def doc
        @doc ||= Nokogiri::HTML(open(url))
      end
    end
    
    scraper = Scraper.new( #url
    
    puts ""#{scraper.artist} - #{scraper.title}""

","2014-10-08 21:13:09"
"26266552","refactoring Ruby scraping code","1","<ruby><nokogiri>","2014-10-08 21:13:09"
"21571197","refactoring input check for hangman in java with acm","1","refactoring input check for hangman in java with acm","2014-02-05 07:33:26"
"21571197","refactoring input check for hangman in java with acm","1","I'm taking an online java course using the acm package, so the following syntax may not be ""orthodox java"".  At any rate, hopefully, the point I'm making here comes through to those familiar with the package and otherwise:

The code I have below works for validating user input for a game of hangman in java, but going in, I was sure that I could do this with simply one if else statement, but ultimately for expediency's sake, I settled for adding a nested if, else statement.  It's really bugging me that I can't figure out how to refactor this code in one if else statement as I'm positive that there is at least one very obvious way to do this.  Any help would be much appreciated!

	private void turn()
	{
		println(""The word now looks like this: "" + currentWord);
		println(""You have "" + guessesLeft + "" guesses left."");
		currentGuess = readLine(""Your guess: "");
		
		String temp = currentWord;
		
		/*test for legality of guess
		 * 1) is it exactly 1 char long?(ie not blank nor a long string
		 * 2) is it a letter?
		 */
		if(currentGuess.length() == 0)
		{
			println(""That is an illegal guess."");
		}
		else{
			char guessedLetter = Character.toUpperCase(currentGuess.charAt(0));
			
			if(currentGuess.length() != 1 || !Character.isLetter(guessedLetter))
			{
				println(""That is an illegal guess."");
			}
			else{
			/*scan through secret word to find a match between
			 * entered guess and secret word
			 */ ......}

    private String currentGuess;
    private String currentWord;
","2014-02-05 07:33:26"
"21571197","refactoring input check for hangman in java with acm","1","<java><acm-java-libraries>","2014-02-05 07:33:26"
"37263329","refactoring multi-dimensional if/else conditions","1","refactoring multi-dimensional if/else conditions","2016-05-16 21:12:39"
"37263329","refactoring multi-dimensional if/else conditions","1","I'm writing in Swift, but the question is really language agnostic.

I have two variables, each of which could have multiple - but discrete - values. The various combinations of the two values lead to different behavior. 

I need to consider all combinations and execute the appropriate code. What's the cleanest/easiest-to-maintain way to do this?

Graphically, it would look like this:

    var2 / var1 |    A    |    B    |    C    |
    ------------|---------|---------|---------|
    Z           |(A && Z) |(B && Z) |(C && Z) |
    ------------|---------|---------|---------|
    Y           |(A && Y) |(B && Y) |(C && Y) |
    ------------|---------|---------|---------|
    X           |(A && X) |(B && X) |(C && X) |
    -------------------------------------------

You could imagine, with a third variable, the matrix becomes 3-dimensional, etc. which is why I'm interested in a generalizable solution, not necessarily a specific solution for my particular project.

I could go multiple if/else:

    if (var1 == A && var2 == Z) {}
    else if (var1 == B && var2 == Z) {}
    else if ...

But that sounds awful.

Currently, I'm using one if/else and the same switch over and over:

    if var1 == A {
        switch var2 {
            case Z:
            case Y:
            case X:
        }
    } else if var1 == B {
        switch var2 {
            case Z:
            case Y:
            case X:
        }
    } ...

But reusing the same switch tells me I'm doing it wrong.

Is this a case for polymorphism? That concept is a bit nebulous to me, and I don't quite philosophically get it. Is there a better way?

My real-life example is a calculator-type app where behavior depends not only on the button pressed, but also the *previous* button pressed, i.e. pressing '=' after a '#' is different than pressing '=' after '+' is different than pressing '+' after '=' is different than pressing a '#' after a '#', etc... So I'm comparing the current button pressed to the previous button pressed to determine the behavior of the calculator.","2016-05-16 21:12:39"
"37263329","refactoring multi-dimensional if/else conditions","1","<if-statement><language-agnostic><conditional>","2016-05-16 21:12:39"
"15204488","refactor legacy code, extracting small interface from a giant one with a small implementation","1","refactor legacy code, extracting small interface from a giant one with a small implementation","2013-03-04 15:00:32"
"15204488","refactor legacy code, extracting small interface from a giant one with a small implementation","1","I have a large piece of code (legacy) which knows to connect to an external service lets say connects to skype and bring its availability, the way its doing this (this is how it works its for the sake of the example). is

    SkypeAvailabilityManager.java
    
    .init
    .start
    .stop
    .connect
    .disconnect
    .keepAlive
    .updateStatus

(lets assume for the example that all methods need to be public and someone calls them).
Now there is a huge piece of code (huge legacy code which calls all above methods).

Now I need to have either synchronizing with skype or with some other service lets say its `MessengerB`

However with messengerB i don't need the init, start, connect, etc, i only need the updateStatus method.

So I thought of this refactor (which does not yet sound fine to me i'll explain why

    Interface: ExternalStatusFetcher

methods of it:

    .updateStatus

Now the legacy code calls the above methods of .init .start .stop .connect in many many places, however the new MessengerStatusUpdaterImpl I need to add only needs .updateStatus and i want to reuse the .updateStatus of the skype implementation because i want to reuse code.

so my limitations:

 1. Reuse SkypeAvailabilityManager.java
 2. Legacy code calls .start .stop ... from many places in code I don't what to change that this is a huge legacy.
 3. I want a common interface meaning in my code I want to treat both impl the same way but so client would either call all the methods or only part of them i do not know until impelemntation is actually initialized with the real implemenation.

what would be a good refactor of it?
If my container class holds an interface that holds all methods this owuld be nice, however my second implemenation does not need all the methods, so i'm a little mixed up what to do.","2013-03-04 15:00:32"
"15204488","refactor legacy code, extracting small interface from a giant one with a small implementation","1","<oop><design><refactoring>","2013-03-04 15:00:32"
"47547719","refactor NodeJs functions","1","refactor NodeJs functions","2017-11-29 07:59:05"
"47547719","refactor NodeJs functions","1","I have a big `app.js` file and want to split the code. I took all my routes into a module called `routes.js`

    module.exports = function(app){
    
    app.get('/', function (req, res) {
      res.redirect('/page1');
    });
    
    app.get('/page1', function (req, res) {
      res.render('page1');
    });
    
    app.get('/page2/:id', function (req, res) {
        res.render('page2', {
          val: Number(req.params.id)
        });
    });
    
    }

and in my app.js I call

    const routes = require('./Server/routes')(app);

So this works fine.

I have some functions like

    function loadData(id, callback) {
      fs.readFile('./database.json', 'utf8', function (err, data) {
        var json = JSON.parse(data);
        var arr = json.arr;
        var obj = arr.find(e => e.id === Number(id));
        callback(obj);
      });
    }

and want to have them in separate files too. How can I do this? I am able to export one function but how can I export more than one?

Like

    module.exports = function(){
    
    function sayHello(){
       console.log(""Hello"");
    }
    
    function calc(){
       return 5 + 7;
    }
    
    }

require the module and call

    myModule.sayHello();
    
    var num = myModule.calc();","2017-11-29 07:59:05"
"47547719","refactor NodeJs functions","1","<javascript><node.js>","2017-11-29 07:59:05"
"932226","refactoring boolean equation","1","refactoring boolean equation","2009-05-31 15:25:32"
"932226","refactoring boolean equation","1","lets say you have a boolean rule/expression like so

(A OR B)  AND (D OR E) AND F

you want to convert it into as many AND only expressions as possible. like so

A AND D AND F
A AND E AND F
B AND D AND F
B AND E AND F

you are just reducing the OR's so it becomes

(A AND D AND F) OR (A AND E AND F) OR (...)

is there a property in boolean algebra that would do this?  

thanks!



","2009-05-31 15:25:32"
"932226","refactoring boolean equation","1","<boolean><equation><parsing><expression>","2009-05-31 15:25:32"
"932226","refactoring boolean equation","1","Let's say you have a Boolean rule/expression like so

    (A OR B) AND (D OR E) AND F

You want to convert it into as many AND only expressions as possible, like so

    A AND D AND F
    A AND E AND F
    B AND D AND F
    B AND E AND F

You are just reducing the OR's so it becomes

    (A AND D AND F) OR (A AND E AND F) OR (...)

Is there a property in Boolean algebra that would do this?  




","2009-05-31 19:10:28"
"32304235","refactoring working recursion code (hasFiveDIVs) for traversing the DOM","1","refactoring working recursion code (hasFiveDIVs) for traversing the DOM","2015-08-31 04:58:17"
"32304235","refactoring working recursion code (hasFiveDIVs) for traversing the DOM","1","@oriol provided an amazing two line recursive solution for a problem I was working on today.  

    function numOccurencesRecursive(arr, val) {
      if (!arr.length) return 0;
      return (arr[0] === val ? 1 : 0) + numOccurencesRecursive(arr.slice(1), val);
    }

I was inspired to refactor some spagetti-ish code that I wrote yesterday:

    function containsFiveOrMoreDivs(domElement) {
      var count = 0;
    
      function doCount(domElement) {
        if (domElement && domElement.tagName === ""DIV"") {
          count++;
        }
    
        if (count >= 5) {
          return true;
        }
    
        if (domElement.hasChildNodes()) {
          var children = domElement.childNodes;
          for (var i = 0; i < children.length; i++) {
            if (doCount(children[i])) {
              return true
            }
          };
        };
    
        return false;
      }
    
      return doCount(domElement)
    }
    containsFiveOrMoreDivs(document);

Here's the attempt:

    function containsFiveOrMoreDivsPureRecursion(domElement) {
      if (!domElement && domElement.tagName !== ""DIV"") {
        return 0;
      }
      return (domElement.tagName === ""DIV"" ? 1 : 0) + containsFiveOrMoreDivsPureRecursion(domElement.childNodes()); //?
    }

how would I loop through all the child nodes recursively in this version? Is what I'm doing possible?","2015-08-31 04:58:17"
"32304235","refactoring working recursion code (hasFiveDIVs) for traversing the DOM","1","<javascript><recursion><refactoring>","2015-08-31 04:58:17"
"32304235","refactoring working recursion code (hasFiveDIVs) for traversing the DOM","1","@oriol provided an amazing two line recursive solution for a problem I was working on today.  

    function numOccurencesRecursive(arr, val) {
      if (!arr.length) return 0;
      return (arr[0] === val ? 1 : 0) + numOccurencesRecursive(arr.slice(1), val);
    }

I was inspired to refactor some spagetti-ish code that I wrote yesterday:

    //returns a boolean
        function containsFiveOrMoreDivs(domElement) {
          var count = 0;
    
      function doCount(domElement) {
        if (domElement && domElement.tagName === ""DIV"") {
          count++;
        }
    
        if (count >= 5) {
          return true;
        }
    
        if (domElement.hasChildNodes()) {
          var children = domElement.childNodes;
          for (var i = 0; i < children.length; i++) {
            if (doCount(children[i])) {
              return true
            }
          };
        };
    
        return false;
      }
    
      return doCount(domElement)
    }
    containsFiveOrMoreDivs(document);

Here's the attempt:

    function containsFiveOrMoreDivsPureRecursion(domElement) {
      if (!domElement && domElement.tagName !== ""DIV"") {
        return 0;
      }
      return (domElement.tagName === ""DIV"" ? 1 : 0) + containsFiveOrMoreDivsPureRecursion(domElement.childNodes()); //?
    }

how would I loop through all the child nodes recursively in this version? Is what I'm doing possible?","2015-08-31 05:09:55"
"10050146","refactor this javascript code","1","refactor this javascript code","2012-04-06 22:54:42"
"10050146","refactor this javascript code","1","I have two click-events, that are nearly similar, but not quite. I am wondering how to refactor them best:

      $('.remove_fields.dynamic').live('click', function(e) {
        var $this = $(this);
        var after_removal_trigger_node = $this.closest("".nested-fields"").parent();
        trigger_removal_callback($this);
        e.preventDefault();
        $this.closest("".nested-fields"").remove();
        trigger_after_removal_callback(after_removal_trigger_node);
      });
    
      $('.remove_fields.existing').live('click', function(e) {
        var $this = $(this);
        var after_removal_trigger_node = $this.closest("".nested-fields"").parent();
        trigger_removal_callback($this);
        e.preventDefault();
        $this.prev(""input[type=hidden]"").val(""1"");
        $this.closest("".nested-fields"").hide();
        trigger_after_removal_callback(after_removal_trigger_node);
      });

As you can tell there is a fair bit of overlap. I am wondering what the best/nicest way would be to refactor this code.","2012-04-06 22:54:42"
"10050146","refactor this javascript code","1","<javascript><refactoring>","2012-04-06 22:54:42"
"5135051","refactoring ruby method","1","refactoring ruby method","2011-02-27 18:36:59"
"5135051","refactoring ruby method","1","this is a simple question...

Does this method can be refactored?

    def sum
      total = 0
      [1,2,3,4].each do |num|
        total += num
      end
      total
    end

thanks for your help!","2011-02-27 18:36:59"
"5135051","refactoring ruby method","1","<ruby><loops><refactoring>","2011-02-27 18:36:59"
"12866445","refactoring databaseHelper","1","refactoring databaseHelper","2012-10-12 20:14:40"
"12866445","refactoring databaseHelper","1","I'm creating a database with this structure (4 Tables):
http://i.stack.imgur.com/vPaoD.png (Can't embed because lack of rep)

My worries is that the class is growing is in a fast pace and it's not that simple to work in it anymore since it is getting so large. Is there anyway i can refactor (=split it into several classes) my databaseHelper to make it simpler and more structured but yet still make it easy to work with?


public class DatabaseHelper extends SQLiteOpenHelper {

	// Database static variables
	private static final int DATABASE_VERSION = 2;
	private static final String DATABASE_NAME = ""feedlrDatabase"";

	// Declaring feed table
	private static final String TABLE_FEED = ""feed"";
	private static final String FEED_COLUMN_ID = ""_id"";
	private static final String FEED_COLUMN_NAME = ""name"";

	// Declaring feed-user bridge table
	private static final String TABLE_FEEDUSER = ""feeduser"";
	private static final String FEEDUSER_COLUMN_FEED_ID = ""feed_ID"";
	private static final String FEEDUSER_COLUMN_USER_ID = ""user_ID"";

	// Declaring user table
	private static final String TABLE_USER = ""user"";
	private static final String USER_COLUMN_ID = ""_id"";
	public static final String USER_COLUMN_USERNAME = ""username"";
	public static final String USER_COLUMN_USERID = ""userid"";
	public static final String USER_COLUMN_IMGURL = ""ProfileImageURL"";
	public static final String USER_COLUMN_SOURCE = ""source"";

	// Declaring item table
	private static final String TABLE_ITEM = ""item"";
	public static final String ITEM_COLUMN_ID = ""_id"";
	public static final String ITEM_COLUMN_ITEMID = ""itemid"";
	public static final String ITEM_COLUMN_TEXT = ""text"";
	private static final String ITEM_COLUMN_TIMESTAMP = ""timestamp"";
	private static final String ITEM_COLUMN_TYPE = ""type"";
	private static final String ITEM_COLUMN_URL = ""URL"";
	private static final String ITEM_COLUMN_IMGURL = ""imgURL"";
	private static final String ITEM_COLUMN_USER_ID = ""user_ID"";

	private SQLiteDatabase db = this.getWritableDatabase();

	public DatabaseHelper(Context context) {
		super(context, DATABASE_NAME, null, DATABASE_VERSION);
	}

	public void onCreate(SQLiteDatabase database) {
		// @formatter:off
		// Creating feed table
		database.execSQL(""CREATE TABLE "" + TABLE_FEED + ""("" + FEED_COLUMN_ID
				+ "" INTEGER PRIMARY KEY AUTOINCREMENT,"" + FEED_COLUMN_NAME
				+ "" TEXT UNIQUE"" + "")"");

		// Creating feed-user bridge table
		database.execSQL(""CREATE TABLE "" + TABLE_FEEDUSER + ""(""
				+ FEEDUSER_COLUMN_FEED_ID + "" INT NOT NULL,""
				+ FEEDUSER_COLUMN_USER_ID + "" INT NOT NULL"" + "")"");

		// Creating user table
		// TODO Should username be the unique idenifier of a user?!
		database.execSQL(""CREATE TABLE "" + TABLE_USER + ""("" + USER_COLUMN_ID
				+ "" INTEGER PRIMARY KEY AUTOINCREMENT,"" + USER_COLUMN_USERNAME
				+ "" TEXT NOT NULL,"" + USER_COLUMN_USERID + "" TEXT UNIQUE,""
				+ USER_COLUMN_IMGURL + "" TEXT,"" + USER_COLUMN_SOURCE
				+ "" TEXT NOT NULL"" + "")"");

		// Creating item table
		database.execSQL(""CREATE TABLE "" + TABLE_ITEM + ""("" + ITEM_COLUMN_ID
				+ "" INTEGER PRIMARY KEY AUTOINCREMENT,"" + ITEM_COLUMN_ITEMID
				+ "" INT UNIQUE,"" + ITEM_COLUMN_TEXT + "" TEXT,""
				+ ITEM_COLUMN_TIMESTAMP + "" DATETIME,"" + ITEM_COLUMN_TYPE
				+ "" TEXT,"" + ITEM_COLUMN_URL + "" TEXT,"" + ITEM_COLUMN_IMGURL
				+ "" TEXT,"" + ITEM_COLUMN_USER_ID + "" INT NOT NULL"" + "")"");
		// @formatter:on
	}

	@Override
	public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
		// Temporarily drops all tables
		db.execSQL(""DROP TABLE IF EXISTS "" + TABLE_FEED);
		db.execSQL(""DROP TABLE IF EXISTS "" + TABLE_FEEDUSER);
		db.execSQL(""DROP TABLE IF EXISTS "" + TABLE_USER);
		db.execSQL(""DROP TABLE IF EXISTS "" + TABLE_ITEM);
		onCreate(db);
	}

	public void addFeed(Feed feed) {
		ContentValues temp = new ContentValues();

		temp.put(FEED_COLUMN_NAME, feed.getTitle());
		try {
			db.insertOrThrow(TABLE_FEED, null, temp);
		} catch (SQLiteConstraintException e) {
			Log.d(""ERROR"", ""Inserted feed is not UNIQUE!"");
			// TODO Apply listener to notify the user that the feed name already
			// exists!
		}
	}

	public void removeFeed(Feed feed) {
		String title = feed.getTitle();
		long id = getFeedID(feed);

		removeFeedBridge(id);

		db.delete(TABLE_FEED, FEED_COLUMN_NAME + ""=?"", new String[] { title });
	}

	public ArrayList<String> listFeeds() {
		final ArrayList<String> feeds = new ArrayList<String>();

		Cursor c = db.rawQuery(""SELECT * FROM "" + TABLE_FEED, null);
		while (c.moveToNext()) {
			String s = c.getString(1);
			feeds.add(s);
		}
		c.close();
		return feeds;
	}

	public long getFeedID(Feed feed) {
		String feedTitle = feed.getTitle();
		SQLiteDatabase db = this.getReadableDatabase();
		Cursor c = db.query(TABLE_FEED, new String[] { FEED_COLUMN_ID },
				FEED_COLUMN_NAME + ""=?"", new String[] { feedTitle }, null,
				null, null);
		c.moveToNext();
		Long id = Long.parseLong(c.getString(0));
		c.close();
		return id;
	}

	public long getUserID(User user) {
		long id = user.getId();
		SQLiteDatabase db = this.getReadableDatabase();
		Cursor c = db.query(TABLE_USER, new String[] { USER_COLUMN_ID },
				USER_COLUMN_ID + ""=?"", new String[] { id + """" }, null, null,
				null);
		c.moveToNext();
		Long id1 = Long.parseLong(c.getString(0));
		c.close();
		return id1;
	}

	public ArrayList<String> listUsers() {
		final ArrayList<String> users = new ArrayList<String>();

		Cursor c = db.rawQuery(""SELECT * FROM "" + TABLE_USER, null);

		while (c.moveToNext()) {
			String s = c.getString(1);
			users.add(s);
		}
		return users;
	}

	public void addUserToFeed(User user, Feed feed) {
		long FeedID = getFeedID(feed);
		long UserID = addUser(user);

		// Add bridge connection
		if (UserID != -1) {
			addFeedUserBridge(FeedID, UserID);
		}
	}

	public long addUser(User user) {
		// TODO Check if the user already exists!!
		ContentValues temp = new ContentValues();

		temp.put(USER_COLUMN_USERNAME, user.getUserName());
		temp.put(USER_COLUMN_USERID, user.getId());
		temp.put(USER_COLUMN_IMGURL, user.getProfileImageURL());
		temp.put(USER_COLUMN_SOURCE, ""Twitter"");
		// TODO implement source on user?

		long userID = db.insert(TABLE_USER, null, temp);
		return userID;
	}

	public void addFeedUserBridge(long feedID, long userID) {
		ContentValues temp = new ContentValues();

		temp.put(FEEDUSER_COLUMN_FEED_ID, feedID);
		temp.put(FEEDUSER_COLUMN_USER_ID, userID);

		db.insert(TABLE_FEEDUSER, null, temp);
	}

	public void removeUserFromFeed(Feed feed, User user) {
		long feedID = getFeedID(feed);
		long userID = getUserID(user);

		removeFeedUserBridge(feedID, userID);
	}

	private void removeUser(User user) {
		long id = user.getId();
		db.delete(TABLE_USER, USER_COLUMN_ID + ""=?"", new String[] { id + """" });
	}

	private void removeFeedUserBridge(long feedID, long userID) {
		db.delete(TABLE_FEEDUSER, FEEDUSER_COLUMN_FEED_ID + ""=?"" + "" and ""
				+ FEEDUSER_COLUMN_USER_ID + ""=?"", new String[] { feedID + """",
				userID + """" });
	}

	public ArrayList<String> listFeedUser() {
		final ArrayList<String> feeduser = new ArrayList<String>();
		Cursor c = db.rawQuery(""SELECT * FROM "" + TABLE_FEEDUSER, null);
		while (c.moveToNext()) {
			feeduser.add(c.getString(0) + "" "" + c.getString(1));
		}
		c.close();
		return feeduser;
	}

	private void removeFeedBridge(Long id) {
		db.delete(TABLE_FEEDUSER, FEEDUSER_COLUMN_FEED_ID + ""=?"",
				new String[] { id + """" });
	}

	public void updateUser(long userID) {
		// TODO implement this method
	}

	public void addListOfItems(List<? extends Item> itemList) {
		db.beginTransaction();
		for (Item i : itemList) {
			ContentValues temp = new ContentValues();
			temp.put(ITEM_COLUMN_ITEMID, i.getId());
			temp.put(ITEM_COLUMN_TEXT, i.getText());
			temp.put(ITEM_COLUMN_TIMESTAMP, i.getTimestamp());
			temp.put(ITEM_COLUMN_TYPE, i.getText());
			temp.put(ITEM_COLUMN_URL, i.getURL());
			temp.put(ITEM_COLUMN_IMGURL, i.getIMGURL());
			temp.put(ITEM_COLUMN_USER_ID, i.getUser().getId());
			db.insertWithOnConflict(TABLE_ITEM, null, temp, SQLiteDatabase.CONFLICT_IGNORE);

		}
		db.setTransactionSuccessful();
		db.endTransaction();
	}

	public List<User> getUsersInFeed(Feed feed) {
		List<User> users = new ArrayList<User>();

		Cursor c = db
				.rawQuery(""SELECT * FROM "" + TABLE_USER + "" WHERE ""
						+ USER_COLUMN_USERID + "" IN (SELECT ""
						+ FEEDUSER_COLUMN_USER_ID + "" FROM "" + TABLE_FEEDUSER
						+ "" WHERE "" + FEEDUSER_COLUMN_FEED_ID + "" = ""
						+ getFeedID(feed) + "")"", null);

		c.moveToFirst();
		while (!c.isAfterLast()) {
			users.add(new User(c.getLong(c.getColumnIndex(USER_COLUMN_USERID)),
					c.getString(c.getColumnIndex(USER_COLUMN_USERNAME))));
			c.moveToNext();
		}

		return users;
	}

	public Cursor getAllItems() {
		Cursor c = db.query(TABLE_ITEM, new String[] { ITEM_COLUMN_ID,
				ITEM_COLUMN_TEXT, ITEM_COLUMN_TIMESTAMP, ITEM_COLUMN_TYPE,
				ITEM_COLUMN_URL, ITEM_COLUMN_IMGURL, ITEM_COLUMN_USER_ID },
				null, null, null, null, null);
		// db.close();
		return c;
	}

	public long getItemTableSize() {
		SQLiteDatabase database = this.getReadableDatabase();
		long l = DatabaseUtils.queryNumEntries(database, TABLE_ITEM);
		// database.close();
		return l;
	}

	public void clearItemTable() {
		db.delete(TABLE_ITEM, null, null);
	}

	public void clearUserTable() {
		db.delete(TABLE_USER, null, null);
	}

	public void clearFeeds() {
		db.delete(TABLE_FEED, null, null);
		db.delete(TABLE_FEEDUSER, null, null);
	}

	public void addUsers(List<? extends User> users) {
		db.beginTransaction();

		for (User u : users) {
			ContentValues temp = new ContentValues();
			temp.put(USER_COLUMN_USERNAME, u.getUserName());
			temp.put(USER_COLUMN_USERID, u.getId());
			temp.put(USER_COLUMN_SOURCE, u.getSource());
			db.insertWithOnConflict(TABLE_USER, null, temp, SQLiteDatabase.CONFLICT_IGNORE);
		}
		db.setTransactionSuccessful();
		db.endTransaction();
	}

	public Cursor getAllUsers() {
		Cursor c = db.query(TABLE_USER, new String[] { USER_COLUMN_ID,
				USER_COLUMN_USERNAME, USER_COLUMN_USERID }, null, null, null,
				null, null);
		return c;
	}

	public Cursor getItems(Feed feed) {
		Cursor c = db.rawQuery(""SELECT * FROM "" + TABLE_ITEM 
				+ "" WHERE ""	+ ITEM_COLUMN_USER_ID 
				+ "" IN (SELECT "" + FEEDUSER_COLUMN_USER_ID 
				+ "" FROM "" + TABLE_FEEDUSER
				+ "" WHERE "" + FEEDUSER_COLUMN_FEED_ID 
				+ "" = "" + getFeedID(feed)
				+ "") ORDER BY "" + ITEM_COLUMN_TIMESTAMP + "" DESC"", null);
		return c;
	}
}

Best regards
Rawa","2012-10-12 20:14:40"
"12866445","refactoring databaseHelper","1","<java><android><sqlite>","2012-10-12 20:14:40"
"9853024","refactoring date and time columns convertion to Time(WithZone)","1","refactoring date and time columns convertion to Time(WithZone)","2012-03-24 15:45:04"
"9853024","refactoring date and time columns convertion to Time(WithZone)","1","I got 2 colums representing a date and a time. 

 `{dateproc: '2012-03-23', horproc: '2000-01-01 16:15:23 UTC'}`

Both are read as a TimeWithZone by rails. I need to combine them.

This is what I've done. It works, but it doesn't *feel* elegant, and it just doesn't seem readable.

    date_time_combined = dateproc + horproc.seconds_since_midnight.seconds

Any advice improoving it?","2012-03-24 15:45:04"
"9853024","refactoring date and time columns convertion to Time(WithZone)","1","<ruby-on-rails><ruby-on-rails-3>","2012-03-24 15:45:04"
"4841542","refactor jquery code","1","Jquery dettach function and chain it.","2011-01-30 06:33:11"
"4841542","refactor jquery code","1","How can I remove the code at the end `data(""autocomplete"")...` and put it in a function?

        var input = $(""#CountryL"");

        $(input).autocomplete({
            minLength: 0,
            source: $(input).data('url'),
            focus: function (event, ui) {
                $(input).val(ui.item[$(input).data('display')]);
                return false;
            },
            select: function (event, ui) {
                $(input).val(ui.item[$(input).data('display')]);
                $('#' + $(input).data('hidden')).val(ui.item[$(input).data('id')]);
                return false;
            }
        }).data(""autocomplete"")._renderItem = function (ul, item) {
            var tmp = $(""<div>"").setTemplate($(""#""+$(input).data('template')).html());
            tmp.processTemplate(item);
            $(""<li></li>"").data(""item.autocomplete"", item)
                          .append($(tmp).html())
                          .appendTo(ul);
            return;
        }; 

I'd like to be able to do:

    function templateOverride(object){

     object.data(""autocomplete"")._renderItem = function (ul, item) {
            var tmp = $(""<div>"").setTemplate($(""#""+$(input).data('template')).html());
            tmp.processTemplate(item);
            $(""<li></li>"").data(""item.autocomplete"", item)
                          .append($(tmp).html())
                          .appendTo(ul);
            return;
    }


    var input = $(""#CountryL"");

    $(input).autocomplete({
            minLength: 0,
            source: $(input).data('url'),
            focus: function (event, ui) {
                $(input).val(ui.item[$(input).data('display')]);
                return false;
            },
            select: function (event, ui) {
                $(input).val(ui.item[$(input).data('display')]);
                $('#' + $(input).data('hidden')).val(ui.item[$(input).data('id')]);
                return false;
            }
    }).templateOverride(this);","2011-01-30 06:33:11"
"4841542","refactor jquery code","1","<jquery>","2011-01-30 06:33:11"
"4841542","refactor jquery code","1","refactor jquery code","2011-01-30 06:41:24"
"4841542","refactor jquery code","1","How can I remove the code at the end `data(""autocomplete"")...` and put it in a function?

        var input = $(""#CountryL"");

        $(input).autocomplete({
            minLength: 0,
            source: $(input).data('url')
        }).data(""autocomplete"")._renderItem = function (ul, item) {
            var tmp = $(""<div>"").setTemplate($(""#""+$(input).data('template')).html());
            tmp.processTemplate(item);
            $(""<li></li>"").data(""item.autocomplete"", item)
                          .append($(tmp).html())
                          .appendTo(ul);
            return;
        }; 

I'd like to be able to do:

    function templateOverride(object){

     object.data(""autocomplete"")._renderItem = function (ul, item) {
            var tmp = $(""<div>"").setTemplate($(""#""+$(input).data('template')).html());
            tmp.processTemplate(item);
            $(""<li></li>"").data(""item.autocomplete"", item)
                          .append($(tmp).html())
                          .appendTo(ul);
            return;
    }


    var input = $(""#CountryL"");

    $(input).autocomplete({
            minLength: 0,
            source: $(input).data('url')
    }).templateOverride(this);","2011-01-30 06:48:43"
"4841542","refactor jquery code","1","<jquery><refactoring>","2011-01-30 06:41:24"
"30156282","refactoring multiple variable names intellij","1","refactoring multiple variable names intellij","2015-05-10 20:25:24"
"30156282","refactoring multiple variable names intellij","1","Is there any way for intellij to refactore code(well, multiple copy-pasted lines) like this one:

    Comment a1 = new Comment(1,null);
    Comment a1 = new Comment(1,null);
    Comment a1 = new Comment(1,null);
    ... and
    .. so
    . on

into

    Comment a1 = new Comment(1,null);
    Comment a2 = new Comment(1,null);
    Comment a3 = new Comment(1,null);
    ... and
    .. so
    . on","2015-05-10 20:25:24"
"30156282","refactoring multiple variable names intellij","1","<intellij-idea>","2015-05-10 20:25:24"
"30156282","refactoring multiple variable names intellij","1","Is there any way for Intellij to refactor the code consisting of multiple copy-pasted lines like this one:

    Comment a1 = new Comment(1,null);
    Comment a1 = new Comment(1,null);
    Comment a1 = new Comment(1,null);
    ... and
    .. so
    . on

into

    Comment a1 = new Comment(1,null);
    Comment a2 = new Comment(1,null);
    Comment a3 = new Comment(1,null);
    ... and
    .. so
    . on","2015-05-10 20:39:44"
"30156282","refactoring multiple variable names intellij","1","","2015-05-10 20:39:44"
"6927614","refactoring sql schema","1","refactoring sql schema","2011-08-03 13:56:18"
"6927614","refactoring sql schema","1","Guys i currently have 2 tables that reference a lookup table. Ive been tasked with modifiying the database to allow the tables to reference more than one value in the lookup table.

My idea is to create a new table that has a new PK and a column that references the lookup table.  The PK of the new table is then dumped into the parent tables thus maintaining referential integrity E.G

Current

     Contracts
     =========
     PK Id
     FK lookupId

     Warranties
     ==========
     PK Id
     FK lookupId

New

     Contracts
     =========
     PK Id
     FK LinkingTableId

     Warranties
     ==========
     PK Id
     FK LinkingTableId

     LinkingTable
     ============
     PK Id
     FK LookupId


Is this a good way of handling the multiple references?","2011-08-03 13:56:18"
"6927614","refactoring sql schema","1","<sql>","2011-08-03 13:56:18"
"4629149","refactoring Quartz jobdata","1","refactoring Quartz jobdata","2011-01-07 18:54:35"
"4629149","refactoring Quartz jobdata","1","I had to refactor a class like this:


Class Person in package com.core has a reference to Class Address which is in the same package. I had to move Address to a new package com.core.location. This was simple on the java side, however, there are some quartz triggers which have com.core.Person referencing the old com.core.Address class as part of their job data map. It could be anywhere in the Map.

I have tried a few approaches, like writing an adapter which acts like a common ground between 2 java programs that eventually replace the ols class with the new one. What would be the best way to resolve this?

Thanks,
Chris.

","2011-01-07 18:54:35"
"4629149","refactoring Quartz jobdata","1","<java><refactoring><triggers><quartz>","2011-01-07 18:54:35"
"4629149","refactoring Quartz jobdata","1","<java><triggers><refactoring><quartz-scheduler>","2013-08-07 13:38:41"
"1396166","refactoring and removing case statements when circling over an enum structure","1","refactoring and removing case statements when circling over an enum structure","2009-09-08 20:26:44"
"1396166","refactoring and removing case statements when circling over an enum structure","1","An enum structure declared in its own class is a member variable to the business logic class. That enum basically represents the state of that other class.

Although I have revisited the issue several times, replacing, or getting rid of those case statements proves quite frustrating to me.

Several business logic methods simple iterate over the enum and change the state of that class by assigning another value of the same enum, and other properties.

        public enum MyEnum{ A,B,C,D }

The business logic class has this enum as a member:

        public class BusinessLogic {
                 private MyEnum CurrentSelection;
                 private int propertyX;
                 private int propertyY;
            
            public void operation1(){
            		switch(CurrentSelection){
            		case A: {alter propertyX this way; break;}
            		case B: {alter propertyY this way; break;}
            		case C: {alter propertyX that way; break;}
            		case D: {alter propertyY that way; break;}
            		}
            		
            	}
            	
            	public void operation2(){
            		switch(CurrentSelection){
            		case A: {CurrentSelection=MyEnum.B; break;}
            		case B: {CurrentSelection=MyEnum.C; break;}
            		....etc
            		}
            	}
            	
            	public void operation3(){
            		switch(CurrentSelection){
            		case A: {CurrentSelection=MyEnum.D; break;}
            		case B: {CurrentSelection=MyEnum.A; break;}
            		....etc
            		}
            	}
    }



Another client class will instatiate the business logic class, initialing its properties and then using its operation methods.

What I have successfully done (with help from SO) is encapsulate the operation methods into a command pattern structure so I can call the operations without any case statements. ([here][1]).

I guess my trouble is how to encapsulate the case statements in my business logic class. I suspect that I would need polymorphism and the appropriate data structures.

The refactoring experts suggest each case statement should be an implementation of a common interface. But if I have 3 methods iterating over a 4-member enum that means I'd probably need 3 interfaces with 4 implementations each, giving me 12 classes (plus 3 interfaces). Wouldn't that be a class overload? The logic is working fine with those 3 methods as they are, but the issue are the repeating switch/case statements.

Is there a way to refactor those switch statements but avoid a myriad of other classes in the name of polymorphism? Would it be possible to factor out the iterate-over-the-enum part? Or just the cases (where the logic is) should be refactored?

Many thanks in advance.


  [1]: http://stackoverflow.com/questions/1386673/trouble-making-polymorphism-defeat-those-switch-case-statements","2009-09-08 20:26:44"
"1396166","refactoring and removing case statements when circling over an enum structure","1","<design-patterns><polymorphism><switch-statement><java><refactoring>","2009-09-08 20:26:44"
"1396166","refactoring and removing case statements when circling over an enum structure","1","An enum structure declared in its own class is a member variable to the business logic class. That enum basically represents the state of that other class.

Although I have revisited the issue several times, replacing, or getting rid of those case statements proves quite frustrating to me.

Several business logic methods simple iterate over the enum and change the state of that class by assigning another value of the same enum, and other properties.

    public enum MyEnum{ A,B,C,D }

The business logic class has this enum as a member:

    public class BusinessLogic {

        private MyEnum CurrentSelection;
        private int propertyX;
        private int propertyY;
    
        public void operation1(){
    		switch(CurrentSelection){
    		case A: {alter propertyX this way; break;}
    		case B: {alter propertyY this way; break;}
    		case C: {alter propertyX that way; break;}
    		case D: {alter propertyY that way; break;}
    		}
    		
    	}
    	
    	public void operation2(){
    		switch(CurrentSelection){
    		case A: {CurrentSelection=MyEnum.B; break;}
    		case B: {CurrentSelection=MyEnum.C; break;}
    		....etc
    		}
    	}
    	
    	public void operation3(){
    		switch(CurrentSelection){
    		case A: {CurrentSelection=MyEnum.D; break;}
    		case B: {CurrentSelection=MyEnum.A; break;}
    		....etc
    		}
    	}
    }


Another client class will instantiate the business logic class, initialing its properties and then using its operation methods.

What I have successfully done (with help from SO) is encapsulate the operation methods into a command pattern structure so I can call the operations without any case statements. ([here][1]).

I guess my trouble is how to encapsulate the case statements in my business logic class. I suspect that I would need polymorphism and the appropriate data structures.

The refactoring experts suggest each case statement should be an implementation of a common interface. But if I have 3 methods iterating over a 4-member enum that means I'd probably need 3 interfaces with 4 implementations each, giving me 12 classes (plus 3 interfaces). Wouldn't that be a class overload? The logic is working fine with those 3 methods as they are, but the issue are the repeating switch/case statements.

Is there a way to refactor those switch statements but avoid a myriad of other classes in the name of polymorphism? Would it be possible to factor out the iterate-over-the-enum part? Or just the cases (where the logic is) should be refactored?

---

As a first step I removed those methods completely my having them implement a simple interface:

    public interface Command {
	    void execute();
    }

So, its operation method implemented the command interface:

    public class Operation1 implements Command {

        private void doOperation1(){
            switch(CurrentSelection){
                ..all the cases here
            }		
        }
    
        public void execute() {
     		doOperation1();
    	}
    
    }

As I see this, it will buy my a cleaner business logic class, but the trail of the switch cases will remain, right?

  [1]: https://stackoverflow.com/questions/1386673/trouble-making-polymorphism-defeat-those-switch-case-statements
","2017-05-23 12:13:44"
"1396166","refactoring and removing case statements when circling over an enum structure","1","An enum structure declared in its own class is a member variable to the business logic class. That enum basically represents the state of that other class.

Although I have revisited the issue several times, replacing, or getting rid of those case statements proves quite frustrating to me.

Several business logic methods simple iterate over the enum and change the state of that class by assigning another value of the same enum, and other properties.

        public enum MyEnum{ A,B,C,D }

The business logic class has this enum as a member:

        public class BusinessLogic {
                 private MyEnum CurrentSelection;
                 private int propertyX;
                 private int propertyY;
            
            public void operation1(){
            		switch(CurrentSelection){
            		case A: {alter propertyX this way; break;}
            		case B: {alter propertyY this way; break;}
            		case C: {alter propertyX that way; break;}
            		case D: {alter propertyY that way; break;}
            		}
            		
            	}
            	
            	public void operation2(){
            		switch(CurrentSelection){
            		case A: {CurrentSelection=MyEnum.B; break;}
            		case B: {CurrentSelection=MyEnum.C; break;}
            		....etc
            		}
            	}
            	
            	public void operation3(){
            		switch(CurrentSelection){
            		case A: {CurrentSelection=MyEnum.D; break;}
            		case B: {CurrentSelection=MyEnum.A; break;}
            		....etc
            		}
            	}
    }



Another client class will instatiate the business logic class, initialing its properties and then using its operation methods.

What I have successfully done (with help from SO) is encapsulate the operation methods into a command pattern structure so I can call the operations without any case statements. ([here][1]).

I guess my trouble is how to encapsulate the case statements in my business logic class. I suspect that I would need polymorphism and the appropriate data structures.

The refactoring experts suggest each case statement should be an implementation of a common interface. But if I have 3 methods iterating over a 4-member enum that means I'd probably need 3 interfaces with 4 implementations each, giving me 12 classes (plus 3 interfaces). Wouldn't that be a class overload? The logic is working fine with those 3 methods as they are, but the issue are the repeating switch/case statements.

Is there a way to refactor those switch statements but avoid a myriad of other classes in the name of polymorphism? Would it be possible to factor out the iterate-over-the-enum part? Or just the cases (where the logic is) should be refactored?

Many thanks in advance.

---

As a first step I removed those methods completely my having them implement a simple interface:

    public interface Command {
	void execute();
}

So, its operation method implemented the command interface:

    public class Operation1 implements Command {
                private void doOperation1(){
                		switch(CurrentSelection){
                		..all the cases here
                		}
                		
                	}
    
            public void execute() {
     		doOperation1();
    	}
    
    }

As I see this, it will buy my a cleaner business logic class, but the trail of the switch cases will remain, right?

  [1]: http://stackoverflow.com/questions/1386673/trouble-making-polymorphism-defeat-those-switch-case-statements
","2009-09-08 20:46:52"
"1396166","refactoring and removing case statements when circling over an enum structure","1","An enum structure declared in its own class is a member variable to the business logic class. That enum basically represents the state of that other class.

Although I have revisited the issue several times, replacing, or getting rid of those case statements proves quite frustrating to me.

Several business logic methods simple iterate over the enum and change the state of that class by assigning another value of the same enum, and other properties.

    public enum MyEnum{ A,B,C,D }

The business logic class has this enum as a member:

    public class BusinessLogic {

        private MyEnum CurrentSelection;
        private int propertyX;
        private int propertyY;
    
        public void operation1(){
    		switch(CurrentSelection){
    		case A: {alter propertyX this way; break;}
    		case B: {alter propertyY this way; break;}
    		case C: {alter propertyX that way; break;}
    		case D: {alter propertyY that way; break;}
    		}
    		
    	}
    	
    	public void operation2(){
    		switch(CurrentSelection){
    		case A: {CurrentSelection=MyEnum.B; break;}
    		case B: {CurrentSelection=MyEnum.C; break;}
    		....etc
    		}
    	}
    	
    	public void operation3(){
    		switch(CurrentSelection){
    		case A: {CurrentSelection=MyEnum.D; break;}
    		case B: {CurrentSelection=MyEnum.A; break;}
    		....etc
    		}
    	}
    }


Another client class will instantiate the business logic class, initialing its properties and then using its operation methods.

What I have successfully done (with help from SO) is encapsulate the operation methods into a command pattern structure so I can call the operations without any case statements. ([here][1]).

I guess my trouble is how to encapsulate the case statements in my business logic class. I suspect that I would need polymorphism and the appropriate data structures.

The refactoring experts suggest each case statement should be an implementation of a common interface. But if I have 3 methods iterating over a 4-member enum that means I'd probably need 3 interfaces with 4 implementations each, giving me 12 classes (plus 3 interfaces). Wouldn't that be a class overload? The logic is working fine with those 3 methods as they are, but the issue are the repeating switch/case statements.

Is there a way to refactor those switch statements but avoid a myriad of other classes in the name of polymorphism? Would it be possible to factor out the iterate-over-the-enum part? Or just the cases (where the logic is) should be refactored?

---

As a first step I removed those methods completely my having them implement a simple interface:

    public interface Command {
	    void execute();
    }

So, its operation method implemented the command interface:

    public class Operation1 implements Command {

        private void doOperation1(){
            switch(CurrentSelection){
                ..all the cases here
            }		
        }
    
        public void execute() {
     		doOperation1();
    	}
    
    }

As I see this, it will buy my a cleaner business logic class, but the trail of the switch cases will remain, right?

  [1]: http://stackoverflow.com/questions/1386673/trouble-making-polymorphism-defeat-those-switch-case-statements
","2016-11-24 14:25:24"
"32639112","refactor and move controller code into model issues","1","refactor and move controller code into model issues","2015-09-17 20:09:30"
"32639112","refactor and move controller code into model issues","1","So I'm running into some issues that I'm not aware of how to solve when I'm improving my code.

Currently in my controller#show I have this ugly piece of code:


    def show
      @room = Room.find(params[:id])
      if user_signed_in?
        gon.push(
          session_id: @room.session_id,
          api_key: 453,
          token: current_user.tokens.last.token
        )
      elsif customer_signed_in?
        gon.push(
          session_id: @room.session_id,
          api_key: 453,
          token: current_customer.tokens.last.token,
          customer_id: current_customer.id
        )
      elsif @room.price == 0.0
        @token = OT.generate_token @room.session_id
        gon.push(
          session_id: @room.session_id,
          api_key: 453,
          token: @token
        )
      else
        @customer = Customer.new
      end
    end

now I would like to move this into the rooms model. The issue that I'm having is that I'm having an if else based on if it's a user, customer or neither. How would I go about moving this into a model and still be able to validate this?","2015-09-17 20:09:30"
"32639112","refactor and move controller code into model issues","1","<ruby-on-rails>","2015-09-17 20:09:30"
"3573107","refactor my if statement code","1","refactor my if statement code","2010-08-26 07:59:17"
"3573107","refactor my if statement code","1","I've been messing with this bit of code for over an hour trying to rearrange it different ways. Is there any easier way to write it?

       if x is not Number      ;// if x is string
       {
          if y is not Number      ;// x, y both strings
          {
             Eval(x)
             Eval(y)
             return
          }
          else                    ;// x is string, y is Number
          {
             Eval(x)
             Scale(y)
             return
          }
       }
       else if y is not Number    ;// x is Number, y is string
       {
          Scale(x)
          Eval(y)
          return
       }
       else                       ;// both are numbers
       {
          Scale(x)
          Scale(y)
          return   
       }","2010-08-26 07:59:17"
"3573107","refactor my if statement code","1","<refactoring><if-statement><pseudocode>","2010-08-26 07:59:17"
"247329","refactor HTML-generating JavaScript","1","refactor JavaScript string concatenation","2008-10-29 15:50:17"
"247329","refactor HTML-generating JavaScript","1","Unfortunately on my project, we generate a lot of the HTML code in JavaScript like this:

    var html = new StringBuffer();
    html.append(""<td class=\""gr-my-deals\""><a href=\"""").append(deal.url).append(""\"" target=\""_blank\"">"").append(deal.description).append(""</a></td>"");

I have 2 specific complaints about this:

1.	The use of escaped double quotes (\”) within the HTML string. These should be replaced by single quotes (‘) to improve readability.
2.	The use of .append() instead of the JavaScript string concatentation operator “+”

Applying both of these suggestions, produces the following equivalent line of code, which I consider to be much more readable:

    var html = ""<td class=’gr-my-deals’><a href=’"" + deal.url + ""’ target=’_blank’>"" + deal.description + ""</a></td>"";

I'm now looking for a way to automatically transform the first line of code into the second. All I've come up with so far is to run the following find and replace over all our Javascript code:

    Find:    ).append(  
    Replace: +

This will convert the line of code shown above to:


    html.append(""<td class=\""gr-my-deals\""><a href=\"""" + deal.url + ""\"" target=\""_blank\"">"" + deal.description + ""</a></td>)"";

This should safely remove all but the first 'append()' statement. Unfortunately, I can't think of any safe way to automatically convert the escaped double-quotes to single quotes. Bear in mind that I can't simply do a find/replace because in some cases (when you have triply-nested strings) you actually do need to use escaped double-quotes. Typically, this is when you're generating HTML that includes nested JS, and that JS contains string parameters

    function makeLink(stringParam) {
    
      var sb = new StringBuffer();
      sb.append(""<a href=\""JavaScript:myFunc('"" + stringParam + ""');\"">"");
    }

My questions (finally) are:

  - Is there a better way to safely replace the calls to 'append()' with '+'
  - Is there any way to safely replace the escaped double quotes with single quotes, regex?

Cheers,
Don
","2008-10-29 15:50:17"
"247329","refactor HTML-generating JavaScript","1","<javascript><string-concatenation>","2008-10-29 15:50:17"
"247329","refactor HTML-generating JavaScript","1","refactor HTML generation in JS","2008-10-29 16:17:09"
"247329","refactor HTML-generating JavaScript","1","refactor HTML generated in JavaScript","2008-10-29 16:41:00"
"247329","refactor HTML-generating JavaScript","1","refactor HTML-generating JavaScript","2008-10-29 16:53:00"
"247329","refactor HTML-generating JavaScript","1","Unfortunately on my project, we generate a lot of the HTML code in JavaScript like this:

    var html = new StringBuffer();
    html.append(""<td class=\""gr-my-deals\""><a href=\"""").append(deal.url).append(""\"" target=\""_blank\"">"").append(deal.description).append(""</a></td>"");

I have 2 specific complaints about this:

1.	The use of escaped double quotes (\”) within the HTML string. These should be replaced by single quotes (‘) to improve readability.
2.	The use of .append() instead of the JavaScript string concatentation operator “+”

Applying both of these suggestions, produces the following equivalent line of code, which I consider to be much more readable:

    var html = ""<td class=’gr-my-deals’><a href=’"" + deal.url + ""’ target=’_blank’>"" + deal.description + ""</a></td>"";

I'm now looking for a way to automatically transform the first line of code into the second. All I've come up with so far is to run the following find and replace over all our Javascript code:

    Find:    ).append(  
    Replace: +

This will convert the line of code shown above to:


    html.append(""<td class=\""gr-my-deals\""><a href=\"""" + deal.url + ""\"" target=\""_blank\"">"" + deal.description + ""</a></td>)"";

This should safely remove all but the first 'append()' statement. Unfortunately, I can't think of any safe way to automatically convert the escaped double-quotes to single quotes. Bear in mind that I can't simply do a find/replace because in some cases you actually do need to use escaped double-quotes. Typically, this is when you're generating HTML that includes nested JS, and that JS contains string parameters, e.g.

    function makeLink(stringParam) {
    
      var sb = new StringBuffer();
      sb.append(""<a href=\""JavaScript:myFunc('"" + stringParam + ""');\"">"");
    }

My questions (finally) are:

  - Is there a better way to safely replace the calls to 'append()' with '+'
  - Is there any way to safely replace the escaped double quotes with single quotes, regex?

Cheers,
Don
","2008-10-29 15:55:54"
"247329","refactor HTML-generating JavaScript","1","<javascript><string-concatenation><html>","2008-10-29 16:17:09"
"2615901","refactor LINQ TO SQL custom properties that instantiate datacontext","1","refactor LINQ TO SQL custom properties that instantiate datacontext","2010-04-11 03:03:28"
"2615901","refactor LINQ TO SQL custom properties that instantiate datacontext","1","I am working on an existing ASP.NET MVC app that started small and has grown with time to require a good re-architecture and refactoring.

One thing that I am struggling with is that we've got partial classes of the L2S entities so we could add some extra properties, but these props create a new data context and query the DB for a subset of data.  This would be the equivalent to doing the following in SQL, which is not a very good way to write this query as oppsed to joins: 

    SELECT tbl1.stuff, 
        (SELECT nestedValue FROM tbl2 WHERE tbl2.Foo = tbl1.Bar),
        tbl1.moreStuff
     FROM tbl1

so in short here's what we've got in some of our partial entity classes:

    public partial class Ticket {
    
    public StatusUpdate LastStatusUpdate
    {
        get
        {
             //this static method call returns a new DataContext but needs to be refactored
             var ctx = OurDataContext.GetContext();
             var su = Compiled_Query_GetLastUpdate(ctx, this.TicketId);
             return su;
        }
    }
    
    }

We've got some functions that create a compiled query, but the issue is that we also have some DataLoadOptions defined in the DataContext, and because we instantiate a new datacontext for getting these nested property, we get an exception 

> ""Compiled Queries across DataContexts
> with different LoadOptions not
> supported""

.  The first DataContext is coming from a DataContextFactory that we implemented with the refactorings, but this second one is just hanging off the entity property getter.

We're implementing the Repository pattern in the refactoring process, so we **must** stop doing stuff like the above.  Does anyone know of a good way to address this issue?","2010-04-11 03:03:28"
"2615901","refactor LINQ TO SQL custom properties that instantiate datacontext","1","<asp.net-mvc><refactoring><linq-to-sql><repository-pattern>","2010-04-11 03:03:28"
"2615901","refactor LINQ TO SQL custom properties that instantiate datacontext","1","I am working on an existing ASP.NET MVC app that started small and has grown with time to require a good re-architecture and refactoring.

One thing that I am struggling with is that we've got partial classes of the L2S entities so we could add some extra properties, but these props create a new data context and query the DB for a subset of data.  This would be the equivalent to doing the following in SQL, which is not a very good way to write this query as oppsed to joins: 

    SELECT tbl1.stuff, 
        (SELECT nestedValue FROM tbl2 WHERE tbl2.Foo = tbl1.Bar),
        tbl1.moreStuff
     FROM tbl1

so in short here's what we've got in some of our partial entity classes:

    public partial class Ticket {
    
    public StatusUpdate LastStatusUpdate
    {
        get
        {
             //this static method call returns a new DataContext but needs to be refactored
             var ctx = OurDataContext.GetContext();
             var su = Compiled_Query_GetLastUpdate(ctx, this.TicketId);
             return su;
        }
    }
    
    }

We've got some functions that create a compiled query, but the issue is that we also have some DataLoadOptions defined in the DataContext, and because we instantiate a new datacontext for getting these nested property, we get an exception 

> ""Compiled Queries across DataContexts
> with different LoadOptions not
> supported""

.  The first DataContext is coming from a DataContextFactory that we implemented with the refactorings, but this second one is just hanging off the entity property getter.

We're implementing the Repository pattern in the refactoring process, so we **must** stop doing stuff like the above.  Does anyone know of a good way to address this issue?

EDIT:  I am adding the code for the DataContextFactory that we created during our refactoring efforts.  Note that in the code above we have a GetContext() static method in the Linq DataContext class, which news up a datacontext, and is not using the DataContextFactory below:

    public class DataContextFactory<T> : IDataContextFactory where T : System.Data.Linq.DataContext
    {
    	public DataContextFactory()
    	{
    		_context = Activator.CreateInstance<T>();
    	}
    
    	public DataContextFactory(T context)
    	{
    		_context = context;
    	}
    
    	private System.Data.Linq.DataContext _context;
    	public System.Data.Linq.DataContext Context
    	{
    		get 
    		{
    			return _context; 
    		}
    	}
    
    	public void SaveAll()
    	{
    		Context.SubmitChanges();
    	}
    
    	public bool IsContextDirty
    	{
    		get
    		{
    			return Context != null && (Context.GetChangeSet().Deletes.Count > 0 ||
    										   Context.GetChangeSet().Inserts.Count > 0 ||
    										   Context.GetChangeSet().Updates.Count > 0);
    		}
    	}
    }

","2010-04-13 17:11:17"
"17752926","refactor jQuery to fade and stop it from crashing browser","1","refactor jQuery to fade and stop it from crashing brower","2013-07-19 18:18:33"
"17752926","refactor jQuery to fade and stop it from crashing browser","1","This js works but after a while it crashes any browser thats open. Do I have to close some loop? 

I would also like to change the slide effect to fade in/out (just replacing .slideDown does not do it). Thoughts?

    function ticker() {
        $('#jsTicker li:first').slideUp(function() {
            $(this).appendTo($('#jsTicker')).slideDown(1500);
        });
    }
    setInterval(ticker, 6000);

http://jsfiddle.net/KevinOrin/Zh3wU/","2013-07-19 18:18:33"
"17752926","refactor jQuery to fade and stop it from crashing browser","1","<javascript><jquery>","2013-07-19 18:18:33"
"17752926","refactor jQuery to fade and stop it from crashing browser","1","refactor jQuery to fade and stop it from crashing browser","2017-02-27 13:41:27"
"30334257","refactoring Rails 4 before_action for code speed with reused controller methods","1","refactoring Rails 4 before_action for code speed with reused controller methods","2015-05-19 19:14:13"
"30334257","refactoring Rails 4 before_action for code speed with reused controller methods","1","I’ve been learning Rails for a while now and I’d like to know what the best way to include reusable methods in other methods is.  I use before_action for some, but I’m wondering if I should convert my code which looks like ‘Fig.A’ to utilize more before actions (Fig. B).  Is this the best practice & does it improve speed? 

**Fig.A** <br>
SomeController.rb

    def some_action
      #logic
    end
    
    def my_method
     some_action
      #logic
    end
    
    def my_other_method
     some_action
      #logic
     end

versus using a before action

**Fig.B**<br>
SomeController.rb

    before_action  :some_action, only: [:my_method, :my_other_method]
    
    def some_action
      #logic
    end
    
    def my_method
      #logic
    end
    
    def my_other_method
      #logic
    end


I am asking as I am trying to get a handle on best practices and clean code.  Which is the preferred way?","2015-05-19 19:14:13"
"30334257","refactoring Rails 4 before_action for code speed with reused controller methods","1","<ruby-on-rails><ruby-on-rails-4><controller><refactoring>","2015-05-19 19:14:13"
"39143730","refactor angular js factory to provider","1","refactor angular js factory to provider","2016-08-25 11:12:35"
"39143730","refactor angular js factory to provider","1","I have a factory defined in my program called 'EntityName'. now i want to refactor it to be a provider since I need to add a register function in the provider level.
however, I don't want to change all places using the existing factory like so:

    new EntityName()

so I refactored my factory to be a provider like so:

    myMoodule.provider('EntityName', function() {
    	var _this = this;		
    	_this.registerLabel = function registerLabel(name) {
              ...
    	};
    	_this.$get =  function (session, Logger) {
    			var logger = new Logger('EntityName');
    			return function EntityName(){...}
        }
    )};

that way I have both method to be used in provider level(registerLabel) and no need to refactor all places using `New EntityName()`

my question is- whether I can add some functions in the 'service' level and keep the fact that I don't need to refactor all `New EntityName()`: 

for example I want to have a method `EntityName.replaceLabel()` 

(not related to the object from `var name = new EntityName()`","2016-08-25 11:12:35"
"39143730","refactor angular js factory to provider","1","<angularjs>","2016-08-25 11:12:35"
"39143730","refactor angular js factory to provider","1","I have a factory defined in my program called 'EntityName'. now i want to refactor it to be a provider since I need to add a register function in the provider level.
however, I don't want to change all places using the existing factory like so:

    new EntityName()

so I refactored my factory to be a provider like so:

    myMoodule.provider('EntityName', function() {
    	var _this = this;		
    	_this.registerLabel = function registerLabel(name) {
              ...
    	};
    	_this.$get =  function (session, Logger) {
    			var logger = new Logger('EntityName');
    			return function EntityName(){...}
        }
    )};

that way I have both method to be used in provider level(registerLabel) and no need to refactor all places using `New EntityName()`

my question is- whether I can add some functions in the 'service' level and keep the fact that I don't need to refactor all `New EntityName()`: 

for example I want to have a method `EntityName.replaceLabel()` 

(not related to the object from `var name = new EntityName()`

I want the service to expose more functions -not only the constructor function. is it possible ? how can i do it? that the $get will return both constructor function (so I won't need to change all other places) and also expose additional methods and use it like any other service ","2016-08-25 11:34:03"
"9491516","refactor calls to a bunch of constructors that all take the same args","1","refactor calls to a bunch of constructors that all take the same args","2012-02-28 23:38:23"
"9491516","refactor calls to a bunch of constructors that all take the same args","1","How would I refactor this:

    if (cond1) {
        return new Class1(arg1, arg2, arg3);
    }
    else if (cond2) {
        return new Class2(arg1, arg2, arg3);
    }
    else if (cond3) {
        return new Class3(arg1, arg2, arg3);
    }
    ...

I'm particularly interested in avoiding repeating `arg1, arg2, arg3`","2012-02-28 23:38:23"
"9491516","refactor calls to a bunch of constructors that all take the same args","1","<c#><constructor><refactoring>","2012-02-28 23:38:23"
"4560741","refactoring this block","1","refactoring this block","2010-12-30 07:09:35"
"4560741","refactoring this block","1","I'm refactoring some code that wasn't written by me. This block sets the value of `$val` but I want to clean it up a bit. Obviously I can't use the tertiary operator here. What other ways I can make this code cleaner?

      if (isset($vars[$input])) {
           $val = $vars[$input];
      } elseif (isset($this->getI['io'])) {
           $val = $this->getI['io'];
      } elseif (isset($vars[5])) {
           $val = $vars[5];
      } else {
           $val = 10;
      }","2010-12-30 07:09:35"
"4560741","refactoring this block","1","<php><refactoring>","2010-12-30 07:09:35"
"32352198","refactor performCrop() method out of activity class","1","refactor performCrop() method out of activity class","2015-09-02 11:41:39"
"32352198","refactor performCrop() method out of activity class","1","I have a PerformCrop method which works perfectly.

I want to move it to my 'util' class so i can call it in other activities. There are complications to this in that it uses intents which return to the calling class. I think this should be no issue but maybe i'm incorrect.

Here is what i have tried and the issue i am seeing

 1. I cut and paste performCrop() to my util class. 
 2. I had an error at 'startActivityForResult(cropIntent, CROP_IMAGE);' where it didnt recognise the method so i extended the class with 'Extends Activity'
 3. When it runs it errors and im not 100% sure why but an exception is caught 

> 'java.lang.NullPointerException: Attempt to invoke virtual method
> 'android.app.ActivityThread$ApplicationThread
> android.app.ActivityThread.getApplicationThread()' on a null object
> reference'

Here is the method, below that is the 'onActivityResult' method. Can anyone tell me how to move the performCrop() to a non Activity extended class?

Code

    public void performCrop(Uri picUri)
    {
        final int CROP_IMAGE = 2;
            /*
    * PERFORM CROP
    * this must take into account he fact we may not have a crop method on phone, or the diff ways diff OS crop
     */
        //NEXUS 5 OS 5 is example of this branch
        // take care of exceptions
        try {
            // call the standard crop action intent (the user device may not
            // support it)
    
            Intent cropIntent = new Intent(""com.android.camera.action.CROP"");
            // indicate image type and Uri
            cropIntent.setDataAndType(picUri, ""image/*"");
            // set crop properties
            cropIntent.putExtra(""crop"", ""true"");
            // // indicate aspect of desired crop
            cropIntent.putExtra(""aspectX"", 1);
            cropIntent.putExtra(""aspectY"", 1);
            // // // indicate output X and Y
    
            // retrieve data on return
            cropIntent.putExtra(""return-data"", true);
            // start the activity - we handle returning in onActivityResult
            startActivityForResult(cropIntent, CROP_IMAGE);
        }
        // respond to users whose devices do not support the crop action
        catch (ActivityNotFoundException anfe)
        {
            Toast toast = Toast.makeText(this,""This device doesn't support the crop action! Exception: "" + anfe.toString(),Toast.LENGTH_SHORT);
            toast.show();
        }
        catch (OutOfMemoryError e)
        {//NOT TESTED AS HW DOES NOT GO HERE
            System.out.println(""out of memory"");
        }
        catch (Exception e)
        { //NOT TESTED AS HW DOES NOT GO HERE
            Display display = this.getWindowManager().getDefaultDisplay();
            Point size = new Point();
            //display.getSize(size);
            int width = size.x;
            int height = size.y;
            Intent cropIntent = new Intent(""com.android.camera.action.CROP"");
            // indicate image type and Uri
            cropIntent.setDataAndType(picUri, ""image/*"");
            // set crop properties
            cropIntent.putExtra(""crop"", ""true"");
            // // indicate aspect of desired crop
            cropIntent.putExtra(""aspectX"", 2);
            cropIntent.putExtra(""aspectY"", 1);
            // // indicate output X and Y
            cropIntent.putExtra(""outputX"", width);
            cropIntent.putExtra(""outputY"", 200);
            // retrieve data on return
            cropIntent.putExtra(""return-data"", true);
            // start the activity - we handle returning in onActivityResult
            startActivityForResult(cropIntent, CROP_IMAGE);
        }
    }
    

Called from Activity when the camera intent returns successful result. Note the crop intent will also retun to this method.

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data)
    {
        // TODO Auto-generated method stub
        if (resultCode==RESULT_OK )
        {
            if(requestCode == CAMERA_IMAGE) //reply from camera
            {
                toolbox.performCrop(uri); //crop the picture
            }
    
            if(requestCode == CROP_IMAGE) //reply from crop
            {
               /* Bitmap bmp = getBitmap(uri);
                imgView.setImageBitmap(bmp);*/
                Bundle extras = data.getExtras();
                if (extras != null) {
                    Bitmap bmp = extras.getParcelable(""data"");
                    imgViewProfilePic.setImageBitmap(bmp);
                }
            }
    
            if (requestCode == PICK_IMAGE_FROM_GALLERY) //reply from gallery
            {
                Uri selectedImage = data.getData();
                uri = data.getData();
                toolbox.performCrop(uri);
            }
        }
    }
         
","2015-09-02 11:41:39"
"32352198","refactor performCrop() method out of activity class","1","<android><crop><android-crop>","2015-09-02 11:41:39"
"32352198","refactor performCrop() method out of activity class","1","<android><android-activity><crop><android-crop>","2015-09-02 13:16:31"
"35002854","refactor code using reflection","1","refactor code using reflection","2016-01-25 21:36:11"
"35002854","refactor code using reflection","1","I am struggling on refactoring this (working) code:

  MyDbContext db = new MyDbContext();

     List<SelectListItem> selectedItems = new List<SelectListItem>();
     if (type == null) return selectedItems;
    
    if (type == typeof(class1))
                 selectedItems = db.class1.ToList().Select(ii => new SelectListItem { Text = ii.Name, Value = ii.Id.ToString() }).OrderBy(si => si.Text).ToList();
    
    if (type == typeof(class2))
                 selectedItems = db.class2.ToList().Select(ii => new SelectListItem { Text = ii.Name, Value = ii.Id.ToString() }).ToList();
    
    if (type == typeof(class3))
                selectedItems = db.class3.ToList().Select(ii => new SelectListItem { Text = ii.Name, Value = ii.Id.ToString() }).ToList();
    
    if (type == typeof(class4))
                selectedItems = db.class4.ToList().Select(ii => new SelectListItem { Text = ii.Name, Value = ii.Id.ToString() }).ToList();

This code is inside an ASP.NET MVC controller.
Class1 to Class 4 are Model classes.


SelectListItem is just a ModelView class I use to grab an Id and a Name from a Class1, 2, 3 or 4 object. I don't think it s worth posting its code.
So below code just extracts all occurrences of Class1 or2 or 3 or 4 and converts them into options that will be passed to a View (for a DropDownBox).
I only know the exact Model type at runtime of course (Class1...or 4).

I use Entity Framework with such a DbContext:

      public partial class MyDbContext: DbContext
        {
    ...
        
            public virtual DbSet<Class1> Class1{ get; set; }
            public virtual DbSet<Class2> Class2{ get; set; }
            public virtual DbSet<Class3> Class3{ get; set; }
            public virtual DbSet<Class4> Class4{ get; set; }
    ...
        }

I am pretty sure I can end up with a clean code with reflection instead of this horrible thing I wrote. But I did not manage to get anything clean that compiles.

Thx for your help.","2016-01-25 21:36:11"
"35002854","refactor code using reflection","1","<c#><asp.net-mvc><reflection>","2016-01-25 21:36:11"
"35002854","refactor code using reflection","1","I am struggling on refactoring this (working) code:

    MyDbContext db = new MyDbContext();

     List<SelectListItem> selectedItems = new List<SelectListItem>();
     if (type == null) return selectedItems;
    
    if (type == typeof(class1))
                 selectedItems = db.class1.ToList().Select(ii => new SelectListItem { Text = ii.Name, Value = ii.Id.ToString() }).OrderBy(si => si.Text).ToList();
    
    if (type == typeof(class2))
                 selectedItems = db.class2.ToList().Select(ii => new SelectListItem { Text = ii.Name, Value = ii.Id.ToString() }).ToList();
    
    if (type == typeof(class3))
                selectedItems = db.class3.ToList().Select(ii => new SelectListItem { Text = ii.Name, Value = ii.Id.ToString() }).ToList();
    
    if (type == typeof(class4))
                selectedItems = db.class4.ToList().Select(ii => new SelectListItem { Text = ii.Name, Value = ii.Id.ToString() }).ToList();

This code is inside an ASP.NET MVC controller.
Class1 to Class 4 are Model classes.


SelectListItem is just a ModelView class I use to grab an Id and a Name from a Class1, 2, 3 or 4 object. I don't think it s worth posting its code.
So below code just extracts all occurrences of Class1 or 2 or 3 or 4 and converts them into options that will be passed to a View (for a DropDownBox).
I only know the exact Model type at runtime of course (Class1...or 4).

I use Entity Framework with such a DbContext:

      public partial class MyDbContext: DbContext
        {
    ...
        
            public virtual DbSet<Class1> Class1{ get; set; }
            public virtual DbSet<Class2> Class2{ get; set; }
            public virtual DbSet<Class3> Class3{ get; set; }
            public virtual DbSet<Class4> Class4{ get; set; }
    ...
        }

I am pretty sure I can end up with a clean code with reflection instead of this horrible thing I wrote. But I did not manage to get anything clean that compiles.
","2016-01-25 21:39:42"
"36697360","refactoring of simple code in Yii2 (if-else)","1","refactoring of simple code in Yii2 (if-else)","2016-04-18 14:48:57"
"36697360","refactoring of simple code in Yii2 (if-else)","1","i was doing some refactoring of code on project in Yii2 framework.

I'm just asking if this can be written nicer, with less repetition (i try to follow DRY whenever i can). Any literature recommendation about this kind of topic is more than welcome, sorry for bad English.

    $exception = Yii::$app->errorHandler->exception;

        if ($exception !== null) {
            if (isset($exception->statusCode)) {
                if ($exception->statusCode == 500) {
                    return $this->render('error-500', ['exception' => $exception]);
                } elseif ($exception->statusCode == 404) {
                    return $this->render('error-404', ['exception' => $exception]);
                } else {
                    return $this->render('error', ['exception' => $exception]);
                }
            } elseif (isset($exception->code)) {
                if ($exception->code == 500) {
                    return $this->render('error-500', ['exception' => $exception]);
                } elseif ($exception->code == 404) {
                    return $this->render('error-404', ['exception' => $exception]);
                } else {
                    return $this->render('error', ['exception' => $exception]);
                }
            }
        } else {
            $exception = new \yii\web\HttpException(500);
            return $this->render('error-500', ['exception' => $exception]);
        }","2016-04-18 14:48:57"
"36697360","refactoring of simple code in Yii2 (if-else)","1","<yii2><refactoring>","2016-04-18 14:48:57"
"45792353","refactor functions using template literal","1","refactor functions using template literal","2017-08-21 08:22:12"
"45792353","refactor functions using template literal","1","I have these 2 functions, if I seperate them I would have a lot of redundant codes. You can see what it does here https://jsfiddle.net/8m9zbefq/ basically I just want to transform the data structure.

How can I refactor two function into one?


    const prepare_femaleObj = raw.map((obj, i) => {
      const female_count = obj.age_data.reduce((accum, obj2) => {
      	if(obj2.female_count) return accum + obj2.female_count
      }, 0)
      
      const percentage = female_count / total_female_count * 100
      
      return { id: ++i, camera: obj.device_info.name + ' - ' + obj.device_info.entrance_name, percentage }
    })
    
    const prepare_maleObj = raw.map((obj, i) => {
      const male_count = obj.age_data.reduce((accum, obj2) => {
      	if(obj2.male_count) return accum + obj2.male_count
      }, 0)
      
      const percentage = male_count / total_male_count * 100
      
      return { id: ++i, camera: obj.device_info.name + ' - ' + obj.device_info.entrance_name, percentage }
    })

I've this thought, use template literal to make the gender dynamic

    const prepare_Obj = (gender) => raw.map((obj, i) => {
      const `${gender}_count` = obj.age_data.reduce((accum, obj2) => {
        if(obj2[`${gender}_count`)] return accum + obj2.female_count
      }, 0)
    
      ...
    })

is the approach fine?","2017-08-21 08:22:12"
"45792353","refactor functions using template literal","1","<javascript><ecmascript-6>","2017-08-21 08:22:12"
"23414508","refactor rails controller that has many query parameters?","1","refactor rails controller that has many query parameters?","2014-05-01 18:54:32"
"23414508","refactor rails controller that has many query parameters?","1","I have a rails controller show action which shows either the parents teams of a team, the child teams of a team, or the full family tree. Currently I am doing this as a simple case statement. Is this the correct ""rails"" way to do it or should I refactor? If yes, any suggestions on how would be appreciated.

    if @team= fetch_team
      case params[:tree]
      when 'parents'
        @output = @team.ancestor_ids
      when 'children'
        @output = @team.child_ids
      when 'full'
        @output = @team.full_tree
      when nil
        @output = fetch_team
      else
        @output = {message: ""requested query parameter: '#{params[:tree]}' not defined""}
      end

      render json: @output
    else
      render json: {message: ""team: '#{params[:id]}' not found""}, status: 404
    end

    ##

    def fetch_team
     Team.find_by(name: params[:id])
    end

","2014-05-01 18:54:32"
"23414508","refactor rails controller that has many query parameters?","1","<ruby-on-rails><ruby><controllers>","2014-05-01 18:54:32"
"19587133","refactor folder ""layout"" to ""layout-sw600dp"" and it cannot work","1","refactor folder ""layout"" to ""layout-sw600dp"" and it cannot work","2013-10-25 10:18:32"
"19587133","refactor folder ""layout"" to ""layout-sw600dp"" and it cannot work","1","Before this, I make an application using the settings for normal phone and now I want to switch to using the tablet .When I refactor the folder ""layout"" to ""layout-sw600dp"", it cannot work in emulator. plz help me.tq","2013-10-25 10:18:32"
"19587133","refactor folder ""layout"" to ""layout-sw600dp"" and it cannot work","1","<android-layout>","2013-10-25 10:18:32"
"7101485","refactor cferror tag to application.cfc's onError()","1","cferror to application.cfc's onError()","2011-08-18 01:41:12"
"7101485","refactor cferror tag to application.cfc's onError()","1","How to translate

    <cferror type=""EXCEPTION"" template=""ErrorTemplate.cfm"">

to an `onError()` function for Application.cfc?  Notice that cferror create a var `error` struct for the template.  Is there a quick and easy way to create the same error struct?  And how to pass that into ErrorTemplate.cfm using `<cfinclude>`?  Stick it to the `Form` scope?

Thank you","2011-08-18 01:41:12"
"7101485","refactor cferror tag to application.cfc's onError()","1","<coldfusion>","2011-08-18 01:41:12"
"7101485","refactor cferror tag to application.cfc's onError()","1","refactor cferror tag to application.cfc's onError()","2011-08-18 01:46:28"
"7101485","refactor cferror tag to application.cfc's onError()","1","How to translate

    <cferror type=""EXCEPTION"" template=""ErrorTemplate.cfm"">

to an `onError()` function for Application.cfc?  Notice that cferror create a var `error` struct for the template.  Is there a quick and easy way to create the same error struct?  How to pass that into ErrorTemplate.cfm using `<cfinclude>`?  

I know `onRequest()` shares the variable scope with the target page, but does onError share variables scope too?  If not, what shall I do? Stick it to the `Form` scope?

Thank you","2011-08-18 01:46:28"
"7101485","refactor cferror tag to application.cfc's onError()","1","<coldfusion><application.cfc>","2012-11-30 00:02:22"
"7101485","refactor cferror tag to application.cfc's onError()","1","","2012-11-30 00:02:22"
"14680106","refactor Html.LabelFor, EditorFor, ValidationMessageFor into partial view","1","refactor Html.LabelFor, EditorFor, ValidationMessageFor into partial view","2013-02-04 03:53:07"
"14680106","refactor Html.LabelFor, EditorFor, ValidationMessageFor into partial view","1","I want to refactor view form code to avoid copyPaste. But it's not working. Razor don't allow to write

    @model System.Linq.Expressions.Expression<Func<TModel, TValue>> expression

and

    @Html.Partial(""Item"", model => model.EmpName)

Old code, that working:

            <tr>
                <td class=""editor-label"" style=""border: 0;"">
                    @Html.LabelFor(model=>model.EmpName)
                </td>
                <td class=""editor-field"" style=""border: 0"">
                    @Html.EditorFor(model=>model.EmpName)
                    @Html.ValidationMessageFor(model=>model.EmpName)
                </td>
            </tr>
            <tr>
                <td class=""editor-label"" style=""border: 0;"">
                    @Html.LabelFor(model=>model.Email)
                </td>
                <td class=""editor-field"" style=""border: 0;"">
                    @Html.EditorFor(model=>model.Email)
                    @Html.ValidationMessageFor(model=>model.Email)
                </td>
            </tr>

After refactoring not working:

Item.cshtml:
             
       @model System.Linq.Expressions.Expression<Func<TModel, TValue>> expression
            <tr>
                <td class=""editor-label"" style=""border: 0;"">
                    @Html.LabelFor(expression)
                </td>
                <td class=""editor-field"" style=""border: 0"">
                    @Html.EditorFor(expression)
                    @Html.ValidationMessageFor(expression)
                </td>
            </tr>
        }

New code:
         
     @Html.Partial(""Item"", model => model.EmpName)
     @Html.Partial(""Item"", model => model.Email)","2013-02-04 03:53:07"
"14680106","refactor Html.LabelFor, EditorFor, ValidationMessageFor into partial view","1","<asp.net><asp.net-mvc><asp.net-mvc-3><razor><asp.net-mvc-4>","2013-02-04 03:53:07"
"14680106","refactor Html.LabelFor, EditorFor, ValidationMessageFor into partial view","1","I want to refactor view form code to avoid copyPaste. But it's not working. Razor don't allow to write

    @model System.Linq.Expressions.Expression<Func<TModel, TValue>> expression

and

    @Html.Partial(""Item"", model => model.EmpName)

Old code, that working:

            <tr>
                <td class=""editor-label"" style=""border: 0;"">
                    @Html.LabelFor(model=>model.EmpName)
                </td>
                <td class=""editor-field"" style=""border: 0"">
                    @Html.EditorFor(model=>model.EmpName)
                    @Html.ValidationMessageFor(model=>model.EmpName)
                </td>
            </tr>
            <tr>
                <td class=""editor-label"" style=""border: 0;"">
                    @Html.LabelFor(model=>model.Email)
                </td>
                <td class=""editor-field"" style=""border: 0;"">
                    @Html.EditorFor(model=>model.Email)
                    @Html.ValidationMessageFor(model=>model.Email)
                </td>
            </tr>

After refactoring not working:

Item.cshtml:
             
       @model System.Linq.Expressions.Expression<Func<TModel, TValue>> expression
            <tr>
                <td class=""editor-label"" style=""border: 0;"">
                    @Html.LabelFor(expression)
                </td>
                <td class=""editor-field"" style=""border: 0"">
                    @Html.EditorFor(expression)
                    @Html.ValidationMessageFor(expression)
                </td>
            </tr>
        }

New code:
         
     @Html.Partial(""Item"", model => model.EmpName)
     @Html.Partial(""Item"", model => model.Email)
How to make it work?","2013-02-04 04:28:47"
"46614735","refactoring to calculate running time of sorting algorithm - python","1","refactoring to calculate running time of sorting algorithm - python","2017-10-06 22:24:17"
"46614735","refactoring to calculate running time of sorting algorithm - python","1","I wrote this to calculate the average running time of sorting algorithms,
and I was just curious if there was a way to refactor this to something simpler or better.

    time = []
    for i in range(3):
        start = timeit.default_timer()
        insert_list = []
        for i in range(3000):
            insert_list.append(randint(0,5000))
        sorted_list = merge_sort(insert_list)
        stop = timeit.default_timer()
        time.append(stop - start)
    print sum(time) /len(time)","2017-10-06 22:24:17"
"46614735","refactoring to calculate running time of sorting algorithm - python","1","<python><algorithm><python-2.7><sorting><refactoring>","2017-10-06 22:24:17"
"5679199","refactoring a database and application due to new requirements","1","refactoring a database and application due to new requirements","2011-04-15 15:43:53"
"5679199","refactoring a database and application due to new requirements","1","My application manages customer's complaints **and has already been deployed into production**. Each complaint has a code to identify it (for eaxmple ""late delivery""  ), a ""department"" type (wich is essentially the department responsible for that kind of complaint) and another ""model"" code which identifies the route through department's employees this complaint dossier has to follow (first to hr responsible then to hr big boss finally back to customer care). Each dossier has some common info and can have department specific infos, that's why i need deparment code.
For example Customer care get a complaint about ""rudeness"" of a call center operator, opens a dossier with code ABC and type ""HR"" (there's could be more HR dossier types). When the customer care has filled all the infos, forward it to hr(a mail is sent to the user configured in the system as HR responsible ). The hr employee fills his own section and send it back to customer care.

Till now each complaint code might have only one department and one model, now requirements have changed and i've two problems:

1. Some complaints are identified by the same code but might be due to different departments . For example a complaint about employees rudeness could be sent to the department which rules the call centers or to the department which rules logistics

i could solve this simply extending the table primary key to include the department (hoping they'll not decide the same code for the same department can follow different routes), changing application code might be a bit painful but it can be done : 

Does extending primary keys to composite keys is a problem in Oracle or have side effects on existing records? the actual primary key is not used as foreign key anywere and all fields are filled.


2. this is a quite more difficult problem (at least for me): marketing department (the rulers) wants a special dossier.They monitor time departments take to answer complaints and open a new type of dossier if they exceeds the standard time.
For the above example, if hr always needs the 30% more time to complete employees rudeness dossiers, marketing can open an ""inquire"" dossier about that complaint code directed to hr.  
Now, referring to point 1, i could add a new record for each complaint code having the second part of the key being the marketing code and associating it to a new model.This is going to double the rows of the table (which is already quite large). I see it very error prone for inserting new complaint codes. 

I know it's very hard to give an opinion without being able to see the schema and the code, but i would appreciate your opinion anyway
   ","2011-04-15 15:43:53"
"5679199","refactoring a database and application due to new requirements","1","<oracle><design><refactoring>","2011-04-15 15:43:53"
"5679199","refactoring a database and application due to new requirements","1","<oracle><database-design><refactoring>","2011-04-15 15:44:44"
"21540479","refactor javascript to an external file","0","refactor javascript to an external file","2014-02-04 00:08:09"
"21540479","refactor javascript to an external file","0","I am beginner in ASP .Net and JQuery. So forgive me for asking this silly question. I have an `Index.cshtml` file as follows. I am using Highcharts' example code to make a gauge. My problem is: the code  between `<script></script>` are long and messy, how can I make it more compact? 
I have tried to move it to an external file, `myscript.js`, inside the Scripts folder and include a line `<script src=""Scripts/myscript.js""></script>` in `Index.cshtml` but it give me error saying $ is undefined, which I suspect may be due to the external myscript.js loading before the DOM is finished in the browser. I have tried putting the code in the _layout.cshtml but that is not pretty either. Thank you for your help.


    @model IEnumerable<WebApplication16.Models.BatteryLog>
    
    @{
        ViewBag.Title = ""Index"";
    }
    @{
        Layout = ""~/Views/Shared/_Layout.cshtml"";
    }
    <script>$(function () {
    
        $('#gauge').highcharts({
    
            chart: {
                type: 'gauge',
                plotBackgroundColor: null,
                plotBackgroundImage: null,
                plotBorderWidth: 0,
                plotShadow: false
            },
    
            title: {
                text: 'Current'
            },
    
            pane: {
                startAngle: -150,
                endAngle: 150,
                background: [{
                    backgroundColor: {
                        linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                        stops: [
    	                    [0, '#FFF'],
    	                    [1, '#333']
                        ]
                    },
                    borderWidth: 0,
                    outerRadius: '109%'
                }, {
                    backgroundColor: {
                        linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                        stops: [
    	                    [0, '#333'],
    	                    [1, '#FFF']
                        ]
                    },
                    borderWidth: 1,
                    outerRadius: '107%'
                }, {
                    // default background
                }, {
                    backgroundColor: '#DDD',
                    borderWidth: 0,
                    outerRadius: '105%',
                    innerRadius: '103%'
                }]
            },
    
            // the value axis
            yAxis: {
                min: 0,
                max: 200,
    
                minorTickInterval: 'auto',
                minorTickWidth: 1,
                minorTickLength: 10,
                minorTickPosition: 'inside',
                minorTickColor: '#666',
    
                tickPixelInterval: 30,
                tickWidth: 2,
                tickPosition: 'inside',
                tickLength: 10,
                tickColor: '#666',
                labels: {
                    step: 2,
                    rotation: 'auto'
                },
                title: {
                    text: 'Volt'
                },
                plotBands: [{
                    from: 0,
                    to: 120,
                    color: '#55BF3B' // green
                }, {
                    from: 120,
                    to: 160,
                    color: '#DDDF0D' // yellow
                }, {
                    from: 160,
                    to: 200,
                    color: '#DF5353' // red
                }]
            },
    
            series: [{
                name: 'Current',
                data: [80],
                tooltip: {
                    valueSuffix: ' Volt'
                }
            }]
    
        },
    	// Add some life
    	function (chart) {
    	    if (!chart.renderer.forExport) {
    	        setInterval(function () {
    	            var point = chart.series[0].points[0],
    		            newVal,
    		            inc = Math.round((Math.random() - 0.5) * 20);
    
    	            newVal = point.y + inc;
    	            if (newVal < 0 || newVal > 200) {
    	                newVal = point.y - inc;
    	            }
    
    	            point.update(newVal);
    
    	        }, 3000);
    	    }
    	});
    });</script>
    
    <h2>Index</h2>
    <div id=""gauge"" style=""min-width: 310px; max-width: 400px; height: 300px; margin: 0 auto""></div>
","2014-02-04 00:08:09"
"21540479","refactor javascript to an external file","0","<javascript><jquery><asp.net-mvc-4><highcharts>","2014-02-04 00:08:09"
"21540479","refactor javascript to an external file","0","{""Voters"":[{""Id"":2952473,""DisplayName"":""user2952473""}]}","2014-02-04 00:27:08"
"21540479","refactor javascript to an external file","0","{""Voters"":[{""Id"":2952473,""DisplayName"":""user2952473""}]}","2014-02-04 00:27:22"
"3331140","refactoring similar code targeted at all view controllers's navigation bar","0","refactoring similar code targeted at all view controllers's navigation bar","2010-07-25 21:42:59"
"3331140","refactoring similar code targeted at all view controllers's navigation bar","0","I'm trying to find the best way to refactor this. Right now, each of the view controllers (about 20 of them) have a function that initializes the content of the toolbar / navigation bar like so ie,

-(void)toolbarInit 

and on each of the controller's viewDidLoad, you will see that the function is being called ie, [self toolbarInit];

Basically what that toolbarInit does is to put a loginButton on the navigation bar's rightBarButtonItem.

Should I:

a. put the toolbar/nav bar setup in the app delegate ( is it possible to initialize each of the view controller's nav bar no matter how deep down the stack it is already?)

b. create a toolbarController or something and just put all the setup code/login code over there?

Many thanks for any other suggestions.



","2010-07-25 21:42:59"
"3331140","refactoring similar code targeted at all view controllers's navigation bar","0","<iphone><design-patterns><uiviewcontroller><view><uinavigationbar>","2010-07-25 21:42:59"
"30675168","refactoring ruby: want to pass attribute name into a method","0","refactoring ruby: want to pass attribute name into a method","2015-06-05 20:20:02"
"30675168","refactoring ruby: want to pass attribute name into a method","0","I have a DataPoint model where I have three methods that do the same thing, just on different fields in the data_points database.

	def self.currently_employed(data_points)
		data_points.where(currently_employed: true).count / data_points.count.to_f * 100
	end

	def self.undergrad_degree(data_points)
		data_points.where(undergrad_degree: true).count / data_points.count.to_f * 100
	end

	def self.grad_degree(data_points)
		data_points.where(grad_degree: true).count / data_points.count.to_f * 100
	end

I think I should be able to refactor this to accept which column to perform the calculation on as a parameter, but much time on the internet / trying stuff out hasn't yielded results.

Could someone please advise me on whether / how I could refactor this to a single method?  

In case it affects the answer: the data_points argument is a subset of DataPoint.all specified by the User - i.e. User types in what age, years work experience, etc. they want to see results for (age & years_work_experience are DataPoint attributes), and then I want to show summary stats for that subset.

Thanks!","2015-06-05 20:20:02"
"30675168","refactoring ruby: want to pass attribute name into a method","0","<ruby-on-rails><ruby>","2015-06-05 20:20:02"
"16014543","refactoring rails method","0","refactoring rails method","2013-04-15 11:55:54"
"16014543","refactoring rails method","0","I was wondering, how could i refactor this code, because it doesn't looks good to read and understand

    def next_payment_price
        price = self.plan_price
        price = discounted_price if self.coupon && self.coupon_duration.nil? && self.coupon_discount != 100
        price = discounted_price if self.coupon && self.coupon_duration.present? && self.coupon_discount != 100 && ((self.created_at + 14.days + self.coupon_duration.month)  > Time.now )
        price
    end
    
    def discounted_price
        self.plan_price - ((self.plan_price * self.coupon_discount) / 100)
    end","2013-04-15 11:55:54"
"16014543","refactoring rails method","0","<ruby-on-rails><ruby><ruby-on-rails-3><refactoring>","2013-04-15 11:55:54"
"16014543","refactoring rails method","0","{""Voters"":[{""Id"":314166,""DisplayName"":""sawa""},{""Id"":427943,""DisplayName"":""theTRON""},{""Id"":1375209,""DisplayName"":""toro2k""},{""Id"":163640,""DisplayName"":""eugen""},{""Id"":1149495,""DisplayName"":""Wouter J""}]}","2014-03-31 22:50:02"
"44919189","refactor to dynamic switch case","0","refactor to dynamic switch case","2017-07-05 07:06:24"
"44919189","refactor to dynamic switch case","0","I have two independent switch cases as below for converting folder and subfolder code to name. How to make the subfolder dependent on folder and to make the code as flexible as possible for extending folderCode and subfolderCode, better still the level of folder hierarchy?

switch (folderCode)
{
    case ""A"":
        folderName = folderNameA;
        break;
    case ""B"":
        folderName = folderNameB;
        break;
    case ""C"":
        folderName=folderNameC;
        break;
    default:
        Console.WriteLine(""The folder code is incorrect"");
        break;
}

switch (subfolderCode)
{
    case ""1"":
        subfolderName = subfolderName1;
        break;
    case ""2"":
        subfolderName = subfolderName2;
        break;
    case ""3"":
        subfolderName = subfolderName3;
        break;
    default:
        Console.WriteLine(""The subfolder code is incorrect"");
        break;
}","2017-07-05 07:06:24"
"44919189","refactor to dynamic switch case","0","<refactoring>","2017-07-05 07:06:24"
"44919189","refactor to dynamic switch case","0","I have two independent switch cases as below for converting folder and subfolder code to name. How to make the subfolder dependent on folder and to make the code as flexible as possible for extending folderCode and subfolderCode, better still the level of folder hierarchy?

    switch (folderCode)
    {
        case ""A"":
            folderName = folderNameA;
            break;
        case ""B"":
            folderName = folderNameB;
            break;
        case ""C"":
            folderName=folderNameC;
            break;
        default:
            Console.WriteLine(""The folder code is incorrect"");
            break;
    }
    
    switch (subfolderCode)
    {
        case ""1"":
            subfolderName = subfolderName1;
            break;
        case ""2"":
            subfolderName = subfolderName2;
            break;
        case ""3"":
            subfolderName = subfolderName3;
            break;
        default:
            Console.WriteLine(""The subfolder code is incorrect"");
            break;
    }","2017-07-05 07:30:10"
"44919189","refactor to dynamic switch case","0","","2017-07-05 07:30:10"
"9108990","refactoring 2 similar if statement in ruby","0","refactoring 2 similar if statement in ruby","2012-02-02 08:10:57"
"9108990","refactoring 2 similar if statement in ruby","0","I am quite new in Ruby so would like to know and learn how not to DRY. I have 2 if statement that's very similar, is there anyway to refactor it? 

    msg1,msg2 = msg.split('.')

    if !msg1.nil?
       items = msg1.split(',')
       items.each do |item|
         item.strip!
       end
       somefunction(items)
    end

    if !msg2.nil?
       items = msg2.split(',')
       items.each do |item|
         item.strip!
       end
       somefunction(items)
    end 
","2012-02-02 08:10:57"
"9108990","refactoring 2 similar if statement in ruby","0","<ruby><refactoring>","2012-02-02 08:10:57"
"9108990","refactoring 2 similar if statement in ruby","0","I am quite new in Ruby so would like to know and learn how to DRY. I have 2 if statement that's very similar, is there anyway to refactor it? 

    msg1,msg2 = msg.split('.')

    if !msg1.nil?
       items = msg1.split(',')
       items.each do |item|
         item.strip!
       end
       somefunction(items)
    end

    if !msg2.nil?
       items = msg2.split(',')
       items.each do |item|
         item.strip!
       end
       somefunction(items)
    end 
","2012-02-06 03:28:56"
"27387799","refactor large switch-statement","0","refactor large switch-statement","2014-12-09 20:04:26"
"27387799","refactor large switch-statement","0","Any suggestions for refactoring this ugly case-switch into something more elegant?

This method returns a (short or full) description for Belgian provinces, given a zipcode.

    def province(zipcode, short = false)
      case zipcode
      when 1000...1300
        short ? 'BXL' : 'Brussel'
      when 1300...1500
        short ? 'WBR' : 'Waals-Brabant'
      when 1500...2000, 3000...3500
        short ? 'VBR' : 'Vlaams-Brabant'
      when 2000...3000
        short ? 'ANT' : 'Antwerpen'
      when 3500...4000
        short ? 'LIM' : 'Limburg'
      when 4000...5000
        short ? 'LIE' : 'Luik'
      when 5000...6000
        short ? 'NAM' : 'Namen'
      when 6000...6600, 7000...8000
        short ? 'HAI' : 'Henegouwen'
      when 6600...7000
        short ? 'LUX' : 'Luxemburg'
      when 8000...9000
        short ? 'WVL' : 'West-Vlaanderen'
      when 9000..9999
        short ? 'OVL' : 'Oost-Vlaanderen'
      else
        fail ArgumentError, 'Not a valid zipcode'
      end
    end","2014-12-09 20:04:26"
"27387799","refactor large switch-statement","0","<refactoring><switch-statement><conditional>","2014-12-09 20:04:26"
"27387799","refactor large switch-statement","0","Any suggestions for refactoring this ugly case-switch into something more elegant?

This method (in Ruby) returns a (short or full) description for Belgian provinces, given a zipcode.

    def province(zipcode, short = false)
      case zipcode
      when 1000...1300
        short ? 'BXL' : 'Brussel'
      when 1300...1500
        short ? 'WBR' : 'Waals-Brabant'
      when 1500...2000, 3000...3500
        short ? 'VBR' : 'Vlaams-Brabant'
      when 2000...3000
        short ? 'ANT' : 'Antwerpen'
      when 3500...4000
        short ? 'LIM' : 'Limburg'
      when 4000...5000
        short ? 'LIE' : 'Luik'
      when 5000...6000
        short ? 'NAM' : 'Namen'
      when 6000...6600, 7000...8000
        short ? 'HAI' : 'Henegouwen'
      when 6600...7000
        short ? 'LUX' : 'Luxemburg'
      when 8000...9000
        short ? 'WVL' : 'West-Vlaanderen'
      when 9000..9999
        short ? 'OVL' : 'Oost-Vlaanderen'
      else
        fail ArgumentError, 'Not a valid zipcode'
      end
    end","2014-12-09 20:11:43"
"27387799","refactor large switch-statement","0","Any suggestions for refactoring this ugly case-switch into something more elegant?

This method (in Ruby) returns a (short or full) description for Belgian provinces, given a zipcode.

    def province(zipcode, short = false)
      case zipcode
      when 1000...1300
        short ? 'BXL' : 'Brussel'
      when 1300...1500
        short ? 'WBR' : 'Waals-Brabant'
      when 1500...2000, 3000...3500
        short ? 'VBR' : 'Vlaams-Brabant'
      when 2000...3000
        short ? 'ANT' : 'Antwerpen'
      when 3500...4000
        short ? 'LIM' : 'Limburg'
      when 4000...5000
        short ? 'LIE' : 'Luik'
      when 5000...6000
        short ? 'NAM' : 'Namen'
      when 6000...6600, 7000...8000
        short ? 'HAI' : 'Henegouwen'
      when 6600...7000
        short ? 'LUX' : 'Luxemburg'
      when 8000...9000
        short ? 'WVL' : 'West-Vlaanderen'
      when 9000..9999
        short ? 'OVL' : 'Oost-Vlaanderen'
      else
        fail ArgumentError, 'Not a valid zipcode'
      end
    end

Based on suggestions from MiiinimalLogic i made a second version

    class Provincie
      ProvincieNaam = Struct.new(:kort, :lang)

      PROVINCIES = {
        1000...1300 => ProvincieNaam.new('BXL', 'Brussel'),
        1300...1500 => ProvincieNaam.new('WBR', 'Waals-Brabant'),
        1500...2000 => ProvincieNaam.new('VBR', 'Vlaams-Brabant'),
        2000...3000 => ProvincieNaam.new('ANT', 'Antwerpen'),
        3000...3500 => ProvincieNaam.new('VBR', 'Vlaams-Brabant'),
        3500...4000 => ProvincieNaam.new('LIM', 'Limburg'),
        4000...5000 => ProvincieNaam.new('LIE', 'Luik'),
        5000...6000 => ProvincieNaam.new('NAM', 'Namen'),
        6000...6600 => ProvincieNaam.new('HAI', 'Henegouwen'),
        6600...7000 => ProvincieNaam.new('LUX', 'Luxemburg'),
        7000...8000 => ProvincieNaam.new('HAI', 'Henegouwen'),
        8000...9000 => ProvincieNaam.new('WVL', 'West-Vlaanderen'),
        9000..9999  => ProvincieNaam.new('OVL', 'Oost-Vlaanderen')
    }.freeze

    def self.lang(postcode)
      provincie_naam(postcode).lang
    end

    def self.kort(postcode)
      provincie_naam(postcode).kort
    end

    def self.provincie_naam(postcode)
      PROVINCIES.each { |list, prov| return prov if list.cover?(postcode) }
      fail ArgumentError, 'Geen geldige postcode'
    end

  private_class_method :provincie_naam
end
","2014-12-10 22:10:48"
"27387799","refactor large switch-statement","0","Any suggestions for refactoring this ugly case-switch into something more elegant?

This method (in Ruby) returns a (short or full) description for Belgian provinces, given a zipcode.

    def province(zipcode, short = false)
      case zipcode
      when 1000...1300
        short ? 'BXL' : 'Brussel'
      when 1300...1500
        short ? 'WBR' : 'Waals-Brabant'
      when 1500...2000, 3000...3500
        short ? 'VBR' : 'Vlaams-Brabant'
      when 2000...3000
        short ? 'ANT' : 'Antwerpen'
      when 3500...4000
        short ? 'LIM' : 'Limburg'
      when 4000...5000
        short ? 'LIE' : 'Luik'
      when 5000...6000
        short ? 'NAM' : 'Namen'
      when 6000...6600, 7000...8000
        short ? 'HAI' : 'Henegouwen'
      when 6600...7000
        short ? 'LUX' : 'Luxemburg'
      when 8000...9000
        short ? 'WVL' : 'West-Vlaanderen'
      when 9000..9999
        short ? 'OVL' : 'Oost-Vlaanderen'
      else
        fail ArgumentError, 'Not a valid zipcode'
      end
    end

Based on suggestions from MiiinimalLogic i made a second version. It this preferable?

    class Provincie
      ProvincieNaam = Struct.new(:kort, :lang)

      PROVINCIES = {
        1000...1300 => ProvincieNaam.new('BXL', 'Brussel'),
        1300...1500 => ProvincieNaam.new('WBR', 'Waals-Brabant'),
        1500...2000 => ProvincieNaam.new('VBR', 'Vlaams-Brabant'),
        2000...3000 => ProvincieNaam.new('ANT', 'Antwerpen'),
        3000...3500 => ProvincieNaam.new('VBR', 'Vlaams-Brabant'),
        3500...4000 => ProvincieNaam.new('LIM', 'Limburg'),
        4000...5000 => ProvincieNaam.new('LIE', 'Luik'),
        5000...6000 => ProvincieNaam.new('NAM', 'Namen'),
        6000...6600 => ProvincieNaam.new('HAI', 'Henegouwen'),
        6600...7000 => ProvincieNaam.new('LUX', 'Luxemburg'),
        7000...8000 => ProvincieNaam.new('HAI', 'Henegouwen'),
        8000...9000 => ProvincieNaam.new('WVL', 'West-Vlaanderen'),
        9000..9999  => ProvincieNaam.new('OVL', 'Oost-Vlaanderen')
      }.freeze

      def self.lang(postcode)
        provincie_naam(postcode).lang
      end

      def self.kort(postcode)
        provincie_naam(postcode).kort
      end

      def self.provincie_naam(postcode)
        PROVINCIES.each { |list, prov| return prov if list.cover?(postcode) }
        fail ArgumentError, 'Geen geldige postcode'
      end

      private_class_method :provincie_naam
    end
","2014-12-11 07:47:15"
"33037617","refactoring ""factories"" into a $resource","0","refactoring ""factories"" into a $resource","2015-10-09 11:53:52"
"33037617","refactoring ""factories"" into a $resource","0","Hi I have converted a previous function for editing records in an api into the following resource:

    app.factory(""Wine"", function($resource){
        return $resource(""http://greatwines.8000.com/wines:id"", {
            //id as a variable
            id: ""@id""
         },
         {
             update: {
                 method: ""PUT""
             }
        });
    });


I now want to use this by triggering a form with the ""wine"" records to edit with the following CTA inside the wine ng-repeat for each wine:

	   <a href=""#/wines/{{wine.id}}"" class=""btn btn-default"">Edit Wine</a>

In my controller I pass the *""Wine""* resource:


    app.controller(""editWineCtrl"", function ($scope, $http, $routeParams, Wine, $location){
       
       
       Wine.get({ id: $routeParams.id }, function(wine){
            $scope.wine = wine;
       });

...

However, in spite of the form URL returning the ID:

`http://greatwines.8000.com/#/wines/1323`

None of the fields i.e. :

    div class=""margin-top-20"">
    					<input type=""text"" class=""form-control"" ng-model=""wine.year"" />
    				</div>
    				<div class=""bold margin-top-20"">
    					Grapes
    				</div>
    				<div class=""margin-top-20"">
    					<input type=""text"" class=""form-control"" ng-model=""wine.grapes"" />
    				</div>


Are being populated. Am I using the resource int he correct way?","2015-10-09 11:53:52"
"33037617","refactoring ""factories"" into a $resource","0","<angularjs><ngresource><angularjs-ng-resource>","2015-10-09 11:53:52"
"33651537","refactoring old php with reflection","0","refactoring old php with reflection","2015-11-11 13:26:32"
"33651537","refactoring old php with reflection","0","so I am refactoring some old code written by someone else. I've come across this:

    $r = new \ReflectionClass($className);
    $args = (is_subclass_of($className, ClassA')) ? [$arg1, $arg2] : [$arg2];
    $classInstance = $r->newInstanceArgs($args);

my question is, why would the person do this? Doesn't this do the same?

    $args = (is_subclass_of($className, ClassA')) ? [$arg1, $arg2] : [$arg2];
    $classInstance = new $className($args);

The code is a few years old - the reason could have something to do with old PHP version features. I'm just looking for reasons and confirmation that the second way is ""better"". thanks.","2015-11-11 13:26:32"
"33651537","refactoring old php with reflection","0","<php><reflection>","2015-11-11 13:26:32"
"33651537","refactoring old php with reflection","0","so I am refactoring some old code written by someone else. I've come across this:

    $r = new \ReflectionClass($className);
    $args = (is_subclass_of($className, 'ClassA')) ? [$arg1, $arg2] : [$arg2];
    $classInstance = $r->newInstanceArgs($args);

my question is, why would the person do this? Doesn't this do the same?

    $args = (is_subclass_of($className, 'ClassA')) ? [$arg1, $arg2] : [$arg2];
    $classInstance = new $className($args);

The code is a few years old - the reason could have something to do with old PHP version features. I'm just looking for reasons and confirmation that the second way is ""better"".","2015-11-11 14:09:54"
"33651537","refactoring old php with reflection","0","so I am refactoring some old code written by someone else. I've come across this:

    $r = new \ReflectionClass($className);
    $args = (is_subclass_of($className, 'ClassA')) ? [$arg1, $arg2] : [$arg2];
    $classInstance = $r->newInstanceArgs($args);

my question is, why would the person do this? Doesn't this do the same?

    $args = (is_subclass_of($className, 'ClassA')) ? [$arg1, $arg2] : [$arg2];
    $classInstance = new $className($args);

The code is a few years old - the reason could have something to do with old PHP version features. I'm just looking for reasons and confirmation that the second way is ""better"". Thanks.","2015-11-11 14:09:54"
"33651537","refactoring old php with reflection","0","","2015-11-11 14:09:54"
"37494997","refactoring caode with spring factory-method","0","refactoring caode with spring factory-method","2016-05-28 03:47:21"
"37494997","refactoring caode with spring factory-method","0","This question is the follow-up of [this one](http://stackoverflow.com/questions/37493304/spring-value-returns-null).

The problem is I want to inject a value in .properties file and always return null. The reason is that myClassContext is calling new myclass1() and new myclass2() so both myclass1 and myclass2 are not manage by Spring.

So my question now is how can I refactor the code to make the @Value(""${path}"") useful so I can get right result of myClassContext.getPath(params) based on the params.  

I think I should use static factory-method to do this, but I can't think of a solution.

In my applicationContext.xml:

    ....
    <context:component-scan base-package=""com.mypackage"">
         <context:exclude-filter type=""annotation"" expression=""org.springframework.stereotype.Controller""/
    </context:component-scan>
    <context:property-placeholder location=""classpath:/config/core/abc.properties""/>
    ....

in abc.properties:
    
    path=testpath

my classes:

    package com.mypackage
    @Component
    public class myclass1 implements Imyclass {
        @Value(""${path}"")
        private String path; //this always is null
        ...
        public String getMyPath() {
		    return path+""myclass1"";
        }
    }

    package com.mypackage
    @Component
    public class myclass2 implements Imyclass {
        @Value(""${path}"")
        private String path; //this always is null
        ...
        public String getMyPath() {
		    return path+""myclass2"";
        }
    }

myClassContext :

    public class myClassContext {
	    public static String getPath(params){
		    return getImyclass(params).getMyPath();
	    }
	    private static Imyclass getImyclass(params){
	  	    Imyclass mc=null;
		    if (logic(params)) {
			    mc=new myclass();
		    }
		    else{
			    mc=new myclass2();
		    }
		    return mc;
	    }
    }
What's the better way to manage instances by Spring so the @value will inject correctly? ","2016-05-28 03:47:21"
"37494997","refactoring caode with spring factory-method","0","<java><spring><spring-mvc><factory-method>","2016-05-28 03:47:21"
"37494997","refactoring caode with spring factory-method","0","This question is the follow-up of [this one](https://stackoverflow.com/questions/37493304/spring-value-returns-null).

The problem is I want to inject a value in .properties file and always return null. The reason is that myClassContext is calling new myclass1() and new myclass2() so both myclass1 and myclass2 are not manage by Spring.

So my question now is how can I refactor the code to make the @Value(""${path}"") useful so I can get right result of myClassContext.getPath(params) based on the params.  

I think I should use static factory-method to do this, but I can't think of a solution.

In my applicationContext.xml:

    ....
    <context:component-scan base-package=""com.mypackage"">
         <context:exclude-filter type=""annotation"" expression=""org.springframework.stereotype.Controller""/
    </context:component-scan>
    <context:property-placeholder location=""classpath:/config/core/abc.properties""/>
    ....

in abc.properties:
    
    path=testpath

my classes:

    package com.mypackage
    @Component
    public class myclass1 implements Imyclass {
        @Value(""${path}"")
        private String path; //this always is null
        ...
        public String getMyPath() {
		    return path+""myclass1"";
        }
    }

    package com.mypackage
    @Component
    public class myclass2 implements Imyclass {
        @Value(""${path}"")
        private String path; //this always is null
        ...
        public String getMyPath() {
		    return path+""myclass2"";
        }
    }

myClassContext :

    public class myClassContext {
	    public static String getPath(params){
		    return getImyclass(params).getMyPath();
	    }
	    private static Imyclass getImyclass(params){
	  	    Imyclass mc=null;
		    if (logic(params)) {
			    mc=new myclass();
		    }
		    else{
			    mc=new myclass2();
		    }
		    return mc;
	    }
    }
What's the better way to manage instances by Spring so the @value will inject correctly? ","2017-05-23 12:31:35"
"687637","refactoring question","0","refactoring question","2009-03-26 21:35:09"
"687637","refactoring question","0","Given a method 

        public static string[] Foo(System.IO.Stream stream)
        {
            XmlTextWriter xmlWriter = new XmlTextWriter(stream,   System.Text.Encoding.ASCII);

            xmlWriter.WriteStartDocument();
            xmlWriter.WriteStartElement(""Element"");
            xmlWriter.WriteEndElement();
            xmlWriter.WriteEndDocument();
            xmlWriter.Flush();

            return new string[3]{""1"", ""2"", ""3""};
        }

and a calling code

    using(MemoryStream memStream = new MemoryStream())
    {
         string[] playerIDs = PlayerCommand.Foo(stream);
         // do some stuff with stream and playerIDs
    }

When the control passes out of the using directive, is there a problem that xmlWriter was not explicitly closed in Foo (which would make the stream useless)?

Also, is passing a Stream between methods unsavory, is there a better way to pass the results of XMLWriting back to the calling code (which will zip it up and file it away)?

Thanks in advance,
Greg","2009-03-26 21:35:09"
"687637","refactoring question","0","<c#><memorystream><xmltextwriter><methods><data-structures>","2009-03-26 21:35:09"
"7819170","refactor a dal with hibernate,dao,services and unit of work : how to put all togheter","0","refactor a dal with hibernate,dao,services and unit of work : how to put all togheter","2011-10-19 09:27:25"
"7819170","refactor a dal with hibernate,dao,services and unit of work : how to put all togheter","0","i'm refactoring a jsf web application dal which uses hibernate and the dao pattern, at the moment each data acces class handles its own session and transaction into each method (a session per operation antipattern is it? )
for example :

	public void saveEntity(ModelEntity entity) throws Exception {
		String entityName = getCleanClassName(entity.getClass());
		Session session = null;
		Transaction tx = null;
		try {
			session = SessionFactoryUtil.getInstance().openSession();
			tx = session.beginTransaction();
			session.saveOrUpdate(entity);
			session.flush();
			tx.commit();
		} catch (Exception ex) {
			tx.rollback();
                        ...
			throw new Exception(msg, ex);
		} finally {
			session.close();
		}
	}


Above classes can be used directly into backing bean actions or through some business logic classes methods (for example create new detached object, set some values and store them trhough DAO objects). Now i've found that some businness logic classes methods need to be executed atomically, for example :

                           //inside some backing bean actionlistener
			DocumentoManager dm = new DocumentoManager();
			PraticaManager pm = new PraticaManager();
			Documento newDoc = new Documento();
			newDoc.setDataArrivo(new java.util.Date			                  newDoc.setNote(""..."");
			Allegato newAll = new Allegato();
			newAll.setTitolo(newDoc.getNote());
                           //businness logic methods that should be executed atomically
			dm.creaDocumentoDaAllegato(newDoc,newAll,
				event.getFile().getContents(),
				event.getFile().getFileName(),
				"""");
			pm.collegaDocumento(pratica, newDoc);



Finally i've a sessionFactoryUtil class which manages hibernate session (getcurrentSession, openSession, etc ... ).

How can i refactor the above architecture? i was thinking to do the following:

 1. remove the transaction from the DAO objects : i can't put
    transactions management into bl classes (xxxManager) , so should i
    use a class that just create,commit or rollback the transaction ,
    encapsulating the sessionFactoryUtil, and to be used inside backing
    beans (say jta userTransaction) ? 
 2. If someone try to use directly the DAO object how do i set the session ? Accessing sessionFactoryUtil into DAOs methods ?
 3. Is it safe to call getCurrentSession inside DAOs?
 4. if i create a class to handle businness logic transactions, how can i be sure it's thread safe ?

I think sessionFactoryUtil is thread safe since it's been written following the pattern suggested on hibernate guide :



	private SessionFactoryUtil() {
	}

	static {
		// Annotation and XML
		// sessionFactory = new
		// AnnotationConfiguration().configure().buildSessionFactory();
		// XML only
		try {
			sessionFactory = new Configuration().configure().buildSessionFactory();
		} catch (Exception e) {
                      ...
		}
		
	}

	public static SessionFactory getInstance() {
		try{
			return sessionFactory;
		} catch (Exception ex)
		{
			return null;
		}
	}




 



","2011-10-19 09:27:25"
"7819170","refactor a dal with hibernate,dao,services and unit of work : how to put all togheter","0","<java><hibernate><design-patterns><refactoring>","2011-10-19 09:27:25"
"30491453","refactoring object methods on javascript","0","refactoring object methods on javascript","2015-05-27 19:27:53"
"30491453","refactoring object methods on javascript","0","I have an object make = {};
I created object methods ( make.a(), make.h1() ) where each method creates a tag element

I created a JSFiddle of what I did:  [here][1]

I want to create many tag elements like that.

Is there any way to avoid repeating 

        return document.createElement('tagName');

each time?


  [1]: http://jsfiddle.net/cruzj/hpep8rfj/","2015-05-27 19:27:53"
"30491453","refactoring object methods on javascript","0","<javascript><object><methods><refactoring>","2015-05-27 19:27:53"
"40017689","refactor lambda to be called by another class: while keeping caller's code to be still short","0","refactor lambda to be called by another class: local variable become out of scope, should cache?","2016-10-13 09:49:50"
"40017689","refactor lambda to be called by another class: while keeping caller's code to be still short","0","How to professionally refactor lambda function to be called by another class WHILE make caller's code still short?

Here is my original code, using lambda.

    void Turret::registerFullversion(int gameObjectId, PhysicObject* phyO){//utility
        //.... something a bit complex .......
    }
    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        auto registerEasy=[&]( PhysicObject* phyO){
            //^ served as a short hand version of ""registerFullversion""
            registerFullversion(gameObjectId,phyO);
        }
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class (###)
                PhysicObject* phy=PhysicSystem::createNewPhysicObject();
                registerEasy( phy);
                //^ equivalent to ""registerFullversion(gameObjectId,phy)""
                //  but it is very concise, nice!
            };break;
            //..... a lot of case ....
        }
    }

I want to move a part of function (###) from `Turret` into another class (`TurretLaser`).     
It works, but the result is not as short as before :-

    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class
                TurretLaser::createTurret(gameObjectId)
            };break;
            //..... a lot of case ....
        }
    }
    void TurretLaser::createTurret(int gameObjectId){ //(###)
        PhysicObject* phy=PhysicSystem::createNewPhysicObject();
        Turret:registerFullversion(gameObjectId,phy);
        //^ it is not as short as before  
    }

**Note:** In real case, all above functions are non-static function, and all functions are far more complex.

My attempt
------

I will manually capture the related data (`gameObjectId`) and cache it (using a new variable `CACHE_gameObjectId`):-

    void Turret::registerEasy(PhysicObject* physicO){
        registerFullversion(CACHE_gameObjectId,physicO);
        //int ""CACHE_gameObjectId"" is a new field of ""Turret""
    };
    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        Turret::CACHE_gameObjectId=gameObjectId;
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class
                TurretLaser::createTurret(gameObjectId)
            };break;
            //..... a lot of case ....
        }
    }
    void TurretLaser::createTurret(int gameObjectId){ //(###)
        PhysicObject* phy=PhysicSystem::createNewPhysicObject();
        Turret:registerEasy(phy);
        //^ short as before, nice
    }

**Disadvantage of my solution:** dirty, look dangerous (not so automatic, thus can cause more bug) , seem to be less thread-safe (?)","2016-10-13 09:49:50"
"40017689","refactor lambda to be called by another class: while keeping caller's code to be still short","0","<c++11><lambda>","2016-10-13 09:49:50"
"40017689","refactor lambda to be called by another class: while keeping caller's code to be still short","0","refactor lambda to be called by another class: while keeping caller's code to be still short","2016-10-13 10:09:52"
"40017689","refactor lambda to be called by another class: while keeping caller's code to be still short","0","How to professionally refactor lambda function to be called by another class WHILE make caller's code still short?

Here is my original code, using lambda.

    void Turret::registerFullversion(int gameObjectId, PhysicObject* phyO){//utility
        //.... something a bit complex .......
    }
    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        auto registerEasy=[&]( PhysicObject* phyO){
            //^ served as a short hand version of ""registerFullversion""
            //  1 parameter is more comfortable than 2
            registerFullversion(gameObjectId,phyO);
        }
        switch(typeOfTurret){
            case 1:{ //this part will be moved into another class (###)
                PhysicObject* phy=PhysicSystem::createNewPhysicObject();
                registerEasy( phy);
                //^ equivalent to ""registerFullversion(gameObjectId,phy)""
                //  but it is very concise (1 parameter), nice!
            };break;
            //..... a lot of case ....
        }
    }

I want to move a part of function (###) from `Turret` into another class (`TurretLaser`).     
It works, but the result is not as short as before :-

    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class
                TurretLaser::createTurret(gameObjectId)
            };break;
            //..... a lot of case ....
        }
    }
    void TurretLaser::createTurret(int gameObjectId){ //(###)
        PhysicObject* phy=PhysicSystem::createNewPhysicObject();
        Turret:registerFullversion(gameObjectId,phy);
        //^ it is not as short as before  (now = 2 parameters)
    }

**Note** 
-----    

- In real case, all above functions are non-static function, and all functions are far more complex.
- Performance is the first priority.
- Solution can also provide a new example & solution instead of showing modification of my code.

My attempt
------

I will manually capture the related data (`gameObjectId`) and cache it (using a new variable `CACHE_gameObjectId`):-

    void Turret::registerEasy(PhysicObject* physicO){
        registerFullversion(CACHE_gameObjectId,physicO);
        //int ""CACHE_gameObjectId"" is a new field of ""Turret""
    };
    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        Turret::CACHE_gameObjectId=gameObjectId;
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class
                TurretLaser::createTurret(gameObjectId)
            };break;
            //..... a lot of case ....
        }
    }
    void TurretLaser::createTurret(int gameObjectId){ //(###)
        PhysicObject* phy=PhysicSystem::createNewPhysicObject();
        Turret:registerEasy(phy);
        //^ short as before, nice
    }

**Disadvantage of my solution:** dirty, look dangerous (not so automatic, thus can cause more bug) , seem to be less thread-safe (?)","2016-10-13 09:55:19"
"40017689","refactor lambda to be called by another class: while keeping caller's code to be still short","0","How to professionally refactor lambda function to be called by another class WHILE make caller's code still short?

Here is my original code, using lambda.

    void Turret::registerFullversion(int gameObjectId, PhysicObject* phyO){//utility
        //.... something a bit complex .......
    }
    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        auto registerEasy=[&]( PhysicObject* phyO){
            //^ served as a short hand version of ""registerFullversion""
            //  1 parameter is more comfortable than 2
            registerFullversion(gameObjectId,phyO);
        }
        switch(typeOfTurret){
            case 1:{ //this part will be moved into another class (###)
                PhysicObject* phy=PhysicSystem::createNewPhysicObject();
                registerEasy( phy);
                //^ equivalent to ""registerFullversion(gameObjectId,phy)""
                //  but it is very concise (1 parameter), nice!
            };break;
            //..... a lot of case ....
        }
    }

I want to move a part of function (###) from `Turret` into another class (`TurretLaser`).     
It works, but the result is that caller have to capture `gameObjectId` and pass it manually :-

    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class
                TurretLaser::createTurret(gameObjectId)
            };break;
            //..... a lot of case ....
        }
    }
    void TurretLaser::createTurret(int gameObjectId){ //(###)
        PhysicObject* phy=PhysicSystem::createNewPhysicObject();
        Turret:registerFullversion(gameObjectId,phy);
        //^ it is not as short as before  (now = 2 parameters)
    }

**Note** 
-----    

- In real case, all above functions are non-static function, and all functions are far more complex.
- Performance is the first priority.
- This question asks about how to omit the captured parameters rather than ""Please fix my code"", so a valid solution can also just provide a new example with its own fix instead of showing modification of my code.

My attempt
------

I will manually capture the related data (`gameObjectId`) and cache it (using a new variable `CACHE_gameObjectId`):-

    void Turret::registerEasy(PhysicObject* physicO){
        registerFullversion(CACHE_gameObjectId,physicO);
        //int ""CACHE_gameObjectId"" is a new field of ""Turret""
    };
    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        Turret::CACHE_gameObjectId=gameObjectId;
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class
                TurretLaser::createTurret(gameObjectId)
            };break;
            //..... a lot of case ....
        }
    }
    void TurretLaser::createTurret(int gameObjectId){ //(###)
        PhysicObject* phy=PhysicSystem::createNewPhysicObject();
        Turret:registerEasy(phy);
        //^ short as before, nice
    }

**Disadvantage of my solution:** dirty, look dangerous (not so automatic, thus can cause more bug) , seem to be less thread-safe (?)","2016-10-13 10:03:43"
"40017689","refactor lambda to be called by another class: while keeping caller's code to be still short","0","How to professionally refactor lambda function to be called by another class WHILE make caller's code still short?

Here is my original code, using lambda.

    void Turret::registerFullversion(int gameObjectId, PhysicObject* phyO){//utility
        //.... something a bit complex .......
    }
    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        auto registerEasy=[&]( PhysicObject* phyO){
            //^ served as a short hand version of ""registerFullversion""
            //  1 parameter is more comfortable than 2
            registerFullversion(gameObjectId,phyO);
        }
        switch(typeOfTurret){
            case 1:{ //this part will be moved into another class (###)
                PhysicObject* phy=PhysicSystem::createNewPhysicObject();
                registerEasy( phy);
                //^ equivalent to ""registerFullversion(gameObjectId,phy)""
                //  but it is very concise (1 parameter), nice!
            };break;
            //..... a lot of case ....
        }
    }

I want to move a part of function (###) from `Turret` into another class (`TurretLaser`).     
It works, but the result is that caller have to capture `gameObjectId` and pass it manually :-

    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class
                TurretLaser::createTurret(gameObjectId)
            };break;
            //..... a lot of case ....
        }
    }
    void TurretLaser::createTurret(int gameObjectId){ //(###)
        PhysicObject* phy=PhysicSystem::createNewPhysicObject();
        Turret:registerFullversion(gameObjectId,phy);
        //^ it is not as short as before  (now = 2 parameters)
    }

**Note** 
-----    

- In real case, all above functions are non-static function, and all functions are far more complex.
- Performance is the first priority.  Thus, `std::bind` and `std::function` are not allowed.
- This question asks about how to omit the captured parameters rather than ""Please fix my code"", so a valid solution can also just provide a new example with its own fix instead of showing modification of my code.

My attempt
------

I will manually capture the related data (`gameObjectId`) and cache it (using a new variable `CACHE_gameObjectId`):-

    void Turret::registerEasy(PhysicObject* physicO){
        registerFullversion(CACHE_gameObjectId,physicO);
        //int ""CACHE_gameObjectId"" is a new field of ""Turret""
    };
    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        Turret::CACHE_gameObjectId=gameObjectId;
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class
                TurretLaser::createTurret(gameObjectId)
            };break;
            //..... a lot of case ....
        }
    }
    void TurretLaser::createTurret(int gameObjectId){ //(###)
        PhysicObject* phy=PhysicSystem::createNewPhysicObject();
        Turret:registerEasy(phy);
        //^ short as before, nice
    }

**Disadvantage of my solution:** dirty, look dangerous (not so automatic, thus can cause more bug) , seem to be less thread-safe (?)","2016-10-13 10:09:52"
"40017689","refactor lambda to be called by another class: while keeping caller's code to be still short","0","How to professionally refactor lambda function to be called by another class WHILE make caller's code still short?

My attempt shows that for changing a lambda function to a normal function, I have to capture variables manually, thus the new normal function requires more parameters (to compensate automatic capture ability).  

As a result, the new function is more tedious to use, and can cause more bug.

Example
-----------

Here is my original code, using lambda.

    void Turret::registerFullversion(int gameObjectId, PhysicObject* phyO){//utility
        //.... something a bit complex .......
    }
    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        auto registerEasy=[&]( PhysicObject* phyO){
            //^ served as a short hand version of ""registerFullversion""
            //  1 parameter is more comfortable than 2
            registerFullversion(gameObjectId,phyO);
        }
        switch(typeOfTurret){
            case 1:{ //this part will be moved into another class (###)
                PhysicObject* phy=PhysicSystem::createNewPhysicObject();
                registerEasy( phy);
                //^ equivalent to ""registerFullversion(gameObjectId,phy)""
                //  but it is very concise (1 parameter), nice!
            };break;
            //..... a lot of case ....
        }
    }

I want to move a part of function (###) from `Turret` into another class (`TurretLaser`).     

It works, but the result is that caller have to capture `gameObjectId` and pass it manually :-

    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class
                TurretLaser::createTurret(gameObjectId)
            };break;
            //..... a lot of case ....
        }
    }
    void TurretLaser::createTurret(int gameObjectId){ //(###)
        PhysicObject* phy=PhysicSystem::createNewPhysicObject();
        Turret:registerFullversion(gameObjectId,phy);
        //^ it is not as short as before  (now = 2 parameters)
    }

**Note** 
-----    

- In real case, all above functions are non-static function, and all functions are far more complex.
- Performance is the first priority.  Thus, `std::bind` and `std::function` are not allowed.
- This question asks about how to omit the captured parameters rather than ""Please fix my code"", so a valid solution can also just provide a new example with its own fix instead of showing modification of my code.

My attempt
------

I will manually capture the related data (`gameObjectId`) and cache it (using a new variable `CACHE_gameObjectId`):-

    void Turret::registerEasy(PhysicObject* physicO){
        registerFullversion(CACHE_gameObjectId,physicO);
        //int ""CACHE_gameObjectId"" is a new field of ""Turret""
    };
    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        Turret::CACHE_gameObjectId=gameObjectId;
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class
                TurretLaser::createTurret(gameObjectId)
            };break;
            //..... a lot of case ....
        }
    }
    void TurretLaser::createTurret(int gameObjectId){ //(###)
        PhysicObject* phy=PhysicSystem::createNewPhysicObject();
        Turret:registerEasy(phy);
        //^ short as before, nice
    }

**Disadvantage of my solution:** dirty, look dangerous (not so automatic, thus can cause more bug) , seem to be less thread-safe (?)","2016-10-13 10:16:26"
"40017689","refactor lambda to be called by another class: while keeping caller's code to be still short","0","How to professionally refactor lambda function to be called by another class WHILE make caller's code still short?

My attempt shows that for changing a lambda function to a normal function, I have to capture variables manually, thus the new normal function requires more parameters (to compensate automatic capture ability).  

As a result, the new function is more tedious to use, and can cause more bug.

Example
-----------

Here is my original code, using lambda.

    void Turret::registerFullversion(int gameObjectId, PhysicObject* phyO){//utility
        //.... something a bit complex .......
    }
    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        auto registerEasy=[&]( PhysicObject* phyO){
            //^ served as a short hand version of ""registerFullversion""
            //  1 parameter is more comfortable than 2
            registerFullversion(gameObjectId,phyO);
        }
        switch(typeOfTurret){
            case 1:{ //this part will be moved into another class (###)
                PhysicObject* phy=PhysicSystem::createNewPhysicObject();
                registerEasy( phy);
                //^ equivalent to ""registerFullversion(gameObjectId,phy)""
                //  but it is very concise (1 parameter), nice!
            };break;
            //..... a lot of case ....
        }
        //... do something about ""gameObjectId""
    }

I want to move a part of function (###) from `Turret` into another class (`TurretLaser`).     

It works, but the result is that caller have to capture `gameObjectId` and pass it manually :-

    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class
                TurretLaser::createTurret(gameObjectId)
            };break;
            //..... a lot of case ....
        }
    }
    void TurretLaser::createTurret(int gameObjectId){ //(###)
        PhysicObject* phy=PhysicSystem::createNewPhysicObject();
        Turret:registerFullversion(gameObjectId,phy);
        //^ it is not as short as before  (now = 2 parameters)
    }

**Note** 
-----    

- In real case, all above functions are non-static function, and all functions are far more complex.
- Performance is the first priority.  Thus, `std::bind` and `std::function` are not allowed.
- This question asks about how to omit the captured parameters rather than ""Please fix my code"", so a valid solution can also just provide a new example with its own fix instead of showing modification of my code.

My attempt
------

I will manually capture the related data (`gameObjectId`) and cache it (using a new variable `CACHE_gameObjectId`):-

    void Turret::registerEasy(PhysicObject* physicO){
        registerFullversion(CACHE_gameObjectId,physicO);
        //int ""CACHE_gameObjectId"" is a new field of ""Turret""
    };
    void Turret::createTurret(int typeOfTurret){
        int gameObjectId=createNewGameObjectId();
        Turret::CACHE_gameObjectId=gameObjectId;
        switch(typeOfTurret){
            case 1:{ //this part have to be move into another class
                TurretLaser::createTurret(gameObjectId)
            };break;
            //..... a lot of case ....
        }
    }
    void TurretLaser::createTurret(int gameObjectId){ //(###)
        PhysicObject* phy=PhysicSystem::createNewPhysicObject();
        Turret:registerEasy(phy);
        //^ short as before, nice
    }

**Disadvantage of my solution:** dirty, look dangerous (not so automatic, thus can cause more bug) , seem to be less thread-safe (?)","2016-10-13 10:55:04"
"40077339","refactor capybara javascript dropzone test","0","refactor capybara javascript dropzone test","2016-10-17 01:34:13"
"40077339","refactor capybara javascript dropzone test","0","I'm trying to call a dropzone capybara test multiple times. However, when I call it a second time, the ID has already been used. I'm trying to randomize the ID so it can run multiple times.

    def drop_in_dropzone(file_path)
      page.execute_script <<-JS
        fakeFileInput = window.$('<input/>').attr(
          {id: 'fakeFileInput', type:'file'}
        ).appendTo('body');
      JS
      attach_file(""fakeFileInput"", file_path)
      page.execute_script(""var fileList = [fakeFileInput.get(0).files[0]]"")
      page.execute_script <<-JS
        var e = jQuery.Event('drop', { dataTransfer : { files : [fakeFileInput.get(0).files[0]] } });
        $('.dropzone')[0].dropzone.listeners[0].events.drop(e);
      JS
    end

Error when calling it 2nd time.

    Failure/Error: attach_file(""fakeFileInput"", file_path)
         
    Capybara::Ambiguous:
    Ambiguous match, found 2 elements matching file field ""fakeFileInput""

","2016-10-17 01:34:13"
"40077339","refactor capybara javascript dropzone test","0","<javascript><ruby-on-rails><rspec><capybara>","2016-10-17 01:34:13"
"6051672","refactoring rails3 models with use with an external model API","0","refactoring rails3 models with use with an external model API","2011-05-18 22:14:59"
"6051672","refactoring rails3 models with use with an external model API","0","How could I optimize (refactor) this non activerecord based model in rails3 that i have created.?

application.rb contains this:

    CS = CloudServers::Connection.new(:username => '<hidden>', :api_key => '<hidden>')

cloudserver.rb (model) contains this:

    class Cloudserver
      # extend ActiveModel::Naming
      
      
      attr_reader :id
      attr_reader :name
      attr_reader :image_id
      attr_reader :flavor_id
      attr_reader :status
      attr_reader :progress
      attr_reader :host_id
      
      def initialize(id,name,image_id,flavor_id,status,progress,host_id)
        @id = id
        @name = name
        @image_id = image_id
        @flavor_id = flavor_id
        @status = status
        @progres = progress
        @host_id = host_id
      end
    
      def self.all
        server = CS.servers.map { |i|
          new(i[:id],i[:name],i[:imageId],i[:flavorId],i[:status],i[:progress],i[:hostId])
          # new(i)
        }
      end
       
      def self.find(param)
        all.detect { |l| l.id == param.to_i } || raise(ActiveRecord::RecordNotFound)
      end
    
      # def self.new
      #     server = CS.create_server(:name => ""BOOYA"", :imageId => 49, :flavorId => 2, :metadata => {'Luke' => 'Awesome'})
      #   end

    end


FYI i am trying to build rails models for this api:
https://github.com/rackspace/ruby-cloudservers

should I bother or just have the controllers access the CS Object directly","2011-05-18 22:14:59"
"6051672","refactoring rails3 models with use with an external model API","0","<ruby><ruby-on-rails-3>","2011-05-18 22:14:59"
"42349192","refactoring namespace in RESTFul WCF causes error at runtime","0","refactoring namespace in RESTFul WCF causes error at runtime","2017-02-20 16:04:47"
"42349192","refactoring namespace in RESTFul WCF causes error at runtime","0","I create a ""WCF Service Application"" project.

I make the interface, then class, a [DataMember] decorated object, and Global.asax.cs Global class in the same namespace, `parentns.mynamespage`.

I run this in VStudio IIS Express and everything is great.

.

Then I realize I want to refactor the namespace to `parentns.subnamespace`.
That is the only change alone in Imyclass.cs (the object also exists in this file), myClass.cs, and Global.asax.cs recompile and F5-run again in VStudio Imyclass

Now I get:

> ""the remote server returned an error: (500) Internal Server Error""

Nothing is reported of interest in the Output window except a very generic 

> ""Exception thrown: 'System.Net.WebException' in System.dll""

If I Ctrl-Z everything and rerun everything works again.

What else am I needing to refactor?

How do you troubleshoot this?

Thanks for you help
","2017-02-20 16:04:47"
"42349192","refactoring namespace in RESTFul WCF causes error at runtime","0","<c#><asp.net><.net><wcf><asp.net-mvc-4>","2017-02-20 16:04:47"
"18966616","refactoring variables access automatically","0","refactoring variables access automatically","2013-09-23 18:48:49"
"18966616","refactoring variables access automatically","0","I have changed access to a class variables from being public to private,

then created getters & setters (100 variables)

sometime later, after that is completed,

how can I automate, accessing any of these variables directly to set/get without going through every single one of these 100 variable. sometime a variable is accessed almost everywhere throughout a big project, so it is a bit tough to do by hand.

I am using Eclipse IDE, c++ project","2013-09-23 18:48:49"
"18966616","refactoring variables access automatically","0","<c++><eclipse><oop><encapsulation><automated-refactoring>","2013-09-23 18:48:49"
"26717938","refactoring repetitive sass to modify based on immediate parent's class","0","refactoring repetitive sass to modify based on immediate parent's class","2014-11-03 15:56:11"
"26717938","refactoring repetitive sass to modify based on immediate parent's class","0","tldr: how to avoid repetition of "".well"" selector in below example.

I am using bootstrap and sass to display a ""well"" div with a shape and with a gradient fill. This may not be a proper use of wells and I'd welcome other suggestions as to how to draw circular/rectangular divs with X% shaded (ideally where X is any integer. [0, 100]) but, for now, I am most interested in whether it's possible in SASS to get rid of the repetition of "".well"". I tried using ""<space>&"" but it would reverse .some_container too and I only wanted to reverse the immediate .inner_container parent to apply there (e.g. .inner_container.round). [There is one outer_container and multiple inner_containers. Each inner_container has one well.]

    .outer_container {
      .inner_container {
        &.round .well {
          border-radius: 50%;
        }
    
        &.barely_filled .well {
          @include gradient-horizontal(sienna, $well-bg, 0%, 25%);
        }
    
        &.half_filled .well {
          @include gradient-horizontal(sienna, $well-bg, 0%, 50%);
        }
    
        &.fairly_filled .well {
          @include gradient-horizontal(sienna, $well-bg, 0%, 75%);
        }
    
        &.mostly_filled .well {
          background-color: sienna;
        }
      }
    }","2014-11-03 15:56:11"
"26717938","refactoring repetitive sass to modify based on immediate parent's class","0","<css><twitter-bootstrap-3><sass>","2014-11-03 15:56:11"
"34119077","refactor javascript to limit repetition in form calculations","0","refactor javascript to limit repetition in form calculations","2015-12-06 15:25:35"
"34119077","refactor javascript to limit repetition in form calculations","0","Building a [form][1] where values can be entered in either pounds or kilos.


  [1]: http://brinsterinc.com/ovn/lbskilos.html

Script is...

		function onlyNumber(fld) {
			 if(fld.value.match(/[^0-9.]/)) {
			 fld.value=fld.value.replace(/[^0-9.]/g,'');
			 }
		}
		function convertUnit(sense, value) {
			retValue = 0;
			if (isNaN (value)) { alert ('Non-numeric value');  return 0; }
			value = parseFloat (value);
			var factor = 0.4536;
			if (sense == 'kg2lb') {
				 retValue = value/factor;
				 retValue = Math.round(retValue);
			}
			else if (sense == 'lb2kg') {
				 retValue = value*factor;
				 retValue = Math.round(retValue);
			}
			return retValue;
		}

Works fine but I have to repeat this on every input:

    onblur=""this.form.kg_va.value=convertUnit('lb2kg',this.value);"" onkeyup=""onlyNumber(this);"" onfocus=""if(this.value == '0') { this.value = ''; }"" 

Is there some way to simplify the onblur code ? 

For example, is there a way to have the function focus on the same var pairs? The var pair being lb_FOOBAR and kg_FOOBAR.

And what about the input functions that are exactly the same?

    onkeyup=""onlyNumber(this);"" onfocus=""if(this.value == '0') { this.value = ''; }""

Any way to avoid having to repeat them for each input? Form will have 12 fields.

Thanks folks... trying to learn how to write gooder code!","2015-12-06 15:25:35"
"34119077","refactor javascript to limit repetition in form calculations","0","<javascript>","2015-12-06 15:25:35"
"17358441","refactoring in C# codefirst","0","refactoring in C# codefirst","2013-06-28 06:20:43"
"17358441","refactoring in C# codefirst","0","I have very method is equal same
for example:
.d asd asdas dasd as dasd

.d asd asd asd asd asdas d

.xsdasd asd asdasdasdasd

. dasd asd asd asd asd asd

.d asdasd asd as dasd asdas

.
 das dsadasdasdasad asd 


//First method

        public ActionResult _Create1(MyClassView1  content)
        {            
            if (ModelState.IsValid)            
            {
                MyClass1 Home = new MyClass();
                Mapper.Map(content, Home);
                if (content.Id <= 0)                
                    db.MyClasse1s.Add(Home);                                    
                else               
                    db.Entry(Home).State = EntityState.Modified;
                db.SaveChanges();
                return Content(""Ok"");
            }
            return PartialView(content);
        }

//second method

        public ActionResult _Create2(MyClassView2  content)
        {            
            if (ModelState.IsValid)            
            {
                MyClass2 Home = new MyClass();
                Mapper.Map(content, Home);
                if (content.Id <= 0)                
                    db.MyClasse1s.Add(Home);                                    
                else                
                    db.Entry(Home).State = EntityState.Modified;
                db.SaveChanges();
                return Content(""Ok"");
            }
            return PartialView(content);
        }

//tree method

        public ActionResult _Create3(MyClassView3  content)
        {            
            if (ModelState.IsValid)            
            {
                MyClass3 Home = new MyClass();
                Mapper.Map(content, Home);
                if (content.Id <= 0)                
                    db.MyClasse1s.Add(Home);                                    
                else                
                    db.Entry(Home).State = EntityState.Modified;
                db.SaveChanges();
                return Content(""Ok"");
            }
            return PartialView(content);
        }
...

..

.

how can merge this class to one class

thanks for answers ","2013-06-28 06:20:43"
"17358441","refactoring in C# codefirst","0","<c#><ef-code-first><refactoring>","2013-06-28 06:20:43"
"17358441","refactoring in C# codefirst","0","I have very method is equal same
for example:

    .d asd asdas dasd as dasd
    
    .d asd asd asd asd asdas d
    
    .xsdasd asd asdasdasdasd
    
    . dasd asd asd asd asd asd
    
    .d asdasd asd as dasd asdas
    
    .
     das dsadasdasdasad asd 


**First method**

        public ActionResult _Create1(MyClassView1  content)
        {            
            if (ModelState.IsValid)            
            {
                MyClass1 Home = new MyClass();
                Mapper.Map(content, Home);
                if (content.Id <= 0)                
                    db.MyClasse1s.Add(Home);                                    
                else               
                    db.Entry(Home).State = EntityState.Modified;
                db.SaveChanges();
                return Content(""Ok"");
            }
            return PartialView(content);
        }

**second method**

        public ActionResult _Create2(MyClassView2  content)
        {            
            if (ModelState.IsValid)            
            {
                MyClass2 Home = new MyClass();
                Mapper.Map(content, Home);
                if (content.Id <= 0)                
                    db.MyClasse1s.Add(Home);                                    
                else                
                    db.Entry(Home).State = EntityState.Modified;
                db.SaveChanges();
                return Content(""Ok"");
            }
            return PartialView(content);
        }

**third method**

        public ActionResult _Create3(MyClassView3  content)
        {            
            if (ModelState.IsValid)            
            {
                MyClass3 Home = new MyClass();
                Mapper.Map(content, Home);
                if (content.Id <= 0)                
                    db.MyClasse1s.Add(Home);                                    
                else                
                    db.Entry(Home).State = EntityState.Modified;
                db.SaveChanges();
                return Content(""Ok"");
            }
            return PartialView(content);
        }

How can merge this class to one class?

thanks for answers ","2013-06-28 06:23:33"
"17358441","refactoring in C# codefirst","0","I have very method is equal same

I want have one method do jobs  three or more method under

but I try use generic method or reflection but cannot write good method or class
my method:

**First method**

        public ActionResult _Create1(MyClassView1  content)
        {            
            if (ModelState.IsValid)            
            {
                MyClass1 Home = new MyClass();
                Mapper.Map(content, Home);
                if (content.Id <= 0)                
                    db.MyClasse1s.Add(Home);                                    
                else               
                    db.Entry(Home).State = EntityState.Modified;
                db.SaveChanges();
                return Content(""Ok"");
            }
            return PartialView(content);
        }

**second method**

        public ActionResult _Create2(MyClassView2  content)
        {            
            if (ModelState.IsValid)            
            {
                MyClass2 Home = new MyClass();
                Mapper.Map(content, Home);
                if (content.Id <= 0)                
                    db.MyClasse1s.Add(Home);                                    
                else                
                    db.Entry(Home).State = EntityState.Modified;
                db.SaveChanges();
                return Content(""Ok"");
            }
            return PartialView(content);
        }

**third method**

        public ActionResult _Create3(MyClassView3  content)
        {            
            if (ModelState.IsValid)            
            {
                MyClass3 Home = new MyClass();
                Mapper.Map(content, Home);
                if (content.Id <= 0)                
                    db.MyClasse1s.Add(Home);                                    
                else                
                    db.Entry(Home).State = EntityState.Modified;
                db.SaveChanges();
                return Content(""Ok"");
            }
            return PartialView(content);
        }

How can merge this class to one class?

thanks for answers ","2013-06-28 06:27:00"
"17358441","refactoring in C# codefirst","0","I have very method is equal same

I want have one method do jobs  three or more method under

but I try use generic method or reflection but cannot write good method or class
my method:

**First method**

        public ActionResult _Create1(MyClassView1  content)
        {            
            if (ModelState.IsValid)            
            {
                MyClass1 Home = new MyClass1();
                Mapper.Map(content, Home);
                if (content.Id <= 0)                
                    db.MyClasse1s.Add(Home);                                    
                else               
                    db.Entry(Home).State = EntityState.Modified;
                db.SaveChanges();
                return Content(""Ok"");
            }
            return PartialView(content);
        }

**second method**

        public ActionResult _Create2(MyClassView2  content)
        {            
            if (ModelState.IsValid)            
            {
                MyClass2 Home = new MyClass2();
                Mapper.Map(content, Home);
                if (content.Id <= 0)                
                    db.MyClasse1s.Add(Home);                                    
                else                
                    db.Entry(Home).State = EntityState.Modified;
                db.SaveChanges();
                return Content(""Ok"");
            }
            return PartialView(content);
        }

**third method**

        public ActionResult _Create3(MyClassView3  content)
        {            
            if (ModelState.IsValid)            
            {
                MyClass3 Home = new MyClass3();
                Mapper.Map(content, Home);
                if (content.Id <= 0)                
                    db.MyClasse1s.Add(Home);                                    
                else                
                    db.Entry(Home).State = EntityState.Modified;
                db.SaveChanges();
                return Content(""Ok"");
            }
            return PartialView(content);
        }

How can merge this class to one class?

thanks for answers ","2013-06-28 06:40:57"
"39543867","refactor a functionwich makes a form","0","refactor a functionwich makes a form","2016-09-17 07:03:24"
"39543867","refactor a functionwich makes a form","0","I got a working function, but i think it should become a lot smaller and better but i aint seeing it. can someone help me improve this function make it better:

I am making a new li-item in a unordered list. in there there is omse info in 3 divisions who get a class making them float left to eachother.

this is the code i used, its all listed out, it can probly be make a lot better, and i hope to learn to refactor my code more, so help is apriciated.

    // making new li item inn <ul>
    function addproduction(){
      // getting info from form
      var startdatum_form = document.getElementById('startdatum').value;
      var uren_form  = document.getElementById('uren').value;
      var ordernummer_form  = document.getElementById('ordernummer').value;

      // new li element
      var newli = document.createElement('li');
      newli.setAttribute('class', 'ui-state-default');
      
      var div1 = document.createElement('div');
      div1.setAttribute('class', 'div1');
        var sortableicon = document.createElement('span');
        sortableicon.setAttribute('class', 'ui-icon ui-icon-arrowthick-2-n-s');

        // count current li elements in UL:
          var number = 0;
          var ullist = document.getElementById('sortable');
          for(i=0;i< ullist.childNodes.length;i++){
              if(ullist.childNodes[i].nodeName=='LI'){
                  number++;
              }
          }
      newli.setAttribute('id', 'p'+(number+1));

        
        // text node (item x)
        var nrText = document.createTextNode('Item ' + (number+1));
        div1.appendChild(sortableicon)
        div1.appendChild(nrText);
      var div2 = document.createElement('div');
      div2.setAttribute('class', 'div1');
            var indiv1 = document.createElement('div');
            indiv1.appendChild(document.createTextNode('Title'));
            var indiv2 = document.createElement('div');
            indiv2.appendChild(document.createTextNode('Start'));
            var indiv3 = document.createElement('div');
            indiv3.appendChild(document.createTextNode('End'));
            var indiv4 = document.createElement('div');
            indiv4.appendChild(document.createTextNode('Uren'));
                div2.appendChild(indiv1);
                div2.appendChild(indiv2);
                div2.appendChild(indiv3);
                div2.appendChild(indiv4);
      var div3 = document.createElement('div');
      div3.setAttribute('class', 'div3');
            var indiv5 = document.createElement('div');
            indiv5.appendChild(document.createTextNode(ordernummer_form));
            var indiv6 = document.createElement('div');
            indiv6.appendChild(document.createTextNode(startdatum_form));
            var indiv7 = document.createElement('div');
            indiv7.appendChild(document.createTextNode('end'));
            var indiv8 = document.createElement('div');
            indiv8.appendChild(document.createTextNode(uren_form));
                div3.appendChild(indiv5);
                div3.appendChild(indiv6);
                div3.appendChild(indiv7);
                div3.appendChild(indiv8);
       
        newli.appendChild(div1);
        newli.appendChild(div2);
        newli.appendChild(div3);
      
        // add new production to list
        document.getElementById('sortable').appendChild(newli);
        saveNewEntry( (number+1), ordernummer_form, startdatum_form, uren_form );
    }
","2016-09-17 07:03:24"
"39543867","refactor a functionwich makes a form","0","<javascript><refactoring>","2016-09-17 07:03:24"
"40916594","refactor python script to a method, for integration with larger process","0","refactor python script to a method, for integration with larger process","2016-12-01 17:16:18"
"40916594","refactor python script to a method, for integration with larger process","0","What I need to do is refactor a script, to turn it into a method that can be added to a larger process. 

**STEP A**

The point is- there's a data processing task that I'm working on- the first step is to create data of the following form: 


    3|Victoria|[51.503378, -0.139134]|2673
    52|Cubitt Town|[51.505199, -0.018848]|23
    5|United Kingdom|[54.75844, -2.69531]|459
    6|London|[51.50853, -0.12574]|346
    296|Bucharest|[44.43225, 26.10626]|9
    352|Vilich-Müldorf|[50.75024, 7.15283]|4
    48|Gut Scheibenhardt|[49.001249, 8.412378]|3
    314|Westerham|[48.0601, 11.62219]|9
    45|Honartsdeich|[53.557429, 9.987297]|34
    9779|Martinsried|[48.137418, 11.555737]|11
    343|Brussels|[50.85045, 4.34878]|27
    563|Russell Square|[51.519403, -0.133906]|20
    2|Germany|[51.5, 10.5]|20
    11|Farringdon|[51.51807, -0.10852]|154
    609|Fröttmaning|[48.16652, 11.59038]|3

**STEP B**

So then Step B will operate on the result of the above step (described by **PROCESS** below) and it will output data like so (the final data representation).

This means that **PROCESS** creates the data displayed in **STEP A**.


*The final data representation looks like this:*

    code: GB-ENG, jobs: 2673
    code: GB-ENG, jobs: 23
    code: GB-ENG, jobs: 459
    code: GB-ENG, jobs: 346
    code: RO-B, jobs: 9
    code: DE-NW, jobs: 4
    code: DE-BW, jobs: 3
    code: DE-BY, jobs: 9
    code: DE-HH, jobs: 34
    code: DE-BY, jobs: 11
    code: BE-BRU, jobs: 27
    code: GB-ENG, jobs: 20
    code: DE-TH, jobs: 20
    code: GB-ENG, jobs: 154
    code: DE-BY, jobs: 3


The script which performs that magic (creates the final output data displayed above) looks in this way: 

    import json
    import requests
    from collections import defaultdict
    from pprint import pprint

    def hasNumbers(inputString):
        return any(char.isdigit() for char in inputString)

    # open up the output of 'data-processing.py'
    with open('job-numbers-by-location.txt') as data_file:

        # print the output to a file
        with open('phase_ii_output.txt', 'w') as output_file_:
            for line in data_file:
                identifier, name, coords, number_of_jobs = line.split(""|"")
                coords = coords[1:-1]
                lat, lng = coords.split("","")
                # print(""lat: "" + lat, ""lng: "" + lng)
                response = requests.get(""http://api.geonames.org/countrySubdivisionJSON?lat=""+lat+""&lng=""+lng+""&username=s.matthew.english"").json()


                codes = response.get('codes', [])
                for code in codes:
                    if code.get('type') == 'ISO3166-2':
                        country_code = '{}-{}'.format(response.get('countryCode', 'UNKNOWN'), code.get('code', 'UNKNOWN'))
                        if not hasNumbers( country_code ):
                            # print(""code: "" + country_code + "", jobs: "" + number_of_jobs)
                            output_file_.write(""code: "" + country_code + "", jobs: "" + number_of_jobs)
        output_file_.close()


But what I need to do is make it into a method, so I can fuse it into this process: 

**PROCESS**

    import json
    from collections import defaultdict
    from pprint import pprint


    def process_locations_data(data):
        # processes the 'data' block
        locations = defaultdict(int)
        for item in data['data']:
            location = item['relationships']['location']['data']['id']
            locations[location] += 1
        return locations


    def process_locations_included(data):
        # processes the 'included' block
        return_list = []
        for record in data['included']:
            id = record.get('id', None)
            name = record.get('attributes', {}).get('name', None)
            coord = record.get('attributes', {}).get('coord', None)
            return_list.append((id, name, coord))
        return return_list    # return list of tuples




    # load the data from file once
    with open('data-science.txt') as data_file:
        data = json.load(data_file)


    # use the two functions on same data
    locations = process_locations_data(data)
    records = process_locations_included(data)


    # output list to collect lines
    output = []


    # combine the data for printing
    for record in records:
        id, name, coord = record
        references = locations[id]   # lookup the references in the dict
        line = str(id) + ""|"" + str(name) + ""|"" + str(coord) + ""|"" + str(references) + ""\n""
        if line not in output:
            output.append(line)


    # print the output to a file
    with open('job-numbers-by-location.txt', 'w') as file_:
        for l in output:
            if not (""None"") in l:
                if not (""[0, 0]"") in l:
                    file_.write(l)
    file_.close()



but the thing is- I keep failing in my efforts to make that script into a method within there. 

How to refactorize that script into an independent method that could be included into the process? 



All of the data related to this task can be found [here on my GitHub page](https://github.com/s-matthew-english/literate-octo-robot)


","2016-12-01 17:16:18"
"40916594","refactor python script to a method, for integration with larger process","0","<python><json><refactoring>","2016-12-01 17:16:18"
"15507783","refactoring code for better recursion","0","refactoring code for better recursion","2013-03-19 18:36:44"
"15507783","refactoring code for better recursion","0","I am trying to write some code that will look into a pdf file and call the Process method (to find a qr code image in the pdf) if not found then it rotates the file and runs the Process method again. Currently i don't think that what i have actually checks the file after being rotated but checks the same original file in its original format. How can i pass in the rotated image properly into the Process method: 

    using (var fullImg = new Bitmap(workGif))
                    {
                        var bandImg = fullImg.Clone(new System.Drawing.Rectangle(0, 0, 375, 375), fullImg.PixelFormat);
                        
                        Bitmap result = fullImg;
                        if (Process(bandImg) == null)
                        {
                             fullImg.RotateFlip(RotateFlipType.Rotate270FlipNone);
                            if (Process(bandImg) == null)
                            {
                                 fullImg.RotateFlip(RotateFlipType.Rotate90FlipNone);
                                if (Process(bandImg) == null)
                                {
                                    fullImg.RotateFlip(RotateFlipType.Rotate180FlipNone);
                                    Process(bandImg);
                                }
                            }
                        } 

**Process Method:**

    public string Process(Bitmap bitmap)
        {
            var reader = new com.google.zxing.qrcode.QRCodeReader();

            try
            {
                LuminanceSource source = new RGBLuminanceSource(bitmap, bitmap.Width, bitmap.Height);
                var binarizer = new HybridBinarizer(source);
                var binBitmap = new BinaryBitmap(binarizer);
                return reader.decode(binBitmap).Text;
            }
            catch (Exception e)
            {
                return null;
            }
        }
","2013-03-19 18:36:44"
"15507783","refactoring code for better recursion","0","<c#><bitmap>","2013-03-19 18:36:44"
"15507783","refactoring code for better recursion","0","I am trying to write some code that will look into a pdf file and call the Process method (to find a qr code image in the pdf) if not found then it rotates the file and runs the Process method again. Currently I don't think that what I have actually checks the file after being rotated but checks the same original file in its original format. How can I pass in the rotated image properly into the Process method: 

    using (var fullImg = new Bitmap(workGif))
    {
        var bandImg = fullImg.Clone(new System.Drawing.Rectangle(0, 0, 375, 375), fullImg.PixelFormat);
        
        Bitmap result = fullImg;
        if (Process(bandImg) == null)
        {
            fullImg.RotateFlip(RotateFlipType.Rotate270FlipNone);
            if (Process(bandImg) == null)
            {
                fullImg.RotateFlip(RotateFlipType.Rotate90FlipNone);
                if (Process(bandImg) == null)
                {
                    fullImg.RotateFlip(RotateFlipType.Rotate180FlipNone);
                    Process(bandImg);
                }
            }
        } 
    }

**Process Method:**

    public string Process(Bitmap bitmap)
    {
        var reader = new com.google.zxing.qrcode.QRCodeReader();

        try
        {
            LuminanceSource source = new RGBLuminanceSource(bitmap, bitmap.Width, bitmap.Height);
            var binarizer = new HybridBinarizer(source);
            var binBitmap = new BinaryBitmap(binarizer);
            return reader.decode(binBitmap).Text;
        }
        catch (Exception e)
        {
            return null;
        }
    }
","2013-03-19 18:42:32"
"15507783","refactoring code for better recursion","0","I am trying to write some code that will look into a pdf file and call the Process method (to find a qr code image in the pdf) if not found then it rotates the file and runs the Process method again. Currently I don't think that what I have actually checks the file after being rotated but checks the same original file in its original format. How can I pass in the rotated image properly into the Process method: 

      using (var fullImg = new Bitmap(workGif))
                    {
                        var bandImg = fullImg.Clone(new System.Drawing.Rectangle(0, 0, 375, 375), fullImg.PixelFormat);
                        
                        Bitmap result = fullImg;
                        if (Process(bandImg) == null)
                        {
                              fullImg.RotateFlip(RotateFlipType.Rotate270FlipNone);
                              bandImg = fullImg.Clone(new System.Drawing.Rectangle(0, 0, 375, 375), fullImg.PixelFormat);
                            if (Process(bandImg) == null)
                            {
                                 fullImg.RotateFlip(RotateFlipType.Rotate90FlipNone);
                                 bandImg = fullImg.Clone(new System.Drawing.Rectangle(0, 0, 375, 375), fullImg.PixelFormat);
                                if (Process(bandImg) == null)
                                {
                                    fullImg.RotateFlip(RotateFlipType.Rotate180FlipNone);
                                    bandImg = fullImg.Clone(new System.Drawing.Rectangle(0, 0, 375, 375), fullImg.PixelFormat);
                                    //Process(bandImg);
                                    string QRinfo = Process(bandImg);
                                    MessageBox.Show(QRinfo);
                                    string[] qcode = QRinfo.Split('/');
                                    string gid = qcode[qcode.Count() - 1];
                                    Guid pgGuid = new Guid(gid);
                                    var ar = dc.Assessments.FirstOrDefault(c => c.ID == pgGuid);
                                    if (ar != null)
                                    {
                                        var p = inputDocument.Pages[pg];
                                        string opdName = FILESTORELOCATION + pgGuid.ToString() + "".pdf"";
                                        PdfDocument opd = new PdfDocument(opdName);
                                        opd.Pages.Add(p);
                                        opd.Close();

                                        ar.StoragePath = opdName;
                                        ar.LastUploadedDT = DateTime.UtcNow;
                                        ar.UploadedByUserID = uploadingUser;
                                        dc.SubmitChanges();
                                    }
                                }
                            }
                        }    
**Process Method:**

    public string Process(Bitmap bitmap)
    {
        var reader = new com.google.zxing.qrcode.QRCodeReader();

        try
        {
            LuminanceSource source = new RGBLuminanceSource(bitmap, bitmap.Width, bitmap.Height);
            var binarizer = new HybridBinarizer(source);
            var binBitmap = new BinaryBitmap(binarizer);
            return reader.decode(binBitmap).Text;
        }
        catch (Exception e)
        {
            return null;
        }
    }","2013-03-19 19:00:15"
"10835677","refactor linq expression to remove duplicate code","0","refactor linq expression to remove duplicate code","2012-05-31 14:32:42"
"10835677","refactor linq expression to remove duplicate code","0","I have the following piece of code and I try to refactor this to remove the duplicate code. However every time I try to refactor it I get stuck. Is there someone who can help me out with this issue.



        public static IOrderedQueryable<T> ObjectSort<T>(this IQueryable<T> entities, Expression<Func<T, object>> expression, string order = ""asc"")
        {
            var sortOrder = order == ""asc"" ? SortOrder.Ascending : SortOrder.Descending;
            return entities.ObjectSort(expression, sortOrder);
        }

        public static IOrderedQueryable<T> ObjectThenBy<T>(this IOrderedQueryable<T> entities, Expression<Func<T, object>> expression, string order = ""asc"")
        {
            var sortOrder = order == ""asc"" ? SortOrder.Ascending : SortOrder.Descending;
            return entities.ObjectThenBy(expression, sortOrder);
        }

        public static IOrderedQueryable<T> ObjectSort<T>(this IQueryable<T> entities, Expression<Func<T, object>> expression, SortOrder order = SortOrder.Ascending)
        {
            var unaryExpression = expression.Body as UnaryExpression;
            if (unaryExpression != null)
            {
                var propertyExpression = (MemberExpression)unaryExpression.Operand;
                var parameters = expression.Parameters;

                if (propertyExpression.Type == typeof(DateTime))
                {
                    var newExpression = Expression.Lambda<Func<T, DateTime>>(propertyExpression, parameters);
                    return order == SortOrder.Ascending ? entities.OrderBy(newExpression) : entities.OrderByDescending(newExpression);
                }

                if (propertyExpression.Type == typeof(DateTime?))
                {
                    var newExpression = Expression.Lambda<Func<T, DateTime?>>(propertyExpression, parameters);
                    return order == SortOrder.Ascending ? entities.OrderBy(newExpression) : entities.OrderByDescending(newExpression);
                }

                if (propertyExpression.Type == typeof(int))
                {
                    var newExpression = Expression.Lambda<Func<T, int>>(propertyExpression, parameters);
                    return order == SortOrder.Ascending ? entities.OrderBy(newExpression) : entities.OrderByDescending(newExpression);
                }

                if (propertyExpression.Type == typeof(int?))
                {
                    var newExpression = Expression.Lambda<Func<T, int?>>(propertyExpression, parameters);
                    return order == SortOrder.Ascending ? entities.OrderBy(newExpression) : entities.OrderByDescending(newExpression);
                }

                if (propertyExpression.Type == typeof(bool))
                {
                    var newExpression = Expression.Lambda<Func<T, bool>>(propertyExpression, parameters);
                    return order == SortOrder.Ascending ? entities.OrderBy(newExpression) : entities.OrderByDescending(newExpression);
                }

                throw new NotSupportedException(""Object type resolution not implemented for this type"");
            }
            return order == SortOrder.Ascending ? entities.OrderBy(expression) : entities.OrderByDescending(expression);
        }

        public static IOrderedQueryable<T> ObjectThenBy<T>(this IOrderedQueryable<T> entities, Expression<Func<T, object>> expression, SortOrder order = SortOrder.Ascending)
        {
            var unaryExpression = expression.Body as UnaryExpression;
            if (unaryExpression != null)
            {
                var propertyExpression = (MemberExpression)unaryExpression.Operand;
                var parameters = expression.Parameters;

                if (propertyExpression.Type == typeof(DateTime))
                {
                    var newExpression = Expression.Lambda<Func<T, DateTime>>(propertyExpression, parameters);
                    return order == SortOrder.Ascending ? entities.ThenBy(newExpression) : entities.ThenByDescending(newExpression);
                }

                if (propertyExpression.Type == typeof(DateTime?))
                {
                    var newExpression = Expression.Lambda<Func<T, DateTime?>>(propertyExpression, parameters);
                    return order == SortOrder.Ascending ? entities.ThenBy(newExpression) : entities.ThenByDescending(newExpression);
                }

                if (propertyExpression.Type == typeof(int))
                {
                    var newExpression = Expression.Lambda<Func<T, int>>(propertyExpression, parameters);
                    return order == SortOrder.Ascending ? entities.ThenBy(newExpression) : entities.ThenByDescending(newExpression);
                }

                if (propertyExpression.Type == typeof(int?))
                {
                    var newExpression = Expression.Lambda<Func<T, int?>>(propertyExpression, parameters);
                    return order == SortOrder.Ascending ? entities.ThenBy(newExpression) : entities.ThenByDescending(newExpression);
                }

                if (propertyExpression.Type == typeof(bool))
                {
                    var newExpression = Expression.Lambda<Func<T, bool>>(propertyExpression, parameters);
                    return order == SortOrder.Ascending ? entities.ThenBy(newExpression) : entities.ThenByDescending(newExpression);
                }

                throw new NotSupportedException(""Object type resolution not implemented for this type"");
            }
            return order == SortOrder.Ascending ? entities.ThenBy(expression) : entities.ThenByDescending(expression);
        }

Please note the difference is the OrderBy and the ThenBy... The rest is exactly the same. Hopefully someone knows a way to refactor this. I was trying to create a Func parameter to pass the OrderBy or the ThenBy method. However everything I try I get stuck.","2012-05-31 14:32:42"
"10835677","refactor linq expression to remove duplicate code","0","<c#><entity-framework><linq-to-sql><lambda>","2012-05-31 14:32:42"
"25110150","refactoring my rails code (model method)","0","refactoring my rails code (model method)","2014-08-03 23:50:40"
"25110150","refactoring my rails code (model method)","0","So this works fine, it's just I need some refactoring done. What I want to achieve is, get all the values for the current record or just put another column (calculated column, like in SQL) that'll hold all the values for all of my fields that starts with ""address"".

So far, this is what I have.

Thanks for any input. Also, if possible, do not post the actual refactored code, but just let me know what I should be reading or just hints. I prefer achieving this on my own. Thanks again.

      def address
        ""#{self[:address_street1]} #{self[:address_street2]} #{self[:address_city]} #{self[:address_state]} #{self[:address_zipcode]} #{self[:address_country]}""
      end","2014-08-03 23:50:40"
"25110150","refactoring my rails code (model method)","0","<ruby-on-rails><ruby>","2014-08-03 23:50:40"
"9571257","refactoring to an attached property","0","refactoring to an attached property","2012-03-05 17:38:16"
"9571257","refactoring to an attached property","0","I am trying to change the code below from being an event setter to an attached property (just so I can clean up the code behind). I get an error in the setter saying the value cannot be null, but I don't see why yet.

Forgetting for a second whether this is a good idea or not, can someone help me get the attached property right?

Cheers,  
Berryl

EventSetter (works but with code behind as shown)
==========

        <!-- SINGLE CLICK EDITING -->
        <Style TargetType=""{x:Type DataGridCell}"">
            <EventSetter Event=""PreviewMouseLeftButtonDown"" Handler=""OnPreviewMouseLeftButtonDown""/>
        </Style>

	private void OnPreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
	{
		var cell = sender as DataGridCell;
		cell.Activate();
	}

Property setter (error)
==================

	<!-- SINGLE CLICK EDITING -->
	<Style TargetType=""{x:Type DataGridCell}"">
		<Setter Property=""begavior:DataGridCellProperties.SingleClickToEdit"" Value=""True""/>
	</Style>

    public class DataGridCellProperties
    {
        public static readonly DependencyProperty SingleClickToEditProperty =
            DependencyProperty.RegisterAttached(""SingleClickToEditProperty"",
                                                typeof(bool), typeof(DataGridCellProperties),
                                                new PropertyMetadata(false, OnSingleClickToEditPropertyChanged));

        [AttachedPropertyBrowsableForChildren(IncludeDescendants = false)]
        [AttachedPropertyBrowsableForType(typeof(DataGridCell))]
        public static bool GetSingleClickToEdit(DataGridCell obj) { return (bool)obj.GetValue(SingleClickToEditProperty); }

        public static void SetSingleClickToEdit(DataGridCell obj, bool value) { obj.SetValue(SingleClickToEditProperty, value); }

        private static void OnSingleClickToEditPropertyChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)
        {
            var sender = obj as UIElement;
            if (sender == null) return;

            if ((bool)e.NewValue)
            {
                sender.PreviewMouseLeftButtonDown += OnPreviewMouseLeftButtonDown_EditCell;
            }
            else
            {
                sender.PreviewMouseLeftButtonDown -= OnPreviewMouseLeftButtonDown_EditCell;
            }
        }

        private static void OnPreviewMouseLeftButtonDown_EditCell(object sender, MouseButtonEventArgs e)
        {
            var cell = sender as DataGridCell;
            cell.Activate();
        }
    }

","2012-03-05 17:38:16"
"9571257","refactoring to an attached property","0","<wpf><xaml><attached-properties>","2012-03-05 17:38:16"
"32711219","refactor angular javascript","0","refactor angular javascript","2015-09-22 07:46:24"
"32711219","refactor angular javascript","0","I have this bit of javascript in an angular controller which works fine. 

    product.prod_custom_mb_qty = 0;
    product.prod_custom_mb = null;
    product.prod_custom_autoship = function (prod_name, prod_qty) {
      if (prod_name === ""mb"") {
        if (prod_qty === 0) {
          product.prod_custom_mb_qty = 0;
        } else {
          product.prod_custom_mb_qty += prod_qty;
        }
      }
      if (product.prod_custom_mb_qty < 1){
        product.prod_custom_mb_qty = 0;
        product.prod_custom_mb = null;
      } else if (product.prod_custom_mb_qty === 1) {
        product.prod_custom_mb = product.prod_custom_mb_qty + "" Mango Bottle"";
      } else if (product.prod_custom_mb_qty > 1) {
        product.prod_custom_mb = product.prod_custom_mb_qty + "" Mango Bottles"";
      }
      product.prod_custom_total = (product.prod_custom_mb_qty * 35);
    }

The problem is I need to do it 8 more times for 8 different products and that would get a bit messy.
Is there a way I can refactor this so everything can be done more simply?

I thought I could do it by changing the names to the var to something like:

    product.prod_custom_qty[prod_name]
    product.prod_custom[prod_name]

But I can't seem to get that to work? Am I on the right track?
","2015-09-22 07:46:24"
"32711219","refactor angular javascript","0","<javascript><angularjs>","2015-09-22 07:46:24"
"40917164","refactor python script into an isolatable method","0","refactor python script into an isolatable method","2016-12-01 17:47:07"
"40917164","refactor python script into an isolatable method","0","Is it possible to refactor this script such that it exists as a completely independent method? 

    import json
    import requests
    from collections import defaultdict
    from pprint import pprint

    def hasNumbers(inputString):
        return any(char.isdigit() for char in inputString)

    # open up the output of 'data-processing.py'
    with open('job-numbers-by-location.txt') as data_file:

        # print the output to a file
        with open('phase_ii_output.txt', 'w') as output_file_:
            for line in data_file:
                identifier, name, coords, number_of_jobs = line.split(""|"")
                coords = coords[1:-1]
                lat, lng = coords.split("","")
                # print(""lat: "" + lat, ""lng: "" + lng)
                response = requests.get(""http://api.geonames.org/countrySubdivisionJSON?lat=""+lat+""&lng=""+lng+""&username=s.matthew.english"").json()


                codes = response.get('codes', [])
                for code in codes:
                    if code.get('type') == 'ISO3166-2':
                        country_code = '{}-{}'.format(response.get('countryCode', 'UNKNOWN'), code.get('code', 'UNKNOWN'))
                        if not hasNumbers( country_code ):
                            # print(""code: "" + country_code + "", jobs: "" + number_of_jobs)
                            output_file_.write(""code: "" + country_code + "", jobs: "" + number_of_jobs)
        output_file_.close()

I've been trying to make it so that I can include it as a component of a much larger process. ","2016-12-01 17:47:07"
"40917164","refactor python script into an isolatable method","0","<python><refactoring>","2016-12-01 17:47:07"
"17159257","refactoring callback inside model","0","refactoring callback inside model","2013-06-18 01:21:38"
"17159257","refactoring callback inside model","0","I am pretty new to rails and I am trying to create a callback that will apply user information before a record is saved. 

Here is the callback:

    def add_resolution_name
      if self.res_desc_changed?
          self.res_provided_name = current_user.first_name
        elsif self.res_desc_changed? && self.res_approved?
          self.res_provided_name = current_user.first_name
          self.res_approved_name = current_user.first_name
        elsif self.res_approved_changed? && self.res_approved?
          self.res_approved_name = current_user.first_name
        elsif self.res_approved_changed? && !self.res_approved?
          self.res_approved_name = nil
      end
      save
    logger.info ""pocessed resolution information... #{current_user.first_name}""
  end

As you can see it's pretty ugly and I don't have access to the current_user inside the ticket model. Should I put this into a presenter or service? Any tips appreciated.","2013-06-18 01:21:38"
"17159257","refactoring callback inside model","0","<ruby-on-rails-3><callback>","2013-06-18 01:21:38"
"17159257","refactoring callback inside model","0","I am pretty new to rails and I am trying to create a callback that will apply user information before a record is saved. 

Here is the callback:

    def add_resolution_name
      if self.res_desc_changed?
          self.res_provided_name = current_user.first_name
        elsif self.res_desc_changed? && self.res_approved?
          self.res_provided_name = current_user.first_name
          self.res_approved_name = current_user.first_name
        elsif self.res_approved_changed? && self.res_approved?
          self.res_approved_name = current_user.first_name
        elsif self.res_approved_changed? && !self.res_approved?
          self.res_approved_name = nil
      end
      save
      logger.info ""pocessed resolution information... #{current_user.first_name}""
    end

As you can see it's pretty ugly and I don't have access to the current_user inside the ticket model. Should I put this into a presenter or service? Any tips appreciated.","2013-06-18 03:45:00"
"2904451","refactoring my code. My headers (Header Guard Issues)","0","refactoring my code. My headers (Header Guard Issues)","2010-05-25 12:19:25"
"2904451","refactoring my code. My headers (Header Guard Issues)","0","I had a post similar to this awhile ago based on a error I was getting. I was able to fix it but since then I been having trouble doing things because headers keep blocking other headers from using code. Honestly, these headers are confusing me and if anyone has any resources that will address these types of issues, that will be helpful. 

What I essentially want to do is be able to have rModel.h be included inside RenderEngine.h. every time I add rModel.h to RenderEngine.h, rModel.h is no longer able to use RenderEngine.h. (rModel.h has a #include of RenderEngine.h as well).

So in a nutshell, RenderEngine and rModel need to use each others functionalities. On top of all this confusion, the Main.cpp needs to use RenderEngine. 



stdafx.h

    #include ""targetver.h""
    
    #define WIN32_LEAN_AND_MEAN             // Exclude rarely-used stuff from Windows headers
    // Windows Header Files:
    #include <windows.h>
    
    // C RunTime Header Files
    #include <stdlib.h>
    #include <malloc.h>
    #include <memory.h>
    #include <tchar.h>
    #include ""resource.h""

main.cpp


    #include ""stdafx.h""
    #include ""RenderEngine.h""
    #include ""rModel.h""
    
    // Global Variables:
    
    RenderEngine go;
    
    rModel *g_pModel;
    
    ...code...........

rModel.h


    #ifndef _MODEL_H
    #define _MODEL_H
    #include ""stdafx.h""
    #include <vector>
    #include <string>
    #include ""rTri.h""
    #include ""RenderEngine.h""
    
    ........Code


RenderEngine.h

    #pragma once
    #include ""stdafx.h""
    #include ""d3d10.h""
    #include ""d3dx10.h""
    #include ""dinput.h""
    #include ""rModel.h""
    
    .......Code......","2010-05-25 12:19:25"
"2904451","refactoring my code. My headers (Header Guard Issues)","0","<c++><c><visual-studio><visual-studio-2008><visual-c++>","2010-05-25 12:19:25"
"24403185","refactor code to avoid N+1 query","0","refactor code to avoid N+1 query","2014-06-25 07:57:53"
"24403185","refactor code to avoid N+1 query","0","I have my association like this

```models/transcription.rb```

    class Transcription < ActiveRecord::Base
      belongs_to :transcription_status, :class_name => ""TranscriptionStatus"",
        :inverse_of => :transcriptions
    

      # Initialize to ""new"" status if a status isn't already set
      def setup_status
        if transcription_status.nil?  # this method is taking lots of execution time ( N + 1 )
          status = TranscriptionStatus.find_by_state(""new"")
          if status
            self.transcription_status = status
          end
        end
      end
    end



``` models/transcription_status.rb ```

    class TranscriptionStatus < ActiveRecord::Base
      has_many :transcriptions, :inverse_of => :transcription_status
    end




**Problem**

Everytime I call ```transcription_status``` it is executing ```N+1``` query. Suggest me the way to refactor this code to prevent ``` N+1 ``` query limit?

Thanks","2014-06-25 07:57:53"
"24403185","refactor code to avoid N+1 query","0","<ruby-on-rails><ruby><ruby-on-rails-3.2>","2014-06-25 07:57:53"
"10158234","refactoring javascript event handlers - is this a reasonable thing to do?","0","refactoring javascript event handlers - is this a reasonable thing to do?","2012-04-14 23:30:34"
"10158234","refactoring javascript event handlers - is this a reasonable thing to do?","0"," I have inherited a relatively big javascript app (~3k lines of code) and just do parttime javascript. I want to put all the jQuery event handlers into a more sane organization. I was thinking something like this:

before:

    $('#click-here').click(function(){
      //a bunch of dom manipulations and with 30 of them makes the app fairly convoluted
    });

after:

    function result_click(){
      var global_id=$(this).data('global-id');
      alert('here are the results of clicking: ' + global_id);
    }
    
    $(document).ready(function(){
      $('#click-here').on('click',result_click);
    });
    </script>
    <div id='click-here' data-global-id='23'>click HERE!</div>

This would be a fairly easy refactoring and would seem to structure it better. The event handling part seems to be the most out of control. Is this a reasonable way to do this? It would seem fairly easy to make this into a backbone.js app once it gets to this point.

thx

","2012-04-14 23:30:34"
"10158234","refactoring javascript event handlers - is this a reasonable thing to do?","0","<javascript><jquery>","2012-04-14 23:30:34"
"35879208","refactor d3 bar chart to be horizontal bar chart","0","refactor d3 bar chart to be horizontal bar chart","2016-03-08 22:22:12"
"35879208","refactor d3 bar chart to be horizontal bar chart","0","I was trying to refactor this bar chart in d3 to be a horizontal bar chart. I think I've isolated the three areas that need to be changed:

the original scale declarations:

      var x0 = d3.scale.ordinal()
          .rangeRoundBands([0, width], 0.1);
    
      var x1 = d3.scale.ordinal();
    
      var y = d3.scale.linear()
          .range([height, 0]);

The domain definitions:

    x0.domain(data.map(function(d) { return d.deviceType; }));
    x1.domain(deviceClass).rangeRoundBands([0, x0.rangeBand()]);
    y.domain([0, d3.max(data, function(d) { return d3.max(d.whenPurchased, function(d) { return d.value; }); })]);

the rect appending and positioning:

    device.selectAll(""rect"")
        .data(function(d) { return d.whenPurchased; })
      .enter().append(""rect"")
        .attr(""width"", x1.rangeBand())
        .attr(""x"", function(d) { return x1(d.device); })
        .attr(""y"", function(d) { return y(d.value); })
        .attr(""height"", function(d) { return height - y(d.value); })
        .style(""fill"", function(d) { return color(d.device); });

I can't seem to get the refactoring right and I think that is because I don't exactly get how domain works for x0 and basically not getting that right has a waterfall effect of everything else not working.

I put the full example here: [JSFIDDLE][1]


  [1]: https://jsfiddle.net/hamlinkn/286L7fh0/1/","2016-03-08 22:22:12"
"35879208","refactor d3 bar chart to be horizontal bar chart","0","<javascript><d3.js>","2016-03-08 22:22:12"
"22236651","refactoring similar functions with access to variables","0","refactoring similar functions with access to variables","2014-03-06 21:41:44"
"22236651","refactoring similar functions with access to variables","0","I have a simple index page that allows you to click a button to change the colors displayed randomly on the background circle divs. The code I've written is working fine, but its really repetitive; I wrote a function for each button, and the functions look identical except for the variables they access.

I'm trying to refactor this into a single function but can't figure out a way to allow the button that is click to access the correct variable to change the background colors. 
For example here is the function for the first button, which accesses the colorList variable that changes the colors to gray spectrum:

    var colorList1 = [//array of 20 colors]
    var colorList2 = [//array of 20 colors]
    var colorList3 = [//array of 20 colors]
    var colorList4 = [//array of 20 colors]

    // .choice-1 is the div class for the first button
    $("".choice-1"").on(""click"", function() {
        blankSlate();
        colorList = colorList1;
        $(""[id^='nav']"").css(""background-color"", colorList[1]);
        $(""#colorChoice"").css(""background-color"", colorList[1]);
    });

I tried to write something that would access the number in the class name and assign that to a variable that would be accessible to the main function doing something like this:

    var buttonVar = $(""button"").attr[0].nodeValue; // get full name of nodeValue
    var btnChoice = buttonVar[buttonVar.length-1]; // access number at end of class name
    $(""button"").on(""click"",function() {
        $('.choice' + btnChoice).on('click', function(){*/
        blankSlate();
        colorList = colorList + btnChoice;
        $(""[id^='nav']"").css(""background-color"", colorList[btnChoice]);
        $(""#colorChoice"").css(""background-color"", colorList[btnChoice]);
      });

...but I'm not sure that this is the right way to go about it, and I'd love some advice about how this type of refactoring is typically handled. 

Here's a link to a Codepen showing how it works, and with all the html, css and remaining JS viewable. 
http://codepen.io/a6ftcruton/full/Beizu
","2014-03-06 21:41:44"
"22236651","refactoring similar functions with access to variables","0","<jquery><html><css><refactoring><parameter-passing>","2014-03-06 21:41:44"
"21403084","refactoring large if else satement in java","0","refactoring large if else satement in java","2014-01-28 10:31:07"
"21403084","refactoring large if else satement in java","0","I'm trying to refactor some code so I don't have a large if / else if statement if possible. 

Here is the code: 

    if (Character.getNumericValue(num) == 0 ) {
        	return bar0;
        }
        else if (Character.getNumericValue(num) == 1 ) {
        	return bar1;
        }
        else if (Character.getNumericValue(num) == 2 ) {
        	return bar2;
        }
        else if (Character.getNumericValue(num) == 3 ) {
        	return bar3;
        }
        else if (Character.getNumericValue(num) == 4 ) {
        	return bar4;
        }
        else if (Character.getNumericValue(num) == 5 ) {
        	return bar5;
        }
        else if (Character.getNumericValue(num) == 6 ) {
        	return bar6;
        }
        else if (Character.getNumericValue(num) == 7 ) {
        	return bar7;
        }
        else if (Character.getNumericValue(num) == 8 ) {
        	return bar8;
        }
        else if (Character.getNumericValue(num) == 9 ) {
        	return bar9;
        }
        else {
        	return bar10;
        }

Basically it checks if char num is equal to an int 0-9, then returns the associated numbers bar (which is of type string). Is there any way to make this better?

I would like it to be something like 

    if (Character.getNumericaValue(num) == x {
       return barx;
    }
    else 
       return bar10;

if that makes sense. 

","2014-01-28 10:31:07"
"21403084","refactoring large if else satement in java","0","<java><if-statement><refactoring>","2014-01-28 10:31:07"
"47185442","refactoring deprecated webClient to httpclient in VB.net","0","refactoring deprecated webClient to httpclient in VB.net","2017-11-08 16:56:40"
"47185442","refactoring deprecated webClient to httpclient in VB.net","0","I have this old console VB.net Processer job I want to convert webClient to httpclient. can someone help me?

           PostAccountsOrder.Add(""PostAccountsOrder"", solomonOrder)

            Dim urlToPost As String = """"
            Dim webClient As New WebClient()
            Dim resByte As Byte()
            Dim resString As String
            Dim reqString() As Byte
            webClient.Headers(""content-type"") = ""application/json""

            Dim str = JsonConvert.SerializeObject(PostAccountsOrder, formatting:=Formatting.Indented)
            reqString =  Encoding.Default.GetBytes(str)
            resByte = webClient.UploadData(urlToPost, ""post"", reqString)

            resString = Encoding.Default.GetString(resByte)
            Console.WriteLine(resString)
            webClient.Dispose()","2017-11-08 16:56:40"
"47185442","refactoring deprecated webClient to httpclient in VB.net","0","<.net><vb.net><refactoring><httpclient><webclient>","2017-11-08 16:56:40"
"47967828","refactoring within a shell script","0","refactoring within a shell script","2017-12-25 10:38:13"
"47967828","refactoring within a shell script","0","I have been given assignments to do on sed command. I was just thinking of coding a refactoring tool using the command line. Is there a way to access the variables declared in a c++ program externally from a shell script and change their name,type,global and static declarations,etc? Are their specific commands. I am using gcc and gdb in my system.
Googling it up did not give suitable results.","2017-12-25 10:38:13"
"47967828","refactoring within a shell script","0","<c++><bash><shell><sed>","2017-12-25 10:38:13"
"39622825","refactoring too many parameter in java code","0","refactoring too many parameter in java code","2016-09-21 17:19:54"
"39622825","refactoring too many parameter in java code","0","I want to refactor below program. It has too many parameter smell . How can I refactor it .
    
              
    package net.sourceforge.ganttproject.export;
    import net.sourceforge.ganttproject.GanttExportSettings;
    import net.sourceforge.ganttproject.task.TaskContainmentHierarchyFacade;
    import net.sourceforge.ganttproject.resource.HumanResourceManager;
    import java.io.File;
    public class PDFExportData extends ProjectExportData {
        final String myStylesheet;
    
    public PDFExportData(GanttExportSettings myExportSettings, File myOutputFile, String myProjectName, String myProjectDescription, String myOrganization, HumanResourceManager myResourceManager, TaskContainmentHierarchyFacade myTaskHierarchyFacade, GanttChartExportProcessor myGanttChartExportProcessor, ResourceChartExportProcessor myResourceChartExportProcessor, String stylesheet) {
            super(myExportSettings, myOutputFile, myProjectName, myProjectDescription, myOrganization, myResourceManager, myTaskHierarchyFacade, myGanttChartExportProcessor, myResourceChartExportProcessor);
            myStylesheet = stylesheet;
        }
    }
    
    
    
    
       ","2016-09-21 17:19:54"
"39622825","refactoring too many parameter in java code","0","<refactoring>","2016-09-21 17:19:54"
"39622825","refactoring too many parameter in java code","0","I want to refactor the program below. It has too many parameter smell. How can I refactor it?
    
              
    package net.sourceforge.ganttproject.export;

    import net.sourceforge.ganttproject.GanttExportSettings;
    import net.sourceforge.ganttproject.task.TaskContainmentHierarchyFacade;
    import net.sourceforge.ganttproject.resource.HumanResourceManager;
    import java.io.File;

    public class PDFExportData extends ProjectExportData {

        final String myStylesheet;
    
    public PDFExportData(GanttExportSettings myExportSettings, File myOutputFile, String myProjectName, String myProjectDescription, String myOrganization, HumanResourceManager myResourceManager, TaskContainmentHierarchyFacade myTaskHierarchyFacade, GanttChartExportProcessor myGanttChartExportProcessor, ResourceChartExportProcessor myResourceChartExportProcessor, String stylesheet) {
            super(myExportSettings, myOutputFile, myProjectName, myProjectDescription, myOrganization, myResourceManager, myTaskHierarchyFacade, myGanttChartExportProcessor, myResourceChartExportProcessor);

            myStylesheet = stylesheet;
        }
    }
    
    
    
    
       ","2016-09-23 17:02:37"
"39622825","refactoring too many parameter in java code","0","<java><refactoring>","2016-09-23 17:02:37"
"39622825","refactoring too many parameter in java code","0","","2016-09-23 17:02:37"
"4089011","refactoring and using a counter?","0","refactoring and using a counter?","2010-11-03 16:03:09"
"4089011","refactoring and using a counter?","0","I have the following structure:

    $text_1 = $this->getValue('value_1');
    $text_2 = $this->getValue('value_2');
    $text_3 = $this->getValue('value_3')

And also the following:

        foreach($text_1 as $t_1)
        {
            if(!$first)
            {
                $string_1 .= "","";

            }
            $first = false;
            $string_1 .= $t_1;
        }

        foreach($text_2 as $t_2)
        {
            if(!$first)
            {
                $string_2 .= "","";

            }
            $first = false;
            $string_2 .= $t_2;
        }

        foreach($text_3 as $t_3)
        {
            if(!$first)
            {
                $string_3 .= "","";

            }
            $first = false;
            $string_3 .= $t_3;
        }

I was wondering if this could be re-factored to use a counter, like in a for loop, to replace the _1, _2, _3 etc from my code?","2010-11-03 16:03:09"
"4089011","refactoring and using a counter?","0","<php><refactoring>","2010-11-03 16:03:09"
"27279292","refactor method name in eclipse from linked project","0","refactor method name in eclipse from linked project","2014-12-03 18:44:20"
"27279292","refactor method name in eclipse from linked project","0","I have 6 java projects in my Eclipse IDE (juno). One of them is a dummy project which is not meant to be compiled or deployed, it simple holds common logic for the other projects. The other projects use this common project. I edited the classpath of the other projects to include the common source folder as a linked source.

This works fine, but I'm having troubles when I refactor a class or method name in the common project. The refactoring is not propagated to the non-common classes in the other projects that makes use of the refactored class or method, resulting in compile errors that a certain class or method is not found.

The only way I can deal with this is either: 

 1. Don't change the name of anything
 2. Manually change the name in all projects after refactoring

This kind of defeats the purpose of having the common source if a simple edit is not propagated. Is there any way of dealing with this?","2014-12-03 18:44:20"
"27279292","refactor method name in eclipse from linked project","0","<java><eclipse>","2014-12-03 18:44:20"
"16230424","refactoring anonymous function javascript","0","refactoring anonymous function javascript","2013-04-26 06:55:02"
"16230424","refactoring anonymous function javascript","0","I am working on knockout bindings.. I have knockout sorting to implement and i have done this way..

    function notesViewModel() {
        _this.colName = ""CreatedDate"";
        _this.sortOrder = ""desc"";
        _this.notes = ko.observableArray();
    
       _this.SortItems = function (colname) {
            var newNotes = _this.notes();
            if (_this.sortOrder === ""desc"") {
                this.notes(newNotes.sort(notesViewModel._getSortFunction = function (a, b) {
                    return a[colname] < b[colname] ? -1 : 1;
                }));
                switchSortOrder();
            } else {
                this.notes(newNotes.sort(notesViewModel._getSortFunction = function (a, b) {
                    return a[colname] > b[colname] ? -1 : 1;
                }));
                switchSortOrder();
            }
        };
        function switchSortOrder() {
            if (_this.sortOrder === ""asc"") {
                _this.sortOrder = ""desc"";
            } else {
                _this.sortOrder = ""asc"";
            }
        }
     ko.applyBindings(_this, $(""body"").get(0));
    return _this;
    }

and my html code is like this:

    <table id=""notes"" class=""notes_table"">
                                <tr class=""head"">
                                    <th data-bind='click: function() { SortItems(""CreatedDate"")}'>
                                        <span>Date</span>
                                    </th>
                                    <th data-bind='click: function() { SortItems(""Type"")}'>
                                        <span>Type</span>
                                    </th>
                                    <th data-bind='click: function() { SortItems(""Category"")}'>
                                        <span>Category</span>
                                    </th>
                                    <th data-bind='click: function() {SortItems(""AddedBy"")}'>
                                        <span>Added by</span>
                                    </th>
                                    <th>
                                        <span>Alerts</span>
                                    </th>
                                    <th></th>
                                </tr>
                                <tbody data-bind=""template: { name: 'StudentNote', foreach: notes }""></tbody>
                            </table>


I want to refactor the sort function to something like this..

_

    this.SortItems = function (colname) {
            var newNotes = _this.notes();
            this.notes(newNotes.sort(notesViewModel._getSortFunction = compareFunction (a, b,_this.sortOrder)));
    
       comparerFunction(a,b,sortOrder)
     {
         if(sortOrder === ""desc"")
        {
    
         return a[colname] < b[colname] ? -1 : 1;
         _this.sortOrder = ""asc"";
                
        }
        else
        {
         return a[colname] > b[colname] ? -1 : 1;
         _this.sortOrder = ""desc"";
        }
     }
    
    };

But it didnt work out as, it was saying that the a and b parameters are not available.. can anyone please tell me how to separe the logic from the anonymous function","2013-04-26 06:55:02"
"16230424","refactoring anonymous function javascript","0","<javascript><knockout.js>","2013-04-26 06:55:02"
"16230424","refactoring anonymous function javascript","0","I am working on knockout bindings.. I have knockout sorting to implement and i have done this way..

    function notesViewModel() {
        _this.colName = ""CreatedDate"";
        _this.sortOrder = ""desc"";
        _this.notes = ko.observableArray();
    
       _this.SortItems = function (colname) {
            var newNotes = _this.notes();
            if (_this.sortOrder === ""desc"") {
                this.notes(newNotes.sort(notesViewModel._getSortFunction = function (a, b) {
                    return a[colname] < b[colname] ? -1 : 1;
                }));
                switchSortOrder();
            } else {
                this.notes(newNotes.sort(notesViewModel._getSortFunction = function (a, b) {
                    return a[colname] > b[colname] ? -1 : 1;
                }));
                switchSortOrder();
            }
        };
        function switchSortOrder() {
            if (_this.sortOrder === ""asc"") {
                _this.sortOrder = ""desc"";
            } else {
                _this.sortOrder = ""asc"";
            }
        }
     ko.applyBindings(_this, $(""body"").get(0));
    return _this;
    }

and my html code is like this:

    <table id=""notes"" class=""notes_table"">
                                <tr class=""head"">
                                    <th data-bind='click: function() { SortItems(""CreatedDate"")}'>
                                        <span>Date</span>
                                    </th>
                                    <th data-bind='click: function() { SortItems(""Type"")}'>
                                        <span>Type</span>
                                    </th>
                                    <th data-bind='click: function() { SortItems(""Category"")}'>
                                        <span>Category</span>
                                    </th>
                                    <th data-bind='click: function() {SortItems(""AddedBy"")}'>
                                        <span>Added by</span>
                                    </th>
                                    <th>
                                        <span>Alerts</span>
                                    </th>
                                    <th></th>
                                </tr>
                                <tbody data-bind=""template: { name: 'StudentNote', foreach: notes }""></tbody>
                            </table>


I want to refactor the sort function to something like this..

_

    this.SortItems = function (colname) {
            var newNotes = _this.notes();
            this.notes(newNotes.sort(notesViewModel._getSortFunction = compareFunction (a, b,_this.sortOrder)));
    
      function comparerFunction(a,b,sortOrder)
     {
         if(sortOrder === ""desc"")
        {
    
         return a[colname] < b[colname] ? -1 : 1;
         _this.sortOrder = ""asc"";
                
        }
        else
        {
         return a[colname] > b[colname] ? -1 : 1;
         _this.sortOrder = ""desc"";
        }
     }
    
    };

But it didnt work out as, it was saying that the a and b parameters are not available.. can anyone please tell me how to separe the logic from the anonymous function","2013-04-26 07:03:40"
"16230424","refactoring anonymous function javascript","0","I am working on knockout bindings.. I have knockout sorting to implement and i have done this way..

    function notesViewModel() {
        _this.colName = ""CreatedDate"";
        _this.sortOrder = ""desc"";
        _this.notes = ko.observableArray();
    
       _this.SortItems = function (colname) {
            var newNotes = _this.notes();
            if (_this.sortOrder === ""desc"") {
                this.notes(newNotes.sort(notesViewModel._getSortFunction = function (a, b) {
                    return a[colname] < b[colname] ? -1 : 1;
                }));
                switchSortOrder();
            } else {
                this.notes(newNotes.sort(notesViewModel._getSortFunction = function (a, b) {
                    return a[colname] > b[colname] ? -1 : 1;
                }));
                switchSortOrder();
            }
        };
        function switchSortOrder() {
            if (_this.sortOrder === ""asc"") {
                _this.sortOrder = ""desc"";
            } else {
                _this.sortOrder = ""asc"";
            }
        }
     ko.applyBindings(_this, $(""body"").get(0));
    return _this;
    }

and my html code is like this:

    <table id=""notes"" class=""notes_table"">
            <tr class=""head"">
            <th data-bind='click: function() { SortItems(""CreatedDate"")}'>
            <span>Date</span>
            </th>
            <th data-bind='click: function() { SortItems(""Type"")}'>
            <span>Type</span>
            </th>
            <th data-bind='click: function() { SortItems(""Category"")}'>
            <span>Category</span>
            </th>
            <th data-bind='click: function() {SortItems(""AddedBy"")}'>
            <span>Added by</span>
            </th>
            <th>
            <span>Alerts</span>
            </th>
            <th></th>
            </tr>
            <tbody data-bind=""template: { name: 'StudentNote', foreach: notes }""></tbody>
        </table>

I want to refactor the sort function to something like this..

_

    this.SortItems = function (colname) {
            var newNotes = _this.notes();
            this.notes(newNotes.sort(notesViewModel._getSortFunction = compareFunction (a, b,_this.sortOrder)));
    
      function comparerFunction(a,b,sortOrder)
     {
         if(sortOrder === ""desc"")
        {
    
         return a[colname] < b[colname] ? -1 : 1;
         _this.sortOrder = ""asc"";
                
        }
        else
        {
         return a[colname] > b[colname] ? -1 : 1;
         _this.sortOrder = ""desc"";
        }
     }
    
    };

But it didnt work out as, it was saying that the a and b parameters are not available.. can anyone please tell me how to separe the logic from the anonymous function
","2013-04-26 07:12:36"
"16230424","refactoring anonymous function javascript","0","{""Voters"":[{""Id"":237838,""DisplayName"":""Andrew Barber""}]}","2013-05-02 11:17:56"
"16230424","refactoring anonymous function javascript","0","{""Voters"":[{""Id"":237838,""DisplayName"":""Andrew Barber""}]}","2013-05-02 11:18:07"
"24021316","refactoring top-level transforms","0","refactoring top-level transforms","2014-06-03 17:23:49"
"24021316","refactoring top-level transforms","0","I have a stylesheet with a number of templates that match certain elements, including an identity template:

    <xsl:stylesheet>
        <xsl:template match=""@*|node()"">
    	    <xsl:copy>
    	        <xsl:apply-templates select=""@*|node()"" />
    	    </xsl:copy>
        </xsl:template>
        <xsl:template match=""someElement/*>
        ...
        </xsl:template>
        <!-- a bunch of other matching templates -->
    </xsl:stylesheet>

A new requirement has come up that if a certain element in the input document has a specific value, most of the transformation should simply be skipped.

Of course I *can't* simply do this:

    <xsl:stylesheet>
        <xsl:choose>
            <xsl:when test=""/someElement/somethingElse &lt; 0"">
               	<xsl:template match=""@*|node()"">
      	    	    <xsl:copy>
        	        	<xsl:apply-templates select=""@*|node()"" />
      	            </xsl:copy>
            	</xsl:template>
    
                <xsl:template match=""someElement/*>
                ...
                </xsl:template>
                <!-- a bunch of other matching templates -->
            </xsl:when>
            <xsl:otherwise>
                <!-- do very simple transform -->
            </xsl:otherwise>
        <xsl:choose>
    </xsl:stylesheet>

because `template` is not allowed as a child of `when`. It looks like the only way to deal with this might be to rewrite all of the templates with actual names and parameters, but there are quite a few and I was wondering if there was an easier way.","2014-06-03 17:23:49"
"24021316","refactoring top-level transforms","0","<xml><xslt><xslt-1.0>","2014-06-03 17:23:49"
"29997423","refactoring a function that sorts with consideration for initial articles","0","refactoring a function that sorts with consideration for initial articles","2015-05-02 01:37:52"
"29997423","refactoring a function that sorts with consideration for initial articles","0","I've got a function that does what I want it to do, but it's really, really ugly. Looking for ways to not necessarily make it faster, but maybe make it a little less ugly, more generic, and overall more maintainable.

    <?php
	
	// unordered list
	$list = Array(
		0 => 'My Images',
		1 => 'Text Alignment',
		2 => 'Your New Post',
		3 => 'The More Tag',
		4 => 'The Average Post',
		5 => 'The Paginated'
	);
	
	// Desired output:
	//	Array(
	//		4 => 'The Average Post',
	//		3 => 'The More Tag',
	//		0 => 'My Images',
	//		5 => 'The Paginated',
	//		1 => 'Text Alignment',
	//		2 => 'Your New Post'
	//	)

	function alphabetical_sort_with_initial_articles($array) {
		$temp_results = [];
		$results = [];
		foreach($array as $key => $value) {
			$value_arr = explode(' ', $value);
			if($value_arr[0] === 'The') { // need to make this dynamic: the|The|etc.
				$initial_article = array_shift($value_arr);
				$temp_results[$key] = array(
					implode(' ', $value_arr),
					$initial_article
				);
			} else {
				$temp_results[$key] = array(
					implode(' ', $value_arr),
					false
				);
			}
		}
		
		uasort($temp_results, function($a, $b) {
			return ($a[0] > $b[0]);
		});
		
		foreach($temp_results as $key => $value) {
			$results[$key] = trim($value[1] . ' ' . $value[0]);
		}
		
		return $results;
	}

	print_r($list);
	echo ""------------------------\n"";
	print_r(alphabetical_sort_with_initial_articles($list));
	
	//josh@lear:~/Development/PHP/$ time php lists.php
	//Array
	//(
	//    [0] => My Images
	//    [1] => Text Alignment
	//    [2] => Your New Post
	//    [3] => The More Tag
	//    [4] => The Average Post
	//    [5] => The Paginated
	//)
	//------------------------
	//Array
	//(
	//    [4] => The Average Post
	//    [3] => The More Tag
	//    [0] => My Images
	//    [5] => The Paginated
	//    [1] => Text Alignment
	//    [2] => Your New Post
	//)
	//
	//real	0m0.032s
	//user	0m0.017s
	//sys	0m0.013s","2015-05-02 01:37:52"
"29997423","refactoring a function that sorts with consideration for initial articles","0","<php><arrays><sorting><filter><refactoring>","2015-05-02 01:37:52"
"10880567","refactor transaction handling code in php","0","refactor transaction handling code in php","2012-06-04 11:35:46"
"10880567","refactor transaction handling code in php","0","I am using php 5.3.3 and developing a MVC webapp using codeigniter. The code I am trying to refactor is basically bunch of:

    $this->db->trans_start();
        // do some db updates
        $this->db->update(...);
        $this->db->update(...);
    $this->db->trans_complete();

    if ( $this->db->trans_status() == FALSE ) {
        $this->handle_db_error();
    }

so I have a few of the above code scatter around in my model classes. I would like to refactor the transaction handling part out of the models and stay DRY. 

I thought I could using closure like the following:

    // in parent CI_Model class 
    public function txn_wrap($closure) {
        $this->db->trans_start();
        $closure();
        $this->db->trans_complete();
        if ( $this->db->trans_status() == FALSE ) {
            $this->handle_db_error();
        }
    }

    // in child model class

     $update_db_closure = function() { 
        // do some db updates
        $this->db->update(...);
        $this->db->update(...);
     };
     $this->txn_wrap($update_db_closure);

That doesn't work and gives me ""PHP Fatal error:  Using $this when not in object context"". So I guess using of $this usage is not supported in 5.3.

Now failing of using closure, What else can I do?

thanks!","2012-06-04 11:35:46"
"10880567","refactor transaction handling code in php","0","<php><codeigniter>","2012-06-04 11:35:46"
"10880567","refactor transaction handling code in php","0","I am using php 5.3.3 and developing a MVC webapp using codeigniter. The code I am trying to refactor is basically bunch of:

    $this->db->trans_start();
        // do some db updates
        $this->db->update(...);
        $this->db->update(...);
    $this->db->trans_complete();

    if ( $this->db->trans_status() == FALSE ) {
        $this->handle_db_error();
    }

so I have a few of the above code scatter around in my model classes. I would like to refactor the transaction handling part out of the models and stay DRY. 

I thought I could using closure like the following:

    // in parent CI_Model class 
    public function txn_wrap($closure) {
        $this->db->trans_start();
        $closure();
        $this->db->trans_complete();
        if ( $this->db->trans_status() == FALSE ) {
            $this->handle_db_error();
        }
    }

    // in child model class

     $update_db_closure = function() { 
        // do some db updates
        $this->db->update(...);
        $this->db->update(...);
     };
     $this->txn_wrap($update_db_closure);

That doesn't work and gives me `""PHP Fatal error:  Using $this when not in object context""`. So I guess using of $this usage is not supported in 5.3.

Now failing of using closure, What else can I do?

thanks!","2012-06-05 01:57:37"
"10880567","refactor transaction handling code in php","0","I am using php 5.3.3 and developing a MVC webapp using codeigniter. The code I am trying to refactor is basically bunch of:

    $this->db->trans_start();
        // do some db updates
        $this->db->update(...);
        $this->db->update(...);
    $this->db->trans_complete();

    if ( $this->db->trans_status() == FALSE ) {
        $this->handle_db_error();
    }

so I have a few of the above code scatter around in my model classes. I would like to refactor the transaction handling part out of the models and stay DRY. 

I thought I could using closure like the following:

    // in parent CI_Model class 
    class MY_Model extends CI_Model {
      public function txn_wrap($closure) {
        $this->db->trans_start();
        $closure();
        $this->db->trans_complete();
        if ( $this->db->trans_status() == FALSE ) {
            $this->handle_db_error();
        }
      }

    // in child model class

     class Blog_model extends MY_Model {
       public function get($id) {
         $instance = $this;
         $closure = function() use($instance) { 
            // do some db updates
            $this->db->update(...);
            $this->db->update(...);
         };
         $this->txn_wrap($closure);
       }

That doesn't work and gives me `""PHP Fatal error:  Using $this when not in object context""`. So I guess using of $this usage is not supported in 5.3.

Now failing of using closure, What else can I do?

thanks!","2012-06-06 03:30:26"
"10880567","refactor transaction handling code in php","0","I am using php 5.3.3 and developing a MVC webapp using codeigniter. The code I am trying to refactor is basically bunch of:

    $this->db->trans_start();
        // do some db updates
        $this->db->update(...);
        $this->db->update(...);
    $this->db->trans_complete();

    if ( $this->db->trans_status() == FALSE ) {
        $this->handle_db_error();
    }

so I have a few of the above code scatter around in my model classes. I would like to refactor the transaction handling part out of the models and stay DRY. 

I thought I could using closure like the following:

    // in parent CI_Model class 
    class MY_Model extends CI_Model {
      public function txn_wrap($closure) {
        $this->db->trans_start();
        $closure();
        $this->db->trans_complete();
        if ( $this->db->trans_status() == FALSE ) {
            $this->handle_db_error();
        }
      }

    // in child model class

     class Blog_model extends MY_Model {
       protected $_table = 'app_about';

       public function get($id) {
         $instance = $this;
         $closure = function() use($instance, $id) { 
            // do some db updates
            $instance->db->update($instance->_table, array('id' => $id));
         };
         $this->txn_wrap($closure);
       }

That doesn't work and gives me `""PHP Fatal error:  Using $this when not in object context""`. So I guess using of $this usage is not supported in 5.3.

Now failing of using closure, What else can I do?

thanks!","2012-06-06 07:02:10"
"10880567","refactor transaction handling code in php","0","I am using php 5.3.3 and developing a MVC webapp using codeigniter. The code I am trying to refactor is basically bunch of:

    $this->db->trans_start();
        // do some db updates
        $this->db->update(...);
        $this->db->update(...);
    $this->db->trans_complete();

    if ( $this->db->trans_status() == FALSE ) {
        $this->handle_db_error();
    }

so I have a few of the above code scatter around in my model classes. I would like to refactor the transaction handling part out of the models and stay DRY. 

I thought I could using closure like the following:

    // in parent CI_Model class 
    class MY_Model extends CI_Model {
      public function txn_wrap($closure) {
        $this->db->trans_start();
        $closure();
        $this->db->trans_complete();
        if ( $this->db->trans_status() == FALSE ) {
            $this->handle_db_error();
        }
      }

    // in child model class

     class Blog_model extends MY_Model {
       protected $_table = 'app_blog';

       public function get($id) {
         $instance = $this;
         $closure = function() use($instance, $id) { 
            // do some db updates
            $instance->db->update($instance->_table, array('title' => 'bla'), array('id' => $id));
         };
         $this->txn_wrap($closure);
       }

That doesn't work and gives me `""PHP Fatal error:  Using $this when not in object context""`. So I guess using of $this usage is not supported in 5.3.

Now failing of using closure, What else can I do?

**UPDATE:**  now I am getting `Undefined property: App_Blog::$_table` where App_About is the controller which calls the get() function in Blog_model. I have tried `function() use($instance, , $instance->_table, $id)` but php complains about the syntax.. Now this closure thing doesn't appears give me as much benefits as I thought..

thanks!","2012-06-06 07:07:27"
"35312510","refactor model method multiple mount_uploader for carrierwave","0","refactor model method multiple mount_uploader for carrierwave","2016-02-10 10:23:09"
"35312510","refactor model method multiple mount_uploader for carrierwave","0","I have rails4 website and i am using carrierwave to upload image to an S3 bucket in production (and local in dev). It's all working, but i wanted to refactor my code.

My model was this (it's working in production) : 

    class Blogging < ActiveRecord::Base

    mount_uploader :picture1, Picture1Uploader  
    mount_uploader :picture2, Picture1Uploader  
    mount_uploader :picture3, Picture1Uploader    
    mount_uploader :picture4, Picture1Uploader  
    mount_uploader :picture5, Picture1Uploader  
    mount_uploader :picture6, Picture1Uploader  
    mount_uploader :picture7, Picture1Uploader  
    mount_uploader :picture8, Picture1Uploader  
    mount_uploader :picture9, Picture1Uploader  
    mount_uploader :picture10, Picture1Uploader  
    mount_uploader :picture11, Picture1Uploader  
    validate :picture_size  


    private
      def picture_size
		if picture1.size > 5.megabytes
			errors.add(:picture1, ""should be less than 5 MB"")
		end
	  end


    end

**A now after some refactoring and more ugly code :/ i have this**

  

    class Blogging < ActiveRecord::Base


    for i in 1..11 
	 mount_uploader :""picture#{i}"", Picture1Uploader
    end


    validate :picture_size
    validates :picture1, :news_title, :news_body, presence: true 



    private

	 def picture_size
		pics = Array.new(11) {|i| ""picture#{i+1}""} 
			pics.each do |p|
			if p.size > 5.megabytes
			errors.add(:picture1, ""should be less than 5 MB"")
			end
		 end
	 end


    end

The mount_uploader, while ugly work fine, but i can't find a way to make picture_size limit the size of each picture(from 1 to 11). 
   
-i can make it work using 11 times a different method or with a case operator. But i am trying to refactor.  

-I'd love to put my ""for"" loop in a method and call it but can't figure out how. if i define a method and call it all the image vanish and no file get uploaded (locally or on the S3 bucket)

Thanks a lot for reading me . 
I am sorry for my bad english, i hope i am clear enough
Cheers.

","2016-02-10 10:23:09"
"35312510","refactor model method multiple mount_uploader for carrierwave","0","<ruby-on-rails><model><refactoring><carrierwave>","2016-02-10 10:23:09"
"35312510","refactor model method multiple mount_uploader for carrierwave","0","I have Rails (4) app and I'm using carrierwave to upload an image to an S3 bucket in production (and local in dev). It's all working, but I wanted to refactor my code.

**My model:**

    class Blogging < ActiveRecord::Base

    mount_uploader :picture1, Picture1Uploader  
    mount_uploader :picture2, Picture1Uploader  
    mount_uploader :picture3, Picture1Uploader    
    mount_uploader :picture4, Picture1Uploader  
    mount_uploader :picture5, Picture1Uploader  
    mount_uploader :picture6, Picture1Uploader  
    mount_uploader :picture7, Picture1Uploader  
    mount_uploader :picture8, Picture1Uploader  
    mount_uploader :picture9, Picture1Uploader  
    mount_uploader :picture10, Picture1Uploader  
    mount_uploader :picture11, Picture1Uploader  
    validate :picture_size  


    private
      def picture_size
		if picture1.size > 5.megabytes
			errors.add(:picture1, ""should be less than 5 MB"")
		end
	  end


    end

**After some refactoring, I have this:**

  

    class Blogging < ActiveRecord::Base


    for i in 1..11 
	 mount_uploader :""picture#{i}"", Picture1Uploader
    end


    validate :picture_size
    validates :picture1, :news_title, :news_body, presence: true 



    private

	 def picture_size
		pics = Array.new(11) {|i| ""picture#{i+1}""} 
			pics.each do |p|
			if p.size > 5.megabytes
			errors.add(:picture1, ""should be less than 5 MB"")
			end
		 end
	 end
    end

The `mount_uploader`, while ugly work fine. But I can't find a way to make `picture_size` limit the size of each picture (from 1 to 11). 
   
- I can make it work using 11 times a different method or with a case operator. But i am trying to refactor.  

- I'd love to put my ""for"" loop in a method and call it but can't figure out how. if i define a method and call it all the image vanish and no file get uploaded (locally or on the S3 bucket)

","2016-02-10 10:28:54"
"13422664","refactor jquery code to one line of code","0","refactor jquery code to one line of code","2012-11-16 18:53:57"
"13422664","refactor jquery code to one line of code","0","I have this jquery code:

    $('#csv_button').attr('disabled', 'disabled').addClass(""disabled"");
    $('#excel_button').attr('disabled', 'disabled').addClass(""disabled"");
    $('#delete_button').attr('disabled', 'disabled').addClass(""disabled"");

Is possible simplify this code to one line of code?

Thank you very much!

","2012-11-16 18:53:57"
"13422664","refactor jquery code to one line of code","0","<jquery>","2012-11-16 18:53:57"
"13422664","refactor jquery code to one line of code","0","I have this jquery code:

    $('#csv_button').attr('disabled', 'disabled').addClass(""disabled"");
    $('#excel_button').attr('disabled', 'disabled').addClass(""disabled"");
    $('#delete_button').attr('disabled', 'disabled').addClass(""disabled"");

Is it possible simplify this code to one line of code?
","2012-11-16 18:56:43"
"13422664","refactor jquery code to one line of code","0","I have this jquery code:

    $('#csv_button').attr('disabled', 'disabled').addClass(""disabled"");
    $('#excel_button').attr('disabled', 'disabled').addClass(""disabled"");
    $('#delete_button').attr('disabled', 'disabled').addClass(""disabled"");

Is possible simplify this code to one line of code?
","2012-11-16 18:56:43"
"13422664","refactor jquery code to one line of code","0","","2012-11-16 18:56:43"
"43616810","refactor d3 v3 pie to version 4 unexpected behavior","0","refactor d3 v3 pie to version 4 unexpected behavior","2017-04-25 16:59:37"
"43616810","refactor d3 v3 pie to version 4 unexpected behavior","0","sample code update:

    var updateChart = function(dataset) {
    arcs = arcs.data(donut(dataset), d => d.data.label);

    arcs.exit().remove();

     arcs.enter().append(""path"")
    .attr(""stroke"", ""white"")
    .attr(""stroke-width"", 0.8)
    .attr(""fill"", function(d, i) {
      return color(i);
    }).attr(""d"", arc);
    arcs.transition()
    .duration(duration)
    .attrTween(""d"", arcTween);
    sliceLabel = sliceLabel.data(donut(dataset), d => d.data.label);
    sliceLabel.exit().remove();
    sliceLabel.enter()
    .append(""text"")
    .attr(""class"", ""arcLabel"")
    .attr(""transform"", function(d) {
      return ""translate("" + (arc.centroid(d)) + "")"";
    })
    .attr(""text-anchor"", ""middle"")
    .style(""fill-opacity"", function(d) {
      if (d.value === 0) {
        return 1e-6;
      } else {
        return 1;
      }
    })
    .text(function(d) {
      return d.data.label;
    });
     sliceLabel.transition()
    .duration(duration)
    .attr(""transform"", function(d) {
      return ""translate("" + (arc.centroid(d)) + "")"";
    })
    .style(""fill-opacity"", function(d) {
      if (d.value === 0) {
        return 1e-6;
      } else {
        return 1;
      }
    });


 







I have a pie that I refactored to version 4 and I got it to run without errors but it no longer deletes segments. Other than changes I had to make to get it to run the pie is exactly the same as the version 3 one. 

[version 4 pie][1]


For reference, here is a working one in version three:
[version 3][2]


  [1]: https://jsfiddle.net/jwaldner/tm2zqbq7/
  [2]: https://jsfiddle.net/jwaldner/0L5tkbww/










","2017-04-25 16:59:37"
"43616810","refactor d3 v3 pie to version 4 unexpected behavior","0","<d3.js>","2017-04-25 16:59:37"
"44727384","refactoring conditional statment","0","refactoring conditional statment","2017-06-23 17:56:46"
"44727384","refactoring conditional statment","0","I been trying to find a better way of writing:

This works but there must be a cleaner way right?

    public static function checkCourierCountry($courier, $country)
    {
        if (isset(self::shippingGroups()['shippingGroups']['europe']) &&
            in_array($country, self::shippingGroups()['shippingGroups']['europe'])) {
            return true;
        }
        if (isset(self::shippingGroups()['shippingGroups']['fedex']) &&
            in_array($country, self::shippingGroups()['shippingGroups']['fedex'])) {
            return true;
        }
        if (isset(self::shippingGroups()['shippingGroups']['parcelForce']) &&
            in_array($country, self::shippingGroups()['shippingGroups']['parcelForce'])) {
            return true;
        }
        return false;
    }","2017-06-23 17:56:46"
"44727384","refactoring conditional statment","0","<php><if-statement><multidimensional-array><condition>","2017-06-23 17:56:46"
"34371397","refactoring Java to get string length","0","refactoring Java to get string length","2015-12-19 13:37:15"
"34371397","refactoring Java to get string length","0","I am starting out with Java and trying to find a neat way of refactoring the below code so that I can set the `firstName` variable as a string and in the same line get and set the `firstNameLength` string length as an integer.

    String firstName = ""Boris"";
    int firstNameLength = firstName.length();

I have been trying variations of the below code but to no avail!

    int newAge = String firstName = ""Boris"".length();","2015-12-19 13:37:15"
"34371397","refactoring Java to get string length","0","<java><string><int><refactoring>","2015-12-19 13:37:15"
"20552844","refactoring array looped around another arrary for assignment","0","refactoring array looped around another arrary for assignment","2013-12-12 19:48:43"
"20552844","refactoring array looped around another arrary for assignment","0","I know this is more of PHP problem because of it's loose Typing of arrays but I see this problem all over the place in a project I took over and not sure of the best way to refactor it. Suppose you have two sets of data $results_by_entity and $target_limits and we want to check what the target is foreach result_by_entity so we can set some state

    foreach ($results_by_entity AS $result_by_entity) {
      foreach ($target_limits AS $target_limit) {
          if ($target_limit['activity_id'] == $result_by_entity['activity_id']) {
              $result_by_entity->target = $target_limit->quantity;
              $result_by_entity->progress = $target_limit->score;
          }
     }
   }

There are a couple of main problems here

1-The data is really strongly tied together, so it is really hard to refactor $results_by_entity into it's own class and $target_limits into it's own class
2-The time taken to process this grows exponentially as the data size grows

I read the Refactoring book by Martin Fowler and it was really helpful but this style of problem doesn't really show up I think mostly because his examples are in JAVA which is strongly typed. The class is super run on so really hard to debug and extend but all the data is so tied together primarily because of these types of loops so not to sure how to solve. Any recommendations would be really appreciated","2013-12-12 19:48:43"
"20552844","refactoring array looped around another arrary for assignment","0","<php><class><refactoring>","2013-12-12 19:48:43"
"20552844","refactoring array looped around another arrary for assignment","0","I know this is more of PHP problem because of it's loose Typing of arrays but I see this problem all over the place in a project I took over and not sure of the best way to refactor it. Suppose you have two sets of data, both multi dimensional arrays, $results_by_entity and $target_limits and we want to check what the target is foreach result_by_entity so we can set some state

    foreach ($results_by_entity AS $result_by_entity) {
      foreach ($target_limits AS $target_limit) {
          if ($target_limit['activity_id'] == $result_by_entity['activity_id']) {
              $result_by_entity->target = $target_limit->quantity;
              $result_by_entity->progress = $target_limit->score;
          }
     }
   }

There are a couple of main problems here

1-The data is really strongly tied together, so it is really hard to refactor $results_by_entity into it's own class and $target_limits into it's own class
2-The time taken to process this grows exponentially as the data size grows

I read the Refactoring book by Martin Fowler and it was really helpful but this style of problem doesn't really show up I think mostly because his examples are in JAVA which is strongly typed. The class is super run on so really hard to debug and extend but all the data is so tied together primarily because of these types of loops so not to sure how to solve. Any recommendations would be really appreciated","2013-12-12 20:14:21"
"22118922","refactor IF...ELSE into Nested foreach to LINQ","0","refactor IF...ELSE into Nested foreach to LINQ","2014-03-01 19:02:49"
"22118922","refactor IF...ELSE into Nested foreach to LINQ","0","I am having troubles on finding a way to refactor my nested foreach code into a Linq, mostly because it includes an IF-Else clause into it.

Below is a simplified version of my code. How do I include the IF..Else into a linq statement??

I appreciate your suggestions.

    List<hierarchy> PredomHierarchy;
    List<hierarchy> RecesesHierarchy;

    foreach x in PredomHierarchy{
    foreach y in RecesesHierarchy{	
	if(x.name = y.name)		
    {			Dosomething(x.name, y.name);				}		
    else		
    {		   	DosomethingElse(x.name, y.name);
		}
    }}





","2014-03-01 19:02:49"
"22118922","refactor IF...ELSE into Nested foreach to LINQ","0","<linq><if-statement><foreach><refactoring>","2014-03-01 19:02:49"
"22118922","refactor IF...ELSE into Nested foreach to LINQ","0","I am having troubles on finding a way to refactor my nested foreach code into a Linq, mostly because it includes an IF-Else clause into it.

Below is a simplified version of my code. How do I include the IF..Else into a linq statement??

I appreciate your suggestions.

    List<hierarchy> PredomHierarchy;
    List<hierarchy> RecesesHierarchy;

    foreach x in PredomHierarchy{
    foreach y in RecesesHierarchy{	

      if(x.name = y.name){		
 	    Dosomething(x.name, y.name);				
        } else {		
   	    DosomethingElse(x.name, y.name);
	  }
     }
    }





","2014-03-01 19:29:12"
"22118922","refactor IF...ELSE into Nested foreach to LINQ","0","","2014-03-01 19:29:12"
"12449370","refactoring from controller to model","0","refactoring from controller to model","2012-09-16 18:10:37"
"12449370","refactoring from controller to model","0","I have this action in my Order Controller:

    # POST /orders
    # POST /orders.json
    def create
      @order = Order.new(params[:order])
    
      #spostare il ciclo cart > line_items come metodo del modello Order
      cart = session[:cart]
    
      cart.each do | id, quantity |
        item = Project.find_by_id(id)
        @line_item = LineItem.new
        @line_item.project = item
        @line_item.quantity = quantity
        @line_item.price = item.price
        @order.line_items << @line_item
      end
  
      @order.user = current_user
  
      session.delete(:cart)
  
      respond_to do |format|
        if @order.save
          #Send an email to admin
          UserMailer.order_created_to_admin(@order).deliver

          format.html { redirect_to :dashboard, notice: ""L'ordine è stato creato correttamente."" }
          format.json { render json: @order, status: :created, location: @order }
        else
          format.html { render action: ""new"" }
          format.json { render json: @order.errors, status: :unprocessable_entity }
        end
      end
    end

now I want to refactor it a bit, and I'm thinking moving the following lines to Order Model as a method:

      cart.each do | id, quantity |
        item = Project.find_by_id(id)
        @line_item = LineItem.new
        @line_item.project = item
        @line_item.quantity = quantity
        @line_item.price = item.price
        @order.line_items << @line_item
      end

like that:

    class Order < ActiveRecord::Base
      attr_accessible :user_id
    
      belongs_to :user
      has_many :line_items, :dependent => :destroy
      accepts_nested_attributes_for :line_items, :allow_destroy => true

      def add_line_items_to_order_from_cart(cart) do
        cart.each do | id, quantity |
          item = Project.find_by_id(id)
          @line_item = LineItem.new
          @line_item.project = item
          @line_item.quantity = quantity
          @line_item.price = item.price
          line_items << @line_item
        end
      end
    end

and calling it from controller like:

    order.add_line_items_to_order_from_cart(cart)

Does it make sense or not in terms of ""skinny controller / fat models"" pattern?

thank you","2012-09-16 18:10:37"
"12449370","refactoring from controller to model","0","<ruby-on-rails><ruby><ruby-on-rails-3><refactoring>","2012-09-16 18:10:37"
"12449370","refactoring from controller to model","0","I have this action in my Order Controller:

    # POST /orders
    # POST /orders.json
    def create
      @order = Order.new(params[:order])
    
      #spostare il ciclo cart > line_items come metodo del modello Order
      cart = session[:cart]
    
      cart.each do | id, quantity |
        item = Project.find_by_id(id)
        @line_item = LineItem.new
        @line_item.project = item
        @line_item.quantity = quantity
        @line_item.price = item.price
        @order.line_items << @line_item
      end
  
      @order.user = current_user
  
      session.delete(:cart)
  
      respond_to do |format|
        if @order.save
          #Send an email to admin
          UserMailer.order_created_to_admin(@order).deliver

          format.html { redirect_to :dashboard, notice: ""L'ordine è stato creato correttamente."" }
          format.json { render json: @order, status: :created, location: @order }
        else
          format.html { render action: ""new"" }
          format.json { render json: @order.errors, status: :unprocessable_entity }
        end
      end
    end

now I want to refactor it a bit, and I'm thinking moving the following lines to Order Model as a method:

      cart.each do | id, quantity |
        item = Project.find_by_id(id)
        @line_item = LineItem.new
        @line_item.project = item
        @line_item.quantity = quantity
        @line_item.price = item.price
        @order.line_items << @line_item
      end

like that:

    class Order < ActiveRecord::Base
      attr_accessible :user_id
    
      belongs_to :user
      has_many :line_items, :dependent => :destroy
      accepts_nested_attributes_for :line_items, :allow_destroy => true

      def add_line_items_to_order_from_cart(cart) do
        cart.each do | id, quantity |
          item = Project.find_by_id(id)
          @line_item = LineItem.new
          @line_item.project = item
          @line_item.quantity = quantity
          @line_item.price = item.price
          line_items << @line_item
        end
      end
    end

and calling it from controller like:

    order.add_line_items_to_order_from_cart(cart)

Does it make sense or not in terms of ""skinny controller / fat models"" pattern?

thank you

EDIT

My Order model now:

    class Order < ActiveRecord::Base
      attr_accessible :user_id
    
      belongs_to :user
      has_many :line_items, :dependent => :destroy
      accepts_nested_attributes_for :line_items, :allow_destroy => true
      validates :user, :presence => :true
    
      def add_line_items_to_order_from_cart(cart)
        cart.each do | id, quantity |
          item = Project.find(id)
          line_items << LineItem.new(project: item,
                                     quantity: quantity,
                                     price: item.price)
        end
      end
    
    end","2012-09-17 16:56:08"
"42667204","refactoring - coworker interaction","0","refactoring - coworker interaction","2017-03-08 09:13:53"
"42667204","refactoring - coworker interaction","0","my only coworker used the following code execution to compile code to pdf

- compile to pdf (1st time): produce a first draft version and an .xlsx. but the only purpose is to create the .xlsx.
- compile the same file to pdf (2d time): look up in the previously created .xlsx to produce the pdf

To have the process in one pass, simplified and avoid a source of foreseeable bugs (2 pass compilation... hell), I mentioned that we could:

- reorganize the code
- use 'in-line' code functionality (code in the latex area)

his answer was something like

> well it works if you follow the step I describe so no need to change
> it and it is written in the comments that you have to compile it twice.

I had to take the time to write the step on a paper. We let non-programmer run this code to produce reports. They don't read comments.

if I refactor the code he will really be upset, because it is not the way he started with plus as mentionned it works if you follow his instruction.

did you already faced it. how did you resolved it?

thanks","2017-03-08 09:13:53"
"42667204","refactoring - coworker interaction","0","<refactoring>","2017-03-08 09:13:53"
"7106474","refactoring problem with one of my classes","0","refactoring problem with one of my classes","2011-08-18 11:12:31"
"7106474","refactoring problem with one of my classes","0","i wrote a program and i named my class StatusListActivity which extend Activity  and is the luncher and main class. I tried refactoring it by  changing the name to something else and whenever i tried to run the application, it closes please do you have an idea of what the problem was","2011-08-18 11:12:31"
"7106474","refactoring problem with one of my classes","0","<refactoring>","2011-08-18 11:12:31"
"7106474","refactoring problem with one of my classes","0","i wrote a program and i named my `class StatusListActivity` which `extend Activity`  and is the launcher and main class. I tried refactoring it by  changing the name to something else and whenever i tried to run the application, it closes please do you have an idea of what the problem was.","2011-08-18 11:38:08"
"7106474","refactoring problem with one of my classes","0","<android><refactoring>","2011-08-18 11:38:08"
"7106474","refactoring problem with one of my classes","0","<android><refactoring><android-manifest>","2011-08-19 11:39:06"
"7106474","refactoring problem with one of my classes","0","","2011-08-18 11:38:08"
"7106474","refactoring problem with one of my classes","0","","2011-08-19 11:39:06"
"12643912","refactoring a view (and inherited variables)","0","Probelm refactoring a view (and inherited variables)","2012-09-28 16:30:53"
"12643912","refactoring a view (and inherited variables)","0","I have this code view that is very hard to read and needs some refactoring:


      <div class=""tab-content"">
        <% @posts.each_with_index do |post,pi| %>
          <div class=""tab-pane fade <%= 'active in' if pi == 0 %>"" id=""<%= ""post_""+ pi.to_s %>"">
            <h2><%= post.title %></h2>
            <ul class=""thumbnails"">
              <% post.assets.each_with_index do |asset, i| %>
                <%= link_to (image_tag (asset.photo.url(:thumb))), ""#p""+pi.to_s+""a""+i.to_s, :""data-toggle"" => ""modal"", :class => ""thumbnail span2"" %>
                <div class=""modal hide fade"" id=""<%= ""p""+pi.to_s+""a""+i.to_s %>"" >
                  <div class=""modal-body"">
                    <div class=""carousel slide"" id=""<%= ""carousel_""+""p""+pi.to_s+""a""+i.to_s %>"" >
                      <div class=""carousel-inner"" >
                        <% post.assets.each_with_index do |photo, ai| %>
                          <div class=""<%= 'active ' if ai == i %>item"">
                            <%= image_tag photo.photo.url(:normal) %>
                            <div class=""carousel-caption"">
                              <h4><%= post.title %></h4>
                            </div>
                          </div>
                        <% end %>
                      </div>
                      <a class=""carousel-control left"" href=""<%= ""#carousel_""+""p""+pi.to_s+""a""+i.to_s %>"" data-slide=""prev"">&lsaquo;</a>
                      <a class=""carousel-control right"" href=""<%= ""#carousel_""+""p""+pi.to_s+""a""+i.to_s %>"" data-slide=""next"">&rsaquo;</a>
                    </div>
                  </div>
                </div>
              <% end %>
            </ul>
            <div><%= mdown(post.content) %></div>
            <p><%= raw post.tags.map(&:name).map { |t| link_to t, tag_path(t) }.join(', ') %></p>
            <p>
              <%= link_to 'Show', post %>
              <%= link_to 'Edit', edit_post_path(post) %>
              <%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } %>
            </p>
          </div>
        <% end %>
    
        <br />
    
        <%= link_to 'New Post', new_post_path %>
      </div>

Basically it lists each post, and renders each image of the post. Each image is a clickable thumbnail that pops up a modal conatining a carousel. Each carousel contains again each photo for the given post.

My idea was to move code from line 8 to line 24 and move it into a partial. The problem is that I get this error:

    undefined local variable or method `pi' for #<#<Class:0x000000023b18f0>:0x007f91ec67c458>

Is there a way to make a partial inherit a variable from the parent?","2012-09-28 16:30:53"
"12643912","refactoring a view (and inherited variables)","0","<ruby-on-rails><ruby-on-rails-3><refactoring>","2012-09-28 16:30:53"
"12643912","refactoring a view (and inherited variables)","0","refactoring a view (and inherited variables)","2017-09-23 11:15:31"
"12643912","refactoring a view (and inherited variables)","0","I have this code view that is very hard to read and needs some refactoring:

      <div class=""tab-content"">
        <% @posts.each_with_index do |post,pi| %>
          <div class=""tab-pane fade <%= 'active in' if pi == 0 %>"" id=""<%= ""post_""+ pi.to_s %>"">
            <h2><%= post.title %></h2>
            <ul class=""thumbnails"">
              <% post.assets.each_with_index do |asset, i| %>
                <%= link_to (image_tag (asset.photo.url(:thumb))), ""#p""+pi.to_s+""a""+i.to_s, :""data-toggle"" => ""modal"", :class => ""thumbnail span2"" %>
                <div class=""modal hide fade"" id=""<%= ""p""+pi.to_s+""a""+i.to_s %>"" >
                  <div class=""modal-body"">
                    <div class=""carousel slide"" id=""<%= ""carousel_""+""p""+pi.to_s+""a""+i.to_s %>"" >
                      <div class=""carousel-inner"" >
                        <% post.assets.each_with_index do |photo, ai| %>
                          <div class=""<%= 'active ' if ai == i %>item"">
                            <%= image_tag photo.photo.url(:normal) %>
                            <div class=""carousel-caption"">
                              <h4><%= post.title %></h4>
                            </div>
                          </div>
                        <% end %>
                      </div>
                      <a class=""carousel-control left"" href=""<%= ""#carousel_""+""p""+pi.to_s+""a""+i.to_s %>"" data-slide=""prev"">&lsaquo;</a>
                      <a class=""carousel-control right"" href=""<%= ""#carousel_""+""p""+pi.to_s+""a""+i.to_s %>"" data-slide=""next"">&rsaquo;</a>
                    </div>
                  </div>
                </div>
              <% end %>
            </ul>
            <div><%= mdown(post.content) %></div>
            <p><%= raw post.tags.map(&:name).map { |t| link_to t, tag_path(t) }.join(', ') %></p>
            <p>
              <%= link_to 'Show', post %>
              <%= link_to 'Edit', edit_post_path(post) %>
              <%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } %>
            </p>
          </div>
        <% end %>
    
        <br />
    
        <%= link_to 'New Post', new_post_path %>
      </div>

Basically it lists each post, and renders each image of the post. Each image is a clickable thumbnail that pops up a modal conatining a carousel. Each carousel contains again each photo for the given post.

My idea was to move code from line 8 to line 24 and move it into a partial. The problem is that I get this error:

    undefined local variable or method `pi' for #<#<Class:0x000000023b18f0>:0x007f91ec67c458>

Is there a way to make a partial inherit a variable from the parent?","2017-09-23 11:15:31"
"36338222","refactory might be done unproperly","0","refactory might be done properly","2016-03-31 15:55:50"
"36338222","refactory might be done unproperly","0","I am a beginner trying to learn Grails 3.1. Regarding to the default, I add the following scratch on the index page:

    <ul>
        <g:each var=""c"" in=""${grailsApplication.controllerClasses.sort { it.fullName } }"">
            <li class=""controller"">
                            <g:link controller=""${c.logicalPropertyName}"">${c.fullName}</g:link>
            </li>
        </g:each>
    </ul>
At the beginning, the index page shows **no controller**. Then, I create another controller, **TodosController** for instance. Because this controller name is not nice somehow, so I want to rename it (of course, using refactory feature in Intellij IDEA) into **TodoListController**. Unfortunately, the code still remains two controllers and shows them in the index page. When I click on the link of **TodosController**, I get the error:

    Could not resolve view with name '/todos/index' in servlet with name 'grailsDispatcherServlet'

Snapshot of the error is below.
[![Could not resolve view][1]][1]
I spend many times to find out where it is, but no magic thing happens to me.
Anyone got such a situation?

  [1]: http://i.stack.imgur.com/3QiOh.png","2016-03-31 15:55:50"
"36338222","refactory might be done unproperly","0","<grails><intellij-idea><controller><grails-3.1><urlmappings.groovy>","2016-03-31 15:55:50"
"36338222","refactory might be done unproperly","0","refactory might be done unproperly","2016-03-31 15:57:04"
"20169236","refactor a ruby method","0","refactor a ruby method","2013-11-23 23:31:53"
"20169236","refactor a ruby method","0","I seem to be writing quite a few methods with the following pattern and it seems like there should be a better way.  Is there a one-liner for this or a better practice?

    def combine_roster(roster)
      rstr = []
      roster.each do |r|
        rstr << r.user
      end
      rstr
    end","2013-11-23 23:31:53"
"20169236","refactor a ruby method","0","<ruby-on-rails><ruby><methods><refactoring>","2013-11-23 23:31:53"
"5135371","refactoring a controller query with If/else","0","refactoring a controller query with If/else","2011-02-27 19:27:32"
"5135371","refactoring a controller query with If/else","0","This is what my index action currently looks like. If the current_user is not enrolled to any courses it lists all courses. If he is enrolled to any, it only lists the other ones. Is this a good way to get the needed records or is there a nicer way? Any suggestions? Thx for your time!

    if current_user.courses.empty?
      @courses = Course.all
    else
      @courses = Course.where(""id not in (?)"", current_user.courses)
    end","2011-02-27 19:27:32"
"5135371","refactoring a controller query with If/else","0","<ruby-on-rails><ruby-on-rails-3><activerecord>","2011-02-27 19:27:32"
"5542598","refactoring an array","0","refactoring an array","2011-04-04 18:22:20"
"5542598","refactoring an array","0","I have the following result in AMFPHP from a sql query:

    (Array)#0
      [0] (Object)#1
        id = ""1""
        naam = ""4 kazen""
        pizzeria_id = ""1""
        pizzerianaam = ""Howest pizza""
        prijs = ""11""
      [1] (Object)#2
        id = ""2""
        naam = ""Napolitano""
        pizzeria_id = ""1""
        pizzerianaam = ""Howest pizza""
        prijs = ""13""
      [2] (Object)#3
        id = ""5""
        naam = ""pizza bolognaise""
        pizzeria_id = ""2""
        pizzerianaam = ""Nicola pizza""
        prijs = ""12""
      [3] (Object)#4
        id = ""6""
        naam = ""pizza funghi""
        pizzeria_id = ""2""
        pizzerianaam = ""Nicola pizza""
        prijs = ""16""

what i would like to do is refactor this array so the result is a  assosiative array with 2 arrays inside of it, the 2 arrays should be called after the ""pizzerianaam"" and within the ""pizzerianaam"" i should see the pizza's where the ""pizzerianaam"" matches.

so an array with 2 arrays in it wich contains other arrays for each pizza where the ""pizzerianaam"" value matches.

Anyone who ca help?
","2011-04-04 18:22:20"
"5542598","refactoring an array","0","<php><amfphp>","2011-04-04 18:22:20"
"5987833","refactoring a complex dynamic active relation query","0","refactoring a complex dynamic active relation query","2011-05-13 06:02:23"
"5987833","refactoring a complex dynamic active relation query","0","I was wondering if I could some refactoring help to make this query more concise.

Basically what this query does is it searches all the help_documents by some search terms. It checks the document question, content and the category it belongs to.

      def self.search(text)
        if text.blank?
          latest
        else
          relation = sorted.joins(:category)
    
          text.split(/\s/).each do |word|
            relation = relation.where(
                ""lower(help_documents.question) like ? or lower(help_documents.content) like ? or lower(help_categories.name) like ?"",
                ""%#{word.downcase}%"", ""%#{word.downcase}%"", ""%#{word.downcase}%""
            )
          end
    
          relation
        end
      end

Compared to how you would do this in java/hibernate, this actually looks pretty good. But I figured the rails people might have even sexier tricks up their sleeve to accomplish the same thing. For example, there might be some methods/objects I don't know about that already do these types of things.","2011-05-13 06:02:23"
"5987833","refactoring a complex dynamic active relation query","0","<ruby-on-rails><ruby><activerecord><refactoring>","2011-05-13 06:02:23"
"5987833","refactoring a complex dynamic active relation query","0","I was wondering if I could get some refactoring help to make this query more concise.

Basically what this query does is it searches all the help_documents by some search terms. It checks the document question, content and the category it belongs to.

      def self.search(text)
        if text.blank?
          latest
        else
          relation = sorted.joins(:category)
    
          text.split(/\s/).each do |word|
            relation = relation.where(
                ""lower(help_documents.question) like ? or lower(help_documents.content) like ? or lower(help_categories.name) like ?"",
                ""%#{word.downcase}%"", ""%#{word.downcase}%"", ""%#{word.downcase}%""
            )
          end
    
          relation
        end
      end

Compared to how you would do this in java/hibernate, this actually looks pretty good. But I figured the rails people might have even sexier tricks up their sleeve to accomplish the same thing. For example, there might be some methods/objects I don't know about that already do these types of things.","2011-05-13 08:12:06"
"1918604","refactoring best practices for both PHP and Ruby on Rails","0","refactoring best practices for both PHP and Ruby on Rails","2009-12-16 23:44:24"
"1918604","refactoring best practices for both PHP and Ruby on Rails","0","Wondering if someone can suggest a refactoring 'best practice' or more ideally a ""check-list"" that we can go through and refactor against common issues.  

Some of these ideas were pretty good:  http://my.safaribooksonline.com/9780321620293

But looking for more.

Thanks.","2009-12-16 23:44:24"
"1918604","refactoring best practices for both PHP and Ruby on Rails","0","<refactoring>","2009-12-16 23:44:24"
"1918604","refactoring best practices for both PHP and Ruby on Rails","0","<refactoring><php><ruby-on-rails>","2009-12-16 23:48:54"
"25973785","refactor method with two foreach loops","0","refactor method with two foreach loops","2014-09-22 12:08:52"
"25973785","refactor method with two foreach loops","0","I run into refactoring problem. I have many similar methods, but i cannot find way to extract one line form them and make another private method.

    private function constructRules($rules, \Languages $langs) {
        foreach ($rules as $fieldType => $rule) {
            foreach ($langs->all() as $lang) {
               //line below changes
                $langRules[$fieldType . '[' . $lang->lang . ']'] = $rule; 
            }       
        }

        return $langRules;
    }
I have these foreach loops in 4 different places. If i extact foreach loops and return array, I still need to make one foreach loop in method, to fill $langRules in this example. Maybe there are simple way to do it, but I am not able to see it...","2014-09-22 12:08:52"
"25973785","refactor method with two foreach loops","0","<php><arrays><foreach><refactoring>","2014-09-22 12:08:52"
"25973785","refactor method with two foreach loops","0","{""Voters"":[{""Id"":212107,""DisplayName"":""Gerald Schneider""},{""Id"":2144390,""DisplayName"":""Gord Thompson""},{""Id"":920371,""DisplayName"":""fivedigit""},{""Id"":526582,""DisplayName"":""Jonas Schnelli""},{""Id"":379855,""DisplayName"":""Donal""}]}","2014-09-22 15:29:07"
"44247588","refactor code to upload multiple images swift 3","0","refactor code to upload multiple images swift 3","2017-05-29 17:15:16"
"44247588","refactor code to upload multiple images swift 3","0","I have some code I am writing in swift, I want to upload multiple images and was wondering if I can refactor the code I have to allow multiple images to be checked. 

below is my code. I want to add 8 images to firebase at once.

    	guard let image1 = picture1.image else {
			print(""Tony: No image selected"")
			return
		}

        guard let image2 = picture2.image else {
			print(""Tony: No image selected"")
			return
		}		

		if let imageData = UIImageJPEGRepresentation(image1, 0.2) {
			
			let imageUid = NSUUID().uuidString
			let metadata = StorageMetadata()
			metadata.contentType = ""image/jpeg""
			DataService.ds.REF_POST_IMAGES.child(imageUid).putData(imageData, metadata: metadata, completion: { (metadata, error) in
				if error != nil {
					print(""Tony: Unable to upload image to Firebase storage"")
				}else {
					print(""Tony: Successfully uploaded image to Firebase storage"")
					let downloadURL = metadata?.downloadURL()?.absoluteString
				}
			})
			alertPlate()
		}
	}","2017-05-29 17:15:16"
"44247588","refactor code to upload multiple images swift 3","0","<swift><xcode><image>","2017-05-29 17:15:16"
"43619317","refactoring code to keep large objects/models in memory in iPython to be reused in python scripts","0","refactoring code to keep large objects/models in memory in iPython to be reused in python scripts","2017-04-25 19:25:34"
"43619317","refactoring code to keep large objects/models in memory in iPython to be reused in python scripts","0","Script I depend on loads lots of variables in a minute and uses them globally in many functions. Everytime I call that script in iPython, it loads them again taking time. 
I tried to take these calls to load and populate functions out of that script, but then these global variables are not available to the functions in the script. 
It gives ```NameError: name 'clf' is not defined``` error message.
Is there a best way to refactor this code to keep these globals in memory and make the script use them? The script loads many variables like these, and uses them in other functions as globals. 
```vectorizer_title, vectorizer_desc, clf, df_instance, vocab, all_tokens, df_dist_all, df_soc2class_proba, dict_p2s, dict_f2m, token_pattern, cleanup_pattern, excluded_words = load_data_and_model(lang)
dict_token2idx_all, dict_token2idx_instance, dist_array,token_dist_to_instance_min, dict_bigram_by_instance,denominate, similar_threshold = populate_data(1)```","2017-04-25 19:25:34"
"43619317","refactoring code to keep large objects/models in memory in iPython to be reused in python scripts","0","<python>","2017-04-25 19:25:34"
"43619317","refactoring code to keep large objects/models in memory in iPython to be reused in python scripts","0","My script depends on loading lots of variables in a minute and uses them globally in many functions. Every time I call that script in iPython, it loads them again, taking time. 

I tried to take these calls to load and populate functions out of that script, but then these global variables are not available to the functions in the script. 
It gives ```NameError: name 'clf' is not defined``` error message.

Is there a best way to refactor this code to keep these globals in memory and make the script use them? The script loads many variables like these, and uses them in other functions as globals. 

```vectorizer_title, vectorizer_desc, clf, 
df_instance, vocab, all_tokens, df_dist_all, 
df_soc2class_proba, dict_p2s, 
dict_f2m, token_pattern, cleanup_pattern, 
excluded_words = load_data_and_model(lang)
dict_token2idx_all, dict_token2idx_instance, 
dist_array, token_dist_to_instance_min, 
dict_bigram_by_instance, denominate, 
similar_threshold = populate_data(1)```","2017-04-25 20:17:33"
"43619317","refactoring code to keep large objects/models in memory in iPython to be reused in python scripts","0","<python><ipython>","2017-04-25 20:17:33"
"43619317","refactoring code to keep large objects/models in memory in iPython to be reused in python scripts","0","","2017-04-25 20:17:33"
"37887740","refactor duplicate code - only difference is a < sign","0","refactor duplicate code - only difference is a < sign","2016-06-17 18:05:47"
"37887740","refactor duplicate code - only difference is a < sign","0","Class Test is `abstract`. It contains a basic testname and a score. This score (double) is accessible through a property named TestScore. 

Three kind of classes inherit from Test. They are as such different that each kind of test has a different way of rating a score.

**Aim**: Rate a score with one of 6 ratings based on a range of values in between of which the score can be.

    class ScoreRangeAscendingTest : Test
    {
        public ScoreRangeAscendingTest(double score, Enums.TestType typeName) : base(score, typeName) { }
        public double[] ranges;
        public Enums.Rating calculateScore(double[] range)
        {
            if (scoreInVeryWeakRange())
                return Enums.Rating.VeryWeak;
            else if (scoreInWeakRange())
                return Enums.Rating.Weak;
            else if (scoreInAveragelyWeakRange())
                return Enums.Rating.AveragelyWeak;
            else if (scoreInAveragelyGoodRange())
                return Enums.Rating.AveragelyGood;
            else if (scoreInGoodRange())
                return Enums.Rating.Good;
            else 
                return Enums.Rating.VeryGood;
        }

        private bool scoreInVeryWeakRange()
        {
            return this.TestScore < ranges[(int)Enums.Border.P10];
        }
        private bool scoreInWeakRange()
        {
            return TestScore >= ranges[(int)Enums.Border.P10] && TestScore < ranges[(int)Enums.Border.P25];
        }
        private bool scoreInAveragelyWeakRange()
        {
            return TestScore >= ranges[(int)Enums.Border.P25] && TestScore < ranges[(int)Enums.Border.P50];
        }
        private bool scoreInAveragelyGoodRange()
        {
            return TestScore >= ranges[(int)Enums.Border.P50] && TestScore < ranges[(int)Enums.Border.P75];
        }
        private bool scoreInGoodRange()
        {
            return TestScore >= ranges[(int)Enums.Border.P75] && TestScore < ranges[(int)Enums.Border.P90];
        }
        private bool scoreInVeryGoodRange()
        {
            return TestScore > ranges[(int)Enums.Border.P90];
        }

    }
}
    
**The problem**: I have tests whose corresponding ranges go up and tests whose corresponding ranges go down. So I need to write the exact same code for the second type of test, but this time, all the '<' signs need to be '>' signs and vice versa. 

**Question**: how can I avoid duplicating this code? is there a possibility to add it to the base class?","2016-06-17 18:05:47"
"37887740","refactor duplicate code - only difference is a < sign","0","<c#><polymorphism>","2016-06-17 18:05:47"
"36500973","refactor a pythonic recursive filter for dict","0","refactor a pythonic recursive filter for dict","2016-04-08 13:33:41"
"36500973","refactor a pythonic recursive filter for dict","0","Now I have a piece of codes as follows:


    def checker(dict_element, dict_filter):
        global counter
        counter = 0
    
        def fullfill_filter(key, value):
            if key in dict_filter:
                if value in dict_filter[key]:
                    return True
    
        def extract_dict(dict_element):
            global counter
    
            for key, value in dict_element.items():
                if isinstance(value, str):
                    if fullfill_filter(key, value):
                        counter += 1
                elif isinstance(value, dict): 
                    extract_dict(value)
                elif isinstance(value, list):
                    extract_list(key, value)
    
        def extract_list(key, list_element):
            global counter
    
            for el in list_element:
                if isinstance(el, dict):
                    extract_dict(el)
                if isinstance(el, list):
                    extract_list(el)
                if isinstance(el, str):
                    if fullfill_filter(key, el):
                        counter += 1
    
        extract_dict(dict_element)
        
        if counter == len(dict_filter.keys()):
            return True
        return False

It is used to filter a dictionary `dict_element` contains various types of object, and I want to find the right one according to what I have in the dict_filter.

For example I have a dictionary have two sub dictionary as follows:

    dict_element = {
    	{
    		'services': [],
    		'location': {
    			'latitude': '51.026',
    			'country': 'Germany',
    			'longitude': '13.725'
    		},
    		'available': 'true',
    		'technologies': ['Virtual Machines', 'Distributed Systems', 'Internet', 'Wired'],
    		'type': 'node',
    		'exclusive': 'false',
    		'types': [{
    			'disk_images': [{
    				'version': 'f22',
    				'os': 'Linux',
    				'name': 'Fedora f22'
    			}],
    
    		}]
    	}, {
    		'services': [],
    		'location': {
    			'latitude': 'unknown',
    			'country': 'Taiwan',
    			'longitude': 'unknown'
    		},
    		'available': 'false',
    		'technologies': ['Virtual Machines', 'Distributed Systems', 'Internet', 'Wired'],
    		'type': 'node',
    		'exclusive': 'false',
    		'types': [{
    			'disk_images': [{
    				'version': 'f24',
    				'os': 'Linux',
    				'name': 'Fedora f24'
    			}],
    		}]
    	}
    }

If I do as ```checker(dict_element, dict_filter = {'avaliable': 'true', 'country':'Germany'})``` or ```checker(dict_element, {'version': 'f22'}```, I can filter out the second case and get the first dict, However, as you can see the codes is ugly and badly naming(not a native English speaker), is there a better and cleaner way to refactor it in pythonic way?","2016-04-08 13:33:41"
"36500973","refactor a pythonic recursive filter for dict","0","<python><dictionary><recursion><refactoring>","2016-04-08 13:33:41"
"36500973","refactor a pythonic recursive filter for dict","0","Now I have a piece of codes as follows:


    def checker(dict_element, dict_filter):
        global counter
        counter = 0
    
        def fullfill_filter(key, value):
            if key in dict_filter:
                if value in dict_filter[key]:
                    return True
    
        def extract_dict(dict_element):
            global counter
    
            for key, value in dict_element.items():
                if isinstance(value, str):
                    if fullfill_filter(key, value):
                        counter += 1
                elif isinstance(value, dict): 
                    extract_dict(value)
                elif isinstance(value, list):
                    extract_list(key, value)
    
        def extract_list(key, list_element):
            global counter
    
            for el in list_element:
                if isinstance(el, dict):
                    extract_dict(el)
                if isinstance(el, list):
                    extract_list(el)
                if isinstance(el, str):
                    if fullfill_filter(key, el):
                        counter += 1
    
        extract_dict(dict_element)
        
        if counter == len(dict_filter.keys()):
            return True
        return False

It is used to filter a dictionary `dict_element` contains various types of object, and I want to find the right one according to what I have in the dict_filter.

For example I have a dictionary have two sub dictionary as follows:

    list = [
    	{
    		'services': [],
    		'location': {
    			'latitude': '51.026',
    			'country': 'Germany',
    			'longitude': '13.725'
    		},
    		'available': 'true',
    		'technologies': ['Virtual Machines', 'Distributed Systems', 'Internet', 'Wired'],
    		'type': 'node',
    		'exclusive': 'false',
    		'types': [{
    			'disk_images': [{
    				'version': 'f22',
    				'os': 'Linux',
    				'name': 'Fedora f22'
    			}],
    
    		}]
    	}, {
    		'services': [],
    		'location': {
    			'latitude': 'unknown',
    			'country': 'Taiwan',
    			'longitude': 'unknown'
    		},
    		'available': 'false',
    		'technologies': ['Virtual Machines', 'Distributed Systems', 'Internet',],
    		'type': 'node',
    		'exclusive': 'false',
    		'types': [{
    			'disk_images': [{
    				'version': 'f24',
    				'os': 'Linux',
    				'name': 'Fedora f24'
    			}],
    		}]
    	}
    ]

If I do as```[checker(dict, dict_filter = {'avaliable': 'true', 'country':'Germany'}) for dict in list]``` 
or ```[checker(dict, {'version': 'f22'}) for dict in list]```
or ```[checkert(dict, {technologies: 'Wired'} for dict in list]```
, I can filter out the second case and get the first dict, However, as you can see the codes is ugly and badly naming(not a native English speaker), is there a better and cleaner way to refactor it in pythonic way?","2016-04-08 13:46:08"
"46542385","refactoring spring boot application to use npm modules","0","refactoring spring boot application to use npm modules","2017-10-03 10:24:45"
"46542385","refactoring spring boot application to use npm modules","0","I had a spring boot application referencing js files from resources/static folder. I installed node modules in that application in the root of the project. Can i load npm downloaded modules in java spring boot application ? How shall i reference the js libraries in html files of the application ?","2017-10-03 10:24:45"
"46542385","refactoring spring boot application to use npm modules","0","<spring-boot><npm>","2017-10-03 10:24:45"
"46542385","refactoring spring boot application to use npm modules","0","I had a spring boot application referencing JS files from resources/static folder. I installed node modules in that application in the root of the project. Can I load `npm` downloaded modules in java spring boot application ? How shall I reference the JS libraries in html files of the application ?","2017-10-03 12:45:57"
"29707139","refactor code for big value","0","refactor code for big value","2015-04-17 18:45:39"
"29707139","refactor code for big value","0","I want to use this code to convert bytes into proper values 

    import java.util.*;
    import java.lang.*;
    import java.io.*;
    import java.text.DecimalFormat;
    
    public class Ideone
    {
    
        public static void main (String[] args) throws java.lang.Exception
        {
            String readableFileSize = readableFileSize(9394343298L);
            System.out.println(""Result "" + readableFileSize);
        }
    
    
    
        public static String readableFileSize(long size)
        {
                if (size <= 0)
                    return ""0"";
                final String[] units = new String[]
                {
                    ""B"", ""kB"", ""MB"", ""GB"", ""TB""
                };
                int digitGroups = (int) (Math.log10(size) / Math.log10(1024));
                return new DecimalFormat(""#,##0.#"").format(size / Math.pow(1024, digitGroups)) + "" "" + units[digitGroups];
        }
    }

The lode works but I have to place L after the number. In my case I use closed source library which when I use it I can't add L. Is there any way to refactor to code to convert very big values into proper format?","2015-04-17 18:45:39"
"29707139","refactor code for big value","0","<java><long-integer>","2015-04-17 18:45:39"
"5130592","refactoring will_paginate attributes in a controller query","0","refactoring will_paginate attributes in a controller query","2011-02-27 00:09:33"
"5130592","refactoring will_paginate attributes in a controller query","0","Hey. I am using the following line over and over in my controller index queries. Does it makes sense to create a new application method to re-use it? Any suggestions on how I could extract this and perhaps pass the `:per_page` attribute a variable parameter? 


    paginate :page => params[:page], :per_page => 12

Thanks for your time!","2011-02-27 00:09:33"
"5130592","refactoring will_paginate attributes in a controller query","0","<ruby-on-rails><ruby-on-rails-3><refactoring><helper>","2011-02-27 00:09:33"
"5863730","refactor accessing child controls in ASP.NET?","0","refactor accessing child controls in ASP.NET?","2011-05-02 23:59:18"
"5863730","refactor accessing child controls in ASP.NET?","0","Is there any way to refactor this:

    placeholder1.Controls[0].Controls[0].Controls[0].Controls[0].Controls[1].Controls[1].Controls[1].ClientID.ToString();

Thanks
","2011-05-02 23:59:18"
"5863730","refactor accessing child controls in ASP.NET?","0","<asp.net>","2011-05-02 23:59:18"
"5863730","refactor accessing child controls in ASP.NET?","0","> **Possible Duplicate:**  
> [Better way to find control in ASP.NET](http://stackoverflow.com/questions/4955769/better-way-to-find-control-in-asp-net)  

<!-- End of automatically inserted text -->

Hi,

Is there any way to refactor this:

    placeholder1.Controls[0].Controls[0].Controls[0].Controls[0].Controls[1].Controls[1].Controls[1].ClientID.ToString();

Thanks
","2011-05-04 21:09:16"
"5863730","refactor accessing child controls in ASP.NET?","0","> **Possible Duplicate:**  
> [Better way to find control in ASP.NET](https://stackoverflow.com/questions/4955769/better-way-to-find-control-in-asp-net)  

<!-- End of automatically inserted text -->

Hi,

Is there any way to refactor this:

    placeholder1.Controls[0].Controls[0].Controls[0].Controls[0].Controls[1].Controls[1].Controls[1].ClientID.ToString();

Thanks
","2017-05-23 12:12:02"
"5863730","refactor accessing child controls in ASP.NET?","0","{""OriginalQuestionIds"":[4955769],""Voters"":[{""Id"":22303,""DisplayName"":""Kon""},{""Id"":97010,""DisplayName"":""Muhammad Akhtar""},{""Id"":417057,""DisplayName"":""VinayC""},{""Id"":76337,""DisplayName"":""John Saunders""},{""Id"":131433,""DisplayName"":""bmargulies""}]}","2011-05-04 21:09:16"
"7302745","refactoring code in symfony","0","refactoring code in symfony","2011-09-04 23:25:06"
"7302745","refactoring code in symfony","0","    if (!$this->getUser()->isAuthenticated())
    {
      $this->redirect('login/index');
    }

i would like add this code for many actions in different modules. I must copy this code for each action? I would like make somethings:


    //module 
    
    class Invite
    public function executeIndex {
     sfConfig:get('redirect');
    }
    
    
    class Home
    public function executeIndex {
     sfConfig:get('redirect');
    }
    
    public function executeShow {
      sfConfig:get('redirect');
    }


if  can't be in different modules, although it might in a single?
","2011-09-04 23:25:06"
"7302745","refactoring code in symfony","0","<php><symfony1><symfony-1.4>","2011-09-04 23:25:06"
"22691648","refactoring code that contains ""button addTarget""","0","refactoring code that contains ""button addTarget""","2014-03-27 15:07:09"
"22691648","refactoring code that contains ""button addTarget""","0","I have a lot of places of a code that changes a view in UINavigationBar.  
So the code is something like this:

    UIButton *butt2=[UIButton buttonWithType:UIButtonTypeCustom ];
    
    [butt2 setFrame:CGRectMake(285, 7, 30, 25)];
    [butt2 setTag:2];
    [butt2 setImage:[UIImage imageNamed:@""tag_icon.png""] forState:UIControlStateNormal];
    [butt2 addTarget:self action:@selector(revealMenu:) forControlEvents:UIControlEventTouchDown];
    [self.navigationController.navigationBar addSubview:butt2] ;

I want to create a method that gets argument of the different things in the code which is:  
1. the image (easy)  
2. The action of the button - **AHA! This one I couldn't figure out how to do**","2014-03-27 15:07:09"
"22691648","refactoring code that contains ""button addTarget""","0","<ios><refactoring>","2014-03-27 15:07:09"
"33232685","refactoring error in maven","0","refactoring error in maven","2015-10-20 09:18:16"
"33232685","refactoring error in maven","0","I have one parent project with its 4 child (project) in maven.But when i am going to execute that one.it gives following plugin in error.How could i resolve this error??plz help me
    
    1.Unable to update index for central|http://repo1.maven.org/maven2 
    2.plug in 'org.maven.ide.eclipse.refactoring' contributed an invalid Menu extension
    
    
    Parent project pom.xml is
    
    <project xmlns=""http://maven.apache.org/POM/4.0.0"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"">
        <modelVersion>4.0.0</modelVersion>
          <groupId>com.te.sss</groupId>
          <artifactId>iin</artifactId>
          <version>0.0.1-SNAPSHOT</version>
          <packaging>pom</packaging>
          <name>iin</name>
          <description>parent</description>
          <modules>
          <module>../commons</module>
          <module>../dao</module>
          <module>../core</module>
          <module>../web</module>
          </modules>  
        </project>","2015-10-20 09:18:16"
"33232685","refactoring error in maven","0","<java><maven>","2015-10-20 09:18:16"
"33232685","refactoring error in maven","0","<java><eclipse><maven>","2015-10-20 09:32:59"
"33232685","refactoring error in maven","0","","2015-10-20 09:32:59"
"34523093","refactor SQL select statement","0","refactor SQL select statement","2015-12-30 04:53:03"
"34523093","refactor SQL select statement","0","I have a bunch of `select` statements

    select A, B, C, D into #temp_table from TableA where C>1 and C<10 order by A
    select distinct A into #temp_two from #temp_table where B like '%term' 
    select E.B from #temp_table E, #temp_two F where F.A = E.A

Can the above be combined into one select statement through a series of joins etc without using temp tables? I don't like the idea of using temp tables.

Don't have to show me the exact answer, but just some hints will do. 

thanks","2015-12-30 04:53:03"
"34523093","refactor SQL select statement","0","<sql><jdbc><sybase>","2015-12-30 04:53:03"
"41774264","refactoring a file and a folder into a new git repository","0","refactoring a file and a folder into a new git repository","2017-01-21 00:02:09"
"41774264","refactoring a file and a folder into a new git repository","0","I followed the potential solution in 

http://stackoverflow.com/questions/359424/detach-move-subdirectory-into-separate-git-repository/17864475#17864475

My requirement is similar but only slightly different Hope someone could provide some easy solution.

say I have the following repo

tree ~/Code/node-browser-compat

node-browser-compat

├── ArrayBuffer

├── Audio

├── Blob

├── FormData

├── atob

├    ├──aaa.xyz 

├── btoa

├── location

└── navigator

I want to have a new repo abcd which has all of btoa and aaa.xyz in it while retaining the history of both btoa and aaa.xyz.
Any help will be highly appreciated.
Note: If I already have an empty repo called abcd, instructions to moving btoa and aaa.xyz into abcd will also help.","2017-01-21 00:02:09"
"41774264","refactoring a file and a folder into a new git repository","0","<git><github>","2017-01-21 00:02:09"
"41774264","refactoring a file and a folder into a new git repository","0","I followed the potential solution in 

https://stackoverflow.com/questions/359424/detach-move-subdirectory-into-separate-git-repository/17864475#17864475

My requirement is similar but only slightly different Hope someone could provide some easy solution.

Say I have the following repo:

    node-browser-compat
    ├── ArrayBuffer
    ├── Audio
    ├── Blob
    ├── FormData
    ├── atob
    ├    ├──aaa.xyz 
    ├── btoa
    ├── location
    └── navigator

I want to have a new repo `abcd` which has all of `btoa` and `aaa.xyz` in it while retaining the history of both `btoa` and `aaa.xyz`.
Any help will be highly appreciated.

Note: If I already have an empty repo called `abcd`, instructions to moving `btoa` and `aaa.xyz` into `abcd` will also help.
","2017-05-23 10:29:18"
"41774264","refactoring a file and a folder into a new git repository","0","I followed the potential solution in 

http://stackoverflow.com/questions/359424/detach-move-subdirectory-into-separate-git-repository/17864475#17864475

My requirement is similar but only slightly different Hope someone could provide some easy solution.

Say I have the following repo:

    node-browser-compat
    ├── ArrayBuffer
    ├── Audio
    ├── Blob
    ├── FormData
    ├── atob
    ├    ├──aaa.xyz 
    ├── btoa
    ├── location
    └── navigator

I want to have a new repo `abcd` which has all of `btoa` and `aaa.xyz` in it while retaining the history of both `btoa` and `aaa.xyz`.
Any help will be highly appreciated.

Note: If I already have an empty repo called `abcd`, instructions to moving `btoa` and `aaa.xyz` into `abcd` will also help.
","2017-01-21 00:19:16"
"38829990","refactor angular-route to angular-ui-router","0","refactor angular-route to angular-ui-router","2016-08-08 13:05:02"
"38829990","refactor angular-route to angular-ui-router","0","I've created a single page application using ngRoute like so:

index.html (ngRoute)

    var smallTalkzModel = angular.module('smallTalkzModel', ['ngRoute']);
    smallTalkzModel.config(function($routeProvider) {
    
        $routeProvider
        .when('/', {
          templateUrl : 'components/login/loginView.html',
          controller  : 'loginController'
        }) 
        .when('/chat', {
          templateUrl : 'components/chat/chatView.html',
          controller  : 'chatController'
        });
      }).run(function ($rootScope) {
    
        // App is loading, so set isAppLoading to true and start a timer
        console.log($rootScope);
        $rootScope.isAppLoading = true;
    
      });;

small-talkz.model.js (ngRoute)

     <div ng-app=""smallTalkzModel"" >
     	<div ng-view>
     	</div>
     
     </div>

Then I heard that it is better to use ui.router because it is a 3rd party which have more capabilities and can does everything that ngRoute does and more and will be supported in future version of angular js...

So, I tried to refactore my code into the code below. which does not work...

Can anyone tell me why? I did not use ng-surf because I don't have any links into my html. I get to them by localhost:3000/somePage and not by navigation...

index.html (ui.router)

 	<div ng-app=""smallTalkzModel"" class=""loader"">
 		<div ui-view>
 		</div>
 	</div>

small-talkz.model.js (ui.router)

    var smallTalkzModel = angular.module('smallTalkzModel', ['ui.router']);
    smallTalkzModel.config(function($stateProvider, $urlRouterProvider) {
    
      $stateProvider
      .state('login', {
        url: '/',
        templateUrl : 'components/login/loginView.html',
        controller  : 'loginController'
      }) 
      .state('chat', {
        url: '/chat',
        templateUrl : 'components/chat/chatView.html',
        controller  : 'chatController'
      });
    });;


","2016-08-08 13:05:02"
"38829990","refactor angular-route to angular-ui-router","0","<javascript><html><angularjs>","2016-08-08 13:05:02"
"23475777","refactor node-mysql callback for KOA and co-mysql with generators","0","refactor node-mysql callback for KOA and co-mysql with generators","2014-05-05 15:05:55"
"23475777","refactor node-mysql callback for KOA and co-mysql with generators","0","I am doing queries like below in existings apps and would like some advice/example on how to refactor this for KOA + co-mysql with generators avoiding or simplifying the chained functions with the sql calls. JS is fine, of course, I use a nodejs 0.11 and a CS version that supports generators. Still trying to get the hang of the 'new way'.

Thanks, K
  
    client = mysql.createPool(mysql_options)
    getSql = (sql, callback) ->
      client.query sql, (err, rows, fields) ->
        if err  #mysql error handling
          if err.code isnt 'PROTOCOL_CONNECTION_LOST'
            console.log 'Mysql Error <> Conn.Lost: ',err.stack
            process.on ""uncaughtException"", (err) ->
              console.log ""getSql Mysql Error Caught Exception: "", err.stack
              return
          else
            setTimeout ->
              console.log 'Connection Lost; Re-connecting lost client (restart delay): ',err.stack
              client = mysql.createPool(mysql_options)
              return
            , 700
        client.release
        callback rows
     
        q10 = ->         # and in the routes...
          sql = ""select count(*) as custCount from cust01 where sessionid = '"" +  prSid + ""' and custNum = "" + ""'"" + sessionLoginUser + ""'""
          getSql sql, (results) ->
            q20(results[0].custCount)

        q20 = (custCount) ->
         ....etc etc

        q10()

","2014-05-05 15:05:55"
"23475777","refactor node-mysql callback for KOA and co-mysql with generators","0","<mysql><node.js><koa>","2014-05-05 15:05:55"
"23349464","refactoring tests that use assert_raises","0","refactoring tests that use assert_raises","2014-04-28 19:19:48"
"23349464","refactoring tests that use assert_raises","0","I have a test block:

    describe 'without' do

      describe 'author' do
        let(:author)  {nil}
        it('fails')   {assert_raises(ArgumentError) { excerpt }}
      end

      describe 'title' do
        # same content as above, but testing title
      end

      describe 'content' do
        # same content as above, but testing content
      end

    end

This works fine and the tests pass - but since there's a lot of repetition here, I wanted to refactor:

    describe 'without' do

      describe 'author' do
        let(:author)  {nil}
        it('fails')   {assert_failure(excerpt} # added a method in this line
      end

      describe 'title' do
        # same content as above, but testing title
      end

      describe 'content' do
        # same content as above, but testing content
      end

      # and the method here
      def assert_failure(instance)
        assert_raises(ArgumentError) { instance }
      end

    end

However this doesn't work - my tests fail with the following error:

    construction::without::author#test_0001_fails:
    ArgumentError: Excerpt cannot be built: Author missing

Which is the error that I would expect to be raised with missing information - and is exactly what I'm testing.  So it seems that when this assertion is extracted, the `ArgumentError` is being raised and stopping the test before `assert_raises` can make any kind of comparison.  I looked into the [code](http://apidock.com/ruby/MiniTest/Assertions/assert_raises) for this assertion, but I can't make out why this would happen when the code is extracted into another method, but not when it's in-line.  ","2014-04-28 19:19:48"
"23349464","refactoring tests that use assert_raises","0","<ruby><unit-testing><minitest>","2014-04-28 19:19:48"
"33500027","refactoring several if else statements","0","refactoring several if else statements","2015-11-03 13:11:21"
"33500027","refactoring several if else statements","0","I have a method that I'm looking to refactor, and I know there is potential in refactoring it, but I'm quite uncertain on how it should be done most effectively.

      # Collection of Users questions
      def all_questions
        current_week = Time.zone.now.strftime('%V').to_i
    
        # biweekly
        odd_or_even_week = current_week.odd? ? 'odd_weeks' : 'even_weeks'
    
        # monthly
        beginning_week_of_month =
          Time.zone.now.beginning_of_month.strftime('%V').to_i
        end_week_of_month       =
          Time.zone.now.end_of_month.strftime('%V').to_i
    
        # quarter
        beginning_week_of_quarter =
          Time.zone.now.beginning_of_quarter.strftime('%V').to_i
        end_week_of_quarter       =
          Time.zone.now.end_of_quarter.strftime('%V').to_i
    
        # User's current week questions
        group_questions.weekly + questions.weekly +
          questions.send(odd_or_even_week.to_sym) +
          group_questions.send(odd_or_even_week.to_sym) +
        if current_week == beginning_week_of_month    then questions.start_of_month   + group_questions.start_of_month        else [] end +
        if current_week == end_week_of_month          then questions.end_of_month     + group_questions.end_of_month          else [] end +
        if current_week == beginning_week_of_quarter  then questions.start_of_quarter + group_questions.start_of_quarter      else [] end +
        if current_week == end_week_of_quarter        then questions.end_of_quarter   + group_questions.end_of_quarter        else [] end
      end

this is my method. What I'm essentially doing is checking if the current week matches one of several criterias which have been assigned to the different variables. If current week matches then I want to add an array to the list.

Some smaller issues I'm having with refactoring say the if else statements are that if I don't have a fallback on false being an empty array, then in the concatenation I'll have two ++ next to each-other because it will get the previous array, and if the one is empty in the midle add the + operator for that array. Thus resulting in an array.

Does anybody have a take on how they'd refactor this?","2015-11-03 13:11:21"
"33500027","refactoring several if else statements","0","<ruby-on-rails>","2015-11-03 13:11:21"
"33500027","refactoring several if else statements","0","I have a method that I'm looking to refactor, and I know there is potential in refactoring it, but I'm quite uncertain on how it should be done most effectively.

      # Collection of Users questions
      def all_questions
        current_week = Time.zone.now.strftime('%V').to_i
    
        # biweekly
        odd_or_even_week = current_week.odd? ? 'odd_weeks' : 'even_weeks'
    
        # monthly
        beginning_week_of_month =
          Time.zone.now.beginning_of_month.strftime('%V').to_i
        end_week_of_month       =
          Time.zone.now.end_of_month.strftime('%V').to_i
    
        # quarter
        beginning_week_of_quarter =
          Time.zone.now.beginning_of_quarter.strftime('%V').to_i
        end_week_of_quarter       =
          Time.zone.now.end_of_quarter.strftime('%V').to_i
    
        # User's current week questions
        group_questions.weekly + questions.weekly +
          questions.send(odd_or_even_week.to_sym) +
          group_questions.send(odd_or_even_week.to_sym) +
        if current_week == beginning_week_of_month    then questions.start_of_month   + group_questions.start_of_month        else [] end +
        if current_week == end_week_of_month          then questions.end_of_month     + group_questions.end_of_month          else [] end +
        if current_week == beginning_week_of_quarter  then questions.start_of_quarter + group_questions.start_of_quarter      else [] end +
        if current_week == end_week_of_quarter        then questions.end_of_quarter   + group_questions.end_of_quarter        else [] end
      end

this is my method. What I'm essentially doing is checking if the current week matches one of several criterias which have been assigned to the different variables. If current week matches then I want to add an array to the list.

Some smaller issues I'm having with refactoring say the if else statements are that if I don't have a fallback on false being an empty array, then in the concatenation I'll have two ++ next to each-other because it will get the previous array, and if the one is empty in the midle add the + operator for that array. Thus resulting in an array.

question and group_questions are associations, the method called on them are enums that looks like this on the Question model:


      enum frequency: { weekly: 0, odd_weeks: 1, even_weeks: 2,
                        start_of_month: 3, end_of_month: 4,
                        start_of_quarter: 5, end_of_quarter: 6 }

Does anybody have a take on how they'd refactor this?","2015-11-03 13:39:26"
"41609016","refactor fat arrow nested rxjs stream","0","refactor fat arrow nested rxjs stream","2017-01-12 09:08:55"
"41609016","refactor fat arrow nested rxjs stream","0","I am playing with http://reactivex.io/learnrx/.  In better effort to learn rxjs.  

The array that I am working through is below.  I am just trying to get the id's out of the array. 

I am able to get the answer to work but feel that answer could be better written.


    var movieLists = [
			{
				name: ""New Releases"",
				videos: [
					{
						""id"": 70111470,
						""title"": ""Die Hard"",
						""boxart"": ""http://cdn-0.nflximg.com/images/2891/DieHard.jpg"",
						""uri"": ""http://api.netflix.com/catalog/titles/movies/70111470"",
						""rating"": 4.0,
						""bookmark"": []
					},
					{
						""id"": 654356453,
						""title"": ""Bad Boys"",
						""boxart"": ""http://cdn-0.nflximg.com/images/2891/BadBoys.jpg"",
						""uri"": ""http://api.netflix.com/catalog/titles/movies/70111470"",
						""rating"": 5.0,
						""bookmark"": [{ id: 432534, time: 65876586 }]
					}
				]
			},
			{
				name: ""Dramas"",
				videos: [
					{
						""id"": 65432445,
						""title"": ""The Chamber"",
						""boxart"": ""http://cdn-0.nflximg.com/images/2891/TheChamber.jpg"",
						""uri"": ""http://api.netflix.com/catalog/titles/movies/70111470"",
						""rating"": 4.0,
						""bookmark"": []
					},
					{
						""id"": 675465,
						""title"": ""Fracture"",
						""boxart"": ""http://cdn-0.nflximg.com/images/2891/Fracture.jpg"",
						""uri"": ""http://api.netflix.com/catalog/titles/movies/70111470"",
						""rating"": 5.0,
						""bookmark"": [{ id: 432534, time: 65876586 }]
					}
				]
			}
		];


Here is the answer that I came up with

              movieLists
       				  .map( movieList => movieList.videos
                      .map(video => video.id)  )   // don't like this part
                      .concatAll()

I am basically nesting a map inside of another map then calling concat all.  

Is it possible to refactor that second map fat arrow so it can sit outside of the first?
  
    .map()
    .map()","2017-01-12 09:08:55"
"41609016","refactor fat arrow nested rxjs stream","0","<ecmascript-6><rxjs><reactive-programming>","2017-01-12 09:08:55"
"8981097","refactoring of the java code","0","refractoring of the java code","2012-01-24 01:40:57"
"8981097","refactoring of the java code","0","I have a code which was not refractored at all. I refractored it to some extent..but stuck at a point where I cannot think of anything further.
Here is my code:
Tractor.java:

 

       package com.farm;
    
    
    
    public class Tractor implements MethodsInterface{
    
    
    
    private int[] position;
    
    private int[] field;
    
    private String orientation;
    
    public Tractor(){
    	
    	position  = new int[]{0,0};
    	field = new int[]{5,5};
    	orientation = ""N"";
    	
    }
    
    public void move(String command) {
    
    if(command==""F""){
    
    moveForwards();
    
    }else if(command==""T""){
    
    turnClockwise();
    
    }
    
    }
    
    
    
    private void moveForwards() {
    
    if(orientation==""N""){
    
    position = new int[]{position[0], position[1]+1}; }else if(orientation == ""E""){ position = new int[]{position[0]+1, position[1]}; }else if(orientation == ""S""){ position = new int[]{position[0], position[1]-1}; }else if(orientation == ""W""){ position = new int[]{position[0]-1, position[1]}; } if(position[0]>field[0]||position[1]>field[1]){
    
    try {
    	throw new TractorInDitchException();
    } catch (TractorInDitchException e) {
    	// TODO Auto-generated catch block
    	e.printStackTrace();
    }
    
    }
    
    }
    
    
    
    private void turnClockwise() {
    
    if(orientation==""N""){
    
    orientation = ""E"";
    
    }else if(orientation == ""E""){
    
    orientation = ""S"";
    
    }else if(orientation == ""S""){
    
    orientation = ""W"";
    
    }else if(orientation == ""W""){
    
    orientation = ""N"";
    
    }
    
    }
    
    
    
    public int getPositionX() {
    
    return position[0];
    
    }
    
    
    
    public int getPositionY() {
    
    return position[1];
    
    }
    
    
    
    public String getOrientation() {
    
    return orientation;
    
    }
    
    }

TractorInDitchException.java

    package com.farm;
    
    public class TractorInDitchException extends Exception{
    
    }
MethodsInterface.java

    package com.farm;
    
    public interface MethodsInterface {
    
    	public int getPositionX();
    	public int getPositionY();
    	public String getOrientation();
    }

What else could be refractored...any suggestions please?

thanks


","2012-01-24 01:40:57"
"8981097","refactoring of the java code","0","<java><oop><refactoring><ooad>","2012-01-24 01:40:57"
"8981097","refactoring of the java code","0","refactoring of the java code","2012-01-24 01:52:51"
"8981097","refactoring of the java code","0","I have a code which was not refactored at all. I refactored it to some extent..but stuck at a point where I cannot think of anything further.

Tractor.java:


       package com.farm;
    
    public class Tractor implements MethodsInterface{
    
    private int[] position;
    
    private int[] field;
    
    private String orientation;
    
    public Tractor(){
    	position  = new int[]{0,0};
    	field = new int[]{5,5};
    	orientation = ""N"";
    }
    
    public void move(String command) {
    if(command==""F""){
    moveForwards();
    }else if(command==""T""){
    turnClockwise();
    }
    
    }
    
    private void moveForwards() {
    if(orientation==""N""){
    position = new int[]{position[0], position[1]+1}; }else if(orientation == ""E""){ position = new int[]{position[0]+1, position[1]}; }else if(orientation == ""S""){ position = new int[]{position[0], position[1]-1}; }else if(orientation == ""W""){ position = new int[]{position[0]-1, position[1]}; } if(position[0]>field[0]||position[1]>field[1]){
    
    try {
    	throw new TractorInDitchException();
    } catch (TractorInDitchException e) {
    	e.printStackTrace();
    }
    
    }
    
    }
    
    private void turnClockwise() {
    if(orientation==""N""){
    orientation = ""E"";
    }else if(orientation == ""E""){
    orientation = ""S"";
    }else if(orientation == ""S""){
    orientation = ""W"";
    }else if(orientation == ""W""){
    orientation = ""N"";
    }
    }
    
    
    public int getPositionX() {
    return position[0];
    }
    
    public int getPositionY() {
    return position[1];
    }
    
    public String getOrientation() {
    return orientation;
    }
    }

TractorInDitchException.java

    package com.farm;
    
    public class TractorInDitchException extends Exception{
    
    }
MethodsInterface.java

    package com.farm;
    
    public interface MethodsInterface {
    
    	public int getPositionX();
    	public int getPositionY();
    	public String getOrientation();
    }

What else could be refactored...any suggestions please?
","2012-01-24 01:52:51"
"8981097","refactoring of the java code","0","{""Voters"":[{""Id"":50049,""DisplayName"":""Tim Post""}]}","2012-01-24 07:54:44"
"34220421","refactor angular ng-resource error handling","0","refactor angular ng-resource error handling","2015-12-11 09:45:50"
"34220421","refactor angular ng-resource error handling","0","Warning: coffeescript ahead.

I have multiple controllers with various ngresource functions like so:

    app.controller 'usersCtrl', ($scope, $state, $filter, $flash, $api) ->

	$scope.saveUser = ->
        $scope.spinner = true
        $api.User.save($scope.user).$promise.then ((response) ->
           ....
        ), (error)
           $scope.spinner = false
           if error.code = 400
              $flash.create('warning', error.message)
           else if error.code = 500
              $flash.create('danger', error.message)

    $scope.updateFoo = ->
        $scope.spinner = true
        $api.Foo.update(foo: $scope.foo).$promise.then ((response) ->
           ....
        ), (error) ->
           $scope.spinner = false
           if error.code = 400
              $flash.create('warning', error.message)
           else if error.code = 500
              $flash.create('danger', error.message)

Given that I'm using virtually the same error handling code across dozens of functions, how do I refactor the code so I can reuse across multiple functions.","2015-12-11 09:45:50"
"34220421","refactor angular ng-resource error handling","0","<javascript><angularjs><coffeescript>","2015-12-11 09:45:50"
"17206541","refactor this ruby database/sequel gem lookup","0","refactor this ruby database/sequel gem lookup","2013-06-20 06:18:51"
"17206541","refactor this ruby database/sequel gem lookup","0","I know this code is not optimal, any ideas on how to improve it?

    job_and_cost_code_found = false
      timberline_db['SELECT Job, Cost_Code FROM [JCM_MASTER__COST_CODE] WHERE [Job] = ? AND [Cost_Code] = ?', job, clean_cost_code].each do |row|
        job_and_cost_code_found = true
      end

    if job_and_cost_code_found == false then 
      info = linenum + "","" + id + "",,Employees default job and cost code do not exist in timberline. job:#{job} cost code:#{clean_cost_code}""
      add_to_exception_output_file(info)
    end","2013-06-20 06:18:51"
"17206541","refactor this ruby database/sequel gem lookup","0","<ruby><refactoring>","2013-06-20 06:18:51"
"12227441","refactor JDBC function","0","refactor JDBC function","2012-09-01 11:46:48"
"12227441","refactor JDBC function","0","I am trying to create a simple web app that saves user data from a form to a database and reads the content of the database back to browser upon request. Following are the functions I have written so far.

    connectToDB()            // connects to database
    addEmployee()            // adds employee to database
    displayEmployee()        // returns a resultSet 
    isExisted(int staffID)   // checks if the staff already exists


Database connection function:

   
    public void connectToDB(){
       try{
           // load Apache derby driver
           Class.forName(""org.apache.derby.jdbc.EmbeddedDriver"");
       } catch(ClassNotFoundException e) {
           System.err.println(e);
       }
       
       try{
           connection = DriverManager.getConnection(DBNAME, USERNAME, PASSWORD);
       } catch(SQLException e){
           System.err.println(e);
       }
    } // end connectToDB
 
Display Employee function:

    public ResultSet displayEmployee(){
       connectToDB(); 
       ResultSet result = null;
       
       try{
           Statement stmt = connection.createStatement();
           String query = ""SELECT * FROM APP.ADDRESSBOOK"";
           result = stmt.executeQuery(query);

       } catch(SQLException e) {
           System.err.println(e);
       }
       
       return result;
       
    }

Check if employee exists:

    public boolean isExisted(int StaffID){
       connectToDB();
       try{
           Statement stmt = connection.createStatement();
           String query = ""SELECT StaffNum FROM APP.ADDRESSBOOK WHERE StaffNum = "" + staff_number;
           ResultSet result = stmt.executeQuery(query);
           
           while(result.next()){
               int temp = result.getInt(1);
               if(temp == staff_number){return true;}
           }
       } catch(SQLException e) {
           System.err.println(e);
       }
       return false;
    }

As you can see, if you compare the `displayEmployee()` and `isExisted()`, I am repeating mysel. Both the function works but I am looking to refactor the code. In those function I havent closed the connection. If there were 20 functions in the web app that connects to the database my code would stink.

I am looking something like this:
******* THIS CODE DOESNT WORK **************

    private Statement queryDB(query){
       connectToDB(); 
       
       Statement stmt;
        try{
           stmt = connection.createStatement();

       } catch(SQLException e) {
           System.err.println(e);
       }
       return stmt;
       
       // code for closing connection
    }
   
    public ResultSet DisplayEmployee(){
       String query = ""SELECT * FROM APP.ADDRESSBOOK"";
       Statement stmt = queryDB(query);
       ResultSet result = stmt.executeQuery(query);
       return result;
    }

Thanks.","2012-09-01 11:46:48"
"12227441","refactor JDBC function","0","<java><jsp><jdbc>","2012-09-01 11:46:48"
"10312002","refactor constructors into setters in java","0","refactor constructors into setters in java","2012-04-25 08:27:09"
"10312002","refactor constructors into setters in java","0","I have refactored my method using ""Introduce a parameter"" as it was accepting a lot of variables. but now all the callers have inline cosntructor as 

    this.somemethod(new MyParam(""a"", ""b"",""c"",""d""); 

i would like to refactor it by replacing constructor with setters like

    MyParam myParam= new MyParam();
    myParam.setA(""a"");........
    .
    .
    this.somemethod(myParam);

Is there someway to do this ?? 

there was a similar bug reported on eclipse https://bugs.eclipse.org/bugs/show_bug.cgi?id=105324","2012-04-25 08:27:09"
"10312002","refactor constructors into setters in java","0","<java><refactoring>","2012-04-25 08:27:09"
"10312002","refactor constructors into setters in java","0","<java><eclipse><refactoring>","2012-04-25 08:31:09"
"10312002","refactor constructors into setters in java","0","","2012-04-25 08:31:09"
"10929201","refactoring a field into a property","0","refactoring a field into a property","2012-06-07 09:32:43"
"10929201","refactoring a field into a property","0","I am currently learning vb.net for my new job and I have mixed feelings over public fields. I see many arguments about them hurting the encapsulation. In python, the common practice is to keep things simple and use fields when they are enough. If we want to add logic later, we just refactor them into a property without breaking anything for the client code.

In the codebase I am working with I see huge classes containing dozen of properties like:

    Private __GetDescriptionMode As Boolean
    <DefaultValue(False)> _
     Public Property GetDescriptionMode() As Boolean
        Get
            GetDescriptionMode = __GetDescriptionMode
        End Get
        Set(ByVal Value As Boolean)
            __GetDescriptionMode = Value
        End Set
    End Property

That's 10 lines of code with little value inside. I can barely see 3 of them in my visual studio window. So I have 2 questions:

- Is there a valid reason not to simply define fields and refactor them into properties when needed?
- Are OOP principle so important to sacrifice so much readability? (I can look at fewer things, I have to parse the property to make sure they are'nt doing anything special, etc)","2012-06-07 09:32:43"
"10929201","refactoring a field into a property","0","<vb.net><properties><encapsulation>","2012-06-07 09:32:43"
"10929201","refactoring a field into a property","0","I am currently learning vb.net for my new job and I have mixed feelings over public fields. I see many arguments about them hurting the encapsulation. In python, the common practice is to keep things simple and use fields when they are enough. If we want to add logic later, we just refactor them into a property without breaking anything for the client code.

In the codebase I am working with I see huge classes containing dozen of properties like:

    Private __GetDescriptionMode As Boolean
    <DefaultValue(False)> _
     Public Property GetDescriptionMode() As Boolean
        Get
            GetDescriptionMode = __GetDescriptionMode
        End Get
        Set(ByVal Value As Boolean)
            __GetDescriptionMode = Value
        End Set
    End Property

That's 10 lines of code with little value inside. I can barely see 3 of them in my visual studio window. So I have 2 questions:

- Is there a valid reason not to simply define fields and refactor them into properties when needed?
- Are OOP principle so important to sacrifice so much readability? (I can look at fewer things, I have to parse the property to make sure they are'nt doing anything special, etc)

**EDIT**
To clarify my first question: Do I have a chance of breaking client code if I change a field into a trivial property?","2012-06-07 09:45:42"
"46757911","refactor - remove CRPT","0","refactor - remove CRPT","2017-10-15 17:27:46"
"46757911","refactor - remove CRPT","0","I have custom List class like this:

    template<class T>
    struct iList{
    	constexpr bool empty() const{
    		return static_cast<const T *>(this)->size() == 0;
    	}
    };
    
    struct MyList : iList<MyList>{
    	constexpr unsigned size() const{
    		return 5;
    	}
    };
    
    int main(){
    	constexpr MyList list;
    	static_assert( ! list.empty() );
    }

code is `constexpr` and simplified so I can use `static_assert`.

I want to get rid of CRTP pattern, because templates become way too ugly. However I do not want to use virtual functions.

One way I am thinking is following:

    struct iList2{
    protected:
    	template<class LIST>
    	constexpr static bool empty_(const LIST &list){
    		return list.size() == 0;
    	}
    };
    
    struct MyList2 : iList2{
    	constexpr unsigned size() const{
    		return 5;
    	}
    
    	constexpr bool empty() const{
    		return empty_(*this);
    	}
    };
    
    int main(){
    	constexpr MyList2 list2;
    	static_assert( ! list2.empty() );
    }

In this case I need to call `empty_` static member function in each list.

Another way is to use mixin, e.g. to inherit `MyList` and add empty() method. If I do this as templated class, I can even make typedef. However I do not like this approach as well.

Is there any possibility I am missing?","2017-10-15 17:27:46"
"46757911","refactor - remove CRPT","0","<c++11><templates><refactoring>","2017-10-15 17:27:46"
"46757911","refactor - remove CRPT","0","I have custom List class like this:

    template<class T>
    struct iList{
    	constexpr bool empty() const{
    		return static_cast<const T *>(this)->size() == 0;
    	}

        // several methods like empty(), some are non const.
    };
    
    // there are several classes like this one with different implementations
    struct MyList : iList<MyList>{
    	constexpr unsigned size() const{
    		return 5;
    	}
    };
    
    int main(){
    	constexpr MyList list;
    	static_assert( ! list.empty() );
    }

code is `constexpr` and simplified so I can use `static_assert`.

I want to get rid of CRTP pattern, because templates become way too ugly. However I do not want to use virtual functions.

One way I am thinking is following:

    struct iList2{
    protected:
    	template<class LIST>
    	constexpr static bool empty_(const LIST &list){
    		return list.size() == 0;
    	}
    };
    
    struct MyList2 : iList2{
    	constexpr unsigned size() const{
    		return 5;
    	}
    
    	constexpr bool empty() const{
    		return empty_(*this);
    	}
    };
    
    int main(){
    	constexpr MyList2 list2;
    	static_assert( ! list2.empty() );
    }

In this case I need to call `empty_` static member function in each list.

Another way is to use mixin, e.g. to inherit `MyList` and add empty() method. If I do this as templated class, I can even make typedef. However I do not like this approach as well.

Is there any possibility I am missing?","2017-10-15 17:33:14"
"43897757","refactor d3 from tsv to json and replace type function","0","refactor d3 from tsv to json and replace type function","2017-05-10 16:10:50"
"43897757","refactor d3 from tsv to json and replace type function","0","I need to factor out the type function so I can use a json variable instead of tsv; I am already doing a data.forEach() to parse the date so that's OK.   I haven't been able to figure out what this does: 

    for (var i = 1, n = columns.length; i < n; ++i) d[columns[i]] = d[columns[i]] 
    / 100;

in

    function type(d, i, columns) {
    d.date = parseDate(d.date);
    for (var i = 1, n = columns.length; i < n; ++i) d[columns[i]] = d[columns[i]] 
    / 100;
    return d;
    }


this is the example:
[Stacked bar][1]


  [1]: https://bl.ocks.org/mbostock/3885211","2017-05-10 16:10:50"
"43897757","refactor d3 from tsv to json and replace type function","0","<d3.js>","2017-05-10 16:10:50"
"4909140","refactoring sql in php","0","refactoring sql in php","2011-02-05 19:29:39"
"4909140","refactoring sql in php","0","What is a good place to put sql commands so they do not appear in the main code, how can this be done? How can sql commands such as the following be refactorised:

    function select_Query($sql, $link)
    {
        $query = mysqli_query($link, $sql);
        
        if (!$query)
        {
            echo ""Failure""; #   TODO: LOG THIS
        }
        
        $data = array();
        while ($row = mysqli_fetch_array($query) )
        {
            $data[] = $row;
        }    
        
        return $data;
    }
    
    
    $query = select_Query(""SELECT thread.title, thread.id as t_id,
                             thread.content
                             FROM thread
                             LIMIT $start, 30"", $link);

How would you factorise the $query var part to generalise it for other sql statements - as that is fairly simple sql, however when several joins are used sql commands take up several lines in my code, I don't want to mix them with my php code.

","2011-02-05 19:29:39"
"4909140","refactoring sql in php","0","<php><sql><refactoring>","2011-02-05 19:29:39"
"1685282","refactor to use oop mvc","0","refactor to use oop mvc","2009-11-06 03:43:32"
"1685282","refactor to use oop mvc","0","how do I refactor this to use oop , with mvc pattern.

    (function () {
      var dataToImage = { 'a': 'a.gif', 'b': 'something.gif' };
      var currentimage = dataToImage['a'];
      function setCurrentImage(e){ currentImage = e.src; }
      function getMousePosition(){  }
      function drawToolbar {
        for(i in dataToImage){
          document.write('<img src=""'+dataToImage[i]+'"" onclick=""setCurrentImage(this);"">');
        }
        document.write('<div onclick=""drawImage(this,getMousePosition())""></div>');
        return;
      }
      function drawImage(div,xy) {
        var img = document.createElement('div');
        div.style[""left""] = xy[0];
        div.style[""top""] = xy[1];
        img.innerHTML='<img src=""'+currentImage+'"">');
        div.appendChild(img);
        return;  
      }
      drawToolbar();
    }());","2009-11-06 03:43:32"
"1685282","refactor to use oop mvc","0","<oop><javascript><html><dom>","2009-11-06 03:43:32"
"21327516","refactoring xsd elements with same elements?","0","refactoring xsd elements with same elements?","2014-01-24 08:09:33"
"21327516","refactoring xsd elements with same elements?","0","I have below xsd elements.


     <xsd:element name=""requestOne"" type=""tns:RequestOne""/>
      <xsd:complexType name=""RequestOne"">
      		<xsd:annotation>
                <xsd:documentation>some comment</xsd:documentation>
            </xsd:annotation>
    		<xsd:sequence>
    			<xsd:element name=""id"" type=""xsd:string"" minOccurs=""1"" maxOccurs=""1""/>
    		</xsd:sequence>
      </xsd:complexType>
      
       <xsd:element name=""requestTwo"" type=""tns:RequestTwo""/>
      <xsd:complexType name=""RequestTwo"">
      		<xsd:annotation>
                <xsd:documentation>other comment</xsd:documentation>
            </xsd:annotation>
    		<xsd:sequence>
    			<xsd:element name=""id"" type=""xsd:string"" minOccurs=""1"" maxOccurs=""1""/>
    		</xsd:sequence>
      </xsd:complexType>

It has two complex elements but inside them there is duplicated code. How can i refactor above code?

Thanks!","2014-01-24 08:09:33"
"21327516","refactoring xsd elements with same elements?","0","<java><xml><web-services><jaxb><xsd>","2014-01-24 08:09:33"
"37610258","refactoring code by reducing iterations and db hits","0","refactoring code by reducing iterations and db hits","2016-06-03 09:06:30"
"37610258","refactoring code by reducing iterations and db hits","0","I have a private instance user model method like below:-  
  
    def generate_authentication_token
      loop do
        token = Devise.friendly_token
        break token unless self.class.unscoped.where(authentication_token:   token).first
      end
    end  
  
Let us assume that, no. of user record is 100 trillions. If I issue the above script and the token generated on each iteration matches with a record then, loop will iterate for 100 trillion times, same will happen with DBMS too for searching record. Is there any solution to make this problem fast, by reducing iteration and reducing db-hits (given that each iteration will give matching record). And seriously, sorry ! if the question makes no sense and let me know, I will delete ASAP. Thanks. Happy    Coding.       ","2016-06-03 09:06:30"
"37610258","refactoring code by reducing iterations and db hits","0","<ruby-on-rails><ruby><devise>","2016-06-03 09:06:30"
"12850480","refactor code to a loop","0","refactor code to a loop","2012-10-12 00:11:51"
"12850480","refactor code to a loop","0","Currently I have 

        <b>Step 1</b>	 
          <%= @recipe_records.instruct_1 %>
         </p>	
        <p> 
        <b>Step 2</b>	 	
          <%= @recipe_records.instruct_2 %>
          </p>
        .....
        <b>Step 30</b>	 	
          <%= @recipe_records.instruct_30 %>
          </p>

How do I put it in a loop instead of listing all 30 steps and to not display empty steps?

        <% 30.times do |n|%>
            <% ri = @recipe_records.instruct_#{n+1}%>
          	<%= if !ri.empty? %>
            	<p>
              	<%= ri %>
        	<% end%>
        <% end %>
Tried but unable to work.","2012-10-12 00:11:51"
"12850480","refactor code to a loop","0","<ruby-on-rails><ruby-on-rails-3><ruby-on-rails-3.2>","2012-10-12 00:11:51"
"14450993","refactoring model to remove proxy_options for rails 3 upgrade","0","refactoring model to remove proxy_options for rails 3 upgrade","2013-01-22 03:15:17"
"14450993","refactoring model to remove proxy_options for rails 3 upgrade","0","I'm currently upgrading a rails app from 2.x to 3.1.

Wondering if anyone can help to refactor this to remove the proxy_option code (which is no longer available in rails 3):

    scope = Product.scoped({})
    scope = scope.scoped( Product.allowed(options[:current_user]).proxy_options )
    scope = scope.scoped( Product.for_country(options[:country_ids]).proxy_options ) if options[:country_ids]

Example of one of the scope methods include:

      def allowed(user)
        where(:id => user.access_to(self.name))
      end

","2013-01-22 03:15:17"
"14450993","refactoring model to remove proxy_options for rails 3 upgrade","0","<ruby-on-rails><activerecord><scope>","2013-01-22 03:15:17"
"14450993","refactoring model to remove proxy_options for rails 3 upgrade","0","<ruby-on-rails><scope><rails-activerecord>","2013-01-22 03:21:07"
"33717310","refactor controller to use a service in angular with multiple functions","0","refactor controller to use a service in angular with multiple functions","2015-11-15 07:09:48"
"33717310","refactor controller to use a service in angular with multiple functions","0","I have a controller that works fine, but it seems like it should be refactored to include a service.

My controller uses two functions to change a display of ingredients. One tied to a select element for mobile, the other tied to links for desktops.

Is it possible to refactor this to use a service?

My html for Mobile:

    <select ng-model=""ingredient.item"" ng-options=""i.option for i in ingredient.items"" ng-change=""ingredient.change_select(ingredient.item)"">
        <option value="""">choose ingredient</option>
    </select>

My html for Desktop:

    <a ng-click=""ingredient.change_tab('octopamine','Octopamine')"">Octopamine</a>

My controller:

    app.controller('IngredientsCtrl', function() {
      var ingredient = this;
      
      ingredient.items = [
        {
          'option': 'Brigham\'s Tea Leaf',
          'param' : 'brighamtea'
        },
        {
          'option': 'White Willow Bark Powder',
          'param' : 'white_willow'
        }];

      ingredient.tab = 'brighamtea';
      ingredient.tab_image = 'http://imgix.ximo365.com/brighamtea.jpg';
      ingredient.tab_title = 'Brigham\'s Tea Leaf';

      ingredient.change_select = function (item) {
        ingredient.tab = item.param;
        ingredient.tab_image = 'http://imgix.ximo365.com/' + item.param + '.jpg';
        ingredient.tab_title = item.option;
      }

      ingredient.change_tab = function(param,title) {
        ingredient.tab = param;
        ingredient.tab_image = 'http://imgix.ximo365.com/' + param + '.jpg';
        ingredient.tab_title = title;
      }
    });","2015-11-15 07:09:48"
"33717310","refactor controller to use a service in angular with multiple functions","0","<javascript><angularjs>","2015-11-15 07:09:48"
"32590525","refactoring jquery addClass removeClass","0","refactoring jquery addClass removeClass","2015-09-15 15:55:23"
"32590525","refactoring jquery addClass removeClass","0","I have the effect I want, but I know it could be coded more efficiently.

Here's the effect...

http://brinsterinc.com/fw/dcp/steps_vert.html

And here's the jQuery...

    $(document).ready(function() {
    	setTimeout(function(){
    		$( ""#1"" ).addClass( ""vstepCycle"" ).delay(1000).queue(function(){
        		$(this).removeClass(""vstepCycle"").dequeue();
        		});
       }, 3000);
       setTimeout(function(){
    		$( ""#2"" ).addClass( ""vstepCycle"" ).delay(1000).queue(function(){
        		$(this).removeClass(""vstepCycle"").dequeue();
        		});
       }, 4000);
       setTimeout(function(){
    		$( ""#3"" ).addClass( ""vstepCycle"" ).delay(1000).queue(function(){
        		$(this).removeClass(""vstepCycle"").dequeue();
        		});
       }, 5000);
       setTimeout(function(){
    		$( ""#4"" ).addClass( ""vstepCycle"" ).delay(1000).queue(function(){
        		$(this).removeClass(""vstepCycle"").dequeue();
        		});
       }, 6000);
    });

Trying to learn so any advice appreciated!","2015-09-15 15:55:23"
"32590525","refactoring jquery addClass removeClass","0","<jquery><refactoring>","2015-09-15 15:55:23"
"16903978","refactoring the following code to use jQuery","0","refactoring the following code to use jQuery","2013-06-03 19:04:11"
"16903978","refactoring the following code to use jQuery","0","I have some code that adds event listeners that wasn't written without jQuery.

    pic1.addEventListener(""webkitTransitionEnd"",
    	function(){
    		pic1.className=""down"";
    		pic1.style.zIndex=picclick;
    		},true);
    pic1.addEventListener(""oTransitionEnd"",
    	function(){
    		pic1.className=""down"";
    		pic1.style.zIndex=picclick;
    		},true);
    pic1.addEventListener(""transitionEnd"",
    	function(){
    		pic1.className=""down"";
    		pic1.style.zIndex=picclick;
    		},true);
I want to now add the eventListeners with jQuery, and maintain the same functionality. Ideas on what this should look like?

Here's a sketch of what I'm doing...
http://jsdo.it/dbwest/4rqo","2013-06-03 19:04:11"
"16903978","refactoring the following code to use jQuery","0","<javascript><jquery><html5><css3>","2013-06-03 19:04:11"
"16903978","refactoring the following code to use jQuery","0","I have some code that adds event listeners that were not written with jQuery.

    pic1.addEventListener(""webkitTransitionEnd"",
    	function(){
    		pic1.className=""down"";
    		pic1.style.zIndex=picclick;
    		},true);
    pic1.addEventListener(""oTransitionEnd"",
    	function(){
    		pic1.className=""down"";
    		pic1.style.zIndex=picclick;
    		},true);
    pic1.addEventListener(""transitionEnd"",
    	function(){
    		pic1.className=""down"";
    		pic1.style.zIndex=picclick;
    		},true);
I want to now add the eventListeners with jQuery, and maintain the same functionality. Ideas on what this should look like?

Here's a sketch of what I'm doing...
http://jsdo.it/dbwest/4rqo","2013-06-03 19:21:04"
"16903978","refactoring the following code to use jQuery","0","<javascript><jquery><html5>","2013-06-03 19:11:28"
"16903978","refactoring the following code to use jQuery","0","{""Voters"":[{""Id"":218196,""DisplayName"":""Felix Kling""},{""Id"":1424361,""DisplayName"":""ben336""},{""Id"":2156756,""DisplayName"":""Linus Caldwell""},{""Id"":1957346,""DisplayName"":""Ashwin Mukhija""},{""Id"":1190388,""DisplayName"":""hjpotter92""}]}","2013-06-04 01:23:17"
"16903978","refactoring the following code to use jQuery","0","","2013-06-03 19:21:04"
"41867292","refactor a regular for loop into an enhanced for loop","0","refactor a regular for loop into an enhanced for loop","2017-01-26 05:14:08"
"41867292","refactor a regular for loop into an enhanced for loop","0","I have a regular for loop that helps me append a character by taking advantage of the index positioning provided by the common for loop. I want to refactor the loop and turn it into an enhanced for loop, but the disadvantage is the index positioning, i cant find a way  to indicate where i want to append my char. Is it even possible to use the enhanced for loop in this case?
from:

    for(int i = 0; i < itinerary.size(); i++){
    			sb.append(itinerary.get(i).toUpperCase());
    			if (i < itinerary.size() -1){
    				sb.append("" to "");
    			}
    		}

to

    for(String itineray : itinerary){
    			sb.append(itineray.toUpperCase());
    			if( //size of the array - 1){
    				sb.append("" to "");
    			}
    		}
        ","2017-01-26 05:14:08"
"41867292","refactor a regular for loop into an enhanced for loop","0","<java>","2017-01-26 05:14:08"
"41867292","refactor a regular for loop into an enhanced for loop","0","I have a regular for loop that helps me append a character by taking advantage of the index positioning provided by the common for loop. I want to refactor the loop and turn it into an enhanced for loop, but the disadvantage is the index positioning, i cant find a way  to indicate where i want to append my char. Is it even possible to use the enhanced for loop in this case?
**from:**

    for(int i = 0; i < itinerary.size(); i++){
    	sb.append(itinerary.get(i).toUpperCase());
    	if (i < itinerary.size() -1){
    		sb.append("" to "");
    	}
    }

**to**

    for(String itineray : itinerary){
    	sb.append(itineray.toUpperCase());
    	if( //size of the array - 1){
    		sb.append("" to "");
    	}
    }","2017-01-26 06:21:04"
"41867292","refactor a regular for loop into an enhanced for loop","0","I have a *regular* `for` loop that helps me append a character by taking advantage of the index positioning provided by the common `for` loop.

I want to refactor the loop and turn it into a `for each` loop, but the disadvantage is the index positioning. I can't find a way to indicate where I want to append my char. Is it even possible to use the `for each` loop in this case?

**from:**

    for (int i = 0; i < itinerary.size(); i++) {
    	sb.append(itinerary.get(i).toUpperCase());
    	if (i < itinerary.size() -1) {
    		sb.append("" to "");
    	}
    }

**to**

    for (String itineray : itinerary){
    	sb.append(itineray.toUpperCase());
    	if ( //size of the array - 1){
    		sb.append("" to "");
    	}
    }","2017-01-26 06:21:04"
"41867292","refactor a regular for loop into an enhanced for loop","0","","2017-01-26 06:21:04"
"26888774","refactor the rspec tests","0","refactor the rspec tests","2014-11-12 14:00:09"
"26888774","refactor the rspec tests","0","I have written a unit tests as below.

    describe Youtube::Metadata do
      let(:subject) { SampleMetadata.from_text(open(url)) }
      context ""when url is passed"" do
        let(:url) { ""http://www.sample.com"" }
        
        describe ""It should return all values from the site"" do
          its(:id) { should eql ""234"" }
          its(:url) { should eql ""www.sample.com"" }
        end
        
        context ""Given a html file with id property"" do
          let(:html) { File.join(PAGES, 'youtube', 'sample1.html') }
          let(:subject) { Youtube::Metadata.from_text(File.read(html)) }
    
          it ""should return unique value from id property"" do
            subject.unique_id.should eql ""65155c6e-ba11-42fc-bb91-53520176d2a8""
          end
        end
    
        context ""Given a html file with rel:canonical property"" do
          let(:html) { File.join(PAGES, 'youtube', 'sample2.html') }
          let(:subject) { Youtube::Metadata.from_text(File.read(html)) }
    
          it ""should return unique value from rel=canonical content property"" do
            subject.unique_id.should eql ""65155c6e-ba11-42fc-bb91-53520176d2a8""
          end
        end
      end
    end

I need to refactor it so that I dont have to repeat the below statement in each and every tests cases.

    let(:subject)   { Youtube::Metadata.from_text(File.read(html))
I tried it with before block but it didn't work.  

> Actually the first context we pass url and the second set of context
> we pass filename. Also I am not sure whether I need to make it as a
> single context (which is passing file name contexts, ie. last two) and describe it.

What would be the right way to do it??

","2014-11-12 14:00:09"
"26888774","refactor the rspec tests","0","<ruby><rspec>","2014-11-12 14:00:09"
"6013852","refactoring 2 closely coupled methods","0","refactoring 2 closely coupled methods","2011-05-16 06:26:13"
"6013852","refactoring 2 closely coupled methods","0","Ok so I'm making a mockup of a distributed system.
each instance of  mClass (object) is used by 1 thread. Mutable data can't be passed between mClass objects
This is a example of code analogous to what I have:
 

    type mClass (mID:id)=
        member this.ID=mID
        
        let resolve : id->mClass  =... //This function turns IDs into the objects they represnt
        ...
        let managementInfo = ref Some mutableData
    
        //this should only ever be called by the GiveControl method.
        private member this.TakeControl (frozenData) =
            let defrostedData = ... //a variable that works out the unfrozen version of the frozenData
            managementInfo := Some defrostedData
    
    
        ///This is a helper that ensure that when ever someone else is told to take control 
        ///that all my internal data and any functions i need to call to tell others are done
        ///And convert the data a nonmutable form 
        ///(Mutable data can not be tranfered between different instances of of mClass (objects), 
        ///as this is a mockup of a distributed system, where the instances of mClass can't
        ///@param: nID this ID of the object we are giving control to
        ///@param: callbacks: a list of functions to call to tell other objects i've given control 
        private member this.GiveControl nID (callbacks: list<id->unit>) =
            let updateInternalData = ... //A function to upate my internal state
            updateInternalData;
            ignore (List.map (fun f-> f nID) callbacks);
            let freezeData data= ... //a function make our mutableData into nonmutable data
            let frozenData = (!managemenInfo).Value|>freezeData 
            managemenInfo:=None;
            (nID|>resolve).TakeControl (frozenData)
    
        ...




private member this.GiveControl was originally declared:
let giveControl
but it made the compiler complain about mis-declaring a new type, until i changed it to a private method.

The question is, how can I re factor this code,
to merge the two methods into one. (or atleast make GiveControl only callable from within this object (real private as it were) and TakeControl only callable from GiveControl)


","2011-05-16 06:26:13"
"6013852","refactoring 2 closely coupled methods","0","<f#><refactoring><functional-programming><distributed><private-members>","2011-05-16 06:26:13"
"6013852","refactoring 2 closely coupled methods","0","<f#><refactoring>","2011-05-17 14:55:41"
"15534746","refactoring an expensive query in rails","0","refactoring an expensive query in rails","2013-03-20 21:08:19"
"15534746","refactoring an expensive query in rails","0","I been all day trying to refactor my queries. It was taking several minutes for a table with 20 records to load. At first, I blamed the query in this stackoverflow post:

http://stackoverflow.com/questions/15442194/rails-using-rails-cache-gives-error

However, after doing some testing, I realized that query was loading very fast, and was not the culprit.

Then I blamed it on kaminari, as I thought that kaminari was populating thousands of records into ruby objects, as I explained in this post:

http://stackoverflow.com/questions/15528861/rails-and-kaminari

But that was wrong too. Kaminari was only loading 20 records at a time (I used the logger to check how many reports where being loaded and it showed 20).

So finally I think I found the real culprit. It is another query that occurs during the pagination of that page. I realized that this query is taking more than 20 seconds to load each time it is run:



    def virtual_fence_duration
        inside_fence_time = nil
        outside_fence_time = nil
        
        outside_fence_time = self.time
        
        previous_reports = Report.where{(time    <  my{self.time}) &
                                       (unit_id == my{self.unit_id})}.order('time desc')
        
        previous_reports.each do |report|
          alerts = report.alerts.collect { |a| a.code_name }
          if alerts.include? ""Inside virtual fence""
            inside_fence_time = report.time
            break
          end
        end
        
        if inside_fence_time && outside_fence_time
          ""Virtual Fence Elapsed Time: #{(((outside_fence_time - inside_fence_time).to_i).to_f/60.0).ceil} minutes"" 
        else
          """"
        end    
      end

Basically, this method gets called when there is an alert that is  ""outside virtual fence"". I store the time. And then I query all the reports previous to it (reports has_many alerts). Then I use the each iterator of ruby to go through every single report and then the alerts associated with those reports to find the alert that is ""inside virtual fence"". Then I store the time of that report and take the difference between the two times. This logic seems to be taking forever if there are  alot of reports between the two durations. Is there a more efficient way to do this in sql (mysql) or ruby?
","2013-03-20 21:08:19"
"15534746","refactoring an expensive query in rails","0","<sql><ruby-on-rails>","2013-03-20 21:08:19"
"15534746","refactoring an expensive query in rails","0","I been all day trying to refactor my queries. It was taking several minutes for a table with 20 records to load. At first, I blamed the query in this stackoverflow post:

https://stackoverflow.com/questions/15442194/rails-using-rails-cache-gives-error

However, after doing some testing, I realized that query was loading very fast, and was not the culprit.

Then I blamed it on kaminari, as I thought that kaminari was populating thousands of records into ruby objects, as I explained in this post:

https://stackoverflow.com/questions/15528861/rails-and-kaminari

But that was wrong too. Kaminari was only loading 20 records at a time (I used the logger to check how many reports where being loaded and it showed 20).

So finally I think I found the real culprit. It is another query that occurs during the pagination of that page. I realized that this query is taking more than 20 seconds to load each time it is run:



    def virtual_fence_duration
        inside_fence_time = nil
        outside_fence_time = nil
        
        outside_fence_time = self.time
        
        previous_reports = Report.where{(time    <  my{self.time}) &
                                       (unit_id == my{self.unit_id})}.order('time desc')
        
        previous_reports.each do |report|
          alerts = report.alerts.collect { |a| a.code_name }
          if alerts.include? ""Inside virtual fence""
            inside_fence_time = report.time
            break
          end
        end
        
        if inside_fence_time && outside_fence_time
          ""Virtual Fence Elapsed Time: #{(((outside_fence_time - inside_fence_time).to_i).to_f/60.0).ceil} minutes"" 
        else
          """"
        end    
      end

Basically, this method gets called when there is an alert that is  ""outside virtual fence"". I store the time. And then I query all the reports previous to it (reports has_many alerts). Then I use the each iterator of ruby to go through every single report and then the alerts associated with those reports to find the alert that is ""inside virtual fence"". Then I store the time of that report and take the difference between the two times. This logic seems to be taking forever if there are  alot of reports between the two durations. Is there a more efficient way to do this in sql (mysql) or ruby?
","2017-05-23 10:25:49"
"46458343","refactored geb login spec to module resulting in ""not initialized"" error","0","refactored geb login spec to module resulting in ""not initialized"" error","2017-09-27 22:46:53"
"46458343","refactored geb login spec to module resulting in ""not initialized"" error","0","I am new to writing geb specs for funcational testing and appreciate your help with this issue. I am also new to Groovy, and the ""Not Initialized"" error might be to do with basic inexperience in that. I am trying to build a module to log me in automatically, at which point I can proceed with further tests, but I receive a `geb.error.ModuleInstanceNotInitializedException`. Previously, not using a module, I was able to log in to my page using only a spec. I was refactoring this to a module approach based on the answer on rcgeorge23's response here:
https://stackoverflow.com/questions/23532633/how-to-refactor-common-geb-test-sequences.

The spec:

    import spock.lang.Unroll

    class FlowSpecs extends GebReportingSpec {
    
        @Unroll
        def ""setup Spec""() {
            given:
                to QUserPage
            when:    
                authModule.signIn(""mwalle"",""password"")
            then:
                assert { $(""span"", ""class"":""login-text z-label"")[3].text() == ""mwalle"" }
        }

the page:

    package pages.app
    
    import geb.Page
    import AuthModule
    
    class QUserPage extends Page {
    
        static url = ""/qsystem/quser""
        static at = { title == ""QSystem"" }
    
        static content = {
            authModule { module AuthModule }
        }
    }

and the module:

    import geb.Module 
     
    class AuthModule extends Module {
    
        def idUser = js.""zk.Widget.\$('\$usr').uuid"" + ""-real""
        def idPass = js.""zk.Widget.\$('\$pwd').uuid""
    
        static content = {
            loginUser { $(""input"", id:idUser) }
            loginPass { $(""input"", id:idPass) }
            loginButton { $(""button"",class:""login-button z-button"")[0] }
        }
    
        void signIn(String username = ""mwalle"", String password = ""password"") {
            loginUser.value(user)
            loginPass.value(pass)
            loginButton.click()
        }
    }

The full error is:

    geb.error.ModuleInstanceNotInitializedException: Instance of module class AuthModule has not been initialized. Please pass it to Navigable.module() or Navigator.module() before using it.
    	at geb.Module.uninitializedException(Module.groovy:757)
    	at geb.Module.getJs(Module.groovy:96)
    	at AuthModule.<init>(AuthModule.groovy:5)
    	at geb.navigator.AbstractNavigator.module(AbstractNavigator.groovy:356)
    	at geb.content.NavigableSupport.module(NavigableSupport.groovy:207)
    	at geb.content.PageContentTemplateFactoryDelegate.module(PageContentTemplateFactoryDelegate.groovy:31)
    	at pages.app.QUserPage._clinit__closure2$_closure3(QUserPage.groovy:12)
    	at pages.app.QUserPage._clinit__closure2$_closure3(QUserPage.groovy)
    	at geb.content.PageContentTemplate.invokeFactory(PageContentTemplate.groovy:97)
    	at geb.content.PageContentTemplate.create_closure1(PageContentTemplate.groovy:59)
    	at geb.content.PageContentTemplate.create_closure1(PageContentTemplate.groovy)
    	at geb.content.PageContentTemplate.create(PageContentTemplate.groovy:82)
    	at geb.content.PageContentTemplate.get(PageContentTemplate.groovy:54)
    	at geb.content.DefaultPageContentSupport.getContent(DefaultPageContentSupport.groovy:42)
    	at geb.content.PageContentSupport.propertyMissing(PageContentSupport.groovy:39)
    	at geb.Page.propertyMissing(Page.groovy:112)
    	at geb.Browser.propertyMissing(Browser.groovy:216)
    	at geb.spock.GebSpec.propertyMissing(GebSpec.groovy:60)
    	at FlowSpecs.setup Spec(FlowSpecs.groovy:23)","2017-09-27 22:46:53"
"46458343","refactored geb login spec to module resulting in ""not initialized"" error","0","<groovy><spock><functional-testing><geb>","2017-09-27 22:46:53"
"11950923","refactor data.frame column values","0","R_loop over a data frame","2012-08-14 11:02:14"
"11950923","refactor data.frame column values","0","Sorry guys if this is a noob question.
I need help on how to loop over my dataframe.Here is a sample data.

    a <- c(10:29);
    b <- c(40:59);
    e <- rep(1,20);
    test <- data.frame(a,b,e)

I need to manipulate column ""e"" using the following criteria for values in column ""a""

for all values of ""a"" <= 15, ""e"" = 1,

""a"" > 15 & < 20, ""e"" = 2

""a"" > 20 & < 25, ""e"" = 3

""a"" > 25 & < 30, ""e"" = 4 and so on to look like this

    result <- cbind(a,b,rep(1:4, each =5)

My actual data frame is over 100k long. Would be great if you could sort me out here 

Biju","2012-08-14 11:02:14"
"11950923","refactor data.frame column values","0","<r><dataframe>","2012-08-14 11:02:14"
"11950923","refactor data.frame column values","0","refactor data.frame column values","2012-08-17 08:00:39"
"11950923","refactor data.frame column values","0","loop over a data frame","2012-08-14 11:07:45"
"11950923","refactor data.frame column values","0","Sorry guys if this is a noob question.
I need help on how to loop over my dataframe.Here is a sample data.

    a <- c(10:29);
    b <- c(40:59);
    e <- rep(1,20);
    test <- data.frame(a,b,e)

I need to manipulate column ""e"" using the following criteria for values in column ""a""

for all values of

""a"" <= 15, ""e"" = 1,

""a"" > 15 & < 20, ""e"" = 2

""a"" > 20 & < 25, ""e"" = 3

""a"" > 25 & < 30, ""e"" = 4 and so on to look like this

    result <- cbind(a,b,rep(1:4, each=5))

My actual data frame is over 100k long. Would be great if you could sort me out here.","2012-08-17 08:00:39"
"11950923","refactor data.frame column values","0","Sorry guys if this is a noob question.
I need help on how to loop over my dataframe.Here is a sample data.

    a <- c(10:29);
    b <- c(40:59);
    e <- rep(1,20);
    test <- data.frame(a,b,e)

I need to manipulate column ""e"" using the following criteria for values in column ""a""

for all values of

""a"" <= 15, ""e"" = 1,

""a"" > 15 & < 20, ""e"" = 2

""a"" > 20 & < 25, ""e"" = 3

""a"" > 25 & < 30, ""e"" = 4 and so on to look like this

    result <- cbind(a,b,rep(1:4, each=5))

My actual data frame is over 100k long. Would be great if you could sort me out here 

Biju","2012-08-14 11:07:45"
"25268847","refactoring code with conditional return","0","refactoring code with conditional return","2014-08-12 15:55:25"
"25268847","refactoring code with conditional return","0","I have this code on my project in the begining of multiple functions.

    try: 
        user = get_user(user_id) 
    except LockedException: 
        logger.warn('op=healthcheck, msg=""user is locked""') 
        return HttpResponseServerError(jsonMessage('user=%(user)s is locked' % {'user': user_id})) 
    except UserFreeException: 
        logger.warn('op=user, msg=""user is free""') 
        return HttpResponseNotFound(jsonMessage('user is free user=%(user)s' % {'user': user_id})) 
    except User.DoesNotExist: 
        logger.warn('op=healthcheck, msg=""user doesn\'t exist""') 
        return HttpResponseNotFound(jsonMessage('invalid user=%(user)s' % {'user': user_id})) 
    except Exception, e: 
        logger.error('op=healthcheck, msg=""unknown error"", msg=""%(exception)s""', 
                     {'exception': e.message}) 
        return HttpResponseServerError(jsonMessage(e.message)) 


Any hints on how can I refactor it so I don't need to reuse it everywhere?
The best I could come would be to create a function that throws a single exception in case of a problem, and this exception contains a ""http_response"" field, so I'd do something like:

    try:
        user = get_user(user_id)
    except MyGenericException, e:
        return e.http_response

Any other ideas?","2014-08-12 15:55:25"
"25268847","refactoring code with conditional return","0","<python>","2014-08-12 15:55:25"
"7488971","refactor old webapp to gain speed","0","refactor old webapp to gain speed","2011-09-20 17:09:38"
"7488971","refactor old webapp to gain speed","0","4 years ago, I've built a webapp which is still used by some friends. the problem with that app, is that now it has a huge database, and it loads very slow. I know that is mainly my fault, because i didn't use any OO programming, mysql queries are mixted all over the places(even in the layout generation time) 

ATM I know some about MVC, and some OO. I'll like to use this knowledge in my old app, but I don't know how to do it without rewriting all the from the beginning. 

If you were in my place, or if you will had the task to improve the speed of my old app, how you will do it? do you have any tips for me? Any working scenarios?","2011-09-20 17:09:38"
"7488971","refactor old webapp to gain speed","0","<git><merge>","2011-09-20 17:09:38"
"7488971","refactor old webapp to gain speed","0","4 years ago, I've built a webapp which is still used by some friends. the problem with that app, is that now it has a huge database, and it loads very slow. I know that is just my fault, mysql queries are mixted all over the places(even in the layout generation time). 

ATM I know some about OO. I'll like to use this knowledge in my old app, but I don't know how to do it without rewriting all the from the beginning. Using MVC for my app, is very difficult at this moment.

If you were in my place, or if you will had the task to improve the speed of my old app, how you will do it? Do you have any tips for me? Any working scenarios?","2011-09-20 17:13:17"
"7488971","refactor old webapp to gain speed","0","<rewrite><upgrade><legacy-app>","2011-09-20 17:13:17"
"7488971","refactor old webapp to gain speed","0","<oop><mvc><refactoring>","2011-09-20 17:13:30"
"7488971","refactor old webapp to gain speed","0","<rewrite><upgrade><legacy-app>","2011-09-20 17:14:11"
"7488971","refactor old webapp to gain speed","0","<rewrite><upgrade><legacy-app>","2011-09-20 17:12:48"
"7788050","refactoring some legacy code - potential memory leaks","0","refactoring some legacy code","2011-10-16 23:21:15"
"7788050","refactoring some legacy code - potential memory leaks","0","
Due to some memory leaks, some memory is not released except when doing IISreset.


I found some code where I have a class of properties and methods, where only 10% of the methods are specific for the class, 90% can be moved to  another class. 

how bad is that? is this is affecting my memory, because I am initiating this class with every user using the application?


It is a ASP.NET Application on IIS6.

","2011-10-16 23:21:15"
"7788050","refactoring some legacy code - potential memory leaks","0","<asp.net><memory-leaks>","2011-10-16 23:21:15"
"7788050","refactoring some legacy code - potential memory leaks","0","refactoring some legacy code - potential memory leaks","2011-10-16 23:25:07"
"7788050","refactoring some legacy code - potential memory leaks","0","Due to some memory leaks, some memory is not released except when doing IISreset.


I found some code where I have a class of properties and methods, where only 10% of the methods are specific for the class, 90% can be moved to  another class. 

how bad is that? is this is affecting my memory, because I am initiating this class with every user using the application?


It is a ASP.NET Application on IIS6.

","2011-10-16 23:25:07"
"17690492","refactoring ruby code inject issues","-1","refactoring artificial intelligence ruby tic tac toe","2013-07-17 03:18:30"
"17690492","refactoring ruby code inject issues","-1","Hi can someone explain to me a better way of calculating if the AI in a simple tic tac toe game has to block the user from winning on a specific round?

Also, am I using inject and break correctly here? For some reason my code gets caught up in an endless loop once this scenario comes into play (the 5th move usually in my game)

      def cpu_block_player
        winning_combinations = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]]
        executed = 0
        winning_combinations.each do |combination|
          result_of_combination = """"
          result_of_combination = combination.inject("""") {|result, element| result + @board[element]}
          if result_of_combination == ""XXe"" || result_of_combination == ""eXX"" || result_of_combination == ""XeX""
            executed += 1
            puts executed 
            player_move(@current_turn, result_of_combination.index(""e""))     
          end
          break if executed >= 1
       end

full game is at https://gist.github.com/jtong33/5991809","2013-07-17 03:18:30"
"17690492","refactoring ruby code inject issues","-1","<ruby><artificial-intelligence><tic-tac-toe>","2013-07-17 03:18:30"
"17690492","refactoring ruby code inject issues","-1","refactoring ruby code inject issues","2013-08-21 15:54:21"
"17690492","refactoring ruby code inject issues","-1","Hi can someone explain to me why my inject isn't working here?

Am I using inject correctly here? For some reason my code gets caught up in an endless loop once this scenario comes into play (the 5th move usually in my game)

      def cpu_block_player
        winning_combinations = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]]
        executed = 0
        winning_combinations.each do |combination|
          result_of_combination = """"
          result_of_combination = combination.inject("""") {|result, element| result + @board[element]}
          if result_of_combination == ""XXe"" || result_of_combination == ""eXX"" || result_of_combination == ""XeX""
            executed += 1
            puts executed 
            player_move(@current_turn, result_of_combination.index(""e""))     
          end
          break if executed >= 1
       end
","2013-08-21 15:54:21"
"17690492","refactoring ruby code inject issues","-1","<ruby><inject>","2013-08-22 07:52:33"
"17690492","refactoring ruby code inject issues","-1","<ruby><artificial-intelligence><inject>","2013-08-21 15:54:21"
"17690492","refactoring ruby code inject issues","-1","{""Voters"":[{""Id"":314166,""DisplayName"":""sawa""},{""Id"":238886,""DisplayName"":""Wayne Conrad""},{""Id"":1369235,""DisplayName"":""hims056""},{""Id"":913543,""DisplayName"":""LaurentG""},{""Id"":2223390,""DisplayName"":""iMani""}]}","2014-03-03 05:46:55"
"44548693","refactoring duplicate javascript click events","-1","refactoring duplicate javascript click events","2017-06-14 15:18:00"
"44548693","refactoring duplicate javascript click events","-1","I have the following javascript click events. There is an indeterminate amount of `cat-#` classes. How can I best refactor this to avoid this code duplication as well as the ability to handle additional numbers that aren't hard coded?

    $(document).on('click', '#browse-category .cat-1', function (e) {
        $('#browse-condition li[class^=""cat""').addClass('hidden');
        $('#browse-condition .cat-1').removeClass('hidden');
    });
    
    $(document).on('click', '#browse-category .cat-2', function (e) {
        $('#browse-condition li[class^=""cat""').addClass('hidden');
        $('#browse-condition .cat-2').removeClass('hidden');
    });
    
    $(document).on('click', '#browse-category .cat-3', function (e) {
        $('#browse-condition li[class^=""cat""').addClass('hidden');
        $('#browse-condition .cat-3').removeClass('hidden');
    });
    
    $(document).on('click', '#browse-category .cat-4', function (e) {
        $('#browse-condition li[class^=""cat""').addClass('hidden');
        $('#browse-condition .cat-4').removeClass('hidden');
    });
    
    $(document).on('click', '#browse-category .cat-5', function (e) {
        $('#browse-condition li[class^=""cat""').addClass('hidden');
        $('#browse-condition .cat-5').removeClass('hidden');
    });","2017-06-14 15:18:00"
"44548693","refactoring duplicate javascript click events","-1","<javascript><jquery>","2017-06-14 15:18:00"
"23745276","refactoring switch code in a Razor view page","-1","Asp.Net MVC optimizing switch code","2014-05-19 19:01:53"
"23745276","refactoring switch code in a Razor view page","-1","I am trying to optimize the below asp.net mvc code by reusing image tag using a variable. Could some one throw idea on optimizing this code/ refractoring code  by adding variables and reusing img tag?


    @model int
    
    @{
        switch (Model)
        {
            case 0:
            <text>
                <img title=""abc"" class=""Container"" src=""@Url.Content(Links.Content.Images.1_png)"" />
            </text>
                break;
            case 1:
            <text>
                <img title=""def"" class=""Container"" src=""@Url.Content(Links.Content.Images.2_png)"" />
            </text>
                break;
            case 2:
            <text>
                <img title=""ghi"" class=""Container"" src=""@Url.Content(Links.Content.Images.3_png)"" />
            </text>
                break;
            case 3:
            <text>
                <img title=""jkl"" class=""Container"" src=""@Url.Content(Links.Content.Images.4_png)"" />
            </text>
                break;
        }   
    }","2014-05-19 19:01:53"
"23745276","refactoring switch code in a Razor view page","-1","<asp.net><asp.net-mvc><razor><switch-statement>","2014-05-19 19:01:53"
"23745276","refactoring switch code in a Razor view page","-1","refactoring switch code in a Razor view page","2014-05-19 19:25:30"
"23745276","refactoring switch code in a Razor view page","-1","Asp.Net MVC refractoring switch code","2014-05-19 19:07:23"
"23745276","refactoring switch code in a Razor view page","-1","I am trying to optimize the below asp.net mvc code by reusing image tag using a variable. Could some one throw idea on optimizing this code/ refactoring code  by adding variables and reusing img tag?


    @model int
    
    @{
        switch (Model)
        {
            case 0:
            <text>
                <img title=""abc"" class=""Container"" src=""@Url.Content(Links.Content.Images.1_png)"" />
            </text>
                break;
            case 1:
            <text>
                <img title=""def"" class=""Container"" src=""@Url.Content(Links.Content.Images.2_png)"" />
            </text>
                break;
            case 2:
            <text>
                <img title=""ghi"" class=""Container"" src=""@Url.Content(Links.Content.Images.3_png)"" />
            </text>
                break;
            case 3:
            <text>
                <img title=""jkl"" class=""Container"" src=""@Url.Content(Links.Content.Images.4_png)"" />
            </text>
                break;
        }   
    }","2014-05-19 19:25:30"
"32748552","refactoring legacy spring framework 4.0.1 to support spring boot RestControllers","-1","refactoring legacy spring framework 4.0.1 to support spring boot RestControllers","2015-09-23 20:05:52"
"32748552","refactoring legacy spring framework 4.0.1 to support spring boot RestControllers","-1","In a broader sense I'd like to be able to have the advantages of spring boot in a traditional ""do everything by hand"" spring framework project. Since the JPA repositories, services and providers are written by hand so far, a soft switch-over to the spring boot way would be perfect. I'd like to use `@RestController(""mymodel"")` type annotations.

	<spring.version>4.0.1.RELEASE</spring.version>
	<org.springframework.security.version>3.2.3.RELEASE</org.springframework.security.version>
	<org.springframework.data.spring-data-jpa.version>1.5.0.RELEASE</org.springframework.data.spring-data-jpa.version>","2015-09-23 20:05:52"
"32748552","refactoring legacy spring framework 4.0.1 to support spring boot RestControllers","-1","<spring><spring-boot>","2015-09-23 20:05:52"
"35801259","refactoring ruby methods in rails","-1","refactoring ruby methods in rails","2016-03-04 16:34:40"
"35801259","refactoring ruby methods in rails","-1","I have the following code in my notification model in my rails app. 

I'd like to refactor it a bit. What is wrong for sure is this ""check if object exists then do something with it"" part. I guess I could use `try` but I don't know how it exactly works. Can sby tell me how to do that (with `try` or if there is a better way then with that)?

Any other observations regarding the rest of the code?


    #check and decrease chat notification that happens between 2 given users (since 1v1 chat notification number max limit is 1)
    def self.decreasing_chat_notification_number(current_user, user)
      if self.between_chat_recipient(current_user, user).unchecked.any?
        notification = self.between_chat_recipient(current_user, user).unchecked.first
        checking_and_decreasing_notification(notification)
      end
    end

    #check and decrease all the task notifications that happens between 2 given users
    def self.decreasing_task_notification_number(current_user, user)
      if self.task.between_other_recipient(current_user, user).unchecked
        self.task.between_other_recipient(current_user, user).unchecked.each do |notification|
          checking_and_decreasing_notification(notification)
        end
      end
    end

    #check and decrease all the post notifications that happened on a given post
    def self.decreeasing_post_notification_number(current_user, post)
      if self.post.this_post_comments(current_user, post).unchecked
        self.post.this_post_comments(current_user, post).unchecked.each do |notification|
          checking_and_decreasing_notification(notification)
        end
      end
    end

    private

    def check_notification #chat notification gets checked
      if self.checked_at == nil
        update_attributes(checked_at: Time.zone.now)
      end
    end

    def checking_and_decreasing_notification(notification)
      notification.check_notification
      current_user.decrease_new_other_notifications
      current_user.decreased_other_number_pusher
    end","2016-03-04 16:34:40"
"35801259","refactoring ruby methods in rails","-1","<ruby-on-rails><ruby><refactoring>","2016-03-04 16:34:40"
"35801259","refactoring ruby methods in rails","-1","I have the following code in my notification model in my rails app. 

I'd like to refactor it a bit. What is wrong for sure is this ""check if object exists then do something with it"" part. I guess I could use `try` but I don't know how it exactly works. Can sby tell me how to do that (with `try` or if there is a better way then with that)?

Any other observations regarding the rest of the code?


    #check and decrease chat notification that happens between 2 given users (since 1v1 chat notification number max limit is 1)
    def self.decreasing_chat_notification_number(current_user, user)
      if self.between_chat_recipient(current_user, user).unchecked.any?
        notification = self.between_chat_recipient(current_user, user).unchecked.first
        checking_and_decreasing_notification(notification)
      end
    end

    #check and decrease all the task notifications that happens between 2 given users
    def self.decreasing_task_notification_number(current_user, user)
      if self.task.between_other_recipient(current_user, user).unchecked
        self.task.between_other_recipient(current_user, user).unchecked.each do |notification|
          checking_and_decreasing_notification(notification)
        end
      end
    end

    #check and decrease all the post notifications that happened on a given post
    def self.decreeasing_post_notification_number(current_user, post)
      if self.post.this_post_comments(current_user, post).unchecked
        self.post.this_post_comments(current_user, post).unchecked.each do |notification|
          checking_and_decreasing_notification(notification)
        end
      end
    end

    private

    def check_notification #chat notification gets checked
      if self.checked_at == nil
        update_attributes(checked_at: Time.zone.now)
      end
    end

    def checking_and_decreasing_notification(notification)
      notification.check_notification
      current_user.decrease_new_other_notifications
      current_user.decreased_other_number_pusher
    end

scopes:

    scope :not_chat, -> { where.not(notifiable_type: ""Message"") }
    scope :chat, -> { where(notifiable_type: ""Message"") }
    scope :task, -> { where(notifiable_type: ""Task"") }
    scope :post, -> { where(notifiable_type: ""Post"") }
    scope :checked, -> { where.not(checked_at: nil) }
    scope :unchecked, -> { where(checked_at: nil) }
    scope :this_post_comments, -> (recipient_id, post_id) do
      where(""notifications.recipient_id = ? AND notifications.notifiable_id = ?"", recipient_id, post_id)
    end
    scope :between_chat_recipient, -> (recipient_id, sender_id) do
      where(""notifications.recipient_id = ? AND notifications.sender_id = ? AND notifications.notifiable_type = ?"", recipient_id, sender_id, ""Message"")
    end
    scope :between_other_recipient, -> (recipient_id, sender_id) do
      where(""notifications.recipient_id = ? AND notifications.sender_id = ?"", recipient_id, sender_id)
    end
","2016-03-04 17:11:39"
"35801259","refactoring ruby methods in rails","-1","I have the following code in my notification model in my rails app. 

I'd like to refactor it a bit. What is wrong for sure is this ""check if object exists then do something with it"" part. I guess I could use `try` but I don't know how it exactly works. Can sby tell me how to do that (with `try` or if there is a better way then with that)?

Any other observations regarding the rest of the code?


    #check and decrease chat notification that happens between 2 given users (since 1v1 chat notification number max limit is 1)
    def self.decreasing_chat_notification_number(current_user, user)
      if self.between_chat_recipient(current_user, user).unchecked.any?
        notification = self.between_chat_recipient(current_user, user).unchecked.first
        checking_and_decreasing_notification(notification)
      end
    end

    #check and decrease all the task notifications that happens between 2 given users
    def self.decreasing_task_notification_number(current_user, user)
      if self.task.between_other_recipient(current_user, user).unchecked
        self.task.between_other_recipient(current_user, user).unchecked.each do |notification|
          checking_and_decreasing_notification(notification)
        end
      end
    end

    #check and decrease all the post notifications that happened on a given post
    def self.decreeasing_post_notification_number(current_user, post)
      if self.post.this_post_comments(current_user, post).unchecked
        self.post.this_post_comments(current_user, post).unchecked.each do |notification|
          checking_and_decreasing_notification(notification)
        end
      end
    end

    private

    def check_notification #chat notification gets checked
      if self.checked_at == nil
        update_attributes(checked_at: Time.zone.now)
      end
    end

    def checking_and_decreasing_notification(notification)
      notification.check_notification
      current_user.decrease_new_other_notifications
      current_user.decreased_other_number_pusher
    end

scopes:

    scope :not_chat, -> { where.not(notifiable_type: ""Message"") }
    scope :chat, -> { where(notifiable_type: ""Message"") }
    scope :task, -> { where(notifiable_type: ""Task"") }
    scope :post, -> { where(notifiable_type: ""Post"") }
    scope :checked, -> { where.not(checked_at: nil) }
    scope :unchecked, -> { where(checked_at: nil) }
    scope :this_post_comments, -> (recipient_id, post_id) do
      where(""notifications.recipient_id = ? AND notifications.notifiable_id = ?"", recipient_id, post_id)
    end
    scope :between_chat_recipient, -> (recipient_id, sender_id) do
      where(""notifications.recipient_id = ? AND notifications.sender_id = ? AND notifications.notifiable_type = ?"", recipient_id, sender_id, ""Message"")
    end
    scope :between_other_recipient, -> (recipient_id, sender_id) do
      where(""notifications.recipient_id = ? AND notifications.sender_id = ?"", recipient_id, sender_id)
    end

UPDATE:

Everything is called on current_user as instance method instead of Notification.class_method. Btw. user table has `""new_chat_notification"",default: 0` and `""new_other_notification"", default: 0` attributes to count the number of current notifications.

user.rb

      #check and decrease chat notification that happens between 2 given users (max 1)
      def decreasing_chat_notification_number(user)
        notification = self.notifications.between_chat_recipient(user).unchecked.first
        self.checking_and_decreasing_notification(notification) if notification.present?
      end
    
      #check and decrease task notifications that happens between 2 given users
      def decreasing_task_notification_number(user)
        self.notifications.task.between_other_recipient(user).unchecked.each do |notification|
          self.checking_and_decreasing_notification(notification)
        end
      end
    
      #check and decrease the post notification that belongs to a given post
      def decreasing_post_notification_number(post_id)
        self.notifications.this_post_comments(post_id).unchecked.each do |notification|
          self.checking_and_decreasing_notification(notification)
        end
      end
    
      def checking_and_decreasing_notification(notification)
        notification.check_notification
        if notification.notifiable_type == ""Message""
          self.decrease_new_chat_notifications
          self.decreased_chat_number_pusher
        else
          self.decrease_new_other_notifications
          self.decreased_other_number_pusher
        end
      end

      def decrease_new_chat_notifications
        decrement!(:new_chat_notification) if self.new_chat_notification > 0
      end

 
      def decrease_new_other_notifications
        decrement!(:new_other_notification) if self.new_other_notification > 0
      end

      def decreased_chat_number_pusher
        number = self.new_chat_notification
        Pusher['private-'+ self.id.to_s].trigger('new_chat_notification', {:number => number})
      end

      def decreased_other_number_pusher
        number = self.new_other_notification
        Pusher['private-'+ self.id.to_s].trigger('new_other_notification', {:number => number})
      end

notification.rb

    scope :not_chat, -> { where.not(notifiable_type: ""Message"") }
    scope :chat, -> { where(notifiable_type: ""Message"") }
    scope :task, -> { where(notifiable_type: ""Task"") }
    scope :post, -> { where(notifiable_type: ""Post"") }
    scope :checked, -> { where.not(checked_at: nil) }
    scope :unchecked, -> { where(checked_at: nil) }

    scope :this_post_comments, -> (post_id) do
      where(""notifications.notifiable_id = ?"", post_id)
    end

    scope :between_chat_recipient, -> (sender_id) do
      where(""notifications.sender_id = ? AND notifications.notifiable_type = ?"", sender_id, ""Message"")
    end

    scope :between_other_recipient, -> (sender_id) do
      where(""notifications.sender_id = ? AND notifications.notifiable_type != ?"", sender_id, ""Message"")
    end

    def check_notification #chat notification gets checked
      update_attribute(:checked_at, Time.zone.now) if self.checked_at.nil?
    end
","2016-03-07 17:55:03"
"16506434","refactor this long but simple code - string comparing","-1","refactor this long but simple code - string comparing","2013-05-12 10:29:56"
"16506434","refactor this long but simple code - string comparing","-1","Given two strings, return true if either of the strings appears at the very end of the other string, ignoring upper/lower case differences (in other words, the computation should not be ""case sensitive""). Note: str.toLowerCase() returns the lowercase version of a string.

endOther(""Hiabc"", ""abc"") → true

endOther(""AbC"", ""HiaBc"") → true

endOther(""abc"", ""abXabc"") → true



    public class endOtherClass{  
          public static void main(String args[]) {  
              boolean is = endOther(""yz"",""12xz"") ;  
              System.out.println(is) ;  
              
          }  
            
         public static boolean endOther(String a, String b) {  
          
           a = a.toLowerCase() ;  
           b = b.toLowerCase() ;  
          
           if( a.length() == b.length()){  
                    System.out.println(""a and b have same length!"") ;  
          
                    if(a.equals(b)){  
                         System.out.println(""wow, even better - they are exact same"") ;   
                         return true ;  
                              }  
                    else {  
                              System.out.println(""but are diff!"") ;  
                               return false ;  
                              }  
           }  
             
                String shorter = """" ;// figure out which - a or b - is shorter   
                String longer = """" ;// and which one is longer  
                  
                if( a.length() > b.length() ){ shorter = b ; longer = a ;}   
                else { shorter = a ; longer = b ;}  
          
                int offset = longer.length() - shorter.length() ; // the offset is used to know where exactly to start comparing  
                                                                                      
          
                //go through the shorter and compare the corresponding part of the longer string  
          
                for(int i = 0 ; i < shorter.length() ; i++){  
                     System.out.println(""comparing subs: "" + shorter.substring(i,i+1) + "" and "" + longer.substring(offset+i, offset+i+1)) ;   
          
          
                 if( !shorter.substring(i,i+1).equals( longer.substring(offset+i, offset+i+1) ) ){    //we add offset so we can start comparing the last n characters of shorter string!  
          
                       System.out.println(""something wrong in long: "" + longer.substring(offset+i, offset+i+1)) ;  
          
                       System.out.println(""something wrong in short: "" + shorter.substring(i,i+1)) ;  
                       return false ;  
                     }  
                }  
                return true ;  
          
          }  
            
            
        }  

i m 90% sure this code can be simplified, but i don't know other logic or way of thinking about this simple exercise

can someone help me refactor it and make it smaller?

","2013-05-12 10:29:56"
"16506434","refactor this long but simple code - string comparing","-1","<java><string>","2013-05-12 10:29:56"
"16506434","refactor this long but simple code - string comparing","-1","{""Voters"":[{""Id"":1343161,""DisplayName"":""Keppil""},{""Id"":387981,""DisplayName"":""Matteo""},{""Id"":863380,""DisplayName"":""Muhammad Reda""},{""Id"":101361,""DisplayName"":""laalto""},{""Id"":567249,""DisplayName"":""Fls'Zen""}]}","2013-05-13 12:09:00"
"46457599","refactor method in ruby instead 3 calls to DB make it one call","-1","refactor method in ruby instead 3 calls to DB make it one call","2017-09-27 21:36:22"
"46457599","refactor method in ruby instead 3 calls to DB make it one call","-1","    def post_stat
        @urls = CallUrl.all
        call = params[:call_url_id] ? params[:call_url_id] : CallUrl.first.id
        call_url = CallUrl.find(call)
        @Posts = callback_url.posts
    end
I am trying to refactor this code to make only one call to database insted of 3 times in each class I am calling?","2017-09-27 21:36:22"
"46457599","refactor method in ruby instead 3 calls to DB make it one call","-1","<ruby>","2017-09-27 21:36:22"
"2046370","refactor dilemma","-1","refactor dilemma","2010-01-12 02:45:17"
"2046370","refactor dilemma","-1","I want to extract the guard statement from the following method    

    private void CreateProxy()
        {
            //extract the following guard statement.
            Host selected = this.comboBox1.SelectedItem as Host;
            if (selected == null)
            {
                return;
            }


            this.SearchProxy = ServiceProxy.ProxyFactory.CreateSearchProxy(GetSelectedIP().ToString());
            this.StreamProxy = ServiceProxy.ProxyFactory.CreatePlayerProxy(GetSelectedIP().ToString());
        }

         //extracted guard method
         public bool IsHostSelected()
         {
            Host selected = this.comboBox1.SelectedItem as Host;
            if (selected == null)
            {
                return false;
            }
            return true;
         }


see? now i have to add return value from the extracted method, is this kinda not so elegant or not?
any better solution?","2010-01-12 02:45:17"
"2046370","refactor dilemma","-1","<refactoring>","2010-01-12 02:45:17"
"2046370","refactor dilemma","-1","I want to extract the guard statement from the following method    

    private void CreateProxy()
        {
            //extract the following guard statement.
            Host selected = this.comboBox1.SelectedItem as Host;
            if (selected == null)
            {
                return;
            }


            this.SearchProxy = ServiceProxy.ProxyFactory.CreateSearchProxy(GetSelectedIP().ToString());
            this.StreamProxy = ServiceProxy.ProxyFactory.CreatePlayerProxy(GetSelectedIP().ToString());
        }

         //extracted guard method
         public bool IsHostSelected()
         {
            Host selected = this.comboBox1.SelectedItem as Host;
            if (selected == null)
            {
                return false;
            }
            return true;
         }


see? now i have to add return value for the extracted method, is this kinda ugly?

any better solution to avoid adding the return value for the extracted method?","2010-01-12 02:50:40"
"47144085","refactoring the replace method in JavaScript","-1","refactoring the replace method in JavaScript","2017-11-06 19:11:42"
"47144085","refactoring the replace method in JavaScript","-1","    var x = ""mike^+tom&+craig+^tom;
    
    var y = x.replace('^+', '').replace('&+', '').replace('+^', '');

    y = mike tom craig tom; // This is the output


Instead of chaining the replacing like above, can we do it other way in JavaScript?","2017-11-06 19:11:42"
"47144085","refactoring the replace method in JavaScript","-1","<javascript><replace>","2017-11-06 19:11:42"
"47144085","refactoring the replace method in JavaScript","-1","    var x = ""mike^+tom&+craig+^tom"";
    
    var y = x.replace('^+', '+').replace('&+', '+').replace('+^', '+');

    y = mike++tom++craig++tom; // This is the output
    
    expected mike+tom+craig+tom;


Instead of chaining the replacing like above, can we do it other way in JavaScript?","2017-11-06 19:18:44"
"47144085","refactoring the replace method in JavaScript","-1","    var x = ""mike^+tom&+craig+^tom;
    
    var y = x.replace('^+', '+').replace('&+', '+').replace('+^', '+');

    y = mike++tom++craig++tom; // This is the output
    
    expected mike+tom+craig+tom;


Instead of chaining the replacing like above, can we do it other way in JavaScript?","2017-11-06 19:15:40"
"21719687","refactor regex ruby code","-2","refactor regex ruby code","2014-02-12 05:46:48"
"21719687","refactor regex ruby code","-2","I want to get the resource name from a class name like:

> ""SequelAdapter::UserGraph""

So I would want user in this case.

Currently I have this code which does work but is very ugly:

    klass = object.class.to_s
    
    if start = klass =~ /[::][A-Za-z]*Graph/
      finish = klass =~ /Graph/
    
      klass = klass[start + 1, finish - start - 1]
    end

Can anyone suggest a better way?
","2014-02-12 05:46:48"
"21719687","refactor regex ruby code","-2","<ruby><regex>","2014-02-12 05:46:48"
"30934698","refactoring if else","-2","refactoring if else c#","2015-06-19 09:32:42"
"30934698","refactoring if else","-2","I am refactoring a legacy code. There is a big if else statement. Is that  a pattern I can use. I have used a dictionary in the past for if-else but this has lot of (&&) so don't know how to refactor this.

for eg the code is

 
        public void ChangeControlVisibiltiy(string Name)
        {
            if (Name == ""A"")
            {
                 controlA.visibile = true;
            }
             if ((Name == ""A"") && (Name == ""B"") && (Name ==""C""))
            {
                 controlC.visibile =true;
            }
             if ((Name == ""A"") && (Name == ""B"") && (Name == ""E""))
             {
                 controlD.visibile = true;
             }
             else if (Name == ""Q"")
             {
                 controlQ.visibile = true;
             }
         }

","2015-06-19 09:32:42"
"30934698","refactoring if else","-2","<if-statement><refactoring>","2015-06-19 09:32:42"
"30934698","refactoring if else","-2","refactoring if else","2015-06-19 09:34:17"
"30934698","refactoring if else","-2","I am refactoring a legacy code. There is a big if else statement. Is that  a pattern I can use. I have used a dictionary in the past for if-else but this has lot of (&&) so don't know how to refactor this.

for eg the code is

 
        public void ChangeControlVisibiltiy(string Name)
        {
            if (Name == ""A"")
            {
                 controlA.visibile = true;
            }
             if ((Name == ""A"") && (Name == ""B"") && (Name ==""C""))
            {
                 controlC.visibile =true;
            }
             if ((Name == ""A"") && (Name == ""D"") && (Name == ""E""))
             {
                 controlD.visibile = true;
             }
             else if (Name == ""Q"")
             {
                 controlQ.visibile = true;
             }
         }

","2015-06-19 09:36:18"
"30934698","refactoring if else","-2","I am refactoring a legacy code. There is a big if else statement. Is that  a pattern I can use. I have used a dictionary in the past for if-else but this has lot of (&&) so don't know how to refactor this.

for eg the code is

 
        public void ChangeControlVisibiltiy()
        {
            if (Name == ""A"")
            {
                 controlA.visibile = true;
            }
             if ((Name == ""A"") && (Name == ""B"") && (Name ==""C""))
            {
                 controlC.visibile =true;
            }
             if ((Name == ""A"") && (Name == ""D"") && (Name == ""E""))
             {
                 controlD.visibile = true;
             }
             else if (Name == ""Q"")
             {
                 controlQ.visibile = true;
             }
         }

","2015-06-19 09:37:18"
"30934698","refactoring if else","-2","I am refactoring a legacy code. There is a big if else statement. Is that  a pattern I can use. I have used a dictionary in the past for if-else but this has lot of (&&) so don't know how to refactor this.

for eg the code is

 
        public void ChangeControlVisibiltiy()
          {
            if (name != ""I"")
            {
               //Do something
            }



            if ((name != ""A"") && (name != ""B"") && (name != ""C"") && (name != ""D"") && (name != ""F"") && (name != ""G"") && (name != ""H"") && (name != ""I"") && (name != ""J"") && (name != ""H"") && (name != ""I"") && (name != ""J""))
            {
               //Do something
            }

            if ((name != ""A"") && (name != ""B"") && (name != ""D"") && (name != ""F"") && (name != ""G"") && (name != ""H"") && (name != ""I"") && (name != ""J"") && (name != ""H"") && (name != ""I"") && (name != ""J""))
            {
                //Do something
               
            }

            if ((name != ""A""))
            {
                //Do something
            }


            if ((name != ""A"") && (name != ""K"") && (name != ""L"") )
            {

               //Do something
            }

        
            if ((name != ""A"") && (name != ""K"") && (name != ""L"") && (name != ""B"") && (name != ""D"") && (name != ""F"") && (name != ""G"") && (name != ""H"") && (name != ""I"") && (name != ""J"") && (name != ""H"") && (name != ""I""))
            {
					//Do something
            }


            if ((name != ""A"") && (name != ""L""))
            {

               //Do something
            }

            if (name == ""M"")
            {
               //Do something
            }

            else if (name == ""C"")
            {
                //Do something
            }
            else
            {
              //Do something
            }

			}","2015-06-19 09:46:13"
"30934698","refactoring if else","-2","<c#><refactoring>","2015-06-19 09:34:17"
"33082761","refactor an array in ruby","-2","refactor an array in ruby","2015-10-12 13:44:04"
"33082761","refactor an array in ruby","-2","I have an array called ""dates"" that looks like this...

    @dates = [ 
        {:month => 'apr', :start_date => '2015-04-01', :end_date => '2015-05-01'}, 
        {:month => 'may', :start_date => '2015-05-01', :end_date => '2015-06-01'},
        {:month => 'jun', :start_date => '2015-06-01', :end_date => '2015-07-01'},
        {:month => 'jul', :start_date => '2015-07-01', :end_date => '2015-08-01'},
        {:month => 'aug', :start_date => '2015-08-01', :end_date => '2015-09-01'},
        {:month => 'sep', :start_date => '2015-09-01', :end_date => '2015-10-01'},
        {:month => 'oct', :start_date => '2015-10-01', :end_date => '2015-11-01'},
        {:month => 'nov', :start_date => '2015-11-01', :end_date => '2015-12-01'},
        {:month => 'dec', :start_date => '2015-12-01', :end_date => '2016-01-01'},
        {:month => 'jan', :start_date => '2016-01-01', :end_date => '2016-02-01'},
        {:month => 'feb', :start_date => '2016-02-01', :end_date => '2016-03-01'},
        {:month => 'mar', :start_date => '2016-03-01', :end_date => '2016-04-01'}
        ]

I'd love to refactor this but it's beyond me. I tried working towards something like this but got lost in the fact that the jan / feb / march dates would be in the next calendar year....

    @months = I18n.t(""date.abbr_month_names"").compact.rotate(3).map(&:downcase)
    
    @dates = []
    @months.@months.each_with_index do |mon, x|
      @dates << {:month => mon, :start_date => Date.parse(mon).beginning_of_month, :end_date => Date.parse(mon).end_of_month + 1}
    end

this ALMOST works, but the last three months are in next year. I have a feeling I could something with the index but cannot get my head round it

any ideas?","2015-10-12 13:44:04"
"33082761","refactor an array in ruby","-2","<ruby-on-rails><ruby>","2015-10-12 13:44:04"
"6164909","refactor a php 5 application with no framework to work with zend framework","-5","transfor a php 5 application to work with zend framework","2011-05-28 23:10:14"
"6164909","refactor a php 5 application with no framework to work with zend framework","-5","> Blockquote

i have a complete web aplication with php5 my question is there an easy way to transform it so it work with zend framework?`

<?php class Projet extends Modele
	{
		var $id_proj;
		var $libelle;
		var $date_Create;
		var $projet_html;
		var $html;
		var	$nbr_bloc;
		var $date_modif;
		var $etat;
		var $width;
		var $height;
		var $bg_color;
		var $border;
		}","2011-05-28 23:10:14"
"6164909","refactor a php 5 application with no framework to work with zend framework","-5","<php><zend-framework><php5>","2011-05-28 23:10:14"
"6164909","refactor a php 5 application with no framework to work with zend framework","-5","refactor a php 5 application with no framework to work with zend framework","2011-05-28 23:19:35"
"6164909","refactor a php 5 application with no framework to work with zend framework","-5","I have a complete web aplication with php5 my question is there an easy way to transform it so it work with zend framework?

    <?php class Projet extends Modele
    	{
    		var $id_proj;
    		var $libelle;
    		var $date_Create;
    		var $projet_html;
    		var $html;
    		var	$nbr_bloc;
    		var $date_modif;
    		var $etat;
    		var $width;
    		var $height;
    		var $bg_color;
    		var $border;
    		}","2011-05-28 23:12:08"
"6164909","refactor a php 5 application with no framework to work with zend framework","-5","<php><zend-framework>","2012-12-20 19:34:54"
"6164909","refactor a php 5 application with no framework to work with zend framework","-5","{""Voters"":[{""Id"":142162,""DisplayName"":""Tim Cooper""},{""Id"":208809,""DisplayName"":""Gordon""},{""Id"":85140,""DisplayName"":""the_drow""},{""Id"":451969,""DisplayName"":""Jared Farrish""},{""Id"":215966,""DisplayName"":""prodigitalson""}]}","2011-05-28 23:31:08"