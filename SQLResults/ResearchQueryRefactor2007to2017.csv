Id,Title,Score,Body,CreationDate
"6855283","refactor function error - ""is not part of the build phase of any targets in the Xcode 3 projects in this workspace and so can't be refactored""","18","<p>Trying to rename a function's name via the refactor->rename button in a categoriy's .h file in XCode 4.1 I'm getting this error: (error and body)</p>

<p>UINavigationController+ZG.h is not part of the build phase of any targets in the Xcode 3 projects in this workspace and so can’t be refactored.</p>

<p>Add the file to the build phase of a target in an Xcode 3 project in this workspace, or make a selection in another file.</p>

<p>Not sure what it wants and why it's saying something about xcode 3 when i don't have any xcode 3 projects or anything like that.</p>
","2011-07-28 07:13:03"
"25424074","refactor large AngularJS module config into separate files","15","<h3>Problem: Large <code>config()</code></h3>

<p>The config of my AngularJS app is growing quite large. How would you refactor the following into separate files?</p>

<pre><code>// app.js
angular.module('myApp')
    .config(function($urlRouterProvider, $stateProvider, $httpProvider) {
        // Configure routing (uiRouter)
        $urlRouterProvider.when('/site', '/site/welcome');
        $stateProvider.state('main', ...
        ...

        // Configure http interceptors
        $httpProvider.interceptors.push(function () {              
            ...
        });
    });
</code></pre>

<hr>

<h3>Option 1. Multiple <code>config()</code>s</h3>

<p>I know that I can have multiple <code>config()</code>s and place them in separate files like this:</p>

<pre><code>// app.js
angular.module('myApp');

// routerConfiguration.js
angular.module('myApp')
    .config(function($urlRouterProvider, $stateProvider) {
        // Configure routing (uiRouter)
        $urlRouterProvider.when('/site', '/site/welcome');
        $stateProvider.state('main', ...
        ...

// httpInterceptorConfig.js
angular.module('myApp')
    .config(function($httpProvider) {
        // Configure http interceptors
        $httpProvider.interceptors.push(function () {              
            ...
        });
    });
</code></pre>

<p>What I do not like about this, is that in the original app.js, <strong>there is no way of getting an overview</strong> of what is run at startup. </p>

<hr>

<h3>Option 2. Inject something</h3>

<p>I would prefer to do something like this, because it would be easier to see what is configured, directly in the app.js. However I know that this is not possible, since we cannot inject services into <code>config()</code>. </p>

<p><strong>Can I use providers to solve this? Is there a better way?</strong></p>

<pre><code>// app.js
angular.module('myApp')
    .config(function(routerConfig, httpInterceptorConfig) {
        routerConfig.setup();
        httpInterceptorConfig.setup();
    });

// routerConfig.js
angular.module('myApp')
    .factory('routerConfig', function($urlRouterProvider, $stateProvider) {
        return {
            setup: function() {
                // Configure routing (uiRouter)
                $urlRouterProvider.when('/site', '/site/welcome');
                $stateProvider.state('main', ...
                ...
            }
        };
    });
});

// httpInterceptorConfig.js
angular.module('myApp')
    .factory('httpInterceptorConfig', function($httpProvider) {
        return {
            setup: function() {
                // Configure http interceptors
                $httpProvider.interceptors.push(function () {              
                ...
            }
        };
    });
});
</code></pre>
","2014-08-21 10:31:43"
"12434127","refactoring to arc results in ""synthesize of 'weak' property is only allowed in arc or gc mode""","8","<p>i am using xcode 4.4.1 for iOS target 5.1
i've started my project using ARC, and in the middle of the project I've added some non-arc thirdparty source to my project.
at this point, i've decided to try refactoring in xcode and an error occurs.
it comes from one of my original source code. </p>

<p>i have a property of (nonatomic, weak) and i've synthesized it ==> synthesize of 'weak' property is only allowed in ARC or GC mode. </p>

<p>I am puzzeled - i am using arc and it complains that it is only allowed in arc??</p>

<p>At the moment, i've refactored the thirdparty app from other project and copied it for my project to work, but the above is a question I'd still like to understand why .
Thanks! 
(by the way, when i do convert to arc, it says that the target currently uses ARC)</p>
","2012-09-15 02:48:52"
"769351","refactoring LINQ IQueryable expression to remove duplicated portions of queries","7","<p>I have some linq queries that have redundancy I'd like to factor out a single piece of code.  These are join experssions that are IQueryable, and its important I don't cause the query to be evaluated earlier than it would be without the refactoring.</p>

<p>Here is a simplified query:</p>

<pre><code>var result = 
from T in db.Transactions
join O in db.Orders on T.OrderID equals O.OrderID
join OD in db.OrderDetails on O.OrderID equals OD.OrderID into OrderDetails
let FirstProductBought = OrderDetails.First().Select(OD =&gt; OD.Product.ProductName)
select new
{
  TransactionID = T.TransactionID,
  OrderID = O.OrderID,
  FirstProductBought = FirstProductBought
};
</code></pre>

<p>What I want to factor out is th logic ""given an order, what is the first product bought"".  I am using the same logic in other queries.  How can I factor it out into a shared method?</p>

<p>Generally, for code reuse and IQueryables, what I've been able to do is code that takes an IQueryable going in and produces an IQueryable/IOrderedQueryable as output.  With such functions I can build up LINQ expressions with reusable code that still defer query until the query is fully constructed.  Here, since I only have an int (the orderID) I'm not sure how to make it work.</p>

<p>thanks</p>
","2009-04-20 17:47:10"
"6033146","refactoring large cursor queries by splitting into multiple cursors","6","<p>Another PL/SQL refactoring question!</p>

<p>I have several cursors that are of the general simplified form:</p>

<pre><code>cursor_1 is
  with X as (select col1, col2 from TAB where col1 = '1'),
       Y as (select col1, col2 from TAB where col2 = '3'),
  /*main select*/
  select count(X.col1), ...
  from X inner join Y on...
  group by rollup (X.col1, ...

cursor_2 is
  with X as (select col1, col2 from TAB where col1 = '7' and col2 = '9' and col3 = 'TEST'),
       Y as (select col1, col2 from TAB where col3 = '6'),
  /*main select*/
  select count(X.col1), ...
  from X inner join Y on...
  group by rollup (X.col1, ...


cursor_2 is
  with X as (select col1, col2 from TAB where col1 IS NULL ),
       Y as (select col1, col2 from TAB where col2 IS NOT NULL ),
  /*main select*/
  select count(X.col1), ...
  from X inner join Y on...
  group by rollup (X.col1, ...


...
begin
    for r in cursor_1 loop
       print_report_results(r);
    end loop;

    for r in cursor_2 loop
       print_report_results(r);
    end loop;
    ...
end;
</code></pre>

<p>Basically, all of these cursors (there's more than 3) are the same summary/reporting queries. The difference is in the factored subqueries. There are always 2 factored subqueries, ""X"" and ""Y"", and they always select the same columns to feed into the main reporting query.</p>

<p>The problem is that the main reporting query is VERY large, about 70 lines. This itself isn't so bad, but it was copy-pasted for ALL of the reporting queries (I think there's over a dozen).</p>

<p>Since the only difference is in the factored subqueries (and they all return the same columns, it's really just a difference in the tables they select from and their conditions) I was hoping to find a way to refactor all this so that there is ONE query for the giant report and smaller ones for the various factored subqueries so that when changes are made to the way the report is done, I only have to do it in one place, not a dozen. Not to mention a much easier-to-navigate (and read) file!</p>

<p>I just don't know how to properly refactor something like this. I was thinking pipelined functions? I'm not sure they're appropriate for this though, or if there's a simpler way...</p>

<p>On the other hand, I also wonder if performance would be significantly worse by splitting out the reporting query. Performance (speed) <em>is</em> an issue for this system. I'd rather not introduce changes for developer convenience if it adds significant execution time.</p>

<hr>

<p>I guess what I'd ultimately like is something that looks sort of like this (I'm just not sure how to do this so that it will actually compile):</p>

<pre><code>cursor main_report_cursor (in_X, in_Y) is
    with X as (select * from in_X),
         Y as (select * from in_Y)
  /*main select*/
  select count(X.col1), ...
  from X inner join Y on...
  group by rollup (X.col1, ...

cursor x_1 is
     select col1, col2 from TAB where col1 = '1';
cursor y_1 is
     select col1, col2 from TAB where col2 = '3'

...
begin
for r in main_report_cursor(x_1,y_1) loop
   print_report_results(r);
end loop;

for r in main_report_cursor(x_2,y_2) loop
   print_report_results(r);
end loop;
...
</code></pre>

<p>(Using Oracle 10g)</p>
","2011-05-17 15:22:08"
"6823936","refactoring a whole class name in whole xcode project","6","<p>I just changed my class name from Group.h to CVGroup.h and therefore everything is affected in my code. Is it possible to refactor the whole project so that Group is refactored into CVGroup?</p>
","2011-07-26 00:17:53"
"1367876","refactor conditions within haml view","5","<p>beside the fact that accessibility standards discourage the use
of a link pointing to the current page, how I am supposed to 
refactor the following view code?</p>

<pre><code>#navigation
  %ul.tabbed
    - if current_page?(new_profile_path)
      %li{:class =&gt; ""current_page_item""}
        = link_to t(""new_profile""), new_profile_path
    - else
      %li
        = link_to t(""new_profile""), new_profile_path

    - if current_page?(profiles_path)
      %li{:class =&gt; ""current_page_item""}
        = link_to t(""profiles""), profiles_path
    - else
      %li
        = link_to t(""profiles""), profiles_path
    ...
</code></pre>

<p>Thank you.</p>
","2009-09-02 13:59:43"
"1409432","refactoring Java arrays and primitives (double[][]) to Collections and Generics (List<List<Double>>)","5","<p>I have been refactoring throwaway code which I wrote some years ago in a FORTRAN-like style. Most of the code is now much more organized and readable. However the heart of the algorithm (which is performance-critical) uses 1- and 2-dimensional Java arrays and is typified by:</p>

<pre><code>    for (int j = 1; j &lt; len[1]+1; j++) {
        int jj = (cont == BY_TYPE) ? seq[1][j-1] : j-1;
        for (int i = 1; i &lt; len[0]+1; i++) {
            matrix[i][j] = matrix[i-1][j] + gap;
            double m = matrix[i][j-1] + gap;
            if (m &gt; matrix[i][j]) {
                matrix[i][j] = m;
                pointers[i][j] = UP;
            }
            //...
        }
    }
</code></pre>

<p>For clarity, maintainability and interfacing with the rest of the code I would like to refactor it. However on reading <a href=""https://stackoverflow.com/questions/185594/java-generics-syntax-for-arrays"">Java Generics Syntax for arrays</a> and   <a href=""https://stackoverflow.com/questions/877897/java-generics-and-numbers"">Java Generics and number</a>s I have the following concerns:</p>

<ul>
<li><p>Performance. The code is planned to use about 10^8 - 10^9 secs/yr and this is just about manageable. My reading suggests that changing double to Double can sometimes add a factor of 3 in performance. I'd like other experience on this. I would also expect that moving from foo[] to List would be a hit as well. I have no first-hand knowledge and again experience would be useful. </p></li>
<li><p>Array-bound checking. Is this treated differently in double[] and List and does it matter? I expect some problems to violate bounds as the algorithm is fairly simple and has only been applied to a few data sets.</p></li>
<li><p>If I don't refactor then the code has an ugly and possibly fragile intermixture of the two approaches. I am already trying to write things such as:</p>

<p>List&lt;double[]&gt; and
List&lt;Double&gt;[]</p></li>
</ul>

<p>and understand that the erasure does not make this pretty and at best gives rise to compiler warnings. It seems difficult to do this without very convoluted constructs.</p>

<ul>
<li>Obsolescence. One poster suggested that Java arrays should be obsoleted. I assume this isn't going to happen RSN but I would like to move away from outdated approaches.</li>
</ul>

<p><strong>SUMMARY</strong> The consensus so far:</p>

<ul>
<li><p>Collections have a significant performance hit over primitive arrays, especially for constructs such as matrices. This is incurred in auto(un)boxing numerics and in accessing list items</p></li>
<li><p>For tight numerical (scientific) algorithms the array notation [][] is actually easier to read but the variables should named as helpfully as possible</p></li>
<li><p>Generics and arrays do not mix well. It may be useful to wrap the arrays in classes to transport them in/out of the tight algorithm.</p></li>
</ul>

<p>There is little objective reason to make the change</p>

<p><strong>QUESTION</strong> @SeanOwen has suggested that it would be useful to take constant values out of the loops. Assuming I haven't goofed this would look like:</p>

<pre><code> int len1 = len[1];
 int len0 = len[0];
 int seq1 = seq[1];
 int[] pointersi;
 double[] matrixi;
 for (int i = 1; i &lt; len0+1; i++) {
     matrixi = matrix[i];
     pointersi = pointers[i];
 }
 for (int j = 1; j &lt; len1+1; j++) {
    int jj = (cont == BY_TYPE) ? seq1[j-1] : j-1;
    for (int i = 1; i &lt; len0+1; i++) {
        matrixi[j] = matrixi[j] + gap;
        double m = matrixi[j-1] + gap;
        if (m &gt; matrixi[j]) {
            matrixi[j] = m;
            pointersi[j] = UP;
        }
        //...
    }
}
</code></pre>

<p>I thought compilers were meant to be smart at doing this sort of thing. Do we need to still do this?</p>
","2009-09-11 07:15:28"
"7412535","refactoring long methods with fluent interfaces","4","<p>I'd like to know your opinion about using the fluent interface pattern to refactor a long method.</p>

<p><a href=""http://en.wikipedia.org/wiki/Fluent_interface"" rel=""nofollow"">http://en.wikipedia.org/wiki/Fluent_interface</a></p>

<p>The fluent pattern is not included in the refactoring books.</p>

<p>for example, say you have this long method (with a long name as it 
does many things)</p>

<pre><code>class TravelClub {

   Receipt buyAndAddPointsAndGetReceipt(long amount, long cardNumber) {
    buy(amount);
    accumulatePoints(cardNumber);
    return generateReceipt();

   }

   void buy(int amount) {...}

   void accumlatePoints(int cardNumber) {...}

   void generateRecepit() {...}

}
</code></pre>

<p>called as:</p>

<pre><code>Receipt myReceipt = myTravelClub.buyAndAddPointsAndGetReceipt(543L,12345678L);
</code></pre>

<p>That could be refactored to:</p>

<pre><code>class TravelClub {

   TravelClub buy(long amount) {
    //buy stuff
    return this;
   }

   TravelClub accumulatePoints(long cardNumber) {
    //accumulate stuff
    return this;
   }

   Receipt generateReceipt() {
    return new Receipt(...);
   }


}
</code></pre>

<p>and called as:</p>

<pre><code>Receipt myReceipt = myTravelClub.buy(543L).accumulatePoints(12345678L).generateReceipt();
</code></pre>

<p>from my point of view this is a quite good manner to decompose a long method and
also to decompose its name.</p>

<p>what do you think?</p>
","2011-09-14 07:11:07"
"6696469","refactor this basic code that determines if number is in tens, hundreds, thousands etc","4","<pre><code> if (n&lt;100) {
     x = 10;
 } else if (n&lt;1000) {
     x = 100;
 } else if (n&lt;10000) {
     x = 1000;
 } else if (n....
</code></pre>

<p>etc. etc. </p>

<p>Is there a nice concise, scalable method for this type of problem? My brain has decided to stop working. </p>
","2011-07-14 16:13:09"
"9084397","refactoring jquery selector expression","4","<p>Is there a way that I can write the following selector in a less verbose fashion (the parent id is being repeated again and again).</p>

<pre><code>$(""#parent_id .class1 , #parent_id .class2,...."")
</code></pre>

<p>Thanx!</p>
","2012-01-31 17:48:53"
"1215207","refactoring multiple if-else conditionals in a method","3","<p>I am in the process of refactoring my existing code. It actually works fine, but it is a bit cluttered with multiple if-else conditionals checking the value of one variable and change the value of a second variable to an updated value taken from a fixed enumeration structure.</p>

<pre><code>else if (var1 == 'valueX')
{
    if (var2 == MyEnum.A)
        var2 = MyEnum.B;
    else if (var2 == MyEnum.B)
        var2 = MyEnum.C;
    else if (var2 == MyEnum.C)
        var2 = MyEnum.D;
    else if (var2 == MyEnum.D)
        var2 = MyEnum.A;
}

else if (....)
{
..similar block of conditionals
}
</code></pre>

<p>I am a bit confused as to what is the best way to refactor and clean-up this code. Would you suggest the use of a switch perhaps? Or something more elegant?</p>

<p>Thanks in advance!</p>
","2009-07-31 22:37:28"
"29726494","refactor two $.each() loops to one","3","<p>I have a JSON object like this...</p>

<pre><code>{  
   ""tasks"":[  
      {  
         ""id"":""task_3"",
         ""taskName"":""Task A"",
         ""assignee"":""Barrack Obama"",
         ""timeReqOptimisitic"":""4"",
         ""timeReqNormal"":""8"",
         ""timeReqPessimistic"":""14"",
         ""timeUnit"":""Days"",
         ""timeReq"":""8.33"",
         ""positionX"":493,
         ""positionY"":101,
         ""lockStatus"":""unlocked""
      }
   ],
   ""milestones"":[  
      {  
         ""id"":""task_1"",
         ""milestoneName"":""Start"",
         ""positionX"":149,
         ""positionY"":109,
         ""lockStatus"":""unlocked"",
         ""milestoneDate"":""2015-04-07""
      },
      {  
         ""id"":""task_2"",
         ""milestoneName"":""Finish"",
         ""positionX"":989,
         ""positionY"":367,
         ""lockStatus"":""unlocked"",
         ""milestoneDate"":""2015-04-22""
      }
   ],
   ""connections"":[  
      {  
         ""connectionId"":""con_10"",
         ""pageSourceId"":""task_1"",
         ""pageTargetId"":""task_3""
      },
      {  
         ""connectionId"":""con_20"",
         ""pageSourceId"":""task_3"",
         ""pageTargetId"":""task_2""
      }
   ]
}
</code></pre>

<p>...this is a minimal version. In practice, there are numerous items in ""tasks"", ""milestones"" and ""connections"". </p>

<p>I need to iterate through the object and determine the ""id"" of the ""milestones"" item with the lowest/earliest ""milestoneDate"", then identify the ""connections"" item that has the same value for its ""pageSourceId"" and return its ""pageTargetId"".</p>

<p>So in the above example:</p>

<p>Step 1)  Iterate through the object and determine the ""id"" of the ""milestones"" item with the lowest/earliest ""milestoneDate"".</p>

<p><code>Answer: milestones.id = ""task_1""</code></p>

<p>Step 2) Identify the ""connections"" item that has the same value for its ""pageSourceId"".</p>

<p><code>Answer: connections.pageSourceId = ""task_1""</code></p>

<p>Step 3) Return its ""pageTargetId"".</p>

<p><code>Answer: ""task_3""</code></p>

<p>I have a working example <a href=""http://jsfiddle.net/sruvtwre/"" rel=""nofollow"">here</a>. However, I would like to know if there is a way to accomplish this without using the extremely high start date and also in one loop.</p>
","2015-04-19 06:17:15"
"1582256","refactoring in iSeries (RPG), is it realistic","3","<p>Implementing agile in projects requires the ability to do refactoring. It is not really a must, but code refactoring has proven to be a good engineering practice.</p>

<p>In an agile (Scrum) project on the iSeries platform, which requires development (new code and modifications to legacy code) in RPG, RPG LE, is it possible to implement refactoring? If so what are the techniques to do it?</p>

<p>If someone who has tried it could share their experience or just point to references, I would greatly appreciate it.</p>
","2009-10-17 13:50:37"
"18876149","refactoring mandatory map.get java code","3","<p>Please, any ideas on how to refactor this java code so I don't have to repeat those code blocks 3 (or more) times?</p>

<pre><code>Integer id = null;
try {
    id = (Integer)extradata.get(""id"");
}
catch(Exception e) {
    logger.error(e);
}

if (id == null) {
    logger.error(""no id set"");
    task.setStatus(Status.ERROR);
    DBService.updateTaskStatus(conn, false, task);
    conn.commit();
    return;
}

String name = null;
try {
    name = (String)extradata.get(""name"");
}
catch(Exception e) {
    logger.error(e);
}

if (name == null) {
    logger.error(""no name set"");
    task.setStatus(Status.ERROR);
    DBService.updateTaskStatus(conn, false, task);
    conn.commit();
    return;
}

String city = null;
try {
    city = (String)extradata.get(""city"");
}
catch(Exception e) {
    logger.error(e);
}

if (city == null) {
    logger.error(""no city set"");
    task.setStatus(Status.ERROR);
    DBService.updateTaskStatus(conn, false, task);
    conn.commit();
    return;
}
</code></pre>
","2013-09-18 15:17:29"
"39163040","refactoring postgres join vs except","3","<p>I'm trying to refactor one of my queries and I'm just not doing something quite right.</p>

<p>I would like to combine two queries and make one, but I'm confused on how it works with a LEFT JOIN.</p>

<blockquote>
  <p>All QuizMasters who have a state of ""active""</p>
</blockquote>

<p><strong>Minus (-)</strong></p>

<blockquote>
  <p>QuizMasters who have an ""active"" event on a given day (not all QuizMasters have events only ~25%).</p>
</blockquote>

<p><strong>Definitions</strong></p>

<blockquote>
  <ul>
  <li><strong>Events</strong> store <code>start_at</code> dow/wday for a given event, eg Monday-Sunday (albeit as a DateTime, only the wday and time are relevant).</li>
  <li><strong>Events</strong> and <strong>QuizMasters</strong> have states which are either <em>""active""</em> or not.</li>
  </ul>
</blockquote>

<h1>Old query (which data is correct)</h1>

<pre><code>SELECT first_name, last_name, email
FROM quiz_masters
WHERE quiz_masters.state = 'active' # (175 rows)

EXCEPT

SELECT first_name, last_name, email
FROM quiz_masters
LEFT JOIN events ON events.quiz_master_id = quiz_masters.id
WHERE quiz_masters.state = 'active'
AND EXTRACT(dow FROM events.start_at::timestamp::date) = 3 AND events.state = 'active'
GROUP BY first_name, last_name, email # (- 20 rows)
</code></pre>

<p>Total of 155 rows match the query.</p>

<h1>Combined query which doesn't work</h1>

<p>I would like to combine them into something like:</p>

<pre><code>SELECT first_name, last_name, email
FROM quiz_masters
LEFT JOIN events ON events.quiz_master_id = quiz_masters.id
WHERE quiz_masters.state = 'active'
AND events.quiz_master_id IS null
OR (EXTRACT(dow FROM events.start_at::timestamp::date) &lt;&gt; 3 AND events.state = 'active')
GROUP BY first_name, last_name, email
</code></pre>

<p>144 Rows (missing 11 rows)</p>

<p>But I'm not sure how to keep all the rows from some <code>quiz_masters</code> who are active but have no event whatsoever.  It still removes them.  Maybe I need some other kind of join?</p>
","2016-08-26 09:31:58"
"494881","refactor this dictionary-to-xml converter in python","3","<p>It's a small thing, really: I have this function that converts dict objects to xml.</p>

<p>Here's the function:</p>

<pre><code>def dictToXml(d):
    from xml.sax.saxutils import escape

    def unicodify(o):
        if o is None:
            return u'';
        return unicode(o)

    lines = []
    def addDict(node, offset):
        for name, value in node.iteritems():
            if isinstance(value, dict):
                lines.append(offset + u""&lt;%s&gt;"" % name)
                addDict(value, offset + u"" "" * 4)
                lines.append(offset + u""&lt;/%s&gt;"" % name)
            elif isinstance(value, list):
                for item in value:
                    if isinstance(item, dict):
                        lines.append(offset + u""&lt;%s&gt;"" % name)
                        addDict(item, offset + u"" "" * 4)
                        lines.append(offset + u""&lt;/%s&gt;"" % name)
                    else:
                        lines.append(offset + u""&lt;%s&gt;%s&lt;/%s&gt;"" % (name, escape(unicodify(item)), name))
            else:
                lines.append(offset + u""&lt;%s&gt;%s&lt;/%s&gt;"" % (name, escape(unicodify(value)), name))

    addDict(d, u"""")
    lines.append(u"""")
    return u""\n"".join(lines)
</code></pre>

<p>For example, it converts this dictionary</p>

<pre><code>{ 'site': { 'name': 'stackoverflow', 'blogger': [ 'Jeff', 'Joel' ] } }
</code></pre>

<p>to:</p>

<pre><code>&lt;site&gt;
    &lt;name&gt;stackoverflow&lt;/name&gt;
    &lt;blogger&gt;jeff&lt;/blogger&gt;
    &lt;blogger&gt;joel&lt;/blogger&gt;
&lt;/site&gt;
</code></pre>

<p>It works, but the <code>addDict</code> function looks a little too repetitive. I'm sure there's a way to refactor it into 3 co-recursive functions named <code>addDict</code>, <code>addList</code> and <code>addElse</code>, but my brain is stuck. Any help?</p>

<p>Also, any way to get rid of the <code>offset +</code> thing in every line would be nice.</p>

<p><strong>NOTE</strong>: I chose these semantics because I'm trying to match the behavior of the <a href=""http://www.json.org/javadoc/org/json/XML.html#toString(java.lang.Object)"" rel=""nofollow noreferrer"">json-to-xml converter</a> in <a href=""http://www.json.org/java/index.html"" rel=""nofollow noreferrer"">org.json</a>, which I use in a different part of my project. If you got to this page just looking for a dictionary to xml converter, there are some really good options in some of the answers. (Especially <a href=""http://foss.cpcc.edu/pyfo/"" rel=""nofollow noreferrer"">pyfo</a>).</p>
","2009-01-30 08:33:12"
"5233063","refactor/rename script for rails 3","3","<p>Is there a refactor/rename script similar to <a href=""https://github.com/hiroshi/script-refactor"" rel=""nofollow"">https://github.com/hiroshi/script-refactor</a> that works with rails 3?</p>
","2011-03-08 13:23:43"
"9463245","refactor LINQ function","3","<p>How could I refactor this function so it could take any many to many parameters?</p>

<p>Program has many to many parameters as in Age, Color, etc...</p>

<p>So I have this function:</p>

<pre><code>public int GetAgesOnProgram(IEnumerable&lt;Program&gt; ProgramList)
{
    return (from x in ProgramList
        where x.Ages.Any()
        select x.Ages).Count();
}
</code></pre>

<p>but I also need this one:</p>

<pre><code>public int GetColorsOnProgram(IEnumerable&lt;Program&gt; ProgramList)
{
    return (from x in ProgramList
        where x.Colors.Any()
        select x.Colors).Count();
}
</code></pre>

<p>As I have up to 10 many to many relationships in Program, I guess it makes sense to have a single function that handles that?</p>

<p>EDIT:
How could I return the Age or Color List, rather than an int as in:</p>

<pre><code>public IEnumerable&lt;Color&gt; GetColorsOnProgram(IEnumerable&lt;Program&gt; ProgramList)
{
    return (from x in ProgramList
        where x.Colors.Any()
        select x.Colors);
}
</code></pre>
","2012-02-27 10:12:31"
"7707673","refactoring javascript. decouple markup or separate modules","3","<p>I'm trying to make a large (~10K lines) javascript code base more maintainable.  Pretty much all of the code is contained in one massive class.  I want to do some refactoring, but I don't want to completely rewrite the code.  </p>

<p>I have two ideas for how to re-organize the code, but I'm not sure which one is best. (I'm very open to other ideas too)  What do you think about each of these approaches?  How would you decide which is best?</p>

<p>Idea 1 – Decouple markup from business logic.
We have a somewhat complicated set of rules for what and how things should be displayed to users.  This approach would split that into ""What do we display?"" and ""How do we display it?""</p>

<p>Idea 2 – Break apart separate components into their own class. 
There are several somewhat disjoint components in this code.  If this code base were Facebook's – this approach would involve pulling apart the code for photos and the newsfeed.</p>
","2011-10-10 01:10:01"
"4481660","refactor my array sorting function","2","<p>So, how to make it more compact?</p>

<pre><code>   public static boolean isDirectOrder( int[] data )
   {
      boolean answer = true;

      if ( ( data != null ) &amp;&amp; ( data.length &gt; 1 ) )
      {
         int last = data[0];

         for (int i = 0; i &lt; data.length; i++)
         {
            if ( last &lt;= data[i] )
            {
               last = data[i];
            }
            else
            {
               answer = false;
               break;
            }
         }
      }

      return answer;
   }
</code></pre>

<p>maybe exist standard tools for same checking?</p>
","2010-12-19 04:55:54"
"28676668","refactoring rails redirects with multiple ifs","2","<p>In the app I am working on, the user can get to a new form from several different places. I need to redirect them back to where they came from. I solved it by passing a parameter in the link on the view, for example</p>

<pre><code>= link_to ""create a new post »"", new_user_post_path(@current_user, :return_to =&gt; 'dashboard')
</code></pre>

<p>then in the new action in the controller like so</p>

<pre><code>if params[:return_to] == 'dashboard'
  session[:return_to]= 'dashboard'
end
</code></pre>

<p>now I am looking at the controller. what I need to do I can achieve by being really verbose, but I'm looking for a more elegant solution. Here is what I have now</p>

<pre><code>if @user_post.save
  flash[:notice] = ""New Post Created""
  if session[:return_to] == 'dashboard'
    session.delete(:return_to)
    redirect_to dashboard_path and return
  else
  redirect_to user_hub_path(@user)
 end
else
  flash[:error] = ""Could not save post""
  redirect_to new_user_post_path(@user)
end
</code></pre>

<p>This does what I need but I was hoping to tidy it up a little. I started looking at 1 line enumerators to see if I could do something like this...</p>

<pre><code>if @user_post.save
  flash[:notice] = ""New post Created""
  session[:return_to] == 'dashboard' ? redirect_to ""#{session.delete(:return_to)}_path"" : redirect_to user_hub_path(@user)
else
  flash[:error] = ""Could not save post""
  redirect_to new_user_post_path(@user)
end
</code></pre>

<p>but it really doesn't like this part....redirect_to ""#{session.delete(:return_to)}_path""</p>

<p>any advice? Guess I'm trying to get it to redirect and delete the session in one line and this is beyond my knowledge...</p>
","2015-02-23 15:00:58"
"10512040","refactor nested switch to objects","2","<p>I'd like some advice on refactoring the following method:</p>

<pre><code>public boolean makeDecision(String group, int level, int primaryAmount, int secondaryAmount)
{
    if (group.equals(""A""))
    {
        switch (level)
        {
            case 0 : return primaryAmount &gt; 10000;break;
            case 1 : return primaryAmount &gt; 20000;break;
            default : return secondaryAmount &gt; 30000; break;
        }
    }
    else if (group.equals(""B""))
    {
         switch (level)
         {
              case 0 : return primaryAmount &gt; 40000;break;
              case 1 : return primaryAmount &gt; 50000;break;
              default : return secondaryAmount &gt; 60000; break;
         }

    }
    else if (group.equals(""C""))
    {
        switch(level)
        {
            case 0 : return primaryAmount &gt; 70000;break;
            case 1 : return primaryAmount &gt; 80000;break;
            default : return secondaryAmount &gt; 90000; break;
        }

    }
    return false;
} 
</code></pre>

<p>What I'd like to achieve:</p>

<ul>
<li>Allow the code to follow the open/closed principle as there will be more groups / levels in time. </li>
<li>Remove the duplication in the 'level' switch statement. </li>
<li>Ideally remove the 'group' top level switch statement.</li>
</ul>
","2012-05-09 07:57:46"
"8898779","refactoring #ifndef __OBJC_GC_ in arc enabled app","2","<p>I'm writing an app in an ARC environment, and I'm trying to use a 3rd party library that was written before ARC. I'm using the -fno-objc-arc flags on all the relevant files, so it's compiling, but the project uses #ifndef __OBJC_GC_ blocks to release memory, which is causing memory allocation errors. I'm trying to determine the right solution, and so far I have the following:</p>

<p>1.) find a different library or write my own - this is the only free library of it's kind, so this is obviously not ideal, and I'm new enough that I don't feel comfortable tackling that</p>

<p>2.) remove the #ifndef blocks and cross my fingers - not able to work on the project today, but that's my next plan</p>

<p>3.) refactor the code to be ARC compliant and remove the -fno-objc-arc flags</p>

<p>is #2 likely to work? How hard would #3 be, andwould it actually cause the compiler to define __OBJC_GC_? (there's about 4-5 classes that I'm planning on using, but they're pretty sizeable)</p>
","2012-01-17 17:11:07"
"4869800","refactoring generated action code in the controller","2","<p>If I generate a scaffold I get the standard actions index, new, show, create .... all of which contain a line e.g. like  </p>

<pre><code>@comment = Comment.find(params[:id])
</code></pre>

<p>Does it make sense to put this line in a seperate method into the controller like</p>

<pre><code>def load
@comment = Comment.find(params[:id])
end
</code></pre>

<p>Is this an advantage? Thx for your time</p>
","2011-02-02 01:12:28"
"15412265","refactoring modular structures in D","2","<p>Here's how I usually develop an application:</p>

<ul>
<li>I start with having all the code in a single source file.</li>
<li>When it grows enough to be modularised, I break the code into several modules.</li>
<li>When the modules grow enough, I split them again. And so on, iteratively.</li>
<li>Over time, some modules get shrunk, deleted or merged with others.</li>
</ul>

<p>This workflow implies the need to move source files between modules sometimes. And here comes the problem:</p>

<p><em>When I move a module to another location, it changes the module's name, so I have to walk through all the other files renaming imports by hand.</em></p>

<p>Is there some organisational technique to avoid that annoying procedure? Or is that the way it goes and I just have to look into some automation utilities instead?</p>
","2013-03-14 14:37:56"
"41528654","refactor filtering and search result","2","<p>I am developing an app which is somewhat similar to airbnb. There are two search function, one for searching apartment and other for searching car rental. When searching apartment, the result page shows the searched result along with some filtering options like filter from range of price and filter from various options like amenities, services. The result page of car rental is same as apartment result page. I mean car result shows the searched result regarding car that are available as rent and filtering categories.</p>

<p>Here is my reducer and actions for such feature. This is a working code. I am trying to code it in best way as much as i can to train my coding skill. I want help of other expert programmers on how can i refactor this code to much better? </p>

<p>actions.js</p>

<pre><code>export function showResultofCar(cityFrom, cityTo, date, paisFrom, paisTo) {
      return (dispatch) =&gt; {
        dispatch({ type: 'CAR_FETCH_START' });
        const token = localStorage.getItem('token');
        return axios.get(`${API_URL}/car/....`)
          .then((response) =&gt; {
            setTimeout(() =&gt; {
              dispatch({ type: 'CAR_FETCH_SUCCESS', payload: response.data });
            }, 1000);
          })
          .catch((err) =&gt; {
            dispatch({ type: 'CAR_FETCH_FAILURE', payload: err });
          });
      };
    }


export function showResultofApartment(people, city, dateFrom, dateTo, pais) {
  console.log('people', people, city, dateFrom, dateTo, pais);
  return (dispatch) =&gt; {
    dispatch({ type: 'APARTMENT_FETCH_START' });
    const token = localStorage.getItem('token');
    return axios.get(`${API_URL}/apartment/...`)
    .then((response) =&gt; {
      console.log('response apart', response.data);
        dispatch({ type: 'APARTMENT_FETCH_SUCCESS', payload: response.data });
    })
    .catch((err) =&gt; {
      dispatch({ type: 'APARTMENT_FETCH_FAILURE', payload: err });
    });
  };
}

export function getFilteredResults(price) {
  console.log('price', price);
  return function (dispatch) {
    dispatch({ type: 'CAR_FETCH_WITH_FILTER', payload: price });
  };
}

export function getTimeFilteredResults(time) {
  console.log('time', time);
  return function (dispatch) {
    dispatch({ type: 'CAR_FETCH_WITH_TIME_FILTER', payload: time });
  };
}

export function sortCarByPrice(price) {
  console.log('price is', price);
  return function (dispatch) {
    dispatch({ type: 'SORT_CAR_BY_PRICE', payload: price });
  };
}

export function getApartmentFromPrice(price) {
  return function (dispatch) {
    dispatch({ type: 'APARTMENT_FILTER_BY_PRICE', payload: price });
  };
}

export function getApartmentFromCategories(filter) {
  return function (dispatch) {
    dispatch({ type: 'APARTMENT_FILTER_BY_CATEGORIES', payload: filter });
  };
}
</code></pre>

<p><strong>reducers.js</strong></p>

<pre><code>let cars = [];
const initialState = {
  fetching: false,
  fetched: true,
  cars: [],
  error: null
};

function carFilterFromPrice(price) {
  return cars.filter(car =&gt; car.price &gt; price.min &amp;&amp; car.price &lt; price.max);
}

function carFilterFromTime(time) {
  return cars.filter(function (car) {
    const departure = car.departure;
    const isValidDate = moment(departure).isValid();
    const departureWithDayandTime = isValidDate ?
      moment(departure).format('hh.mm') : '';
      return departureWithDayandTime &gt; time.min &amp;&amp; departureWithDayandTime &lt; time.max;
  });
}

function carSortFromPrice(price) {
  return cars.sort((a, b) =&gt; {
    if (price === 'descending') {
      return parseFloat(a.price) - parseFloat(b.price);
    }
      return parseFloat(b.price) - parseFloat(a.price);
  });
}

export function getCarResult(state = initialState, action) {
  switch (action.type) {
    case 'CAR_FETCH_START':
      return { ...state, fetching: true };
    case 'CAR_FETCH_SUCCESS':
      cars = action.payload;
      return {
              ...state,
              fetched: true,
              fetching: false,
              cars: action.payload,
             };
    case 'CAR_FETCH_WITH_FILTER':
      return { ...state, fetched: true, fetching: false, cars: carFilterFromPrice(action.payload) };
    case 'CAR_FETCH_WITH_TIME_FILTER':
      return { ...state, fetched: true, fetching: false, cars: carFilterFromTime(action.payload) };
    case 'SORT_CAR_BY_PRICE':
      return { ...state, fetched: true, fetching: false, cars: carSortFromPrice(action.payload) };
    case 'CAR_FETCH_FAILURE':
      return { ...state, error: action.payload };
    default:
      return state;
  }
}

let apartments = [];
const apartmentInitialState = {
  fetching: false,
  fetched: true,
  apartments: [],
  error: null
};

function apartmentFilterFromPrice(price) {
  return apartments.filter(apartment =&gt;
    apartment.price &gt; price.min &amp;&amp; apartment.price &lt; price.max
  );
}

function apartmentFilterFromCategory(filter) {
  console.log('filter', filter);
}

export function getApartmentResult(state = apartmentInitialState, action) {
  switch (action.type) {
    case 'APARTMENT_FETCH_START':
      console.log('action', action);
      return { ...state, fetching: true };
    case 'APARTMENT_FETCH_SUCCESS':
    apartments = action.payload;
    return { ...state, fetched: true, fetching: false, apartments: action.payload };
    case 'APARTMENT_FILTER_BY_PRICE':
      return { ...state,
              fetched: true,
              fetching: false,
              apartments: apartmentFilterFromPrice(action.payload)
            };
    case 'APARTMENT_FILTER_BY_CATEGORIES':
      return { ...state,
              fetched: true,
              fetching: false,
              apartments: apartmentFilterFromCategory(action.payload)
             };
    case 'APARTMENT_FETCH_FAILURE':
      return { ...state, error: action.payload };
    default:
      return state;
  }
}
</code></pre>
","2017-01-08 01:52:40"
"17007194","refactor PHP legacy code to REST API","2","<p>I have a big PHP legacy codebase and I was planning to move it to a MVC based pattern. Not because I want, but if I could separate the views, It would be easier to give the views/layouts with a mockup backend to designers. </p>

<p>Our application is really complicated to setup locally (we are working to make it easier, but its not easy, because it runs on a specific OS, read-only FS, etc). </p>

<p>So my first idea was: Move the whole view logic to templates and then with the time migrate the rest of the code to models and controllers. However now, I'm considering to pack my code in a REST API (no view logic on the server side, just JSON being delivered. View I want to render with backbone.js).  </p>

<p>Questions that I still don't have answers are:</p>

<ul>
<li>Anyone has an experience similar to share with me? </li>
<li>PHP rest API lib that I should use? (I'm thinking about SLIM Framework)</li>
<li>Is it a good approach?</li>
</ul>
","2013-06-09 06:51:50"
"30064986","refactoring static member functions with same parameters","2","<p>I have a static helper class, which has several functions that are using same parameters:</p>

<pre><code>class helper {
public:
  static double getValue(const CString &amp;a, const CString &amp;b, const CString &amp;c, ... );
private:
  static double foo(const CString &amp;a, const CString &amp;b, const CString &amp;c, ... );
  static bool bar(const CString &amp;a, const CString &amp;b, const CString &amp;c, ... );
  static bool qux(const CString &amp;a, const CString &amp;b, const CString &amp;c, ... );
  static double wad(const CString &amp;a, const CString &amp;b, const CString &amp;c, ... );
  static int xyz(const CString &amp;a, const CString &amp;b, const CString &amp;c, ... );
};
</code></pre>

<p>use it like:</p>

<pre><code>double value = helper::getValue(a, b, c, k, ...);
</code></pre>

<p><code>getValue()</code> will call <code>foo()</code>, which will call <code>bar()</code>, <code>qux()</code> and <code>wad()</code>, etc.<br>
They all need the same data set of a, b, c.</p>

<p>As you can see, there are many duplicated parameters that looks a little messy.</p>

<p>Is there any way to refactor it?</p>
","2015-05-05 23:36:04"
"30659537","refactor 'execute and log' pattern","2","<p>I found myself keep following the same pattern again and again:</p>

<pre><code>if((return_code = doFoo1(...)) != CODE_OK) {
    log(""useful log message based on return code"");
    // very likely to return an error code. 
}

// continue

if((return_code = doFoo2(...)) != CODE_OK) {
    log(""useful log message based on return code"");
    // very likely to return an error code. 
}
</code></pre>

<p>Any insight how to avoid this annoying pattern and keep the logic clean?</p>
","2015-06-05 06:14:58"
"42900040","refactor MANY functions to receive any type of parameter elegantly (template<any>)","2","<p>I have a custom datastructure.   </p>

<pre><code>template&lt;class T&gt; class MyArray3D{
    public: void setElement(const int* index,const T&amp; t){
        //do something about ""index[0,1,2]""
    }
    public: T&amp; get(const int* index){
        //do something about ""index[0,1,2]""
    }
    public: void reserve(const int* index1,const int* index2){
        //do something about ""index1,2[0,1,2]"" (e.g. index can be negative)
    }
    //about 20 functions, and some fields
};
</code></pre>

<p>Everything is good.        It is currently used by many classes.<br>
Then I want those functions to accept anything (<code>index</code>) that has <code>operator[]</code>.</p>

<h2>My poor solution</h2>

<p>Here is a correct (but not good) way to do.<br>
I change <code>const int*</code> to <code>template INT_ARRAY</code>:-</p>

<pre><code>template&lt;class T&gt; class MyArray3D{
    public: template&lt;class IARRAY&gt; void setElement(IARRAY index,const T&amp; t){
        //do something about ""index[0,1,2]""
    }
    public: template&lt;class IARRAY&gt; T&amp; get(IARRAY index){
        //do something about ""index[0,1,2]""
    }
    public: template&lt;class IARRAY1,class IARRAY2&gt; 
      void reserve(IARRAY1 index1,IARRAY2 index2){
        //do something about ""index1,2[0,1,2]"" (e.g. index can be negative)
    }
    //about 20 functions, and some fields
};
</code></pre>

<p>The above refactoring is tedious.     I have to do that for all functions.     </p>

<p>If a function has 4 <code>const int*</code>, it will be prefixed as <code>template&lt;class IARRAY1,class IARRAY2,class IARRAY3,class IARRAY4&gt;</code> - so ugly.    </p>

<h2>Question</h2>

<p>How to refactor above function elegantly (less repetitive &amp; shorter code)? </p>

<p>I am dreaming about something like :- </p>

<pre><code>template&lt;class T&gt; class MyArray3D{
    using IARRAY1 = please don't care about my type; ????
    public: void setElement(IARRAY1 index,const T&amp; t);
    public: T&amp; get(IARRAY1 index);
    public: void reserve(IARRAY1 index1,IARRAY1 index2);
};
</code></pre>

<p><strong>Here are the related questions :-</strong>      </p>

<ul>
<li><a href=""https://stackoverflow.com/questions/37642158/multiple-functions-using-the-same-template"">Multiple functions using the same template?</a>   : but the functions has no parameter      </li>
<li><a href=""https://stackoverflow.com/questions/8627625/is-it-possible-to-make-function-that-will-accept-multiple-data-types-for-given-a"">is it possible to make function that will accept multiple data types for given argument?</a> : the template solution is same as my poor approach, and I don't think union is suitable for my case</li>
</ul>
","2017-03-20 09:34:03"
"8962394","refactor ""render format"" in multiple controllers","2","<p>so i've got a view method in multiple controllers which mostly looks exactly the same:</p>

<pre><code>  def show
    show! do |format|
      format.json do
        if @text.activated?
          @text.log
          render_for_api :texts_all, :json =&gt; @text
        else
          render :nothing =&gt; true
        end
      end
      format.pdf do
        pdf = QrPdf.new(@text)
        send_data pdf.render, filename: ""text_#{@text.id}.pdf"", type: ""application/pdf""
      end
    end
  end
</code></pre>

<p>the models for this are different, but they all have the same attributes that are used in this method (<code>activated</code>, <code>log</code>, <code>id</code>). i also could change the <code>render_for_api</code> given hash from which is currently <code>texts_all</code>, <code>documents_all</code> etc to a hash that its everywhere the same.</p>

<p>is there a way to use this code in multiple models without having this enormous duplication?</p>

<p>i'm thankful for every hint!
especially i find it hard to deal with the <code>do |format|</code> block. but also i'm not sure where to put the code and how to use it with different types of models. </p>

<p>thank you.</p>
","2012-01-22 16:00:59"
"8031895","refactor to ARC gives error implicit error [picture]","2","<p>I am refactoring to use ARC in my project and can not figure out this problem for the life of me! </p>

<p>I don't know where I got the code from.</p>

<p><a href=""http://img341.imageshack.us/img341/972/xcode.png"" rel=""nofollow noreferrer"">screenshot of error http://img341.imageshack.us/img341/972/xcode.png</a>""screenshot of error""
<a href=""http://img341.imageshack.us/img341/972/xcode.png"" rel=""nofollow noreferrer"">http://img341.imageshack.us/img341/972/xcode.png</a></p>
","2011-11-07 01:34:35"
"2415027","refactoring this function in Java","2","<p>I'm learning Java, and I know one of the big complaints about newbie programmers is that we make really long and involved methods that should be broken into several.  Well here is one I wrote and is a perfect example. :-D.</p>

<pre><code>public void buildBall(){

        /* sets the x and y value for the center of the canvas */
        double i = ((getWidth() / 2));
        double j = ((getHeight() / 2));

        /* randomizes the start speed of the ball */
        vy = 3.0;
        vx = rgen.nextDouble(1.0, 3.0);
        if (rgen.nextBoolean(.05)) vx = -vx;    

        /* creates the ball */
        GOval ball = new GOval(i,j,(2 *BALL_RADIUS),(2 * BALL_RADIUS));     
        ball.setFilled(true);
        ball.setFillColor(Color.RED);
        add(ball);


        /* animates the ball */ 
        while(true){
            i = (i + (vx* 2));
            j = (j + (vy* 2));  
            if (i &gt; APPLICATION_WIDTH-(2 * BALL_RADIUS)){
                vx = -vx;       
            }

            if (j &gt; APPLICATION_HEIGHT-(2 * BALL_RADIUS)){
                vy = -vy;
            }

            if (i &lt; 0){
                vx = -vx;
            }

            if (j &lt; 0){
                vy = -vy;
            }

            ball.move(vx + vx, vy + vy);
            pause(10);

            /* checks the edges of the ball to see if it hits an object */
            colider = getElementAt(i, j);

            if (colider == null){
                colider = getElementAt(i + (2*BALL_RADIUS), j); 
                }
            if (colider == null){
                colider = getElementAt(i + (2*BALL_RADIUS), j + (2*BALL_RADIUS));   
                }
            if (colider == null){
                colider = getElementAt(i, j + (2*BALL_RADIUS)); 
                }

            /* If the ball hits an object it reverses direction */
            if (colider != null){
                vy = -vy;


             /* removes bricks when hit but not the paddle */
                if (j &lt; (getHeight() -(PADDLE_Y_OFFSET + PADDLE_HEIGHT))){
                remove(colider);
                }

            }

        }
</code></pre>

<p>You can see from the title of the method that I started with good intentions of ""building the ball"".</p>

<p>There are a few issues I ran up against:</p>

<p>The problem is that then I needed to move the ball, so I created that while loop.  I don't see any other way to do that other than just keep it ""true"", so that means any other code I create below this loop won't happen.  I didn't make the while loop a different function because I was using those variables <code>i and j</code>.</p>

<p>So I don't see how I can refactor beyond this loop.  </p>

<p>So my main question is:</p>

<p>How would I pass the values of <code>i and j</code> to a new method: ""animateBall"" and how would I use 
<code>ball.move(vx + vx, vy + vy);</code> in that new method if ball has been declared in the buildBall method?</p>

<p>I understand this is probably a simple thing of better understanding variable scope and passing arguments, but I'm not quite there yet...</p>
","2010-03-10 06:49:43"
"1160132","refactor help - strategy pattern","2","<p>The object here is to update the UI. I normally do this on the client however this application uses the code behind. Anyways my question is I am trying to clean up these if else statements and I thought the strategy pattern may be appropriate. I don't need everything done for me but if you could give me a couple pointers to get going. Do I create an interface first and then each strategy implement the interface? Are generics helpful here? What types of methods should be in the interface? Any thing to get me going would be very much appreciated.</p>

<pre><code>if (someObject.Status == 'A') {
                    btnRecordCall.Enabled = false;
                    btnAddMailOrStatusAction.Enabled = false;
                    btnPayments.Enabled = false;
                    btnAddressMaint.Enabled = false;
                    btnFilter.Enabled = false;
                    btnAddCoverage.Enabled = false;
                    btnPolicyForms.Enabled = false;
                    lblIsArchived.Text = ""********** THIS CLAIM HAS BEEN ARCHIVED **********"";
                } else if (someObject.Status == 'D') {
                    btnRecordCall.Enabled = false;
                    btnAddMailOrStatusAction.Enabled = false;
                    btnPayments.Enabled = false;
                    btnAddressMaint.Enabled = false;
                    btnFilter.Enabled = false;
                    btnAddCoverage.Enabled = false;
                    btnPolicyForms.Enabled = false;
                    lblIsArchived.Text = ""- De-archive Request Pending"";
                } else {
                    btnRecordCall.Enabled = true;
                    btnAddMailOrStatusAction.Enabled = true;
                    btnPayments.Enabled = true;
                    btnAddressMaint.Enabled = true;
                    btnFilter.Enabled = true;
                    btnAddCoverage.Enabled = true;
                    btnPolicyForms.Enabled = true;
                    lblIsArchived.Text = """";
                }
</code></pre>

<p>Thanks,
~ck</p>
","2009-07-21 15:56:36"
"7525594","refactoring: swicthing from custom data access layer to Entity Framework","2","<p>I am a .NET Developer and as part of a refactoring project, I have a few questions.</p>

<p>Our software is currently using an Active Record pattern (one to one mapping between the data objects and the business objects). The bad thing is that the business objects inherits from the data objects, inducing highly couple between the layers.</p>

<p>Our goal is to switch from our custom data access layer (based on ADO.NET) to Entity Framework. The constraint we have is not to break the code so that our older applications will still compile and run using the old data access layer while allowing us to use EF for the new projects.</p>

<p>My first idea to do so is to break the inheritance and have the data object as an attribute of the business object (and use an interface or abstract class in order to inject the data object, whether it is our custom layer or Entity Framework). The properties would be migrated from the Data objects to the business objects which would act like some kind of ""proxy"" to access the properties of the data objects.</p>

<p>Would that be a viable solution ? That would still use the active record pattern (and I don't like this a lot, since our business layer has become quite large) so if you have any other idea, please don't hesitate.</p>

<p>My other question is about the Entity framework generation. We need the entities properties to have the same name as the old data objects (we would use an abstract class in order to allow the business objects to call the properties of the data object, whether it is our custom data object or the EF entities). What would be the best way to accomplish that ? Using T4 to generate the entities or have an EF Code first approach ?</p>

<p>I am very open to any suggestion, so please do not hesitate to propose other approaches. Thanks for your time.</p>
","2011-09-23 07:22:58"
"14466683","refactoring dot jsp dot html and other non dot java files","2","<p>Refactoring for Java ee web apps for example renaming a page name , is not done well by most ides like e.g netbeans , where I observe that the renaming (refactoring) (in this example) does not reflect the change of that name in other parts of the applicaion . eg. in froms and other pages that have links to the renamed page.  </p>

<p>(this is contrary to normal .java files.) Is my observation correct? and what is the solution if so?  Thats my usuall practice for .java files. but thats not the case with .jsp or html or other files , even I rename  (refactor) a .java file. its not reflected in .jsp . html files. I have alot of files pointing to that renamed file... then what</p>

<p>well how to properly reafactor in the first place. do tell me</p>

<p><strong>Global search and replace is the last thing I and most devs want to do</strong></p>
","2013-01-22 19:40:15"
"375014","refactoring the OrderBy expression","2","<p>I would like to be able to refactor out the <strong>OrderBy</strong> clause in a linq expression. </p>

<p>Here is an example of a refactor of the <strong>where</strong> clause  </p>

<p>before:</p>

<pre><code>results = ctx.ActiveUsers
    .Where(u =&gt; u.CompanyID != 1 &amp;&amp;
           (u.LastName.ToLower().Contains(searchString)
           || u.Email.ToLower().Contains(searchString)
           || u.Company.Name.ToLower().Contains(searchString)))
    .OrderBy(u =&gt;  u.LastName ).ThenBy(u =&gt; u.FirstName)
    .Select(u =&gt; new Employee {
      ID = u.ID
      , FirstName = u.FirstName
      , LastName = u.LastName
      , Email = u.Email
      , CompanyName = u.Company.Name
      , CompanyID = u.CompanyID.ToString() });
</code></pre>

<hr>

<p>after:</p>

<pre><code>results = ctx.ActiveUsers
    .Where(Employee.GetExpression(searchString))
    .OrderBy(u =&gt;  u.LastName ).ThenBy(u =&gt; u.FirstName)
    .Select(u =&gt; new Employee {
      ID = u.ID
      , FirstName = u.FirstName
      , LastName = u.LastName
      , Email = u.Email
      , CompanyName = u.Company.Name
      , CompanyID = u.CompanyID.ToString() });
</code></pre>

<hr>

<pre><code>private static Expression&lt;Func&lt;User, bool&gt;&gt; GetExpression(string searchString)
{ 
    Expression&lt;Func&lt;User, bool&gt;&gt; p = (u =&gt; u.CompanyID != 1 &amp;&amp;
                       (u.LastName.ToLower().Contains(searchString)
                       || u.Email.ToLower().Contains(searchString)
                       || u.Company.Name.ToLower().Contains(searchString)));
    return p;
}
</code></pre>

<p>I was wondering if the same type of thing would be possible except I would like to refactor the <strong>Orderby</strong> expression.</p>

<p>Thank you in advance</p>
","2008-12-17 15:56:20"
"219395","refactoring stored procedure","2","<p>I have a stored procedure currently executing a complicated fetch that is frequently timing out when used. The proposed solution in my department has been to simply increase the timeout time length; which I don't really want to do. I'd like to refactor this sproc, but because it's so complicated and undocumented (yay legacy systems) I'm concerned my refactoring my not result in the same functionality executing more efficiently. Are there any strategies to use when refactoring a stored procedure to ensure the same functions are being performed in less time?</p>

<p>This is a Microsoft SQL Server 2005 stored procedure.</p>
","2008-10-20 18:29:18"
"16810328","refactor rails if else statement with to a single line with return?","2","<p>Im refactoring my older code parts, have lots of returns with multi line like:</p>

<pre><code>if ...
 return false
else
 return true
end
</code></pre>

<p>How could one refactor to use a single line and return true or false?</p>
","2013-05-29 09:33:57"
"7075972","refactoring PL/SQL","2","<p>I encountered the following PL/SQL code(variables modified) at work:</p>

<pre><code>PROCEDURE test(i_w IN a.w%type,o_result IN OUT resu_cur_type) IS
BEGIN
    IF i_w IS NULL THEN
      open o_result for SELECT a.x, b.y FROM a,b WHERE a.z=b.z;
    ELSE
      open o_result for SELECT a.x, b.y FROM a,b WHERE a.z=b.z AND a.w=i_w;
    END IF;
END test;
</code></pre>

<p>I think the above is equivalent to the following:</p>

<pre><code>PROCEDURE test(i_w IN a.w%type,o_result IN OUT resu_cur_type) IS
BEGIN
      open o_result for SELECT a.x, b.y FROM a,b WHERE a.z=b.z AND NVL(a.w,1)=NVL(NVL(i_w,a.w),1);
END test;
</code></pre>

<p>Won't it be the same?. Could somebody please explain is there any reason to use the
original version?. 
Please note that the original cursor is a 50 line query, so refactoring might improve its readability and keep it simple.</p>

<p>Edit:</p>

<p>To address the problem in Kevin Burton's answer, I've updated the WHERE condition.</p>
","2011-08-16 09:14:43"
"35249984","refactoring $rootScope.$apply in Angular","1","<p>my <code>MusicPlayer.js</code> Angular service  has a callback function wrapped in <code>$rootScope.$apply</code> that updates a specific object (<code>musicPlayer.currentPlaybackTime</code>) and is shared to all other controllers ( via applying to <code>$rootScope</code>).  </p>

<p>I understand that you'll ideally want to limit any <code>$rootScope</code> pollution, so i'm looking at possible refactoring options that take away calling apply methods to <code>$rootScope</code> but allows my updated object to be shared across multiple controllers.  </p>

<p>My research indicates that i'll need to register the other controllers (i.e. <code>PlayerDashboardCtrl.js</code>, <code>PlaylistCtrl.js</code> and <code>AlbumListCtrl.js</code>) that  need my <code>currentPlaybackTime</code> object, but i'd like to understand what's the most efficient way of doing this.  </p>

<p>Thank you.</p>

<pre><code> var setSong = function(song) {

    currentBuzzObject = new buzz.sound(song.audioUrl, {
        formats: ['mp3'],
        preload: true
    });

    currentBuzzObject.bind('timeupdate', function() {
        $rootScope.$apply(function() {
          musicPlayer.currentPlaybackTime = currentBuzzObject.getTime();  
        });
    });

    musicPlayer.currentSong = song;
};
</code></pre>
","2016-02-07 05:11:38"
"17752926","refactor jQuery to fade and stop it from crashing browser","1","<p>This js works but after a while it crashes any browser thats open. Do I have to close some loop? </p>

<p>I would also like to change the slide effect to fade in/out (just replacing .slideDown does not do it). Thoughts?</p>

<pre><code>function ticker() {
    $('#jsTicker li:first').slideUp(function() {
        $(this).appendTo($('#jsTicker')).slideDown(1500);
    });
}
setInterval(ticker, 6000);
</code></pre>

<p><a href=""http://jsfiddle.net/KevinOrin/Zh3wU/"" rel=""nofollow"">http://jsfiddle.net/KevinOrin/Zh3wU/</a></p>
","2013-07-19 18:18:33"
"3573107","refactor my if statement code","1","<p>I've been messing with this bit of code for over an hour trying to rearrange it different ways. Is there any easier way to write it?</p>

<pre><code>   if x is not Number      ;// if x is string
   {
      if y is not Number      ;// x, y both strings
      {
         Eval(x)
         Eval(y)
         return
      }
      else                    ;// x is string, y is Number
      {
         Eval(x)
         Scale(y)
         return
      }
   }
   else if y is not Number    ;// x is Number, y is string
   {
      Scale(x)
      Eval(y)
      return
   }
   else                       ;// both are numbers
   {
      Scale(x)
      Scale(y)
      return   
   }
</code></pre>
","2010-08-26 07:59:17"
"4841542","refactor jquery code","1","<p>How can I remove the code at the end <code>data(""autocomplete"")...</code> and put it in a function?</p>

<pre><code>    var input = $(""#CountryL"");

    $(input).autocomplete({
        minLength: 0,
        source: $(input).data('url')
    }).data(""autocomplete"")._renderItem = function (ul, item) {
        var tmp = $(""&lt;div&gt;"").setTemplate($(""#""+$(input).data('template')).html());
        tmp.processTemplate(item);
        $(""&lt;li&gt;&lt;/li&gt;"").data(""item.autocomplete"", item)
                      .append($(tmp).html())
                      .appendTo(ul);
        return;
    }; 
</code></pre>

<p>I'd like to be able to do:</p>

<pre><code>function templateOverride(object){

 object.data(""autocomplete"")._renderItem = function (ul, item) {
        var tmp = $(""&lt;div&gt;"").setTemplate($(""#""+$(input).data('template')).html());
        tmp.processTemplate(item);
        $(""&lt;li&gt;&lt;/li&gt;"").data(""item.autocomplete"", item)
                      .append($(tmp).html())
                      .appendTo(ul);
        return;
}


var input = $(""#CountryL"");

$(input).autocomplete({
        minLength: 0,
        source: $(input).data('url')
}).templateOverride(this);
</code></pre>
","2011-01-30 06:33:11"
"12866445","refactoring databaseHelper","1","<p>I'm creating a database with this structure (4 Tables):
<a href=""http://i.stack.imgur.com/vPaoD.png"" rel=""nofollow"">http://i.stack.imgur.com/vPaoD.png</a> (Can't embed because lack of rep)</p>

<p>My worries is that the class is growing is in a fast pace and it's not that simple to work in it anymore since it is getting so large. Is there anyway i can refactor (=split it into several classes) my databaseHelper to make it simpler and more structured but yet still make it easy to work with?</p>

<p>public class DatabaseHelper extends SQLiteOpenHelper {</p>

<pre><code>// Database static variables
private static final int DATABASE_VERSION = 2;
private static final String DATABASE_NAME = ""feedlrDatabase"";

// Declaring feed table
private static final String TABLE_FEED = ""feed"";
private static final String FEED_COLUMN_ID = ""_id"";
private static final String FEED_COLUMN_NAME = ""name"";

// Declaring feed-user bridge table
private static final String TABLE_FEEDUSER = ""feeduser"";
private static final String FEEDUSER_COLUMN_FEED_ID = ""feed_ID"";
private static final String FEEDUSER_COLUMN_USER_ID = ""user_ID"";

// Declaring user table
private static final String TABLE_USER = ""user"";
private static final String USER_COLUMN_ID = ""_id"";
public static final String USER_COLUMN_USERNAME = ""username"";
public static final String USER_COLUMN_USERID = ""userid"";
public static final String USER_COLUMN_IMGURL = ""ProfileImageURL"";
public static final String USER_COLUMN_SOURCE = ""source"";

// Declaring item table
private static final String TABLE_ITEM = ""item"";
public static final String ITEM_COLUMN_ID = ""_id"";
public static final String ITEM_COLUMN_ITEMID = ""itemid"";
public static final String ITEM_COLUMN_TEXT = ""text"";
private static final String ITEM_COLUMN_TIMESTAMP = ""timestamp"";
private static final String ITEM_COLUMN_TYPE = ""type"";
private static final String ITEM_COLUMN_URL = ""URL"";
private static final String ITEM_COLUMN_IMGURL = ""imgURL"";
private static final String ITEM_COLUMN_USER_ID = ""user_ID"";

private SQLiteDatabase db = this.getWritableDatabase();

public DatabaseHelper(Context context) {
    super(context, DATABASE_NAME, null, DATABASE_VERSION);
}

public void onCreate(SQLiteDatabase database) {
    // @formatter:off
    // Creating feed table
    database.execSQL(""CREATE TABLE "" + TABLE_FEED + ""("" + FEED_COLUMN_ID
            + "" INTEGER PRIMARY KEY AUTOINCREMENT,"" + FEED_COLUMN_NAME
            + "" TEXT UNIQUE"" + "")"");

    // Creating feed-user bridge table
    database.execSQL(""CREATE TABLE "" + TABLE_FEEDUSER + ""(""
            + FEEDUSER_COLUMN_FEED_ID + "" INT NOT NULL,""
            + FEEDUSER_COLUMN_USER_ID + "" INT NOT NULL"" + "")"");

    // Creating user table
    // TODO Should username be the unique idenifier of a user?!
    database.execSQL(""CREATE TABLE "" + TABLE_USER + ""("" + USER_COLUMN_ID
            + "" INTEGER PRIMARY KEY AUTOINCREMENT,"" + USER_COLUMN_USERNAME
            + "" TEXT NOT NULL,"" + USER_COLUMN_USERID + "" TEXT UNIQUE,""
            + USER_COLUMN_IMGURL + "" TEXT,"" + USER_COLUMN_SOURCE
            + "" TEXT NOT NULL"" + "")"");

    // Creating item table
    database.execSQL(""CREATE TABLE "" + TABLE_ITEM + ""("" + ITEM_COLUMN_ID
            + "" INTEGER PRIMARY KEY AUTOINCREMENT,"" + ITEM_COLUMN_ITEMID
            + "" INT UNIQUE,"" + ITEM_COLUMN_TEXT + "" TEXT,""
            + ITEM_COLUMN_TIMESTAMP + "" DATETIME,"" + ITEM_COLUMN_TYPE
            + "" TEXT,"" + ITEM_COLUMN_URL + "" TEXT,"" + ITEM_COLUMN_IMGURL
            + "" TEXT,"" + ITEM_COLUMN_USER_ID + "" INT NOT NULL"" + "")"");
    // @formatter:on
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // Temporarily drops all tables
    db.execSQL(""DROP TABLE IF EXISTS "" + TABLE_FEED);
    db.execSQL(""DROP TABLE IF EXISTS "" + TABLE_FEEDUSER);
    db.execSQL(""DROP TABLE IF EXISTS "" + TABLE_USER);
    db.execSQL(""DROP TABLE IF EXISTS "" + TABLE_ITEM);
    onCreate(db);
}

public void addFeed(Feed feed) {
    ContentValues temp = new ContentValues();

    temp.put(FEED_COLUMN_NAME, feed.getTitle());
    try {
        db.insertOrThrow(TABLE_FEED, null, temp);
    } catch (SQLiteConstraintException e) {
        Log.d(""ERROR"", ""Inserted feed is not UNIQUE!"");
        // TODO Apply listener to notify the user that the feed name already
        // exists!
    }
}

public void removeFeed(Feed feed) {
    String title = feed.getTitle();
    long id = getFeedID(feed);

    removeFeedBridge(id);

    db.delete(TABLE_FEED, FEED_COLUMN_NAME + ""=?"", new String[] { title });
}

public ArrayList&lt;String&gt; listFeeds() {
    final ArrayList&lt;String&gt; feeds = new ArrayList&lt;String&gt;();

    Cursor c = db.rawQuery(""SELECT * FROM "" + TABLE_FEED, null);
    while (c.moveToNext()) {
        String s = c.getString(1);
        feeds.add(s);
    }
    c.close();
    return feeds;
}

public long getFeedID(Feed feed) {
    String feedTitle = feed.getTitle();
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor c = db.query(TABLE_FEED, new String[] { FEED_COLUMN_ID },
            FEED_COLUMN_NAME + ""=?"", new String[] { feedTitle }, null,
            null, null);
    c.moveToNext();
    Long id = Long.parseLong(c.getString(0));
    c.close();
    return id;
}

public long getUserID(User user) {
    long id = user.getId();
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor c = db.query(TABLE_USER, new String[] { USER_COLUMN_ID },
            USER_COLUMN_ID + ""=?"", new String[] { id + """" }, null, null,
            null);
    c.moveToNext();
    Long id1 = Long.parseLong(c.getString(0));
    c.close();
    return id1;
}

public ArrayList&lt;String&gt; listUsers() {
    final ArrayList&lt;String&gt; users = new ArrayList&lt;String&gt;();

    Cursor c = db.rawQuery(""SELECT * FROM "" + TABLE_USER, null);

    while (c.moveToNext()) {
        String s = c.getString(1);
        users.add(s);
    }
    return users;
}

public void addUserToFeed(User user, Feed feed) {
    long FeedID = getFeedID(feed);
    long UserID = addUser(user);

    // Add bridge connection
    if (UserID != -1) {
        addFeedUserBridge(FeedID, UserID);
    }
}

public long addUser(User user) {
    // TODO Check if the user already exists!!
    ContentValues temp = new ContentValues();

    temp.put(USER_COLUMN_USERNAME, user.getUserName());
    temp.put(USER_COLUMN_USERID, user.getId());
    temp.put(USER_COLUMN_IMGURL, user.getProfileImageURL());
    temp.put(USER_COLUMN_SOURCE, ""Twitter"");
    // TODO implement source on user?

    long userID = db.insert(TABLE_USER, null, temp);
    return userID;
}

public void addFeedUserBridge(long feedID, long userID) {
    ContentValues temp = new ContentValues();

    temp.put(FEEDUSER_COLUMN_FEED_ID, feedID);
    temp.put(FEEDUSER_COLUMN_USER_ID, userID);

    db.insert(TABLE_FEEDUSER, null, temp);
}

public void removeUserFromFeed(Feed feed, User user) {
    long feedID = getFeedID(feed);
    long userID = getUserID(user);

    removeFeedUserBridge(feedID, userID);
}

private void removeUser(User user) {
    long id = user.getId();
    db.delete(TABLE_USER, USER_COLUMN_ID + ""=?"", new String[] { id + """" });
}

private void removeFeedUserBridge(long feedID, long userID) {
    db.delete(TABLE_FEEDUSER, FEEDUSER_COLUMN_FEED_ID + ""=?"" + "" and ""
            + FEEDUSER_COLUMN_USER_ID + ""=?"", new String[] { feedID + """",
            userID + """" });
}

public ArrayList&lt;String&gt; listFeedUser() {
    final ArrayList&lt;String&gt; feeduser = new ArrayList&lt;String&gt;();
    Cursor c = db.rawQuery(""SELECT * FROM "" + TABLE_FEEDUSER, null);
    while (c.moveToNext()) {
        feeduser.add(c.getString(0) + "" "" + c.getString(1));
    }
    c.close();
    return feeduser;
}

private void removeFeedBridge(Long id) {
    db.delete(TABLE_FEEDUSER, FEEDUSER_COLUMN_FEED_ID + ""=?"",
            new String[] { id + """" });
}

public void updateUser(long userID) {
    // TODO implement this method
}

public void addListOfItems(List&lt;? extends Item&gt; itemList) {
    db.beginTransaction();
    for (Item i : itemList) {
        ContentValues temp = new ContentValues();
        temp.put(ITEM_COLUMN_ITEMID, i.getId());
        temp.put(ITEM_COLUMN_TEXT, i.getText());
        temp.put(ITEM_COLUMN_TIMESTAMP, i.getTimestamp());
        temp.put(ITEM_COLUMN_TYPE, i.getText());
        temp.put(ITEM_COLUMN_URL, i.getURL());
        temp.put(ITEM_COLUMN_IMGURL, i.getIMGURL());
        temp.put(ITEM_COLUMN_USER_ID, i.getUser().getId());
        db.insertWithOnConflict(TABLE_ITEM, null, temp, SQLiteDatabase.CONFLICT_IGNORE);

    }
    db.setTransactionSuccessful();
    db.endTransaction();
}

public List&lt;User&gt; getUsersInFeed(Feed feed) {
    List&lt;User&gt; users = new ArrayList&lt;User&gt;();

    Cursor c = db
            .rawQuery(""SELECT * FROM "" + TABLE_USER + "" WHERE ""
                    + USER_COLUMN_USERID + "" IN (SELECT ""
                    + FEEDUSER_COLUMN_USER_ID + "" FROM "" + TABLE_FEEDUSER
                    + "" WHERE "" + FEEDUSER_COLUMN_FEED_ID + "" = ""
                    + getFeedID(feed) + "")"", null);

    c.moveToFirst();
    while (!c.isAfterLast()) {
        users.add(new User(c.getLong(c.getColumnIndex(USER_COLUMN_USERID)),
                c.getString(c.getColumnIndex(USER_COLUMN_USERNAME))));
        c.moveToNext();
    }

    return users;
}

public Cursor getAllItems() {
    Cursor c = db.query(TABLE_ITEM, new String[] { ITEM_COLUMN_ID,
            ITEM_COLUMN_TEXT, ITEM_COLUMN_TIMESTAMP, ITEM_COLUMN_TYPE,
            ITEM_COLUMN_URL, ITEM_COLUMN_IMGURL, ITEM_COLUMN_USER_ID },
            null, null, null, null, null);
    // db.close();
    return c;
}

public long getItemTableSize() {
    SQLiteDatabase database = this.getReadableDatabase();
    long l = DatabaseUtils.queryNumEntries(database, TABLE_ITEM);
    // database.close();
    return l;
}

public void clearItemTable() {
    db.delete(TABLE_ITEM, null, null);
}

public void clearUserTable() {
    db.delete(TABLE_USER, null, null);
}

public void clearFeeds() {
    db.delete(TABLE_FEED, null, null);
    db.delete(TABLE_FEEDUSER, null, null);
}

public void addUsers(List&lt;? extends User&gt; users) {
    db.beginTransaction();

    for (User u : users) {
        ContentValues temp = new ContentValues();
        temp.put(USER_COLUMN_USERNAME, u.getUserName());
        temp.put(USER_COLUMN_USERID, u.getId());
        temp.put(USER_COLUMN_SOURCE, u.getSource());
        db.insertWithOnConflict(TABLE_USER, null, temp, SQLiteDatabase.CONFLICT_IGNORE);
    }
    db.setTransactionSuccessful();
    db.endTransaction();
}

public Cursor getAllUsers() {
    Cursor c = db.query(TABLE_USER, new String[] { USER_COLUMN_ID,
            USER_COLUMN_USERNAME, USER_COLUMN_USERID }, null, null, null,
            null, null);
    return c;
}

public Cursor getItems(Feed feed) {
    Cursor c = db.rawQuery(""SELECT * FROM "" + TABLE_ITEM 
            + "" WHERE "" + ITEM_COLUMN_USER_ID 
            + "" IN (SELECT "" + FEEDUSER_COLUMN_USER_ID 
            + "" FROM "" + TABLE_FEEDUSER
            + "" WHERE "" + FEEDUSER_COLUMN_FEED_ID 
            + "" = "" + getFeedID(feed)
            + "") ORDER BY "" + ITEM_COLUMN_TIMESTAMP + "" DESC"", null);
    return c;
}
</code></pre>

<p>}</p>

<p>Best regards
Rawa</p>
","2012-10-12 20:14:40"
"5135051","refactoring ruby method","1","<p>this is a simple question...</p>

<p>Does this method can be refactored?</p>

<pre><code>def sum
  total = 0
  [1,2,3,4].each do |num|
    total += num
  end
  total
end
</code></pre>

<p>thanks for your help!</p>
","2011-02-27 18:36:59"
"14680106","refactor Html.LabelFor, EditorFor, ValidationMessageFor into partial view","1","<p>I want to refactor view form code to avoid copyPaste. But it's not working. Razor don't allow to write</p>

<pre><code>@model System.Linq.Expressions.Expression&lt;Func&lt;TModel, TValue&gt;&gt; expression
</code></pre>

<p>and</p>

<pre><code>@Html.Partial(""Item"", model =&gt; model.EmpName)
</code></pre>

<p>Old code, that working:</p>

<pre><code>        &lt;tr&gt;
            &lt;td class=""editor-label"" style=""border: 0;""&gt;
                @Html.LabelFor(model=&gt;model.EmpName)
            &lt;/td&gt;
            &lt;td class=""editor-field"" style=""border: 0""&gt;
                @Html.EditorFor(model=&gt;model.EmpName)
                @Html.ValidationMessageFor(model=&gt;model.EmpName)
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td class=""editor-label"" style=""border: 0;""&gt;
                @Html.LabelFor(model=&gt;model.Email)
            &lt;/td&gt;
            &lt;td class=""editor-field"" style=""border: 0;""&gt;
                @Html.EditorFor(model=&gt;model.Email)
                @Html.ValidationMessageFor(model=&gt;model.Email)
            &lt;/td&gt;
        &lt;/tr&gt;
</code></pre>

<p>After refactoring not working:</p>

<p>Item.cshtml:</p>

<pre><code>   @model System.Linq.Expressions.Expression&lt;Func&lt;TModel, TValue&gt;&gt; expression
        &lt;tr&gt;
            &lt;td class=""editor-label"" style=""border: 0;""&gt;
                @Html.LabelFor(expression)
            &lt;/td&gt;
            &lt;td class=""editor-field"" style=""border: 0""&gt;
                @Html.EditorFor(expression)
                @Html.ValidationMessageFor(expression)
            &lt;/td&gt;
        &lt;/tr&gt;
    }
</code></pre>

<p>New code:</p>

<pre><code> @Html.Partial(""Item"", model =&gt; model.EmpName)
 @Html.Partial(""Item"", model =&gt; model.Email)
</code></pre>

<p>How to make it work?</p>
","2013-02-04 03:53:07"
"30156282","refactoring multiple variable names intellij","1","<p>Is there any way for Intellij to refactor the code consisting of multiple copy-pasted lines like this one:</p>

<pre><code>Comment a1 = new Comment(1,null);
Comment a1 = new Comment(1,null);
Comment a1 = new Comment(1,null);
... and
.. so
. on
</code></pre>

<p>into</p>

<pre><code>Comment a1 = new Comment(1,null);
Comment a2 = new Comment(1,null);
Comment a3 = new Comment(1,null);
... and
.. so
. on
</code></pre>
","2015-05-10 20:25:24"
"32639112","refactor and move controller code into model issues","1","<p>So I'm running into some issues that I'm not aware of how to solve when I'm improving my code.</p>

<p>Currently in my controller#show I have this ugly piece of code:</p>

<pre><code>def show
  @room = Room.find(params[:id])
  if user_signed_in?
    gon.push(
      session_id: @room.session_id,
      api_key: 453,
      token: current_user.tokens.last.token
    )
  elsif customer_signed_in?
    gon.push(
      session_id: @room.session_id,
      api_key: 453,
      token: current_customer.tokens.last.token,
      customer_id: current_customer.id
    )
  elsif @room.price == 0.0
    @token = OT.generate_token @room.session_id
    gon.push(
      session_id: @room.session_id,
      api_key: 453,
      token: @token
    )
  else
    @customer = Customer.new
  end
end
</code></pre>

<p>now I would like to move this into the rooms model. The issue that I'm having is that I'm having an if else based on if it's a user, customer or neither. How would I go about moving this into a model and still be able to validate this?</p>
","2015-09-17 20:09:30"
"932226","refactoring boolean equation","1","<p>Let's say you have a Boolean rule/expression like so</p>

<pre><code>(A OR B) AND (D OR E) AND F
</code></pre>

<p>You want to convert it into as many AND only expressions as possible, like so</p>

<pre><code>A AND D AND F
A AND E AND F
B AND D AND F
B AND E AND F
</code></pre>

<p>You are just reducing the OR's so it becomes</p>

<pre><code>(A AND D AND F) OR (A AND E AND F) OR (...)
</code></pre>

<p>Is there a property in Boolean algebra that would do this?  </p>
","2009-05-31 15:25:32"
"7998937","refactoring and removing 'for' statements when circling over many enum structures","1","<p>My class have an Enum as attribute.
It uses a String to set this attr.
There are many Enum classes.
How can I refactor it?</p>

<pre><code>public void setType(String s) {  

for (MyEnum1 e : MyEnum1.values()) {  
    if (e.name().equalsIgnoreCase(s))  
    this.type = e;  
}  
for (MyEnum2 e : MyEnum2.values()) {  
    if (e.name().equalsIgnoreCase(s))  
    this.type = e;  
}  
for ...  
</code></pre>

<p>Thanks in advance.</p>
","2011-11-03 17:04:41"
"25504751","refactor legacy python code: from u'...' to '...'","1","<p>I have a legacy code project which uses a lot of unicode strings like this: <code>u'...'</code></p>

<p>I want to update the code to use <code>from __future__ import unicode_literals</code></p>

<p>Any automated help from pycharm or an other tool?</p>

<p><strong>Update</strong></p>

<p>A simple search+replace does not work, since the code could contain strings like <code>'fuu'</code> and I don't want that to be replace to <code>'fu'</code>.</p>
","2014-08-26 11:28:58"
"4776687","refactor a method with a block that contains multiple blocks itself","1","<p>I'm using Ruby 1.9.2</p>

<p>I have a class method called search that takes a block</p>

<p>e.g.</p>

<pre><code>class MyClass
  def self.search do
    if criteria1
      keywords ""abcde"", fields: :c1 do
        minimum_match(1)
      end
    end

    if criteria2
      keywords ""defghi"", fields: :c2 do
        minimum_match(1)
      end
    end
  end
end
</code></pre>

<p>What I'd like to do is refactor the MyClass.search method and have a simple one-line method for each if/end statement</p>

<p>e.g. it would look something like this:</p>

<pre><code>class MyClass

  def self.search do
    c1_method
    c2_method
  end

  def self.c1_method
    if criteria1
      return keywords ""abcde"", fields: :c1 do
        minimum_match(1)
      end
    end
  end

  def self.c2_method
    if criteria2
      return keywords ""defghi"", fields: :c2 do
        minimum_match(1)
      end
    end
  end
end
</code></pre>

<p>But the refactoring that I show above doesn't quite work.  It looks like the ""blocks"" that I'm returning in c1_method and c2_method aren't really being returned and evaluated in the search method, but I'm not sure how to do that.</p>
","2011-01-23 21:37:24"
"9491516","refactor calls to a bunch of constructors that all take the same args","1","<p>How would I refactor this:</p>

<pre><code>if (cond1) {
    return new Class1(arg1, arg2, arg3);
}
else if (cond2) {
    return new Class2(arg1, arg2, arg3);
}
else if (cond3) {
    return new Class3(arg1, arg2, arg3);
}
...
</code></pre>

<p>I'm particularly interested in avoiding repeating <code>arg1, arg2, arg3</code></p>
","2012-02-28 23:38:23"
"45792353","refactor functions using template literal","1","<p>I have these 2 functions, if I seperate them I would have a lot of redundant codes. You can see what it does here <a href=""https://jsfiddle.net/8m9zbefq/"" rel=""nofollow noreferrer"">https://jsfiddle.net/8m9zbefq/</a> basically I just want to transform the data structure.</p>

<p>How can I refactor two function into one?</p>

<pre><code>const prepare_femaleObj = raw.map((obj, i) =&gt; {
  const female_count = obj.age_data.reduce((accum, obj2) =&gt; {
    if(obj2.female_count) return accum + obj2.female_count
  }, 0)

  const percentage = female_count / total_female_count * 100

  return { id: ++i, camera: obj.device_info.name + ' - ' + obj.device_info.entrance_name, percentage }
})

const prepare_maleObj = raw.map((obj, i) =&gt; {
  const male_count = obj.age_data.reduce((accum, obj2) =&gt; {
    if(obj2.male_count) return accum + obj2.male_count
  }, 0)

  const percentage = male_count / total_male_count * 100

  return { id: ++i, camera: obj.device_info.name + ' - ' + obj.device_info.entrance_name, percentage }
})
</code></pre>

<p>I've this thought, use template literal to make the gender dynamic</p>

<pre><code>const prepare_Obj = (gender) =&gt; raw.map((obj, i) =&gt; {
  const `${gender}_count` = obj.age_data.reduce((accum, obj2) =&gt; {
    if(obj2[`${gender}_count`)] return accum + obj2.female_count
  }, 0)

  ...
})
</code></pre>

<p>is the approach fine?</p>
","2017-08-21 08:22:12"
"4560741","refactoring this block","1","<p>I'm refactoring some code that wasn't written by me. This block sets the value of <code>$val</code> but I want to clean it up a bit. Obviously I can't use the tertiary operator here. What other ways I can make this code cleaner?</p>

<pre><code>  if (isset($vars[$input])) {
       $val = $vars[$input];
  } elseif (isset($this-&gt;getI['io'])) {
       $val = $this-&gt;getI['io'];
  } elseif (isset($vars[5])) {
       $val = $vars[5];
  } else {
       $val = 10;
  }
</code></pre>
","2010-12-30 07:09:35"
"23414508","refactor rails controller that has many query parameters?","1","<p>I have a rails controller show action which shows either the parents teams of a team, the child teams of a team, or the full family tree. Currently I am doing this as a simple case statement. Is this the correct ""rails"" way to do it or should I refactor? If yes, any suggestions on how would be appreciated.</p>

<pre><code>if @team= fetch_team
  case params[:tree]
  when 'parents'
    @output = @team.ancestor_ids
  when 'children'
    @output = @team.child_ids
  when 'full'
    @output = @team.full_tree
  when nil
    @output = fetch_team
  else
    @output = {message: ""requested query parameter: '#{params[:tree]}' not defined""}
  end

  render json: @output
else
  render json: {message: ""team: '#{params[:id]}' not found""}, status: 404
end

##

def fetch_team
 Team.find_by(name: params[:id])
end
</code></pre>
","2014-05-01 18:54:32"
"19587133","refactor folder ""layout"" to ""layout-sw600dp"" and it cannot work","1","<p>Before this, I make an application using the settings for normal phone and now I want to switch to using the tablet .When I refactor the folder ""layout"" to ""layout-sw600dp"", it cannot work in emulator. plz help me.tq</p>
","2013-10-25 10:18:32"
"1396166","refactoring and removing case statements when circling over an enum structure","1","<p>An enum structure declared in its own class is a member variable to the business logic class. That enum basically represents the state of that other class.</p>

<p>Although I have revisited the issue several times, replacing, or getting rid of those case statements proves quite frustrating to me.</p>

<p>Several business logic methods simple iterate over the enum and change the state of that class by assigning another value of the same enum, and other properties.</p>

<pre><code>public enum MyEnum{ A,B,C,D }
</code></pre>

<p>The business logic class has this enum as a member:</p>

<pre><code>public class BusinessLogic {

    private MyEnum CurrentSelection;
    private int propertyX;
    private int propertyY;

    public void operation1(){
        switch(CurrentSelection){
        case A: {alter propertyX this way; break;}
        case B: {alter propertyY this way; break;}
        case C: {alter propertyX that way; break;}
        case D: {alter propertyY that way; break;}
        }

    }

    public void operation2(){
        switch(CurrentSelection){
        case A: {CurrentSelection=MyEnum.B; break;}
        case B: {CurrentSelection=MyEnum.C; break;}
        ....etc
        }
    }

    public void operation3(){
        switch(CurrentSelection){
        case A: {CurrentSelection=MyEnum.D; break;}
        case B: {CurrentSelection=MyEnum.A; break;}
        ....etc
        }
    }
}
</code></pre>

<p>Another client class will instantiate the business logic class, initialing its properties and then using its operation methods.</p>

<p>What I have successfully done (with help from SO) is encapsulate the operation methods into a command pattern structure so I can call the operations without any case statements. (<a href=""https://stackoverflow.com/questions/1386673/trouble-making-polymorphism-defeat-those-switch-case-statements"">here</a>).</p>

<p>I guess my trouble is how to encapsulate the case statements in my business logic class. I suspect that I would need polymorphism and the appropriate data structures.</p>

<p>The refactoring experts suggest each case statement should be an implementation of a common interface. But if I have 3 methods iterating over a 4-member enum that means I'd probably need 3 interfaces with 4 implementations each, giving me 12 classes (plus 3 interfaces). Wouldn't that be a class overload? The logic is working fine with those 3 methods as they are, but the issue are the repeating switch/case statements.</p>

<p>Is there a way to refactor those switch statements but avoid a myriad of other classes in the name of polymorphism? Would it be possible to factor out the iterate-over-the-enum part? Or just the cases (where the logic is) should be refactored?</p>

<hr>

<p>As a first step I removed those methods completely my having them implement a simple interface:</p>

<pre><code>public interface Command {
    void execute();
}
</code></pre>

<p>So, its operation method implemented the command interface:</p>

<pre><code>public class Operation1 implements Command {

    private void doOperation1(){
        switch(CurrentSelection){
            ..all the cases here
        }       
    }

    public void execute() {
        doOperation1();
    }

}
</code></pre>

<p>As I see this, it will buy my a cleaner business logic class, but the trail of the switch cases will remain, right?</p>
","2009-09-08 20:26:44"
"39143730","refactor angular js factory to provider","1","<p>I have a factory defined in my program called 'EntityName'. now i want to refactor it to be a provider since I need to add a register function in the provider level.
however, I don't want to change all places using the existing factory like so:</p>

<pre><code>new EntityName()
</code></pre>

<p>so I refactored my factory to be a provider like so:</p>

<pre><code>myMoodule.provider('EntityName', function() {
    var _this = this;       
    _this.registerLabel = function registerLabel(name) {
          ...
    };
    _this.$get =  function (session, Logger) {
            var logger = new Logger('EntityName');
            return function EntityName(){...}
    }
)};
</code></pre>

<p>that way I have both method to be used in provider level(registerLabel) and no need to refactor all places using <code>New EntityName()</code></p>

<p>my question is- whether I can add some functions in the 'service' level and keep the fact that I don't need to refactor all <code>New EntityName()</code>: </p>

<p>for example I want to have a method <code>EntityName.replaceLabel()</code> </p>

<p>(not related to the object from <code>var name = new EntityName()</code></p>

<p>I want the service to expose more functions -not only the constructor function. is it possible ? how can i do it? that the $get will return both constructor function (so I won't need to change all other places) and also expose additional methods and use it like any other service </p>
","2016-08-25 11:12:35"
"46614735","refactoring to calculate running time of sorting algorithm - python","1","<p>I wrote this to calculate the average running time of sorting algorithms,
and I was just curious if there was a way to refactor this to something simpler or better.</p>

<pre><code>time = []
for i in range(3):
    start = timeit.default_timer()
    insert_list = []
    for i in range(3000):
        insert_list.append(randint(0,5000))
    sorted_list = merge_sort(insert_list)
    stop = timeit.default_timer()
    time.append(stop - start)
print sum(time) /len(time)
</code></pre>
","2017-10-06 22:24:17"
"10184290","refactoring code in rails controller","1","<p>i have two actions in my controller</p>

<pre><code>def up_vote
    lesson = Lesson.find(params[:id])
    current_user.up_vote!(lesson)
    flash[:message] = 'Thanks for voting!'
    redirect_to lesson_path(lesson)
end

def down_vote
    lesson = Lesson.find(params[:id])
    current_user.down_vote!(lesson)
    flash[:message] = 'Thanks for voting!'
    redirect_to lesson_path(lesson)
end
</code></pre>

<p>i was wondering what would be a good way to refactor this (keeping DRY in mind)? i read online that i shouldn't be trying to abuse the before_filter. what else could i use then? thanks!</p>
","2012-04-17 02:28:17"
"2615901","refactor LINQ TO SQL custom properties that instantiate datacontext","1","<p>I am working on an existing ASP.NET MVC app that started small and has grown with time to require a good re-architecture and refactoring.</p>

<p>One thing that I am struggling with is that we've got partial classes of the L2S entities so we could add some extra properties, but these props create a new data context and query the DB for a subset of data.  This would be the equivalent to doing the following in SQL, which is not a very good way to write this query as oppsed to joins: </p>

<pre><code>SELECT tbl1.stuff, 
    (SELECT nestedValue FROM tbl2 WHERE tbl2.Foo = tbl1.Bar),
    tbl1.moreStuff
 FROM tbl1
</code></pre>

<p>so in short here's what we've got in some of our partial entity classes:</p>

<pre><code>public partial class Ticket {

public StatusUpdate LastStatusUpdate
{
    get
    {
         //this static method call returns a new DataContext but needs to be refactored
         var ctx = OurDataContext.GetContext();
         var su = Compiled_Query_GetLastUpdate(ctx, this.TicketId);
         return su;
    }
}

}
</code></pre>

<p>We've got some functions that create a compiled query, but the issue is that we also have some DataLoadOptions defined in the DataContext, and because we instantiate a new datacontext for getting these nested property, we get an exception </p>

<blockquote>
  <p>""Compiled Queries across DataContexts
  with different LoadOptions not
  supported""</p>
</blockquote>

<p>.  The first DataContext is coming from a DataContextFactory that we implemented with the refactorings, but this second one is just hanging off the entity property getter.</p>

<p>We're implementing the Repository pattern in the refactoring process, so we <strong>must</strong> stop doing stuff like the above.  Does anyone know of a good way to address this issue?</p>

<p>EDIT:  I am adding the code for the DataContextFactory that we created during our refactoring efforts.  Note that in the code above we have a GetContext() static method in the Linq DataContext class, which news up a datacontext, and is not using the DataContextFactory below:</p>

<pre><code>public class DataContextFactory&lt;T&gt; : IDataContextFactory where T : System.Data.Linq.DataContext
{
    public DataContextFactory()
    {
        _context = Activator.CreateInstance&lt;T&gt;();
    }

    public DataContextFactory(T context)
    {
        _context = context;
    }

    private System.Data.Linq.DataContext _context;
    public System.Data.Linq.DataContext Context
    {
        get 
        {
            return _context; 
        }
    }

    public void SaveAll()
    {
        Context.SubmitChanges();
    }

    public bool IsContextDirty
    {
        get
        {
            return Context != null &amp;&amp; (Context.GetChangeSet().Deletes.Count &gt; 0 ||
                                           Context.GetChangeSet().Inserts.Count &gt; 0 ||
                                           Context.GetChangeSet().Updates.Count &gt; 0);
        }
    }
}
</code></pre>
","2010-04-11 03:03:28"
"10050146","refactor this javascript code","1","<p>I have two click-events, that are nearly similar, but not quite. I am wondering how to refactor them best:</p>

<pre><code>  $('.remove_fields.dynamic').live('click', function(e) {
    var $this = $(this);
    var after_removal_trigger_node = $this.closest("".nested-fields"").parent();
    trigger_removal_callback($this);
    e.preventDefault();
    $this.closest("".nested-fields"").remove();
    trigger_after_removal_callback(after_removal_trigger_node);
  });

  $('.remove_fields.existing').live('click', function(e) {
    var $this = $(this);
    var after_removal_trigger_node = $this.closest("".nested-fields"").parent();
    trigger_removal_callback($this);
    e.preventDefault();
    $this.prev(""input[type=hidden]"").val(""1"");
    $this.closest("".nested-fields"").hide();
    trigger_after_removal_callback(after_removal_trigger_node);
  });
</code></pre>

<p>As you can tell there is a fair bit of overlap. I am wondering what the best/nicest way would be to refactor this code.</p>
","2012-04-06 22:54:42"
"35002854","refactor code using reflection","1","<p>I am struggling on refactoring this (working) code:</p>

<pre><code>MyDbContext db = new MyDbContext();

 List&lt;SelectListItem&gt; selectedItems = new List&lt;SelectListItem&gt;();
 if (type == null) return selectedItems;

if (type == typeof(class1))
             selectedItems = db.class1.ToList().Select(ii =&gt; new SelectListItem { Text = ii.Name, Value = ii.Id.ToString() }).OrderBy(si =&gt; si.Text).ToList();

if (type == typeof(class2))
             selectedItems = db.class2.ToList().Select(ii =&gt; new SelectListItem { Text = ii.Name, Value = ii.Id.ToString() }).ToList();

if (type == typeof(class3))
            selectedItems = db.class3.ToList().Select(ii =&gt; new SelectListItem { Text = ii.Name, Value = ii.Id.ToString() }).ToList();

if (type == typeof(class4))
            selectedItems = db.class4.ToList().Select(ii =&gt; new SelectListItem { Text = ii.Name, Value = ii.Id.ToString() }).ToList();
</code></pre>

<p>This code is inside an ASP.NET MVC controller.
Class1 to Class 4 are Model classes.</p>

<p>SelectListItem is just a ModelView class I use to grab an Id and a Name from a Class1, 2, 3 or 4 object. I don't think it s worth posting its code.
So below code just extracts all occurrences of Class1 or 2 or 3 or 4 and converts them into options that will be passed to a View (for a DropDownBox).
I only know the exact Model type at runtime of course (Class1...or 4).</p>

<p>I use Entity Framework with such a DbContext:</p>

<pre><code>  public partial class MyDbContext: DbContext
    {
...

        public virtual DbSet&lt;Class1&gt; Class1{ get; set; }
        public virtual DbSet&lt;Class2&gt; Class2{ get; set; }
        public virtual DbSet&lt;Class3&gt; Class3{ get; set; }
        public virtual DbSet&lt;Class4&gt; Class4{ get; set; }
...
    }
</code></pre>

<p>I am pretty sure I can end up with a clean code with reflection instead of this horrible thing I wrote. But I did not manage to get anything clean that compiles.</p>
","2016-01-25 21:36:11"
"32304235","refactoring working recursion code (hasFiveDIVs) for traversing the DOM","1","<p>@oriol provided an amazing two line recursive solution for a problem I was working on today.  </p>

<pre><code>function numOccurencesRecursive(arr, val) {
  if (!arr.length) return 0;
  return (arr[0] === val ? 1 : 0) + numOccurencesRecursive(arr.slice(1), val);
}
</code></pre>

<p>I was inspired to refactor some spagetti-ish code that I wrote yesterday:</p>

<pre><code>//returns a boolean
    function containsFiveOrMoreDivs(domElement) {
      var count = 0;

  function doCount(domElement) {
    if (domElement &amp;&amp; domElement.tagName === ""DIV"") {
      count++;
    }

    if (count &gt;= 5) {
      return true;
    }

    if (domElement.hasChildNodes()) {
      var children = domElement.childNodes;
      for (var i = 0; i &lt; children.length; i++) {
        if (doCount(children[i])) {
          return true
        }
      };
    };

    return false;
  }

  return doCount(domElement)
}
containsFiveOrMoreDivs(document);
</code></pre>

<p>Here's the attempt:</p>

<pre><code>function containsFiveOrMoreDivsPureRecursion(domElement) {
  if (!domElement &amp;&amp; domElement.tagName !== ""DIV"") {
    return 0;
  }
  return (domElement.tagName === ""DIV"" ? 1 : 0) + containsFiveOrMoreDivsPureRecursion(domElement.childNodes()); //?
}
</code></pre>

<p>how would I loop through all the child nodes recursively in this version? Is what I'm doing possible?</p>
","2015-08-31 04:58:17"
"37263329","refactoring multi-dimensional if/else conditions","1","<p>I'm writing in Swift, but the question is really language agnostic.</p>

<p>I have two variables, each of which could have multiple - but discrete - values. The various combinations of the two values lead to different behavior. </p>

<p>I need to consider all combinations and execute the appropriate code. What's the cleanest/easiest-to-maintain way to do this?</p>

<p>Graphically, it would look like this:</p>

<pre><code>var2 / var1 |    A    |    B    |    C    |
------------|---------|---------|---------|
Z           |(A &amp;&amp; Z) |(B &amp;&amp; Z) |(C &amp;&amp; Z) |
------------|---------|---------|---------|
Y           |(A &amp;&amp; Y) |(B &amp;&amp; Y) |(C &amp;&amp; Y) |
------------|---------|---------|---------|
X           |(A &amp;&amp; X) |(B &amp;&amp; X) |(C &amp;&amp; X) |
-------------------------------------------
</code></pre>

<p>You could imagine, with a third variable, the matrix becomes 3-dimensional, etc. which is why I'm interested in a generalizable solution, not necessarily a specific solution for my particular project.</p>

<p>I could go multiple if/else:</p>

<pre><code>if (var1 == A &amp;&amp; var2 == Z) {}
else if (var1 == B &amp;&amp; var2 == Z) {}
else if ...
</code></pre>

<p>But that sounds awful.</p>

<p>Currently, I'm using one if/else and the same switch over and over:</p>

<pre><code>if var1 == A {
    switch var2 {
        case Z:
        case Y:
        case X:
    }
} else if var1 == B {
    switch var2 {
        case Z:
        case Y:
        case X:
    }
} ...
</code></pre>

<p>But reusing the same switch tells me I'm doing it wrong.</p>

<p>Is this a case for polymorphism? That concept is a bit nebulous to me, and I don't quite philosophically get it. Is there a better way?</p>

<p>My real-life example is a calculator-type app where behavior depends not only on the button pressed, but also the <em>previous</em> button pressed, i.e. pressing '=' after a '#' is different than pressing '=' after '+' is different than pressing '+' after '=' is different than pressing a '#' after a '#', etc... So I'm comparing the current button pressed to the previous button pressed to determine the behavior of the calculator.</p>
","2016-05-16 21:12:39"
"21571197","refactoring input check for hangman in java with acm","1","<p>I'm taking an online java course using the acm package, so the following syntax may not be ""orthodox java"".  At any rate, hopefully, the point I'm making here comes through to those familiar with the package and otherwise:</p>

<p>The code I have below works for validating user input for a game of hangman in java, but going in, I was sure that I could do this with simply one if else statement, but ultimately for expediency's sake, I settled for adding a nested if, else statement.  It's really bugging me that I can't figure out how to refactor this code in one if else statement as I'm positive that there is at least one very obvious way to do this.  Any help would be much appreciated!</p>

<pre><code>private void turn()
{
    println(""The word now looks like this: "" + currentWord);
    println(""You have "" + guessesLeft + "" guesses left."");
    currentGuess = readLine(""Your guess: "");

    String temp = currentWord;

    /*test for legality of guess
     * 1) is it exactly 1 char long?(ie not blank nor a long string
     * 2) is it a letter?
     */
    if(currentGuess.length() == 0)
    {
        println(""That is an illegal guess."");
    }
    else{
        char guessedLetter = Character.toUpperCase(currentGuess.charAt(0));

        if(currentGuess.length() != 1 || !Character.isLetter(guessedLetter))
        {
            println(""That is an illegal guess."");
        }
        else{
        /*scan through secret word to find a match between
         * entered guess and secret word
         */ ......}

private String currentGuess;
private String currentWord;
</code></pre>
","2014-02-05 07:33:26"
"13501039","refactor maybe stack in Yesod","1","<p>Using Yesod, I want to show the user's profile name in the navigation bar of every page and want to link, with the <code>ProfileId</code>, to the profile-page of a user. <code>config/models</code> contains:</p>

<pre><code>User
    ident Text
    password Text Maybe
    UniqueUser ident
Profile
    username Text
    user UserId
    UniqueProfile user
    UniqueUsername username
</code></pre>

<p>Snippet from <code>Foundation.hs</code>:</p>

<pre><code>defaultLayout widget = do
    master &lt;- getYesod
    mmsg &lt;- getMessage
    maid &lt;- maybeAuthId
</code></pre>

<p>With the user-id I can query for the profile, but it's burried in <code>Maybe</code>s.
<a href=""https://stackoverflow.com/questions/12130732/deep-maybe-stack-with-yesod"">This Stack Overflow question</a> gives a good hint how to handle all those <code>Maybe</code>s... but, with my little experience of Haskell, I'm still struggling with it.</p>

<p>I came up with:</p>

<pre><code>mpid &lt;- runMaybeT $ do
    ouid &lt;- MaybeT maybeAuthId
    (Entity pid _) &lt;- MaybeT . runDB . getBy $ UniqueProfile ouid
    return pid

mprofilename &lt;- runMaybeT $ do
    ouid &lt;- MaybeT maybeAuthId
    (Entity _ p) &lt;- MaybeT . runDB . getBy $ UniqueProfile ouid
    return $ profileUsername p
</code></pre>

<p>This works, but is not optimal - repeating code and double database hits. How can I refactor this code?</p>

<p>I thought this would work:</p>

<pre><code>(mpid, mprofilename) &lt;- runMaybeT $ do
    ouid &lt;- MaybeT maybeAuthId
    (Entity pid p) &lt;- MaybeT . runDB . getBy $ UniqueProfile ouid
    return (pid, profileUsername p)
</code></pre>

<p>but, alas, a no-go:</p>

<pre><code>Foundation.hs:91:9:
    Couldn't match expected type `Maybe (t0, Text)'
                with actual type `(t1, t2)'
    In the pattern: (mpid, mprofilename)
    In a stmt of a 'do' block:
        (mpid, mprofilename) &lt;- runMaybeT
            $ do { ouid &lt;- MaybeT maybeAuthId;
                (Entity pid p) &lt;- MaybeT . runDB . getBy $ UniqueProfile ouid;
                return (pid, profileUsername p) }
    In the expression:
        do { master &lt;- getYesod;
             mmsg &lt;- getMessage;
             maid &lt;- maybeAuthId;
             (mpid, mprofilename) &lt;- runMaybeT
                 $ do { ouid &lt;- MaybeT maybeAuthId;
                 (Entity pid p) &lt;- MaybeT . runDB . getBy
                     $ UniqueProfile ouid;
                                          .... };
           .... }
</code></pre>

<p>I understand the error, but I don't get it solved.</p>

<p>Enlighten me!</p>
","2012-11-21 19:53:53"
"9853024","refactoring date and time columns convertion to Time(WithZone)","1","<p>I got 2 colums representing a date and a time. </p>

<p><code>{dateproc: '2012-03-23', horproc: '2000-01-01 16:15:23 UTC'}</code></p>

<p>Both are read as a TimeWithZone by rails. I need to combine them.</p>

<p>This is what I've done. It works, but it doesn't <em>feel</em> elegant, and it just doesn't seem readable.</p>

<pre><code>date_time_combined = dateproc + horproc.seconds_since_midnight.seconds
</code></pre>

<p>Any advice improoving it?</p>
","2012-03-24 15:45:04"
"6927614","refactoring sql schema","1","<p>Guys i currently have 2 tables that reference a lookup table. Ive been tasked with modifiying the database to allow the tables to reference more than one value in the lookup table.</p>

<p>My idea is to create a new table that has a new PK and a column that references the lookup table.  The PK of the new table is then dumped into the parent tables thus maintaining referential integrity E.G</p>

<p>Current</p>

<pre><code> Contracts
 =========
 PK Id
 FK lookupId

 Warranties
 ==========
 PK Id
 FK lookupId
</code></pre>

<p>New</p>

<pre><code> Contracts
 =========
 PK Id
 FK LinkingTableId

 Warranties
 ==========
 PK Id
 FK LinkingTableId

 LinkingTable
 ============
 PK Id
 FK LookupId
</code></pre>

<p>Is this a good way of handling the multiple references?</p>
","2011-08-03 13:56:18"
"7101485","refactor cferror tag to application.cfc's onError()","1","<p>How to translate</p>

<pre><code>&lt;cferror type=""EXCEPTION"" template=""ErrorTemplate.cfm""&gt;
</code></pre>

<p>to an <code>onError()</code> function for Application.cfc?  Notice that cferror create a var <code>error</code> struct for the template.  Is there a quick and easy way to create the same error struct?  How to pass that into ErrorTemplate.cfm using <code>&lt;cfinclude&gt;</code>?  </p>

<p>I know <code>onRequest()</code> shares the variable scope with the target page, but does onError share variables scope too?  If not, what shall I do? Stick it to the <code>Form</code> scope?</p>

<p>Thank you</p>
","2011-08-18 01:41:12"
"4629149","refactoring Quartz jobdata","1","<p>I had to refactor a class like this:</p>

<p>Class Person in package com.core has a reference to Class Address which is in the same package. I had to move Address to a new package com.core.location. This was simple on the java side, however, there are some quartz triggers which have com.core.Person referencing the old com.core.Address class as part of their job data map. It could be anywhere in the Map.</p>

<p>I have tried a few approaches, like writing an adapter which acts like a common ground between 2 java programs that eventually replace the ols class with the new one. What would be the best way to resolve this?</p>

<p>Thanks,
Chris.</p>
","2011-01-07 18:54:35"
"4096481","refactor XML with XSL","1","<p>I need to move the <code>&lt;sectionid/&gt;</code> and the <code>&lt;sponsor/&gt;</code> elements inside the corresponding <code>&lt;amendment/&gt;</code>.</p>

<p>Here is an example:</p>

<p>From :</p>

<pre><code>&lt;root&gt;
      &lt;sectionid&gt;A&lt;/sectionid&gt;
      &lt;sponsor&gt;john&lt;/sponsor&gt;
      &lt;sponsor&gt;paul&lt;/sponsor&gt;
      &lt;amendment&gt;
            &lt;id&gt;1&lt;/id&gt;
            &lt;text&gt;some text&lt;/text&gt;
      &lt;/amendment&gt;
      &lt;sectionid&gt;B&lt;/sectionid&gt;
      &lt;sponsor&gt;peter&lt;/sponsor&gt;
      &lt;amendment&gt;
            &lt;id&gt;5&lt;/id&gt;
            &lt;text&gt;some text&lt;/text&gt;
      &lt;/amendment&gt;
      &lt;amendment&gt;
            &lt;id&gt;4&lt;/id&gt;
            &lt;text&gt;some text&lt;/text&gt;
      &lt;/amendment&gt;
      &lt;sponsor&gt;max&lt;/sponsor&gt;
      &lt;amendment&gt;
            &lt;id&gt;6&lt;/id&gt;
            &lt;text&gt;some text&lt;/text&gt;
      &lt;/amendment&gt;
      &lt;amendment&gt;
            &lt;id&gt;7&lt;/id&gt;
            &lt;text&gt;some text&lt;/text&gt;
      &lt;/amendment&gt;

&lt;/root&gt;
</code></pre>

<p>to:</p>

<pre><code>&lt;root&gt;
      &lt;amendment&gt;
            &lt;sectionid&gt;A&lt;/sectionid&gt;
            &lt;sponsor&gt;john&lt;/sponsor&gt;
            &lt;sponsor&gt;paul&lt;/paul&gt;
            &lt;id&gt;1&lt;/id&gt;
            &lt;text&gt;some text&lt;/text&gt;
      &lt;/amendment&gt;
      &lt;amendment&gt;
            &lt;sectionid&gt;B&lt;/sectionid&gt;
            &lt;sponsor&gt;peter&lt;/sponsor&gt;
            &lt;id&gt;5&lt;/id&gt;
            &lt;text&gt;some text&lt;/text&gt;
      &lt;/amendment&gt;
      &lt;amendment&gt;
            &lt;sectionid&gt;B&lt;/sectionid&gt;
            &lt;sponsor&gt;peter&lt;/sponsor&gt;
            &lt;id&gt;4&lt;/id&gt;
            &lt;text&gt;some text&lt;/text&gt;
      &lt;/amendment&gt;
      &lt;amendment&gt;
            &lt;sectionid&gt;B&lt;/sectionid&gt;
            &lt;sponsor&gt;max&lt;/sponsor&gt;
            &lt;id&gt;6&lt;/id&gt;
            &lt;text&gt;some text&lt;/text&gt;
      &lt;/amendment&gt;
      &lt;amendment&gt;
            &lt;sectionid&gt;B&lt;/sectionid&gt;
            &lt;sponsor&gt;max&lt;/sponsor&gt;
            &lt;id&gt;7&lt;/id&gt;
            &lt;text&gt;some text&lt;/text&gt;
      &lt;/amendment&gt;

&lt;/root&gt;
</code></pre>

<p>Note 1: the <code>&lt;section/&gt;</code> element applies to all the <code>&lt;amendments/&gt;</code> before the next <code>&lt;sectionid/&gt;</code></p>

<p>Note 2: the <code>&lt;sponsor/&gt;</code> element applies to all the <code>&lt;amendments/&gt;</code> before the next <code>&lt;sponsor/&gt;</code> list.</p>

<p>Note 3: The values of <code>//amendment/id</code> are not sequential.</p>

<p>How can this transformation be done with XSLT 1.0.</p>
","2010-11-04 12:09:57"
"9083767","refactor code in order to use 3 values to make plot & tuple indices must be integers, not float","1","<p>I have a code in which for 3 different values of D ,i have 3 different values of dx and so,3 different plots.</p>

<p>I want to do a plot which will have all 3 plots in one.</p>

<pre><code>...
D=(0.133e-4,0.243e-4,0.283e-4)

dx=sc.zeros(3)
    for i in D:
        dx[i]=sc.sqrt(D[i]*dt/M)

        plt.ion()
        while n&lt;N:
            Vw_n=Vw_n1
            C_n=C_n1
            R2=(Vw_n+B1)/(Vw_0+B1)
            Cc=C_n1[0]/C0
            F2_1=10000/3*Pw*A*(C0*Vw_0/Vw_n1-C_n[1])
            dV=F2_1*dt
            Vw_n1=Vw_n+dV
            C_n1[0]=C0*Vw_0/Vw_n1
            F_i_2=-D[i]/dx[i]*(C_n[1:7]-C_n[0:6])
            C_n1[0:6]=C_n[0:6]-F_i_2*A*dt/(L/(V0/A)*V0/5)
            n+=1
            ttime=n*0.02*1000

            #-----PLOT AREA---------------------------------#

            mylabels=('T=273','T=293','T=298')
            colors=('-b','or','+k')

            if x==1:
                plt.plot(ttime,R2,mylabels[i],colors[i])
            elif x==2:
                plt.plot(ttime,Cc,mylabels[i],colors[i])
            plt.draw()
            plt.show()
</code></pre>

<p>----------RUNNABLE--------------------------</p>

<pre><code>import scipy as sc
import matplotlib.pyplot as plt


def graph(x):

    A=1.67e-6  
    V0=88e-12 
    Vw_n1=71.7/100*V0 
    Pw=0.22   
    L=4e-4
    B1=V0-Vw_n1   

    C7=0.447e-3  



    dt=0.2e-4
    M=0.759e-1

    C_n1=sc.zeros(7)
    C_n1[0:6]=0.290e-3
    C_n1[6]=0.447e-3


    C0=C_n1[0]
    Vw_0=Vw_n1

    N=2000 
    n =1
    D = ,0.243e-4
    dx = sc.sqrt(D*dt/M)

        plt.ion()
        while n&lt;N:
            Vw_n=Vw_n1
            C_n=C_n1
            R2=(Vw_n+B1)/(Vw_0+B1)
            Cc=C_n1[0]/C0
            F2_1=10000/3*Pw*A*(C0*Vw_0/Vw_n1-C_n[1])
            dV=F2_1*dt
            Vw_n1=Vw_n+dV
            C_n1[0]=C0*Vw_0/Vw_n1
            F_i_2=-D/dx*(C_n[1:7]-C_n[0:6])
            C_n1[0:6]=C_n[0:6]-F_i_2*A*dt/(L/(V0/A)*V0/5)
            n+=1
            ttime=n*0.02*1000

            #-----PLOT AREA---------------------------------#


            if x==1:
                plt.plot(ttime,R2)
            elif x==2:
                plt.plot(ttime,Cc)
            plt.draw()
            plt.show()
</code></pre>

<p>My problem is that i want to plot (ttime,R2) and (ttime,Cc).
But i can't figure how to call R2 and Cc for the 3 different values of D (and dx).</p>

<p>Also, i am taking an error: tuple indices must be integers, not float</p>

<p>at dx[i]=sc.sqrt(D[i]*dt/M).</p>

<p>Thanks!</p>
","2012-01-31 17:07:33"
"36697360","refactoring of simple code in Yii2 (if-else)","1","<p>i was doing some refactoring of code on project in Yii2 framework.</p>

<p>I'm just asking if this can be written nicer, with less repetition (i try to follow DRY whenever i can). Any literature recommendation about this kind of topic is more than welcome, sorry for bad English.</p>

<pre><code>$exception = Yii::$app-&gt;errorHandler-&gt;exception;

    if ($exception !== null) {
        if (isset($exception-&gt;statusCode)) {
            if ($exception-&gt;statusCode == 500) {
                return $this-&gt;render('error-500', ['exception' =&gt; $exception]);
            } elseif ($exception-&gt;statusCode == 404) {
                return $this-&gt;render('error-404', ['exception' =&gt; $exception]);
            } else {
                return $this-&gt;render('error', ['exception' =&gt; $exception]);
            }
        } elseif (isset($exception-&gt;code)) {
            if ($exception-&gt;code == 500) {
                return $this-&gt;render('error-500', ['exception' =&gt; $exception]);
            } elseif ($exception-&gt;code == 404) {
                return $this-&gt;render('error-404', ['exception' =&gt; $exception]);
            } else {
                return $this-&gt;render('error', ['exception' =&gt; $exception]);
            }
        }
    } else {
        $exception = new \yii\web\HttpException(500);
        return $this-&gt;render('error-500', ['exception' =&gt; $exception]);
    }
</code></pre>
","2016-04-18 14:48:57"
"15204488","refactor legacy code, extracting small interface from a giant one with a small implementation","1","<p>I have a large piece of code (legacy) which knows to connect to an external service lets say connects to skype and bring its availability, the way its doing this (this is how it works its for the sake of the example). is</p>

<pre><code>SkypeAvailabilityManager.java

.init
.start
.stop
.connect
.disconnect
.keepAlive
.updateStatus
</code></pre>

<p>(lets assume for the example that all methods need to be public and someone calls them).
Now there is a huge piece of code (huge legacy code which calls all above methods).</p>

<p>Now I need to have either synchronizing with skype or with some other service lets say its <code>MessengerB</code></p>

<p>However with messengerB i don't need the init, start, connect, etc, i only need the updateStatus method.</p>

<p>So I thought of this refactor (which does not yet sound fine to me i'll explain why</p>

<pre><code>Interface: ExternalStatusFetcher
</code></pre>

<p>methods of it:</p>

<pre><code>.updateStatus
</code></pre>

<p>Now the legacy code calls the above methods of .init .start .stop .connect in many many places, however the new MessengerStatusUpdaterImpl I need to add only needs .updateStatus and i want to reuse the .updateStatus of the skype implementation because i want to reuse code.</p>

<p>so my limitations:</p>

<ol>
<li>Reuse SkypeAvailabilityManager.java</li>
<li>Legacy code calls .start .stop ... from many places in code I don't what to change that this is a huge legacy.</li>
<li>I want a common interface meaning in my code I want to treat both impl the same way but so client would either call all the methods or only part of them i do not know until impelemntation is actually initialized with the real implemenation.</li>
</ol>

<p>what would be a good refactor of it?
If my container class holds an interface that holds all methods this owuld be nice, however my second implemenation does not need all the methods, so i'm a little mixed up what to do.</p>
","2013-03-04 15:00:32"
"30334257","refactoring Rails 4 before_action for code speed with reused controller methods","1","<p>I’ve been learning Rails for a while now and I’d like to know what the best way to include reusable methods in other methods is.  I use before_action for some, but I’m wondering if I should convert my code which looks like ‘Fig.A’ to utilize more before actions (Fig. B).  Is this the best practice &amp; does it improve speed? </p>

<p><strong>Fig.A</strong> <br>
SomeController.rb</p>

<pre><code>def some_action
  #logic
end

def my_method
 some_action
  #logic
end

def my_other_method
 some_action
  #logic
 end
</code></pre>

<p>versus using a before action</p>

<p><strong>Fig.B</strong><br>
SomeController.rb</p>

<pre><code>before_action  :some_action, only: [:my_method, :my_other_method]

def some_action
  #logic
end

def my_method
  #logic
end

def my_other_method
  #logic
end
</code></pre>

<p>I am asking as I am trying to get a handle on best practices and clean code.  Which is the preferred way?</p>
","2015-05-19 19:14:13"
"247329","refactor HTML-generating JavaScript","1","<p>Unfortunately on my project, we generate a lot of the HTML code in JavaScript like this:</p>

<pre><code>var html = new StringBuffer();
html.append(""&lt;td class=\""gr-my-deals\""&gt;&lt;a href=\"""").append(deal.url).append(""\"" target=\""_blank\""&gt;"").append(deal.description).append(""&lt;/a&gt;&lt;/td&gt;"");
</code></pre>

<p>I have 2 specific complaints about this:</p>

<ol>
<li>The use of escaped double quotes (\”) within the HTML string. These should be replaced by single quotes (‘) to improve readability.</li>
<li>The use of .append() instead of the JavaScript string concatentation operator “+”</li>
</ol>

<p>Applying both of these suggestions, produces the following equivalent line of code, which I consider to be much more readable:</p>

<pre><code>var html = ""&lt;td class=’gr-my-deals’&gt;&lt;a href=’"" + deal.url + ""’ target=’_blank’&gt;"" + deal.description + ""&lt;/a&gt;&lt;/td&gt;"";
</code></pre>

<p>I'm now looking for a way to automatically transform the first line of code into the second. All I've come up with so far is to run the following find and replace over all our Javascript code:</p>

<pre><code>Find:    ).append(  
Replace: +
</code></pre>

<p>This will convert the line of code shown above to:</p>

<pre><code>html.append(""&lt;td class=\""gr-my-deals\""&gt;&lt;a href=\"""" + deal.url + ""\"" target=\""_blank\""&gt;"" + deal.description + ""&lt;/a&gt;&lt;/td&gt;)"";
</code></pre>

<p>This should safely remove all but the first 'append()' statement. Unfortunately, I can't think of any safe way to automatically convert the escaped double-quotes to single quotes. Bear in mind that I can't simply do a find/replace because in some cases you actually do need to use escaped double-quotes. Typically, this is when you're generating HTML that includes nested JS, and that JS contains string parameters, e.g.</p>

<pre><code>function makeLink(stringParam) {

  var sb = new StringBuffer();
  sb.append(""&lt;a href=\""JavaScript:myFunc('"" + stringParam + ""');\""&gt;"");
}
</code></pre>

<p>My questions (finally) are:</p>

<ul>
<li>Is there a better way to safely replace the calls to 'append()' with '+'</li>
<li>Is there any way to safely replace the escaped double quotes with single quotes, regex?</li>
</ul>

<p>Cheers,
Don</p>
","2008-10-29 15:50:17"
"32352198","refactor performCrop() method out of activity class","1","<p>I have a PerformCrop method which works perfectly.</p>

<p>I want to move it to my 'util' class so i can call it in other activities. There are complications to this in that it uses intents which return to the calling class. I think this should be no issue but maybe i'm incorrect.</p>

<p>Here is what i have tried and the issue i am seeing</p>

<ol>
<li>I cut and paste performCrop() to my util class. </li>
<li>I had an error at 'startActivityForResult(cropIntent, CROP_IMAGE);' where it didnt recognise the method so i extended the class with 'Extends Activity'</li>
<li>When it runs it errors and im not 100% sure why but an exception is caught </li>
</ol>

<blockquote>
  <p>'java.lang.NullPointerException: Attempt to invoke virtual method
  'android.app.ActivityThread$ApplicationThread
  android.app.ActivityThread.getApplicationThread()' on a null object
  reference'</p>
</blockquote>

<p>Here is the method, below that is the 'onActivityResult' method. Can anyone tell me how to move the performCrop() to a non Activity extended class?</p>

<p>Code</p>

<pre><code>public void performCrop(Uri picUri)
{
    final int CROP_IMAGE = 2;
        /*
* PERFORM CROP
* this must take into account he fact we may not have a crop method on phone, or the diff ways diff OS crop
 */
    //NEXUS 5 OS 5 is example of this branch
    // take care of exceptions
    try {
        // call the standard crop action intent (the user device may not
        // support it)

        Intent cropIntent = new Intent(""com.android.camera.action.CROP"");
        // indicate image type and Uri
        cropIntent.setDataAndType(picUri, ""image/*"");
        // set crop properties
        cropIntent.putExtra(""crop"", ""true"");
        // // indicate aspect of desired crop
        cropIntent.putExtra(""aspectX"", 1);
        cropIntent.putExtra(""aspectY"", 1);
        // // // indicate output X and Y

        // retrieve data on return
        cropIntent.putExtra(""return-data"", true);
        // start the activity - we handle returning in onActivityResult
        startActivityForResult(cropIntent, CROP_IMAGE);
    }
    // respond to users whose devices do not support the crop action
    catch (ActivityNotFoundException anfe)
    {
        Toast toast = Toast.makeText(this,""This device doesn't support the crop action! Exception: "" + anfe.toString(),Toast.LENGTH_SHORT);
        toast.show();
    }
    catch (OutOfMemoryError e)
    {//NOT TESTED AS HW DOES NOT GO HERE
        System.out.println(""out of memory"");
    }
    catch (Exception e)
    { //NOT TESTED AS HW DOES NOT GO HERE
        Display display = this.getWindowManager().getDefaultDisplay();
        Point size = new Point();
        //display.getSize(size);
        int width = size.x;
        int height = size.y;
        Intent cropIntent = new Intent(""com.android.camera.action.CROP"");
        // indicate image type and Uri
        cropIntent.setDataAndType(picUri, ""image/*"");
        // set crop properties
        cropIntent.putExtra(""crop"", ""true"");
        // // indicate aspect of desired crop
        cropIntent.putExtra(""aspectX"", 2);
        cropIntent.putExtra(""aspectY"", 1);
        // // indicate output X and Y
        cropIntent.putExtra(""outputX"", width);
        cropIntent.putExtra(""outputY"", 200);
        // retrieve data on return
        cropIntent.putExtra(""return-data"", true);
        // start the activity - we handle returning in onActivityResult
        startActivityForResult(cropIntent, CROP_IMAGE);
    }
}
</code></pre>

<p>Called from Activity when the camera intent returns successful result. Note the crop intent will also retun to this method.</p>

<pre><code>@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data)
{
    // TODO Auto-generated method stub
    if (resultCode==RESULT_OK )
    {
        if(requestCode == CAMERA_IMAGE) //reply from camera
        {
            toolbox.performCrop(uri); //crop the picture
        }

        if(requestCode == CROP_IMAGE) //reply from crop
        {
           /* Bitmap bmp = getBitmap(uri);
            imgView.setImageBitmap(bmp);*/
            Bundle extras = data.getExtras();
            if (extras != null) {
                Bitmap bmp = extras.getParcelable(""data"");
                imgViewProfilePic.setImageBitmap(bmp);
            }
        }

        if (requestCode == PICK_IMAGE_FROM_GALLERY) //reply from gallery
        {
            Uri selectedImage = data.getData();
            uri = data.getData();
            toolbox.performCrop(uri);
        }
    }
}
</code></pre>
","2015-09-02 11:41:39"
"26266552","refactoring Ruby scraping code","1","<p>Basically, I will have multiple <code>.main_entry</code> blocks on each page and I will need to pull a couple of pieces of data from each. How can this be properly refactored into methods? </p>

<pre><code>require 'open-uri'
require 'nokogiri'


url = #url
doc = Nokogiri::HTML(open(url))

doc.css("".main_entry"").each do |item|
  artist = item.at_css("".list_artist"").text
  title = item.at_css("".list_album"").text
  puts ""#{artist} - #{title}""
end
</code></pre>

<p>I have arrived at this mess below, which throws the <code>undefined local variable or method 'release'</code> error that seems to be related to methods being over-written. Could you explain to me what process the code below goes through, why it breaks down and what I should turn to for the fix? Should each <code>.main_entry</code> block be saved into some kind of a cache or an array first, before instantiating? </p>

<pre><code>require 'open-uri'
require 'nokogiri'

class Scraper
  def initialize(url)
    @url = url
  end

  def release
    @release ||= doc.css("".main_entry"") || []
  end

  release.each do |item|
    define_method(:artist) do
      @artist ||= item.at_css("".list_artist"").text
    end

    define_method(:title) do
      @title ||= item.at_css("".list_album"").text
    end
  end

  private
  attr_reader :url

  def doc
    @doc ||= Nokogiri::HTML(open(url))
  end
end

scraper = Scraper.new( #url

puts ""#{scraper.artist} - #{scraper.title}""
</code></pre>
","2014-10-08 21:13:09"
"5679199","refactoring a database and application due to new requirements","1","<p>My application manages customer's complaints <strong>and has already been deployed into production</strong>. Each complaint has a code to identify it (for eaxmple ""late delivery""  ), a ""department"" type (wich is essentially the department responsible for that kind of complaint) and another ""model"" code which identifies the route through department's employees this complaint dossier has to follow (first to hr responsible then to hr big boss finally back to customer care). Each dossier has some common info and can have department specific infos, that's why i need deparment code.
For example Customer care get a complaint about ""rudeness"" of a call center operator, opens a dossier with code ABC and type ""HR"" (there's could be more HR dossier types). When the customer care has filled all the infos, forward it to hr(a mail is sent to the user configured in the system as HR responsible ). The hr employee fills his own section and send it back to customer care.</p>

<p>Till now each complaint code might have only one department and one model, now requirements have changed and i've two problems:</p>

<ol>
<li>Some complaints are identified by the same code but might be due to different departments . For example a complaint about employees rudeness could be sent to the department which rules the call centers or to the department which rules logistics</li>
</ol>

<p>i could solve this simply extending the table primary key to include the department (hoping they'll not decide the same code for the same department can follow different routes), changing application code might be a bit painful but it can be done : </p>

<p>Does extending primary keys to composite keys is a problem in Oracle or have side effects on existing records? the actual primary key is not used as foreign key anywere and all fields are filled.</p>

<ol>
<li>this is a quite more difficult problem (at least for me): marketing department (the rulers) wants a special dossier.They monitor time departments take to answer complaints and open a new type of dossier if they exceeds the standard time.
For the above example, if hr always needs the 30% more time to complete employees rudeness dossiers, marketing can open an ""inquire"" dossier about that complaint code directed to hr.<br>
Now, referring to point 1, i could add a new record for each complaint code having the second part of the key being the marketing code and associating it to a new model.This is going to double the rows of the table (which is already quite large). I see it very error prone for inserting new complaint codes. </li>
</ol>

<p>I know it's very hard to give an opinion without being able to see the schema and the code, but i would appreciate your opinion anyway</p>
","2011-04-15 15:43:53"
"47547719","refactor NodeJs functions","1","<p>I have a big <code>app.js</code> file and want to split the code. I took all my routes into a module called <code>routes.js</code></p>

<pre><code>module.exports = function(app){

app.get('/', function (req, res) {
  res.redirect('/page1');
});

app.get('/page1', function (req, res) {
  res.render('page1');
});

app.get('/page2/:id', function (req, res) {
    res.render('page2', {
      val: Number(req.params.id)
    });
});

}
</code></pre>

<p>and in my app.js I call</p>

<pre><code>const routes = require('./Server/routes')(app);
</code></pre>

<p>So this works fine.</p>

<p>I have some functions like</p>

<pre><code>function loadData(id, callback) {
  fs.readFile('./database.json', 'utf8', function (err, data) {
    var json = JSON.parse(data);
    var arr = json.arr;
    var obj = arr.find(e =&gt; e.id === Number(id));
    callback(obj);
  });
}
</code></pre>

<p>and want to have them in separate files too. How can I do this? I am able to export one function but how can I export more than one?</p>

<p>Like</p>

<pre><code>module.exports = function(){

function sayHello(){
   console.log(""Hello"");
}

function calc(){
   return 5 + 7;
}

}
</code></pre>

<p>require the module and call</p>

<pre><code>myModule.sayHello();

var num = myModule.calc();
</code></pre>
","2017-11-29 07:59:05"
"10312002","refactor constructors into setters in java","0","<p>I have refactored my method using ""Introduce a parameter"" as it was accepting a lot of variables. but now all the callers have inline cosntructor as </p>

<pre><code>this.somemethod(new MyParam(""a"", ""b"",""c"",""d""); 
</code></pre>

<p>i would like to refactor it by replacing constructor with setters like</p>

<pre><code>MyParam myParam= new MyParam();
myParam.setA(""a"");........
.
.
this.somemethod(myParam);
</code></pre>

<p>Is there someway to do this ?? </p>

<p>there was a similar bug reported on eclipse <a href=""https://bugs.eclipse.org/bugs/show_bug.cgi?id=105324"" rel=""nofollow"">https://bugs.eclipse.org/bugs/show_bug.cgi?id=105324</a></p>
","2012-04-25 08:27:09"
"1918604","refactoring best practices for both PHP and Ruby on Rails","0","<p>Wondering if someone can suggest a refactoring 'best practice' or more ideally a ""check-list"" that we can go through and refactor against common issues.  </p>

<p>Some of these ideas were pretty good:  <a href=""http://my.safaribooksonline.com/9780321620293"" rel=""nofollow noreferrer"">http://my.safaribooksonline.com/9780321620293</a></p>

<p>But looking for more.</p>

<p>Thanks.</p>
","2009-12-16 23:44:24"
"17358441","refactoring in C# codefirst","0","<p>I have very method is equal same</p>

<p>I want have one method do jobs  three or more method under</p>

<p>but I try use generic method or reflection but cannot write good method or class
my method:</p>

<p><strong>First method</strong></p>

<pre><code>    public ActionResult _Create1(MyClassView1  content)
    {            
        if (ModelState.IsValid)            
        {
            MyClass1 Home = new MyClass1();
            Mapper.Map(content, Home);
            if (content.Id &lt;= 0)                
                db.MyClasse1s.Add(Home);                                    
            else               
                db.Entry(Home).State = EntityState.Modified;
            db.SaveChanges();
            return Content(""Ok"");
        }
        return PartialView(content);
    }
</code></pre>

<p><strong>second method</strong></p>

<pre><code>    public ActionResult _Create2(MyClassView2  content)
    {            
        if (ModelState.IsValid)            
        {
            MyClass2 Home = new MyClass2();
            Mapper.Map(content, Home);
            if (content.Id &lt;= 0)                
                db.MyClasse1s.Add(Home);                                    
            else                
                db.Entry(Home).State = EntityState.Modified;
            db.SaveChanges();
            return Content(""Ok"");
        }
        return PartialView(content);
    }
</code></pre>

<p><strong>third method</strong></p>

<pre><code>    public ActionResult _Create3(MyClassView3  content)
    {            
        if (ModelState.IsValid)            
        {
            MyClass3 Home = new MyClass3();
            Mapper.Map(content, Home);
            if (content.Id &lt;= 0)                
                db.MyClasse1s.Add(Home);                                    
            else                
                db.Entry(Home).State = EntityState.Modified;
            db.SaveChanges();
            return Content(""Ok"");
        }
        return PartialView(content);
    }
</code></pre>

<p>How can merge this class to one class?</p>

<p>thanks for answers </p>
","2013-06-28 06:20:43"
"41774264","refactoring a file and a folder into a new git repository","0","<p>I followed the potential solution in </p>

<p><a href=""https://stackoverflow.com/questions/359424/detach-move-subdirectory-into-separate-git-repository/17864475#17864475"">Detach (move) subdirectory into separate Git repository</a></p>

<p>My requirement is similar but only slightly different Hope someone could provide some easy solution.</p>

<p>Say I have the following repo:</p>

<pre><code>node-browser-compat
├── ArrayBuffer
├── Audio
├── Blob
├── FormData
├── atob
├    ├──aaa.xyz 
├── btoa
├── location
└── navigator
</code></pre>

<p>I want to have a new repo <code>abcd</code> which has all of <code>btoa</code> and <code>aaa.xyz</code> in it while retaining the history of both <code>btoa</code> and <code>aaa.xyz</code>.
Any help will be highly appreciated.</p>

<p>Note: If I already have an empty repo called <code>abcd</code>, instructions to moving <code>btoa</code> and <code>aaa.xyz</code> into <code>abcd</code> will also help.</p>
","2017-01-21 00:02:09"
"38829990","refactor angular-route to angular-ui-router","0","<p>I've created a single page application using ngRoute like so:</p>

<p>index.html (ngRoute)</p>

<pre><code>var smallTalkzModel = angular.module('smallTalkzModel', ['ngRoute']);
smallTalkzModel.config(function($routeProvider) {

    $routeProvider
    .when('/', {
      templateUrl : 'components/login/loginView.html',
      controller  : 'loginController'
    }) 
    .when('/chat', {
      templateUrl : 'components/chat/chatView.html',
      controller  : 'chatController'
    });
  }).run(function ($rootScope) {

    // App is loading, so set isAppLoading to true and start a timer
    console.log($rootScope);
    $rootScope.isAppLoading = true;

  });;
</code></pre>

<p>small-talkz.model.js (ngRoute)</p>

<pre><code> &lt;div ng-app=""smallTalkzModel"" &gt;
    &lt;div ng-view&gt;
    &lt;/div&gt;

 &lt;/div&gt;
</code></pre>

<p>Then I heard that it is better to use ui.router because it is a 3rd party which have more capabilities and can does everything that ngRoute does and more and will be supported in future version of angular js...</p>

<p>So, I tried to refactore my code into the code below. which does not work...</p>

<p>Can anyone tell me why? I did not use ng-surf because I don't have any links into my html. I get to them by localhost:3000/somePage and not by navigation...</p>

<p>index.html (ui.router)</p>

<pre><code>&lt;div ng-app=""smallTalkzModel"" class=""loader""&gt;
    &lt;div ui-view&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p>small-talkz.model.js (ui.router)</p>

<pre><code>var smallTalkzModel = angular.module('smallTalkzModel', ['ui.router']);
smallTalkzModel.config(function($stateProvider, $urlRouterProvider) {

  $stateProvider
  .state('login', {
    url: '/',
    templateUrl : 'components/login/loginView.html',
    controller  : 'loginController'
  }) 
  .state('chat', {
    url: '/chat',
    templateUrl : 'components/chat/chatView.html',
    controller  : 'chatController'
  });
});;
</code></pre>
","2016-08-08 13:05:02"
"29707139","refactor code for big value","0","<p>I want to use this code to convert bytes into proper values </p>

<pre><code>import java.util.*;
import java.lang.*;
import java.io.*;
import java.text.DecimalFormat;

public class Ideone
{

    public static void main (String[] args) throws java.lang.Exception
    {
        String readableFileSize = readableFileSize(9394343298L);
        System.out.println(""Result "" + readableFileSize);
    }



    public static String readableFileSize(long size)
    {
            if (size &lt;= 0)
                return ""0"";
            final String[] units = new String[]
            {
                ""B"", ""kB"", ""MB"", ""GB"", ""TB""
            };
            int digitGroups = (int) (Math.log10(size) / Math.log10(1024));
            return new DecimalFormat(""#,##0.#"").format(size / Math.pow(1024, digitGroups)) + "" "" + units[digitGroups];
    }
}
</code></pre>

<p>The lode works but I have to place L after the number. In my case I use closed source library which when I use it I can't add L. Is there any way to refactor to code to convert very big values into proper format?</p>
","2015-04-17 18:45:39"
"33651537","refactoring old php with reflection","0","<p>so I am refactoring some old code written by someone else. I've come across this:</p>

<pre><code>$r = new \ReflectionClass($className);
$args = (is_subclass_of($className, 'ClassA')) ? [$arg1, $arg2] : [$arg2];
$classInstance = $r-&gt;newInstanceArgs($args);
</code></pre>

<p>my question is, why would the person do this? Doesn't this do the same?</p>

<pre><code>$args = (is_subclass_of($className, 'ClassA')) ? [$arg1, $arg2] : [$arg2];
$classInstance = new $className($args);
</code></pre>

<p>The code is a few years old - the reason could have something to do with old PHP version features. I'm just looking for reasons and confirmation that the second way is ""better"". Thanks.</p>
","2015-11-11 13:26:32"
"33717310","refactor controller to use a service in angular with multiple functions","0","<p>I have a controller that works fine, but it seems like it should be refactored to include a service.</p>

<p>My controller uses two functions to change a display of ingredients. One tied to a select element for mobile, the other tied to links for desktops.</p>

<p>Is it possible to refactor this to use a service?</p>

<p>My html for Mobile:</p>

<pre><code>&lt;select ng-model=""ingredient.item"" ng-options=""i.option for i in ingredient.items"" ng-change=""ingredient.change_select(ingredient.item)""&gt;
    &lt;option value=""""&gt;choose ingredient&lt;/option&gt;
&lt;/select&gt;
</code></pre>

<p>My html for Desktop:</p>

<pre><code>&lt;a ng-click=""ingredient.change_tab('octopamine','Octopamine')""&gt;Octopamine&lt;/a&gt;
</code></pre>

<p>My controller:</p>

<pre><code>app.controller('IngredientsCtrl', function() {
  var ingredient = this;

  ingredient.items = [
    {
      'option': 'Brigham\'s Tea Leaf',
      'param' : 'brighamtea'
    },
    {
      'option': 'White Willow Bark Powder',
      'param' : 'white_willow'
    }];

  ingredient.tab = 'brighamtea';
  ingredient.tab_image = 'http://imgix.ximo365.com/brighamtea.jpg';
  ingredient.tab_title = 'Brigham\'s Tea Leaf';

  ingredient.change_select = function (item) {
    ingredient.tab = item.param;
    ingredient.tab_image = 'http://imgix.ximo365.com/' + item.param + '.jpg';
    ingredient.tab_title = item.option;
  }

  ingredient.change_tab = function(param,title) {
    ingredient.tab = param;
    ingredient.tab_image = 'http://imgix.ximo365.com/' + param + '.jpg';
    ingredient.tab_title = title;
  }
});
</code></pre>
","2015-11-15 07:09:48"
"17206541","refactor this ruby database/sequel gem lookup","0","<p>I know this code is not optimal, any ideas on how to improve it?</p>

<pre><code>job_and_cost_code_found = false
  timberline_db['SELECT Job, Cost_Code FROM [JCM_MASTER__COST_CODE] WHERE [Job] = ? AND [Cost_Code] = ?', job, clean_cost_code].each do |row|
    job_and_cost_code_found = true
  end

if job_and_cost_code_found == false then 
  info = linenum + "","" + id + "",,Employees default job and cost code do not exist in timberline. job:#{job} cost code:#{clean_cost_code}""
  add_to_exception_output_file(info)
end
</code></pre>
","2013-06-20 06:18:51"
"26717938","refactoring repetitive sass to modify based on immediate parent's class","0","<p>tldr: how to avoid repetition of "".well"" selector in below example.</p>

<p>I am using bootstrap and sass to display a ""well"" div with a shape and with a gradient fill. This may not be a proper use of wells and I'd welcome other suggestions as to how to draw circular/rectangular divs with X% shaded (ideally where X is any integer. [0, 100]) but, for now, I am most interested in whether it's possible in SASS to get rid of the repetition of "".well"". I tried using ""&amp;"" but it would reverse .some_container too and I only wanted to reverse the immediate .inner_container parent to apply there (e.g. .inner_container.round). [There is one outer_container and multiple inner_containers. Each inner_container has one well.]</p>

<pre><code>.outer_container {
  .inner_container {
    &amp;.round .well {
      border-radius: 50%;
    }

    &amp;.barely_filled .well {
      @include gradient-horizontal(sienna, $well-bg, 0%, 25%);
    }

    &amp;.half_filled .well {
      @include gradient-horizontal(sienna, $well-bg, 0%, 50%);
    }

    &amp;.fairly_filled .well {
      @include gradient-horizontal(sienna, $well-bg, 0%, 75%);
    }

    &amp;.mostly_filled .well {
      background-color: sienna;
    }
  }
}
</code></pre>
","2014-11-03 15:56:11"
"5542598","refactoring an array","0","<p>I have the following result in AMFPHP from a sql query:</p>

<pre><code>(Array)#0
  [0] (Object)#1
    id = ""1""
    naam = ""4 kazen""
    pizzeria_id = ""1""
    pizzerianaam = ""Howest pizza""
    prijs = ""11""
  [1] (Object)#2
    id = ""2""
    naam = ""Napolitano""
    pizzeria_id = ""1""
    pizzerianaam = ""Howest pizza""
    prijs = ""13""
  [2] (Object)#3
    id = ""5""
    naam = ""pizza bolognaise""
    pizzeria_id = ""2""
    pizzerianaam = ""Nicola pizza""
    prijs = ""12""
  [3] (Object)#4
    id = ""6""
    naam = ""pizza funghi""
    pizzeria_id = ""2""
    pizzerianaam = ""Nicola pizza""
    prijs = ""16""
</code></pre>

<p>what i would like to do is refactor this array so the result is a  assosiative array with 2 arrays inside of it, the 2 arrays should be called after the ""pizzerianaam"" and within the ""pizzerianaam"" i should see the pizza's where the ""pizzerianaam"" matches.</p>

<p>so an array with 2 arrays in it wich contains other arrays for each pizza where the ""pizzerianaam"" value matches.</p>

<p>Anyone who ca help?</p>
","2011-04-04 18:22:20"
"29997423","refactoring a function that sorts with consideration for initial articles","0","<p>I've got a function that does what I want it to do, but it's really, really ugly. Looking for ways to not necessarily make it faster, but maybe make it a little less ugly, more generic, and overall more maintainable.</p>

<pre><code>&lt;?php

// unordered list
$list = Array(
    0 =&gt; 'My Images',
    1 =&gt; 'Text Alignment',
    2 =&gt; 'Your New Post',
    3 =&gt; 'The More Tag',
    4 =&gt; 'The Average Post',
    5 =&gt; 'The Paginated'
);

// Desired output:
//  Array(
//      4 =&gt; 'The Average Post',
//      3 =&gt; 'The More Tag',
//      0 =&gt; 'My Images',
//      5 =&gt; 'The Paginated',
//      1 =&gt; 'Text Alignment',
//      2 =&gt; 'Your New Post'
//  )

function alphabetical_sort_with_initial_articles($array) {
    $temp_results = [];
    $results = [];
    foreach($array as $key =&gt; $value) {
        $value_arr = explode(' ', $value);
        if($value_arr[0] === 'The') { // need to make this dynamic: the|The|etc.
            $initial_article = array_shift($value_arr);
            $temp_results[$key] = array(
                implode(' ', $value_arr),
                $initial_article
            );
        } else {
            $temp_results[$key] = array(
                implode(' ', $value_arr),
                false
            );
        }
    }

    uasort($temp_results, function($a, $b) {
        return ($a[0] &gt; $b[0]);
    });

    foreach($temp_results as $key =&gt; $value) {
        $results[$key] = trim($value[1] . ' ' . $value[0]);
    }

    return $results;
}

print_r($list);
echo ""------------------------\n"";
print_r(alphabetical_sort_with_initial_articles($list));

//josh@lear:~/Development/PHP/$ time php lists.php
//Array
//(
//    [0] =&gt; My Images
//    [1] =&gt; Text Alignment
//    [2] =&gt; Your New Post
//    [3] =&gt; The More Tag
//    [4] =&gt; The Average Post
//    [5] =&gt; The Paginated
//)
//------------------------
//Array
//(
//    [4] =&gt; The Average Post
//    [3] =&gt; The More Tag
//    [0] =&gt; My Images
//    [5] =&gt; The Paginated
//    [1] =&gt; Text Alignment
//    [2] =&gt; Your New Post
//)
//
//real  0m0.032s
//user  0m0.017s
//sys   0m0.013s
</code></pre>
","2015-05-02 01:37:52"
"46542385","refactoring spring boot application to use npm modules","0","<p>I had a spring boot application referencing JS files from resources/static folder. I installed node modules in that application in the root of the project. Can I load <code>npm</code> downloaded modules in java spring boot application ? How shall I reference the JS libraries in html files of the application ?</p>
","2017-10-03 10:24:45"
"35879208","refactor d3 bar chart to be horizontal bar chart","0","<p>I was trying to refactor this bar chart in d3 to be a horizontal bar chart. I think I've isolated the three areas that need to be changed:</p>

<p>the original scale declarations:</p>

<pre><code>  var x0 = d3.scale.ordinal()
      .rangeRoundBands([0, width], 0.1);

  var x1 = d3.scale.ordinal();

  var y = d3.scale.linear()
      .range([height, 0]);
</code></pre>

<p>The domain definitions:</p>

<pre><code>x0.domain(data.map(function(d) { return d.deviceType; }));
x1.domain(deviceClass).rangeRoundBands([0, x0.rangeBand()]);
y.domain([0, d3.max(data, function(d) { return d3.max(d.whenPurchased, function(d) { return d.value; }); })]);
</code></pre>

<p>the rect appending and positioning:</p>

<pre><code>device.selectAll(""rect"")
    .data(function(d) { return d.whenPurchased; })
  .enter().append(""rect"")
    .attr(""width"", x1.rangeBand())
    .attr(""x"", function(d) { return x1(d.device); })
    .attr(""y"", function(d) { return y(d.value); })
    .attr(""height"", function(d) { return height - y(d.value); })
    .style(""fill"", function(d) { return color(d.device); });
</code></pre>

<p>I can't seem to get the refactoring right and I think that is because I don't exactly get how domain works for x0 and basically not getting that right has a waterfall effect of everything else not working.</p>

<p>I put the full example here: <a href=""https://jsfiddle.net/hamlinkn/286L7fh0/1/"" rel=""nofollow"">JSFIDDLE</a></p>
","2016-03-08 22:22:12"
"6051672","refactoring rails3 models with use with an external model API","0","<p>How could I optimize (refactor) this non activerecord based model in rails3 that i have created.?</p>

<p>application.rb contains this:</p>

<pre><code>CS = CloudServers::Connection.new(:username =&gt; '&lt;hidden&gt;', :api_key =&gt; '&lt;hidden&gt;')
</code></pre>

<p>cloudserver.rb (model) contains this:</p>

<pre><code>class Cloudserver
  # extend ActiveModel::Naming


  attr_reader :id
  attr_reader :name
  attr_reader :image_id
  attr_reader :flavor_id
  attr_reader :status
  attr_reader :progress
  attr_reader :host_id

  def initialize(id,name,image_id,flavor_id,status,progress,host_id)
    @id = id
    @name = name
    @image_id = image_id
    @flavor_id = flavor_id
    @status = status
    @progres = progress
    @host_id = host_id
  end

  def self.all
    server = CS.servers.map { |i|
      new(i[:id],i[:name],i[:imageId],i[:flavorId],i[:status],i[:progress],i[:hostId])
      # new(i)
    }
  end

  def self.find(param)
    all.detect { |l| l.id == param.to_i } || raise(ActiveRecord::RecordNotFound)
  end

  # def self.new
  #     server = CS.create_server(:name =&gt; ""BOOYA"", :imageId =&gt; 49, :flavorId =&gt; 2, :metadata =&gt; {'Luke' =&gt; 'Awesome'})
  #   end

end
</code></pre>

<p>FYI i am trying to build rails models for this api:
<a href=""https://github.com/rackspace/ruby-cloudservers"" rel=""nofollow"">https://github.com/rackspace/ruby-cloudservers</a></p>

<p>should I bother or just have the controllers access the CS Object directly</p>
","2011-05-18 22:14:59"
"12850480","refactor code to a loop","0","<p>Currently I have </p>

<pre><code>    &lt;b&gt;Step 1&lt;/b&gt;    
      &lt;%= @recipe_records.instruct_1 %&gt;
     &lt;/p&gt;   
    &lt;p&gt; 
    &lt;b&gt;Step 2&lt;/b&gt;       
      &lt;%= @recipe_records.instruct_2 %&gt;
      &lt;/p&gt;
    .....
    &lt;b&gt;Step 30&lt;/b&gt;      
      &lt;%= @recipe_records.instruct_30 %&gt;
      &lt;/p&gt;
</code></pre>

<p>How do I put it in a loop instead of listing all 30 steps and to not display empty steps?</p>

<pre><code>    &lt;% 30.times do |n|%&gt;
        &lt;% ri = @recipe_records.instruct_#{n+1}%&gt;
        &lt;%= if !ri.empty? %&gt;
            &lt;p&gt;
            &lt;%= ri %&gt;
        &lt;% end%&gt;
    &lt;% end %&gt;
</code></pre>

<p>Tried but unable to work.</p>
","2012-10-12 00:11:51"
"7302745","refactoring code in symfony","0","<pre><code>if (!$this-&gt;getUser()-&gt;isAuthenticated())
{
  $this-&gt;redirect('login/index');
}
</code></pre>

<p>i would like add this code for many actions in different modules. I must copy this code for each action? I would like make somethings:</p>

<pre><code>//module 

class Invite
public function executeIndex {
 sfConfig:get('redirect');
}


class Home
public function executeIndex {
 sfConfig:get('redirect');
}

public function executeShow {
  sfConfig:get('redirect');
}
</code></pre>

<p>if  can't be in different modules, although it might in a single?</p>
","2011-09-04 23:25:06"
"44247588","refactor code to upload multiple images swift 3","0","<p>I have some code I am writing in swift, I want to upload multiple images and was wondering if I can refactor the code I have to allow multiple images to be checked. </p>

<p>below is my code. I want to add 8 images to firebase at once.</p>

<pre><code>    guard let image1 = picture1.image else {
        print(""Tony: No image selected"")
        return
    }

    guard let image2 = picture2.image else {
        print(""Tony: No image selected"")
        return
    }       

    if let imageData = UIImageJPEGRepresentation(image1, 0.2) {

        let imageUid = NSUUID().uuidString
        let metadata = StorageMetadata()
        metadata.contentType = ""image/jpeg""
        DataService.ds.REF_POST_IMAGES.child(imageUid).putData(imageData, metadata: metadata, completion: { (metadata, error) in
            if error != nil {
                print(""Tony: Unable to upload image to Firebase storage"")
            }else {
                print(""Tony: Successfully uploaded image to Firebase storage"")
                let downloadURL = metadata?.downloadURL()?.absoluteString
            }
        })
        alertPlate()
    }
}
</code></pre>
","2017-05-29 17:15:16"
"21403084","refactoring large if else satement in java","0","<p>I'm trying to refactor some code so I don't have a large if / else if statement if possible. </p>

<p>Here is the code: </p>

<pre><code>if (Character.getNumericValue(num) == 0 ) {
        return bar0;
    }
    else if (Character.getNumericValue(num) == 1 ) {
        return bar1;
    }
    else if (Character.getNumericValue(num) == 2 ) {
        return bar2;
    }
    else if (Character.getNumericValue(num) == 3 ) {
        return bar3;
    }
    else if (Character.getNumericValue(num) == 4 ) {
        return bar4;
    }
    else if (Character.getNumericValue(num) == 5 ) {
        return bar5;
    }
    else if (Character.getNumericValue(num) == 6 ) {
        return bar6;
    }
    else if (Character.getNumericValue(num) == 7 ) {
        return bar7;
    }
    else if (Character.getNumericValue(num) == 8 ) {
        return bar8;
    }
    else if (Character.getNumericValue(num) == 9 ) {
        return bar9;
    }
    else {
        return bar10;
    }
</code></pre>

<p>Basically it checks if char num is equal to an int 0-9, then returns the associated numbers bar (which is of type string). Is there any way to make this better?</p>

<p>I would like it to be something like </p>

<pre><code>if (Character.getNumericaValue(num) == x {
   return barx;
}
else 
   return bar10;
</code></pre>

<p>if that makes sense. </p>
","2014-01-28 10:31:07"
"11950923","refactor data.frame column values","0","<p>Sorry guys if this is a noob question.
I need help on how to loop over my dataframe.Here is a sample data.</p>

<pre><code>a &lt;- c(10:29);
b &lt;- c(40:59);
e &lt;- rep(1,20);
test &lt;- data.frame(a,b,e)
</code></pre>

<p>I need to manipulate column ""e"" using the following criteria for values in column ""a""</p>

<p>for all values of</p>

<p>""a"" &lt;= 15, ""e"" = 1,</p>

<p>""a"" > 15 &amp; &lt; 20, ""e"" = 2</p>

<p>""a"" > 20 &amp; &lt; 25, ""e"" = 3</p>

<p>""a"" > 25 &amp; &lt; 30, ""e"" = 4 and so on to look like this</p>

<pre><code>result &lt;- cbind(a,b,rep(1:4, each=5))
</code></pre>

<p>My actual data frame is over 100k long. Would be great if you could sort me out here.</p>
","2012-08-14 11:02:14"
"30491453","refactoring object methods on javascript","0","<p>I have an object make = {};
I created object methods ( make.a(), make.h1() ) where each method creates a tag element</p>

<p>I created a JSFiddle of what I did:  <a href=""http://jsfiddle.net/cruzj/hpep8rfj/"" rel=""nofollow"">here</a></p>

<p>I want to create many tag elements like that.</p>

<p>Is there any way to avoid repeating </p>

<pre><code>    return document.createElement('tagName');
</code></pre>

<p>each time?</p>
","2015-05-27 19:27:53"
"25110150","refactoring my rails code (model method)","0","<p>So this works fine, it's just I need some refactoring done. What I want to achieve is, get all the values for the current record or just put another column (calculated column, like in SQL) that'll hold all the values for all of my fields that starts with ""address"".</p>

<p>So far, this is what I have.</p>

<p>Thanks for any input. Also, if possible, do not post the actual refactored code, but just let me know what I should be reading or just hints. I prefer achieving this on my own. Thanks again.</p>

<pre><code>  def address
    ""#{self[:address_street1]} #{self[:address_street2]} #{self[:address_city]} #{self[:address_state]} #{self[:address_zipcode]} #{self[:address_country]}""
  end
</code></pre>
","2014-08-03 23:50:40"
"1685282","refactor to use oop mvc","0","<p>how do I refactor this to use oop , with mvc pattern.</p>

<pre><code>(function () {
  var dataToImage = { 'a': 'a.gif', 'b': 'something.gif' };
  var currentimage = dataToImage['a'];
  function setCurrentImage(e){ currentImage = e.src; }
  function getMousePosition(){  }
  function drawToolbar {
    for(i in dataToImage){
      document.write('&lt;img src=""'+dataToImage[i]+'"" onclick=""setCurrentImage(this);""&gt;');
    }
    document.write('&lt;div onclick=""drawImage(this,getMousePosition())""&gt;&lt;/div&gt;');
    return;
  }
  function drawImage(div,xy) {
    var img = document.createElement('div');
    div.style[""left""] = xy[0];
    div.style[""top""] = xy[1];
    img.innerHTML='&lt;img src=""'+currentImage+'""&gt;');
    div.appendChild(img);
    return;  
  }
  drawToolbar();
}());
</code></pre>
","2009-11-06 03:43:32"
"39622825","refactoring too many parameter in java code","0","<p>I want to refactor the program below. It has too many parameter smell. How can I refactor it?</p>

<pre><code>package net.sourceforge.ganttproject.export;

import net.sourceforge.ganttproject.GanttExportSettings;
import net.sourceforge.ganttproject.task.TaskContainmentHierarchyFacade;
import net.sourceforge.ganttproject.resource.HumanResourceManager;
import java.io.File;

public class PDFExportData extends ProjectExportData {

    final String myStylesheet;

public PDFExportData(GanttExportSettings myExportSettings, File myOutputFile, String myProjectName, String myProjectDescription, String myOrganization, HumanResourceManager myResourceManager, TaskContainmentHierarchyFacade myTaskHierarchyFacade, GanttChartExportProcessor myGanttChartExportProcessor, ResourceChartExportProcessor myResourceChartExportProcessor, String stylesheet) {
        super(myExportSettings, myOutputFile, myProjectName, myProjectDescription, myOrganization, myResourceManager, myTaskHierarchyFacade, myGanttChartExportProcessor, myResourceChartExportProcessor);

        myStylesheet = stylesheet;
    }
}
</code></pre>
","2016-09-21 17:19:54"
"41867292","refactor a regular for loop into an enhanced for loop","0","<p>I have a <em>regular</em> <code>for</code> loop that helps me append a character by taking advantage of the index positioning provided by the common <code>for</code> loop.</p>

<p>I want to refactor the loop and turn it into a <code>for each</code> loop, but the disadvantage is the index positioning. I can't find a way to indicate where I want to append my char. Is it even possible to use the <code>for each</code> loop in this case?</p>

<p><strong>from:</strong></p>

<pre><code>for (int i = 0; i &lt; itinerary.size(); i++) {
    sb.append(itinerary.get(i).toUpperCase());
    if (i &lt; itinerary.size() -1) {
        sb.append("" to "");
    }
}
</code></pre>

<p><strong>to</strong></p>

<pre><code>for (String itineray : itinerary){
    sb.append(itineray.toUpperCase());
    if ( //size of the array - 1){
        sb.append("" to "");
    }
}
</code></pre>
","2017-01-26 05:14:08"
"687637","refactoring question","0","<p>Given a method </p>

<pre><code>    public static string[] Foo(System.IO.Stream stream)
    {
        XmlTextWriter xmlWriter = new XmlTextWriter(stream,   System.Text.Encoding.ASCII);

        xmlWriter.WriteStartDocument();
        xmlWriter.WriteStartElement(""Element"");
        xmlWriter.WriteEndElement();
        xmlWriter.WriteEndDocument();
        xmlWriter.Flush();

        return new string[3]{""1"", ""2"", ""3""};
    }
</code></pre>

<p>and a calling code</p>

<pre><code>using(MemoryStream memStream = new MemoryStream())
{
     string[] playerIDs = PlayerCommand.Foo(stream);
     // do some stuff with stream and playerIDs
}
</code></pre>

<p>When the control passes out of the using directive, is there a problem that xmlWriter was not explicitly closed in Foo (which would make the stream useless)?</p>

<p>Also, is passing a Stream between methods unsavory, is there a better way to pass the results of XMLWriting back to the calling code (which will zip it up and file it away)?</p>

<p>Thanks in advance,
Greg</p>
","2009-03-26 21:35:09"
"24021316","refactoring top-level transforms","0","<p>I have a stylesheet with a number of templates that match certain elements, including an identity template:</p>

<pre><code>&lt;xsl:stylesheet&gt;
    &lt;xsl:template match=""@*|node()""&gt;
        &lt;xsl:copy&gt;
            &lt;xsl:apply-templates select=""@*|node()"" /&gt;
        &lt;/xsl:copy&gt;
    &lt;/xsl:template&gt;
    &lt;xsl:template match=""someElement/*&gt;
    ...
    &lt;/xsl:template&gt;
    &lt;!-- a bunch of other matching templates --&gt;
&lt;/xsl:stylesheet&gt;
</code></pre>

<p>A new requirement has come up that if a certain element in the input document has a specific value, most of the transformation should simply be skipped.</p>

<p>Of course I <em>can't</em> simply do this:</p>

<pre><code>&lt;xsl:stylesheet&gt;
    &lt;xsl:choose&gt;
        &lt;xsl:when test=""/someElement/somethingElse &amp;lt; 0""&gt;
            &lt;xsl:template match=""@*|node()""&gt;
                &lt;xsl:copy&gt;
                    &lt;xsl:apply-templates select=""@*|node()"" /&gt;
                &lt;/xsl:copy&gt;
            &lt;/xsl:template&gt;

            &lt;xsl:template match=""someElement/*&gt;
            ...
            &lt;/xsl:template&gt;
            &lt;!-- a bunch of other matching templates --&gt;
        &lt;/xsl:when&gt;
        &lt;xsl:otherwise&gt;
            &lt;!-- do very simple transform --&gt;
        &lt;/xsl:otherwise&gt;
    &lt;xsl:choose&gt;
&lt;/xsl:stylesheet&gt;
</code></pre>

<p>because <code>template</code> is not allowed as a child of <code>when</code>. It looks like the only way to deal with this might be to rewrite all of the templates with actual names and parameters, but there are quite a few and I was wondering if there was an easier way.</p>
","2014-06-03 17:23:49"
"5863730","refactor accessing child controls in ASP.NET?","0","<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/4955769/better-way-to-find-control-in-asp-net"">Better way to find control in ASP.NET</a>  </p>
</blockquote>



<p>Hi,</p>

<p>Is there any way to refactor this:</p>

<pre><code>placeholder1.Controls[0].Controls[0].Controls[0].Controls[0].Controls[1].Controls[1].Controls[1].ClientID.ToString();
</code></pre>

<p>Thanks</p>
","2011-05-02 23:59:18"
"32711219","refactor angular javascript","0","<p>I have this bit of javascript in an angular controller which works fine. </p>

<pre><code>product.prod_custom_mb_qty = 0;
product.prod_custom_mb = null;
product.prod_custom_autoship = function (prod_name, prod_qty) {
  if (prod_name === ""mb"") {
    if (prod_qty === 0) {
      product.prod_custom_mb_qty = 0;
    } else {
      product.prod_custom_mb_qty += prod_qty;
    }
  }
  if (product.prod_custom_mb_qty &lt; 1){
    product.prod_custom_mb_qty = 0;
    product.prod_custom_mb = null;
  } else if (product.prod_custom_mb_qty === 1) {
    product.prod_custom_mb = product.prod_custom_mb_qty + "" Mango Bottle"";
  } else if (product.prod_custom_mb_qty &gt; 1) {
    product.prod_custom_mb = product.prod_custom_mb_qty + "" Mango Bottles"";
  }
  product.prod_custom_total = (product.prod_custom_mb_qty * 35);
}
</code></pre>

<p>The problem is I need to do it 8 more times for 8 different products and that would get a bit messy.
Is there a way I can refactor this so everything can be done more simply?</p>

<p>I thought I could do it by changing the names to the var to something like:</p>

<pre><code>product.prod_custom_qty[prod_name]
product.prod_custom[prod_name]
</code></pre>

<p>But I can't seem to get that to work? Am I on the right track?</p>
","2015-09-22 07:46:24"
"40916594","refactor python script to a method, for integration with larger process","0","<p>What I need to do is refactor a script, to turn it into a method that can be added to a larger process. </p>

<p><strong>STEP A</strong></p>

<p>The point is- there's a data processing task that I'm working on- the first step is to create data of the following form: </p>

<pre><code>3|Victoria|[51.503378, -0.139134]|2673
52|Cubitt Town|[51.505199, -0.018848]|23
5|United Kingdom|[54.75844, -2.69531]|459
6|London|[51.50853, -0.12574]|346
296|Bucharest|[44.43225, 26.10626]|9
352|Vilich-Müldorf|[50.75024, 7.15283]|4
48|Gut Scheibenhardt|[49.001249, 8.412378]|3
314|Westerham|[48.0601, 11.62219]|9
45|Honartsdeich|[53.557429, 9.987297]|34
9779|Martinsried|[48.137418, 11.555737]|11
343|Brussels|[50.85045, 4.34878]|27
563|Russell Square|[51.519403, -0.133906]|20
2|Germany|[51.5, 10.5]|20
11|Farringdon|[51.51807, -0.10852]|154
609|Fröttmaning|[48.16652, 11.59038]|3
</code></pre>

<p><strong>STEP B</strong></p>

<p>So then Step B will operate on the result of the above step (described by <strong>PROCESS</strong> below) and it will output data like so (the final data representation).</p>

<p>This means that <strong>PROCESS</strong> creates the data displayed in <strong>STEP A</strong>.</p>

<p><em>The final data representation looks like this:</em></p>

<pre><code>code: GB-ENG, jobs: 2673
code: GB-ENG, jobs: 23
code: GB-ENG, jobs: 459
code: GB-ENG, jobs: 346
code: RO-B, jobs: 9
code: DE-NW, jobs: 4
code: DE-BW, jobs: 3
code: DE-BY, jobs: 9
code: DE-HH, jobs: 34
code: DE-BY, jobs: 11
code: BE-BRU, jobs: 27
code: GB-ENG, jobs: 20
code: DE-TH, jobs: 20
code: GB-ENG, jobs: 154
code: DE-BY, jobs: 3
</code></pre>

<p>The script which performs that magic (creates the final output data displayed above) looks in this way: </p>

<pre><code>import json
import requests
from collections import defaultdict
from pprint import pprint

def hasNumbers(inputString):
    return any(char.isdigit() for char in inputString)

# open up the output of 'data-processing.py'
with open('job-numbers-by-location.txt') as data_file:

    # print the output to a file
    with open('phase_ii_output.txt', 'w') as output_file_:
        for line in data_file:
            identifier, name, coords, number_of_jobs = line.split(""|"")
            coords = coords[1:-1]
            lat, lng = coords.split("","")
            # print(""lat: "" + lat, ""lng: "" + lng)
            response = requests.get(""http://api.geonames.org/countrySubdivisionJSON?lat=""+lat+""&amp;lng=""+lng+""&amp;username=s.matthew.english"").json()


            codes = response.get('codes', [])
            for code in codes:
                if code.get('type') == 'ISO3166-2':
                    country_code = '{}-{}'.format(response.get('countryCode', 'UNKNOWN'), code.get('code', 'UNKNOWN'))
                    if not hasNumbers( country_code ):
                        # print(""code: "" + country_code + "", jobs: "" + number_of_jobs)
                        output_file_.write(""code: "" + country_code + "", jobs: "" + number_of_jobs)
    output_file_.close()
</code></pre>

<p>But what I need to do is make it into a method, so I can fuse it into this process: </p>

<p><strong>PROCESS</strong></p>

<pre><code>import json
from collections import defaultdict
from pprint import pprint


def process_locations_data(data):
    # processes the 'data' block
    locations = defaultdict(int)
    for item in data['data']:
        location = item['relationships']['location']['data']['id']
        locations[location] += 1
    return locations


def process_locations_included(data):
    # processes the 'included' block
    return_list = []
    for record in data['included']:
        id = record.get('id', None)
        name = record.get('attributes', {}).get('name', None)
        coord = record.get('attributes', {}).get('coord', None)
        return_list.append((id, name, coord))
    return return_list    # return list of tuples




# load the data from file once
with open('data-science.txt') as data_file:
    data = json.load(data_file)


# use the two functions on same data
locations = process_locations_data(data)
records = process_locations_included(data)


# output list to collect lines
output = []


# combine the data for printing
for record in records:
    id, name, coord = record
    references = locations[id]   # lookup the references in the dict
    line = str(id) + ""|"" + str(name) + ""|"" + str(coord) + ""|"" + str(references) + ""\n""
    if line not in output:
        output.append(line)


# print the output to a file
with open('job-numbers-by-location.txt', 'w') as file_:
    for l in output:
        if not (""None"") in l:
            if not (""[0, 0]"") in l:
                file_.write(l)
file_.close()
</code></pre>

<p>but the thing is- I keep failing in my efforts to make that script into a method within there. </p>

<p>How to refactorize that script into an independent method that could be included into the process? </p>

<p>All of the data related to this task can be found <a href=""https://github.com/s-matthew-english/literate-octo-robot"" rel=""nofollow noreferrer"">here on my GitHub page</a></p>
","2016-12-01 17:16:18"
"40077339","refactor capybara javascript dropzone test","0","<p>I'm trying to call a dropzone capybara test multiple times. However, when I call it a second time, the ID has already been used. I'm trying to randomize the ID so it can run multiple times.</p>

<pre><code>def drop_in_dropzone(file_path)
  page.execute_script &lt;&lt;-JS
    fakeFileInput = window.$('&lt;input/&gt;').attr(
      {id: 'fakeFileInput', type:'file'}
    ).appendTo('body');
  JS
  attach_file(""fakeFileInput"", file_path)
  page.execute_script(""var fileList = [fakeFileInput.get(0).files[0]]"")
  page.execute_script &lt;&lt;-JS
    var e = jQuery.Event('drop', { dataTransfer : { files : [fakeFileInput.get(0).files[0]] } });
    $('.dropzone')[0].dropzone.listeners[0].events.drop(e);
  JS
end
</code></pre>

<p>Error when calling it 2nd time.</p>

<pre><code>Failure/Error: attach_file(""fakeFileInput"", file_path)

Capybara::Ambiguous:
Ambiguous match, found 2 elements matching file field ""fakeFileInput""
</code></pre>
","2016-10-17 01:34:13"
"33037617","refactoring ""factories"" into a $resource","0","<p>Hi I have converted a previous function for editing records in an api into the following resource:</p>

<pre><code>app.factory(""Wine"", function($resource){
    return $resource(""http://greatwines.8000.com/wines:id"", {
        //id as a variable
        id: ""@id""
     },
     {
         update: {
             method: ""PUT""
         }
    });
});
</code></pre>

<p>I now want to use this by triggering a form with the ""wine"" records to edit with the following CTA inside the wine ng-repeat for each wine:</p>

<pre><code>   &lt;a href=""#/wines/{{wine.id}}"" class=""btn btn-default""&gt;Edit Wine&lt;/a&gt;
</code></pre>

<p>In my controller I pass the <em>""Wine""</em> resource:</p>

<pre><code>app.controller(""editWineCtrl"", function ($scope, $http, $routeParams, Wine, $location){


   Wine.get({ id: $routeParams.id }, function(wine){
        $scope.wine = wine;
   });
</code></pre>

<p>...</p>

<p>However, in spite of the form URL returning the ID:</p>

<p><code>http://greatwines.8000.com/#/wines/1323</code></p>

<p>None of the fields i.e. :</p>

<pre><code>div class=""margin-top-20""&gt;
                    &lt;input type=""text"" class=""form-control"" ng-model=""wine.year"" /&gt;
                &lt;/div&gt;
                &lt;div class=""bold margin-top-20""&gt;
                    Grapes
                &lt;/div&gt;
                &lt;div class=""margin-top-20""&gt;
                    &lt;input type=""text"" class=""form-control"" ng-model=""wine.grapes"" /&gt;
                &lt;/div&gt;
</code></pre>

<p>Are being populated. Am I using the resource int he correct way?</p>
","2015-10-09 11:53:52"
"3331140","refactoring similar code targeted at all view controllers's navigation bar","0","<p>I'm trying to find the best way to refactor this. Right now, each of the view controllers (about 20 of them) have a function that initializes the content of the toolbar / navigation bar like so ie,</p>

<p>-(void)toolbarInit </p>

<p>and on each of the controller's viewDidLoad, you will see that the function is being called ie, [self toolbarInit];</p>

<p>Basically what that toolbarInit does is to put a loginButton on the navigation bar's rightBarButtonItem.</p>

<p>Should I:</p>

<p>a. put the toolbar/nav bar setup in the app delegate ( is it possible to initialize each of the view controller's nav bar no matter how deep down the stack it is already?)</p>

<p>b. create a toolbarController or something and just put all the setup code/login code over there?</p>

<p>Many thanks for any other suggestions.</p>
","2010-07-25 21:42:59"
"20169236","refactor a ruby method","0","<p>I seem to be writing quite a few methods with the following pattern and it seems like there should be a better way.  Is there a one-liner for this or a better practice?</p>

<pre><code>def combine_roster(roster)
  rstr = []
  roster.each do |r|
    rstr &lt;&lt; r.user
  end
  rstr
end
</code></pre>
","2013-11-23 23:31:53"
"7788050","refactoring some legacy code - potential memory leaks","0","<p>Due to some memory leaks, some memory is not released except when doing IISreset.</p>

<p>I found some code where I have a class of properties and methods, where only 10% of the methods are specific for the class, 90% can be moved to  another class. </p>

<p>how bad is that? is this is affecting my memory, because I am initiating this class with every user using the application?</p>

<p>It is a ASP.NET Application on IIS6.</p>
","2011-10-16 23:21:15"
"41609016","refactor fat arrow nested rxjs stream","0","<p>I am playing with <a href=""http://reactivex.io/learnrx/"" rel=""nofollow noreferrer"">http://reactivex.io/learnrx/</a>.  In better effort to learn rxjs.  </p>

<p>The array that I am working through is below.  I am just trying to get the id's out of the array. </p>

<p>I am able to get the answer to work but feel that answer could be better written.</p>

<pre><code>var movieLists = [
        {
            name: ""New Releases"",
            videos: [
                {
                    ""id"": 70111470,
                    ""title"": ""Die Hard"",
                    ""boxart"": ""http://cdn-0.nflximg.com/images/2891/DieHard.jpg"",
                    ""uri"": ""http://api.netflix.com/catalog/titles/movies/70111470"",
                    ""rating"": 4.0,
                    ""bookmark"": []
                },
                {
                    ""id"": 654356453,
                    ""title"": ""Bad Boys"",
                    ""boxart"": ""http://cdn-0.nflximg.com/images/2891/BadBoys.jpg"",
                    ""uri"": ""http://api.netflix.com/catalog/titles/movies/70111470"",
                    ""rating"": 5.0,
                    ""bookmark"": [{ id: 432534, time: 65876586 }]
                }
            ]
        },
        {
            name: ""Dramas"",
            videos: [
                {
                    ""id"": 65432445,
                    ""title"": ""The Chamber"",
                    ""boxart"": ""http://cdn-0.nflximg.com/images/2891/TheChamber.jpg"",
                    ""uri"": ""http://api.netflix.com/catalog/titles/movies/70111470"",
                    ""rating"": 4.0,
                    ""bookmark"": []
                },
                {
                    ""id"": 675465,
                    ""title"": ""Fracture"",
                    ""boxart"": ""http://cdn-0.nflximg.com/images/2891/Fracture.jpg"",
                    ""uri"": ""http://api.netflix.com/catalog/titles/movies/70111470"",
                    ""rating"": 5.0,
                    ""bookmark"": [{ id: 432534, time: 65876586 }]
                }
            ]
        }
    ];
</code></pre>

<p>Here is the answer that I came up with</p>

<pre><code>          movieLists
                  .map( movieList =&gt; movieList.videos
                  .map(video =&gt; video.id)  )   // don't like this part
                  .concatAll()
</code></pre>

<p>I am basically nesting a map inside of another map then calling concat all.  </p>

<p>Is it possible to refactor that second map fat arrow so it can sit outside of the first?</p>

<pre><code>.map()
.map()
</code></pre>
","2017-01-12 09:08:55"
"20552844","refactoring array looped around another arrary for assignment","0","<p>I know this is more of PHP problem because of it's loose Typing of arrays but I see this problem all over the place in a project I took over and not sure of the best way to refactor it. Suppose you have two sets of data, both multi dimensional arrays, $results_by_entity and $target_limits and we want to check what the target is foreach result_by_entity so we can set some state</p>

<pre><code>foreach ($results_by_entity AS $result_by_entity) {
  foreach ($target_limits AS $target_limit) {
      if ($target_limit['activity_id'] == $result_by_entity['activity_id']) {
          $result_by_entity-&gt;target = $target_limit-&gt;quantity;
          $result_by_entity-&gt;progress = $target_limit-&gt;score;
      }
 }
</code></pre>

<p>}</p>

<p>There are a couple of main problems here</p>

<p>1-The data is really strongly tied together, so it is really hard to refactor $results_by_entity into it's own class and $target_limits into it's own class
2-The time taken to process this grows exponentially as the data size grows</p>

<p>I read the Refactoring book by Martin Fowler and it was really helpful but this style of problem doesn't really show up I think mostly because his examples are in JAVA which is strongly typed. The class is super run on so really hard to debug and extend but all the data is so tied together primarily because of these types of loops so not to sure how to solve. Any recommendations would be really appreciated</p>
","2013-12-12 19:48:43"
"15507783","refactoring code for better recursion","0","<p>I am trying to write some code that will look into a pdf file and call the Process method (to find a qr code image in the pdf) if not found then it rotates the file and runs the Process method again. Currently I don't think that what I have actually checks the file after being rotated but checks the same original file in its original format. How can I pass in the rotated image properly into the Process method: </p>

<pre><code>  using (var fullImg = new Bitmap(workGif))
                {
                    var bandImg = fullImg.Clone(new System.Drawing.Rectangle(0, 0, 375, 375), fullImg.PixelFormat);

                    Bitmap result = fullImg;
                    if (Process(bandImg) == null)
                    {
                          fullImg.RotateFlip(RotateFlipType.Rotate270FlipNone);
                          bandImg = fullImg.Clone(new System.Drawing.Rectangle(0, 0, 375, 375), fullImg.PixelFormat);
                        if (Process(bandImg) == null)
                        {
                             fullImg.RotateFlip(RotateFlipType.Rotate90FlipNone);
                             bandImg = fullImg.Clone(new System.Drawing.Rectangle(0, 0, 375, 375), fullImg.PixelFormat);
                            if (Process(bandImg) == null)
                            {
                                fullImg.RotateFlip(RotateFlipType.Rotate180FlipNone);
                                bandImg = fullImg.Clone(new System.Drawing.Rectangle(0, 0, 375, 375), fullImg.PixelFormat);
                                //Process(bandImg);
                                string QRinfo = Process(bandImg);
                                MessageBox.Show(QRinfo);
                                string[] qcode = QRinfo.Split('/');
                                string gid = qcode[qcode.Count() - 1];
                                Guid pgGuid = new Guid(gid);
                                var ar = dc.Assessments.FirstOrDefault(c =&gt; c.ID == pgGuid);
                                if (ar != null)
                                {
                                    var p = inputDocument.Pages[pg];
                                    string opdName = FILESTORELOCATION + pgGuid.ToString() + "".pdf"";
                                    PdfDocument opd = new PdfDocument(opdName);
                                    opd.Pages.Add(p);
                                    opd.Close();

                                    ar.StoragePath = opdName;
                                    ar.LastUploadedDT = DateTime.UtcNow;
                                    ar.UploadedByUserID = uploadingUser;
                                    dc.SubmitChanges();
                                }
                            }
                        }
                    }    
</code></pre>

<p><strong>Process Method:</strong></p>

<pre><code>public string Process(Bitmap bitmap)
{
    var reader = new com.google.zxing.qrcode.QRCodeReader();

    try
    {
        LuminanceSource source = new RGBLuminanceSource(bitmap, bitmap.Width, bitmap.Height);
        var binarizer = new HybridBinarizer(source);
        var binBitmap = new BinaryBitmap(binarizer);
        return reader.decode(binBitmap).Text;
    }
    catch (Exception e)
    {
        return null;
    }
}
</code></pre>
","2013-03-19 18:36:44"
"15534746","refactoring an expensive query in rails","0","<p>I been all day trying to refactor my queries. It was taking several minutes for a table with 20 records to load. At first, I blamed the query in this stackoverflow post:</p>

<p><a href=""https://stackoverflow.com/questions/15442194/rails-using-rails-cache-gives-error"">rails - using Rails.cache gives error</a></p>

<p>However, after doing some testing, I realized that query was loading very fast, and was not the culprit.</p>

<p>Then I blamed it on kaminari, as I thought that kaminari was populating thousands of records into ruby objects, as I explained in this post:</p>

<p><a href=""https://stackoverflow.com/questions/15528861/rails-and-kaminari"">rails and kaminari</a></p>

<p>But that was wrong too. Kaminari was only loading 20 records at a time (I used the logger to check how many reports where being loaded and it showed 20).</p>

<p>So finally I think I found the real culprit. It is another query that occurs during the pagination of that page. I realized that this query is taking more than 20 seconds to load each time it is run:</p>

<pre><code>def virtual_fence_duration
    inside_fence_time = nil
    outside_fence_time = nil

    outside_fence_time = self.time

    previous_reports = Report.where{(time    &lt;  my{self.time}) &amp;
                                   (unit_id == my{self.unit_id})}.order('time desc')

    previous_reports.each do |report|
      alerts = report.alerts.collect { |a| a.code_name }
      if alerts.include? ""Inside virtual fence""
        inside_fence_time = report.time
        break
      end
    end

    if inside_fence_time &amp;&amp; outside_fence_time
      ""Virtual Fence Elapsed Time: #{(((outside_fence_time - inside_fence_time).to_i).to_f/60.0).ceil} minutes"" 
    else
      """"
    end    
  end
</code></pre>

<p>Basically, this method gets called when there is an alert that is  ""outside virtual fence"". I store the time. And then I query all the reports previous to it (reports has_many alerts). Then I use the each iterator of ruby to go through every single report and then the alerts associated with those reports to find the alert that is ""inside virtual fence"". Then I store the time of that report and take the difference between the two times. This logic seems to be taking forever if there are  alot of reports between the two durations. Is there a more efficient way to do this in sql (mysql) or ruby?</p>
","2013-03-20 21:08:19"
"26888774","refactor the rspec tests","0","<p>I have written a unit tests as below.</p>

<pre><code>describe Youtube::Metadata do
  let(:subject) { SampleMetadata.from_text(open(url)) }
  context ""when url is passed"" do
    let(:url) { ""http://www.sample.com"" }

    describe ""It should return all values from the site"" do
      its(:id) { should eql ""234"" }
      its(:url) { should eql ""www.sample.com"" }
    end

    context ""Given a html file with id property"" do
      let(:html) { File.join(PAGES, 'youtube', 'sample1.html') }
      let(:subject) { Youtube::Metadata.from_text(File.read(html)) }

      it ""should return unique value from id property"" do
        subject.unique_id.should eql ""65155c6e-ba11-42fc-bb91-53520176d2a8""
      end
    end

    context ""Given a html file with rel:canonical property"" do
      let(:html) { File.join(PAGES, 'youtube', 'sample2.html') }
      let(:subject) { Youtube::Metadata.from_text(File.read(html)) }

      it ""should return unique value from rel=canonical content property"" do
        subject.unique_id.should eql ""65155c6e-ba11-42fc-bb91-53520176d2a8""
      end
    end
  end
end
</code></pre>

<p>I need to refactor it so that I dont have to repeat the below statement in each and every tests cases.</p>

<pre><code>let(:subject)   { Youtube::Metadata.from_text(File.read(html))
</code></pre>

<p>I tried it with before block but it didn't work.  </p>

<blockquote>
  <p>Actually the first context we pass url and the second set of context
  we pass filename. Also I am not sure whether I need to make it as a
  single context (which is passing file name contexts, ie. last two) and describe it.</p>
</blockquote>

<p>What would be the right way to do it??</p>
","2014-11-12 14:00:09"
"25268847","refactoring code with conditional return","0","<p>I have this code on my project in the begining of multiple functions.</p>

<pre><code>try: 
    user = get_user(user_id) 
except LockedException: 
    logger.warn('op=healthcheck, msg=""user is locked""') 
    return HttpResponseServerError(jsonMessage('user=%(user)s is locked' % {'user': user_id})) 
except UserFreeException: 
    logger.warn('op=user, msg=""user is free""') 
    return HttpResponseNotFound(jsonMessage('user is free user=%(user)s' % {'user': user_id})) 
except User.DoesNotExist: 
    logger.warn('op=healthcheck, msg=""user doesn\'t exist""') 
    return HttpResponseNotFound(jsonMessage('invalid user=%(user)s' % {'user': user_id})) 
except Exception, e: 
    logger.error('op=healthcheck, msg=""unknown error"", msg=""%(exception)s""', 
                 {'exception': e.message}) 
    return HttpResponseServerError(jsonMessage(e.message)) 
</code></pre>

<p>Any hints on how can I refactor it so I don't need to reuse it everywhere?
The best I could come would be to create a function that throws a single exception in case of a problem, and this exception contains a ""http_response"" field, so I'd do something like:</p>

<pre><code>try:
    user = get_user(user_id)
except MyGenericException, e:
    return e.http_response
</code></pre>

<p>Any other ideas?</p>
","2014-08-12 15:55:25"
"42349192","refactoring namespace in RESTFul WCF causes error at runtime","0","<p>I create a ""WCF Service Application"" project.</p>

<p>I make the interface, then class, a [DataMember] decorated object, and Global.asax.cs Global class in the same namespace, <code>parentns.mynamespage</code>.</p>

<p>I run this in VStudio IIS Express and everything is great.</p>

<p>.</p>

<p>Then I realize I want to refactor the namespace to <code>parentns.subnamespace</code>.
That is the only change alone in Imyclass.cs (the object also exists in this file), myClass.cs, and Global.asax.cs recompile and F5-run again in VStudio Imyclass</p>

<p>Now I get:</p>

<blockquote>
  <p>""the remote server returned an error: (500) Internal Server Error""</p>
</blockquote>

<p>Nothing is reported of interest in the Output window except a very generic </p>

<blockquote>
  <p>""Exception thrown: 'System.Net.WebException' in System.dll""</p>
</blockquote>

<p>If I Ctrl-Z everything and rerun everything works again.</p>

<p>What else am I needing to refactor?</p>

<p>How do you troubleshoot this?</p>

<p>Thanks for you help</p>
","2017-02-20 16:04:47"
"17159257","refactoring callback inside model","0","<p>I am pretty new to rails and I am trying to create a callback that will apply user information before a record is saved. </p>

<p>Here is the callback:</p>

<pre><code>def add_resolution_name
  if self.res_desc_changed?
      self.res_provided_name = current_user.first_name
    elsif self.res_desc_changed? &amp;&amp; self.res_approved?
      self.res_provided_name = current_user.first_name
      self.res_approved_name = current_user.first_name
    elsif self.res_approved_changed? &amp;&amp; self.res_approved?
      self.res_approved_name = current_user.first_name
    elsif self.res_approved_changed? &amp;&amp; !self.res_approved?
      self.res_approved_name = nil
  end
  save
  logger.info ""pocessed resolution information... #{current_user.first_name}""
end
</code></pre>

<p>As you can see it's pretty ugly and I don't have access to the current_user inside the ticket model. Should I put this into a presenter or service? Any tips appreciated.</p>
","2013-06-18 01:21:38"
"43616810","refactor d3 v3 pie to version 4 unexpected behavior","0","<p>sample code update:</p>

<pre><code>var updateChart = function(dataset) {
arcs = arcs.data(donut(dataset), d =&gt; d.data.label);

arcs.exit().remove();

 arcs.enter().append(""path"")
.attr(""stroke"", ""white"")
.attr(""stroke-width"", 0.8)
.attr(""fill"", function(d, i) {
  return color(i);
}).attr(""d"", arc);
arcs.transition()
.duration(duration)
.attrTween(""d"", arcTween);
sliceLabel = sliceLabel.data(donut(dataset), d =&gt; d.data.label);
sliceLabel.exit().remove();
sliceLabel.enter()
.append(""text"")
.attr(""class"", ""arcLabel"")
.attr(""transform"", function(d) {
  return ""translate("" + (arc.centroid(d)) + "")"";
})
.attr(""text-anchor"", ""middle"")
.style(""fill-opacity"", function(d) {
  if (d.value === 0) {
    return 1e-6;
  } else {
    return 1;
  }
})
.text(function(d) {
  return d.data.label;
});
 sliceLabel.transition()
.duration(duration)
.attr(""transform"", function(d) {
  return ""translate("" + (arc.centroid(d)) + "")"";
})
.style(""fill-opacity"", function(d) {
  if (d.value === 0) {
    return 1e-6;
  } else {
    return 1;
  }
});
</code></pre>

<p>I have a pie that I refactored to version 4 and I got it to run without errors but it no longer deletes segments. Other than changes I had to make to get it to run the pie is exactly the same as the version 3 one. </p>

<p><a href=""https://jsfiddle.net/jwaldner/tm2zqbq7/"" rel=""nofollow noreferrer"">version 4 pie</a></p>

<p>For reference, here is a working one in version three:
<a href=""https://jsfiddle.net/jwaldner/0L5tkbww/"" rel=""nofollow noreferrer"">version 3</a></p>
","2017-04-25 16:59:37"
"22236651","refactoring similar functions with access to variables","0","<p>I have a simple index page that allows you to click a button to change the colors displayed randomly on the background circle divs. The code I've written is working fine, but its really repetitive; I wrote a function for each button, and the functions look identical except for the variables they access.</p>

<p>I'm trying to refactor this into a single function but can't figure out a way to allow the button that is click to access the correct variable to change the background colors. 
For example here is the function for the first button, which accesses the colorList variable that changes the colors to gray spectrum:</p>

<pre><code>var colorList1 = [//array of 20 colors]
var colorList2 = [//array of 20 colors]
var colorList3 = [//array of 20 colors]
var colorList4 = [//array of 20 colors]

// .choice-1 is the div class for the first button
$("".choice-1"").on(""click"", function() {
    blankSlate();
    colorList = colorList1;
    $(""[id^='nav']"").css(""background-color"", colorList[1]);
    $(""#colorChoice"").css(""background-color"", colorList[1]);
});
</code></pre>

<p>I tried to write something that would access the number in the class name and assign that to a variable that would be accessible to the main function doing something like this:</p>

<pre><code>var buttonVar = $(""button"").attr[0].nodeValue; // get full name of nodeValue
var btnChoice = buttonVar[buttonVar.length-1]; // access number at end of class name
$(""button"").on(""click"",function() {
    $('.choice' + btnChoice).on('click', function(){*/
    blankSlate();
    colorList = colorList + btnChoice;
    $(""[id^='nav']"").css(""background-color"", colorList[btnChoice]);
    $(""#colorChoice"").css(""background-color"", colorList[btnChoice]);
  });
</code></pre>

<p>...but I'm not sure that this is the right way to go about it, and I'd love some advice about how this type of refactoring is typically handled. </p>

<p>Here's a link to a Codepen showing how it works, and with all the html, css and remaining JS viewable. 
<a href=""http://codepen.io/a6ftcruton/full/Beizu"" rel=""nofollow"">http://codepen.io/a6ftcruton/full/Beizu</a></p>
","2014-03-06 21:41:44"
"34523093","refactor SQL select statement","0","<p>I have a bunch of <code>select</code> statements</p>

<pre><code>select A, B, C, D into #temp_table from TableA where C&gt;1 and C&lt;10 order by A
select distinct A into #temp_two from #temp_table where B like '%term' 
select E.B from #temp_table E, #temp_two F where F.A = E.A
</code></pre>

<p>Can the above be combined into one select statement through a series of joins etc without using temp tables? I don't like the idea of using temp tables.</p>

<p>Don't have to show me the exact answer, but just some hints will do. </p>

<p>thanks</p>
","2015-12-30 04:53:03"
"22691648","refactoring code that contains ""button addTarget""","0","<p>I have a lot of places of a code that changes a view in UINavigationBar.<br>
So the code is something like this:</p>

<pre><code>UIButton *butt2=[UIButton buttonWithType:UIButtonTypeCustom ];

[butt2 setFrame:CGRectMake(285, 7, 30, 25)];
[butt2 setTag:2];
[butt2 setImage:[UIImage imageNamed:@""tag_icon.png""] forState:UIControlStateNormal];
[butt2 addTarget:self action:@selector(revealMenu:) forControlEvents:UIControlEventTouchDown];
[self.navigationController.navigationBar addSubview:butt2] ;
</code></pre>

<p>I want to create a method that gets argument of the different things in the code which is:<br>
1. the image (easy)<br>
2. The action of the button - <strong>AHA! This one I couldn't figure out how to do</strong></p>
","2014-03-27 15:07:09"
"46757911","refactor - remove CRPT","0","<p>I have custom List class like this:</p>

<pre><code>template&lt;class T&gt;
struct iList{
    constexpr bool empty() const{
        return static_cast&lt;const T *&gt;(this)-&gt;size() == 0;
    }

    // several methods like empty(), some are non const.
};

// there are several classes like this one with different implementations
struct MyList : iList&lt;MyList&gt;{
    constexpr unsigned size() const{
        return 5;
    }
};

int main(){
    constexpr MyList list;
    static_assert( ! list.empty() );
}
</code></pre>

<p>code is <code>constexpr</code> and simplified so I can use <code>static_assert</code>.</p>

<p>I want to get rid of CRTP pattern, because templates become way too ugly. However I do not want to use virtual functions.</p>

<p>One way I am thinking is following:</p>

<pre><code>struct iList2{
protected:
    template&lt;class LIST&gt;
    constexpr static bool empty_(const LIST &amp;list){
        return list.size() == 0;
    }
};

struct MyList2 : iList2{
    constexpr unsigned size() const{
        return 5;
    }

    constexpr bool empty() const{
        return empty_(*this);
    }
};

int main(){
    constexpr MyList2 list2;
    static_assert( ! list2.empty() );
}
</code></pre>

<p>In this case I need to call <code>empty_</code> static member function in each list.</p>

<p>Another way is to use mixin, e.g. to inherit <code>MyList</code> and add empty() method. If I do this as templated class, I can even make typedef. However I do not like this approach as well.</p>

<p>Is there any possibility I am missing?</p>
","2017-10-15 17:27:46"
"34371397","refactoring Java to get string length","0","<p>I am starting out with Java and trying to find a neat way of refactoring the below code so that I can set the <code>firstName</code> variable as a string and in the same line get and set the <code>firstNameLength</code> string length as an integer.</p>

<pre><code>String firstName = ""Boris"";
int firstNameLength = firstName.length();
</code></pre>

<p>I have been trying variations of the below code but to no avail!</p>

<pre><code>int newAge = String firstName = ""Boris"".length();
</code></pre>
","2015-12-19 13:37:15"
"16230424","refactoring anonymous function javascript","0","<p>I am working on knockout bindings.. I have knockout sorting to implement and i have done this way..</p>

<pre><code>function notesViewModel() {
    _this.colName = ""CreatedDate"";
    _this.sortOrder = ""desc"";
    _this.notes = ko.observableArray();

   _this.SortItems = function (colname) {
        var newNotes = _this.notes();
        if (_this.sortOrder === ""desc"") {
            this.notes(newNotes.sort(notesViewModel._getSortFunction = function (a, b) {
                return a[colname] &lt; b[colname] ? -1 : 1;
            }));
            switchSortOrder();
        } else {
            this.notes(newNotes.sort(notesViewModel._getSortFunction = function (a, b) {
                return a[colname] &gt; b[colname] ? -1 : 1;
            }));
            switchSortOrder();
        }
    };
    function switchSortOrder() {
        if (_this.sortOrder === ""asc"") {
            _this.sortOrder = ""desc"";
        } else {
            _this.sortOrder = ""asc"";
        }
    }
 ko.applyBindings(_this, $(""body"").get(0));
return _this;
}
</code></pre>

<p>and my html code is like this:</p>

<pre><code>&lt;table id=""notes"" class=""notes_table""&gt;
        &lt;tr class=""head""&gt;
        &lt;th data-bind='click: function() { SortItems(""CreatedDate"")}'&gt;
        &lt;span&gt;Date&lt;/span&gt;
        &lt;/th&gt;
        &lt;th data-bind='click: function() { SortItems(""Type"")}'&gt;
        &lt;span&gt;Type&lt;/span&gt;
        &lt;/th&gt;
        &lt;th data-bind='click: function() { SortItems(""Category"")}'&gt;
        &lt;span&gt;Category&lt;/span&gt;
        &lt;/th&gt;
        &lt;th data-bind='click: function() {SortItems(""AddedBy"")}'&gt;
        &lt;span&gt;Added by&lt;/span&gt;
        &lt;/th&gt;
        &lt;th&gt;
        &lt;span&gt;Alerts&lt;/span&gt;
        &lt;/th&gt;
        &lt;th&gt;&lt;/th&gt;
        &lt;/tr&gt;
        &lt;tbody data-bind=""template: { name: 'StudentNote', foreach: notes }""&gt;&lt;/tbody&gt;
    &lt;/table&gt;
</code></pre>

<p>I want to refactor the sort function to something like this..</p>

<p>_</p>

<pre><code>this.SortItems = function (colname) {
        var newNotes = _this.notes();
        this.notes(newNotes.sort(notesViewModel._getSortFunction = compareFunction (a, b,_this.sortOrder)));

  function comparerFunction(a,b,sortOrder)
 {
     if(sortOrder === ""desc"")
    {

     return a[colname] &lt; b[colname] ? -1 : 1;
     _this.sortOrder = ""asc"";

    }
    else
    {
     return a[colname] &gt; b[colname] ? -1 : 1;
     _this.sortOrder = ""desc"";
    }
 }

};
</code></pre>

<p>But it didnt work out as, it was saying that the a and b parameters are not available.. can anyone please tell me how to separe the logic from the anonymous function</p>
","2013-04-26 06:55:02"
"44919189","refactor to dynamic switch case","0","<p>I have two independent switch cases as below for converting folder and subfolder code to name. How to make the subfolder dependent on folder and to make the code as flexible as possible for extending folderCode and subfolderCode, better still the level of folder hierarchy?</p>

<pre><code>switch (folderCode)
{
    case ""A"":
        folderName = folderNameA;
        break;
    case ""B"":
        folderName = folderNameB;
        break;
    case ""C"":
        folderName=folderNameC;
        break;
    default:
        Console.WriteLine(""The folder code is incorrect"");
        break;
}

switch (subfolderCode)
{
    case ""1"":
        subfolderName = subfolderName1;
        break;
    case ""2"":
        subfolderName = subfolderName2;
        break;
    case ""3"":
        subfolderName = subfolderName3;
        break;
    default:
        Console.WriteLine(""The subfolder code is incorrect"");
        break;
}
</code></pre>
","2017-07-05 07:06:24"
"34220421","refactor angular ng-resource error handling","0","<p>Warning: coffeescript ahead.</p>

<p>I have multiple controllers with various ngresource functions like so:</p>

<pre><code>app.controller 'usersCtrl', ($scope, $state, $filter, $flash, $api) -&gt;

$scope.saveUser = -&gt;
    $scope.spinner = true
    $api.User.save($scope.user).$promise.then ((response) -&gt;
       ....
    ), (error)
       $scope.spinner = false
       if error.code = 400
          $flash.create('warning', error.message)
       else if error.code = 500
          $flash.create('danger', error.message)

$scope.updateFoo = -&gt;
    $scope.spinner = true
    $api.Foo.update(foo: $scope.foo).$promise.then ((response) -&gt;
       ....
    ), (error) -&gt;
       $scope.spinner = false
       if error.code = 400
          $flash.create('warning', error.message)
       else if error.code = 500
          $flash.create('danger', error.message)
</code></pre>

<p>Given that I'm using virtually the same error handling code across dozens of functions, how do I refactor the code so I can reuse across multiple functions.</p>
","2015-12-11 09:45:50"
"47185442","refactoring deprecated webClient to httpclient in VB.net","0","<p>I have this old console VB.net Processer job I want to convert webClient to httpclient. can someone help me?</p>

<pre><code>       PostAccountsOrder.Add(""PostAccountsOrder"", solomonOrder)

        Dim urlToPost As String = """"
        Dim webClient As New WebClient()
        Dim resByte As Byte()
        Dim resString As String
        Dim reqString() As Byte
        webClient.Headers(""content-type"") = ""application/json""

        Dim str = JsonConvert.SerializeObject(PostAccountsOrder, formatting:=Formatting.Indented)
        reqString =  Encoding.Default.GetBytes(str)
        resByte = webClient.UploadData(urlToPost, ""post"", reqString)

        resString = Encoding.Default.GetString(resByte)
        Console.WriteLine(resString)
        webClient.Dispose()
</code></pre>
","2017-11-08 16:56:40"
"27387799","refactor large switch-statement","0","<p>Any suggestions for refactoring this ugly case-switch into something more elegant?</p>

<p>This method (in Ruby) returns a (short or full) description for Belgian provinces, given a zipcode.</p>

<pre><code>def province(zipcode, short = false)
  case zipcode
  when 1000...1300
    short ? 'BXL' : 'Brussel'
  when 1300...1500
    short ? 'WBR' : 'Waals-Brabant'
  when 1500...2000, 3000...3500
    short ? 'VBR' : 'Vlaams-Brabant'
  when 2000...3000
    short ? 'ANT' : 'Antwerpen'
  when 3500...4000
    short ? 'LIM' : 'Limburg'
  when 4000...5000
    short ? 'LIE' : 'Luik'
  when 5000...6000
    short ? 'NAM' : 'Namen'
  when 6000...6600, 7000...8000
    short ? 'HAI' : 'Henegouwen'
  when 6600...7000
    short ? 'LUX' : 'Luxemburg'
  when 8000...9000
    short ? 'WVL' : 'West-Vlaanderen'
  when 9000..9999
    short ? 'OVL' : 'Oost-Vlaanderen'
  else
    fail ArgumentError, 'Not a valid zipcode'
  end
end
</code></pre>

<p>Based on suggestions from MiiinimalLogic i made a second version. It this preferable?</p>

<pre><code>class Provincie
  ProvincieNaam = Struct.new(:kort, :lang)

  PROVINCIES = {
    1000...1300 =&gt; ProvincieNaam.new('BXL', 'Brussel'),
    1300...1500 =&gt; ProvincieNaam.new('WBR', 'Waals-Brabant'),
    1500...2000 =&gt; ProvincieNaam.new('VBR', 'Vlaams-Brabant'),
    2000...3000 =&gt; ProvincieNaam.new('ANT', 'Antwerpen'),
    3000...3500 =&gt; ProvincieNaam.new('VBR', 'Vlaams-Brabant'),
    3500...4000 =&gt; ProvincieNaam.new('LIM', 'Limburg'),
    4000...5000 =&gt; ProvincieNaam.new('LIE', 'Luik'),
    5000...6000 =&gt; ProvincieNaam.new('NAM', 'Namen'),
    6000...6600 =&gt; ProvincieNaam.new('HAI', 'Henegouwen'),
    6600...7000 =&gt; ProvincieNaam.new('LUX', 'Luxemburg'),
    7000...8000 =&gt; ProvincieNaam.new('HAI', 'Henegouwen'),
    8000...9000 =&gt; ProvincieNaam.new('WVL', 'West-Vlaanderen'),
    9000..9999  =&gt; ProvincieNaam.new('OVL', 'Oost-Vlaanderen')
  }.freeze

  def self.lang(postcode)
    provincie_naam(postcode).lang
  end

  def self.kort(postcode)
    provincie_naam(postcode).kort
  end

  def self.provincie_naam(postcode)
    PROVINCIES.each { |list, prov| return prov if list.cover?(postcode) }
    fail ArgumentError, 'Geen geldige postcode'
  end

  private_class_method :provincie_naam
end
</code></pre>
","2014-12-09 20:04:26"
"21540479","refactor javascript to an external file","0","<p>I am beginner in ASP .Net and JQuery. So forgive me for asking this silly question. I have an <code>Index.cshtml</code> file as follows. I am using Highcharts' example code to make a gauge. My problem is: the code  between <code>&lt;script&gt;&lt;/script&gt;</code> are long and messy, how can I make it more compact? 
I have tried to move it to an external file, <code>myscript.js</code>, inside the Scripts folder and include a line <code>&lt;script src=""Scripts/myscript.js""&gt;&lt;/script&gt;</code> in <code>Index.cshtml</code> but it give me error saying $ is undefined, which I suspect may be due to the external myscript.js loading before the DOM is finished in the browser. I have tried putting the code in the _layout.cshtml but that is not pretty either. Thank you for your help.</p>

<pre><code>@model IEnumerable&lt;WebApplication16.Models.BatteryLog&gt;

@{
    ViewBag.Title = ""Index"";
}
@{
    Layout = ""~/Views/Shared/_Layout.cshtml"";
}
&lt;script&gt;$(function () {

    $('#gauge').highcharts({

        chart: {
            type: 'gauge',
            plotBackgroundColor: null,
            plotBackgroundImage: null,
            plotBorderWidth: 0,
            plotShadow: false
        },

        title: {
            text: 'Current'
        },

        pane: {
            startAngle: -150,
            endAngle: 150,
            background: [{
                backgroundColor: {
                    linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                    stops: [
                        [0, '#FFF'],
                        [1, '#333']
                    ]
                },
                borderWidth: 0,
                outerRadius: '109%'
            }, {
                backgroundColor: {
                    linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                    stops: [
                        [0, '#333'],
                        [1, '#FFF']
                    ]
                },
                borderWidth: 1,
                outerRadius: '107%'
            }, {
                // default background
            }, {
                backgroundColor: '#DDD',
                borderWidth: 0,
                outerRadius: '105%',
                innerRadius: '103%'
            }]
        },

        // the value axis
        yAxis: {
            min: 0,
            max: 200,

            minorTickInterval: 'auto',
            minorTickWidth: 1,
            minorTickLength: 10,
            minorTickPosition: 'inside',
            minorTickColor: '#666',

            tickPixelInterval: 30,
            tickWidth: 2,
            tickPosition: 'inside',
            tickLength: 10,
            tickColor: '#666',
            labels: {
                step: 2,
                rotation: 'auto'
            },
            title: {
                text: 'Volt'
            },
            plotBands: [{
                from: 0,
                to: 120,
                color: '#55BF3B' // green
            }, {
                from: 120,
                to: 160,
                color: '#DDDF0D' // yellow
            }, {
                from: 160,
                to: 200,
                color: '#DF5353' // red
            }]
        },

        series: [{
            name: 'Current',
            data: [80],
            tooltip: {
                valueSuffix: ' Volt'
            }
        }]

    },
    // Add some life
    function (chart) {
        if (!chart.renderer.forExport) {
            setInterval(function () {
                var point = chart.series[0].points[0],
                    newVal,
                    inc = Math.round((Math.random() - 0.5) * 20);

                newVal = point.y + inc;
                if (newVal &lt; 0 || newVal &gt; 200) {
                    newVal = point.y - inc;
                }

                point.update(newVal);

            }, 3000);
        }
    });
});&lt;/script&gt;

&lt;h2&gt;Index&lt;/h2&gt;
&lt;div id=""gauge"" style=""min-width: 310px; max-width: 400px; height: 300px; margin: 0 auto""&gt;&lt;/div&gt;
</code></pre>
","2014-02-04 00:08:09"
"46458343","refactored geb login spec to module resulting in ""not initialized"" error","0","<p>I am new to writing geb specs for funcational testing and appreciate your help with this issue. I am also new to Groovy, and the ""Not Initialized"" error might be to do with basic inexperience in that. I am trying to build a module to log me in automatically, at which point I can proceed with further tests, but I receive a <code>geb.error.ModuleInstanceNotInitializedException</code>. Previously, not using a module, I was able to log in to my page using only a spec. I was refactoring this to a module approach based on the answer on rcgeorge23's response here:
<a href=""https://stackoverflow.com/questions/23532633/how-to-refactor-common-geb-test-sequences"">How to refactor common Geb test sequences</a>.</p>

<p>The spec:</p>

<pre><code>import spock.lang.Unroll

class FlowSpecs extends GebReportingSpec {

    @Unroll
    def ""setup Spec""() {
        given:
            to QUserPage
        when:    
            authModule.signIn(""mwalle"",""password"")
        then:
            assert { $(""span"", ""class"":""login-text z-label"")[3].text() == ""mwalle"" }
    }
</code></pre>

<p>the page:</p>

<pre><code>package pages.app

import geb.Page
import AuthModule

class QUserPage extends Page {

    static url = ""/qsystem/quser""
    static at = { title == ""QSystem"" }

    static content = {
        authModule { module AuthModule }
    }
}
</code></pre>

<p>and the module:</p>

<pre><code>import geb.Module 

class AuthModule extends Module {

    def idUser = js.""zk.Widget.\$('\$usr').uuid"" + ""-real""
    def idPass = js.""zk.Widget.\$('\$pwd').uuid""

    static content = {
        loginUser { $(""input"", id:idUser) }
        loginPass { $(""input"", id:idPass) }
        loginButton { $(""button"",class:""login-button z-button"")[0] }
    }

    void signIn(String username = ""mwalle"", String password = ""password"") {
        loginUser.value(user)
        loginPass.value(pass)
        loginButton.click()
    }
}
</code></pre>

<p>The full error is:</p>

<pre><code>geb.error.ModuleInstanceNotInitializedException: Instance of module class AuthModule has not been initialized. Please pass it to Navigable.module() or Navigator.module() before using it.
    at geb.Module.uninitializedException(Module.groovy:757)
    at geb.Module.getJs(Module.groovy:96)
    at AuthModule.&lt;init&gt;(AuthModule.groovy:5)
    at geb.navigator.AbstractNavigator.module(AbstractNavigator.groovy:356)
    at geb.content.NavigableSupport.module(NavigableSupport.groovy:207)
    at geb.content.PageContentTemplateFactoryDelegate.module(PageContentTemplateFactoryDelegate.groovy:31)
    at pages.app.QUserPage._clinit__closure2$_closure3(QUserPage.groovy:12)
    at pages.app.QUserPage._clinit__closure2$_closure3(QUserPage.groovy)
    at geb.content.PageContentTemplate.invokeFactory(PageContentTemplate.groovy:97)
    at geb.content.PageContentTemplate.create_closure1(PageContentTemplate.groovy:59)
    at geb.content.PageContentTemplate.create_closure1(PageContentTemplate.groovy)
    at geb.content.PageContentTemplate.create(PageContentTemplate.groovy:82)
    at geb.content.PageContentTemplate.get(PageContentTemplate.groovy:54)
    at geb.content.DefaultPageContentSupport.getContent(DefaultPageContentSupport.groovy:42)
    at geb.content.PageContentSupport.propertyMissing(PageContentSupport.groovy:39)
    at geb.Page.propertyMissing(Page.groovy:112)
    at geb.Browser.propertyMissing(Browser.groovy:216)
    at geb.spock.GebSpec.propertyMissing(GebSpec.groovy:60)
    at FlowSpecs.setup Spec(FlowSpecs.groovy:23)
</code></pre>
","2017-09-27 22:46:53"
"40017689","refactor lambda to be called by another class: while keeping caller's code to be still short","0","<p>How to professionally refactor lambda function to be called by another class WHILE make caller's code still short?</p>

<p>My attempt shows that for changing a lambda function to a normal function, I have to capture variables manually, thus the new normal function requires more parameters (to compensate automatic capture ability).  </p>

<p>As a result, the new function is more tedious to use, and can cause more bug.</p>

<h2>Example</h2>

<p>Here is my original code, using lambda.</p>

<pre><code>void Turret::registerFullversion(int gameObjectId, PhysicObject* phyO){//utility
    //.... something a bit complex .......
}
void Turret::createTurret(int typeOfTurret){
    int gameObjectId=createNewGameObjectId();
    auto registerEasy=[&amp;]( PhysicObject* phyO){
        //^ served as a short hand version of ""registerFullversion""
        //  1 parameter is more comfortable than 2
        registerFullversion(gameObjectId,phyO);
    }
    switch(typeOfTurret){
        case 1:{ //this part will be moved into another class (###)
            PhysicObject* phy=PhysicSystem::createNewPhysicObject();
            registerEasy( phy);
            //^ equivalent to ""registerFullversion(gameObjectId,phy)""
            //  but it is very concise (1 parameter), nice!
        };break;
        //..... a lot of case ....
    }
    //... do something about ""gameObjectId""
}
</code></pre>

<p>I want to move a part of function (###) from <code>Turret</code> into another class (<code>TurretLaser</code>).     </p>

<p>It works, but the result is that caller have to capture <code>gameObjectId</code> and pass it manually :-</p>

<pre><code>void Turret::createTurret(int typeOfTurret){
    int gameObjectId=createNewGameObjectId();
    switch(typeOfTurret){
        case 1:{ //this part have to be move into another class
            TurretLaser::createTurret(gameObjectId)
        };break;
        //..... a lot of case ....
    }
}
void TurretLaser::createTurret(int gameObjectId){ //(###)
    PhysicObject* phy=PhysicSystem::createNewPhysicObject();
    Turret:registerFullversion(gameObjectId,phy);
    //^ it is not as short as before  (now = 2 parameters)
}
</code></pre>

<h2><strong>Note</strong></h2>

<ul>
<li>In real case, all above functions are non-static function, and all functions are far more complex.</li>
<li>Performance is the first priority.  Thus, <code>std::bind</code> and <code>std::function</code> are not allowed.</li>
<li>This question asks about how to omit the captured parameters rather than ""Please fix my code"", so a valid solution can also just provide a new example with its own fix instead of showing modification of my code.</li>
</ul>

<h2>My attempt</h2>

<p>I will manually capture the related data (<code>gameObjectId</code>) and cache it (using a new variable <code>CACHE_gameObjectId</code>):-</p>

<pre><code>void Turret::registerEasy(PhysicObject* physicO){
    registerFullversion(CACHE_gameObjectId,physicO);
    //int ""CACHE_gameObjectId"" is a new field of ""Turret""
};
void Turret::createTurret(int typeOfTurret){
    int gameObjectId=createNewGameObjectId();
    Turret::CACHE_gameObjectId=gameObjectId;
    switch(typeOfTurret){
        case 1:{ //this part have to be move into another class
            TurretLaser::createTurret(gameObjectId)
        };break;
        //..... a lot of case ....
    }
}
void TurretLaser::createTurret(int gameObjectId){ //(###)
    PhysicObject* phy=PhysicSystem::createNewPhysicObject();
    Turret:registerEasy(phy);
    //^ short as before, nice
}
</code></pre>

<p><strong>Disadvantage of my solution:</strong> dirty, look dangerous (not so automatic, thus can cause more bug) , seem to be less thread-safe (?)</p>
","2016-10-13 09:49:50"
"30675168","refactoring ruby: want to pass attribute name into a method","0","<p>I have a DataPoint model where I have three methods that do the same thing, just on different fields in the data_points database.</p>

<pre><code>def self.currently_employed(data_points)
    data_points.where(currently_employed: true).count / data_points.count.to_f * 100
end

def self.undergrad_degree(data_points)
    data_points.where(undergrad_degree: true).count / data_points.count.to_f * 100
end

def self.grad_degree(data_points)
    data_points.where(grad_degree: true).count / data_points.count.to_f * 100
end
</code></pre>

<p>I think I should be able to refactor this to accept which column to perform the calculation on as a parameter, but much time on the internet / trying stuff out hasn't yielded results.</p>

<p>Could someone please advise me on whether / how I could refactor this to a single method?  </p>

<p>In case it affects the answer: the data_points argument is a subset of DataPoint.all specified by the User - i.e. User types in what age, years work experience, etc. they want to see results for (age &amp; years_work_experience are DataPoint attributes), and then I want to show summary stats for that subset.</p>

<p>Thanks!</p>
","2015-06-05 20:20:02"
"27279292","refactor method name in eclipse from linked project","0","<p>I have 6 java projects in my Eclipse IDE (juno). One of them is a dummy project which is not meant to be compiled or deployed, it simple holds common logic for the other projects. The other projects use this common project. I edited the classpath of the other projects to include the common source folder as a linked source.</p>

<p>This works fine, but I'm having troubles when I refactor a class or method name in the common project. The refactoring is not propagated to the non-common classes in the other projects that makes use of the refactored class or method, resulting in compile errors that a certain class or method is not found.</p>

<p>The only way I can deal with this is either: </p>

<ol>
<li>Don't change the name of anything</li>
<li>Manually change the name in all projects after refactoring</li>
</ol>

<p>This kind of defeats the purpose of having the common source if a simple edit is not propagated. Is there any way of dealing with this?</p>
","2014-12-03 18:44:20"
"13422664","refactor jquery code to one line of code","0","<p>I have this jquery code:</p>

<pre><code>$('#csv_button').attr('disabled', 'disabled').addClass(""disabled"");
$('#excel_button').attr('disabled', 'disabled').addClass(""disabled"");
$('#delete_button').attr('disabled', 'disabled').addClass(""disabled"");
</code></pre>

<p>Is it possible simplify this code to one line of code?</p>
","2012-11-16 18:53:57"
"12227441","refactor JDBC function","0","<p>I am trying to create a simple web app that saves user data from a form to a database and reads the content of the database back to browser upon request. Following are the functions I have written so far.</p>

<pre><code>connectToDB()            // connects to database
addEmployee()            // adds employee to database
displayEmployee()        // returns a resultSet 
isExisted(int staffID)   // checks if the staff already exists
</code></pre>

<p>Database connection function:</p>

<pre><code>public void connectToDB(){
   try{
       // load Apache derby driver
       Class.forName(""org.apache.derby.jdbc.EmbeddedDriver"");
   } catch(ClassNotFoundException e) {
       System.err.println(e);
   }

   try{
       connection = DriverManager.getConnection(DBNAME, USERNAME, PASSWORD);
   } catch(SQLException e){
       System.err.println(e);
   }
} // end connectToDB
</code></pre>

<p>Display Employee function:</p>

<pre><code>public ResultSet displayEmployee(){
   connectToDB(); 
   ResultSet result = null;

   try{
       Statement stmt = connection.createStatement();
       String query = ""SELECT * FROM APP.ADDRESSBOOK"";
       result = stmt.executeQuery(query);

   } catch(SQLException e) {
       System.err.println(e);
   }

   return result;

}
</code></pre>

<p>Check if employee exists:</p>

<pre><code>public boolean isExisted(int StaffID){
   connectToDB();
   try{
       Statement stmt = connection.createStatement();
       String query = ""SELECT StaffNum FROM APP.ADDRESSBOOK WHERE StaffNum = "" + staff_number;
       ResultSet result = stmt.executeQuery(query);

       while(result.next()){
           int temp = result.getInt(1);
           if(temp == staff_number){return true;}
       }
   } catch(SQLException e) {
       System.err.println(e);
   }
   return false;
}
</code></pre>

<p>As you can see, if you compare the <code>displayEmployee()</code> and <code>isExisted()</code>, I am repeating mysel. Both the function works but I am looking to refactor the code. In those function I havent closed the connection. If there were 20 functions in the web app that connects to the database my code would stink.</p>

<p>I am looking something like this:
<strong><em>*</em></strong> THIS CODE DOESNT WORK <strong><em>*</em>**<em>*</em>**</strong></p>

<pre><code>private Statement queryDB(query){
   connectToDB(); 

   Statement stmt;
    try{
       stmt = connection.createStatement();

   } catch(SQLException e) {
       System.err.println(e);
   }
   return stmt;

   // code for closing connection
}

public ResultSet DisplayEmployee(){
   String query = ""SELECT * FROM APP.ADDRESSBOOK"";
   Statement stmt = queryDB(query);
   ResultSet result = stmt.executeQuery(query);
   return result;
}
</code></pre>

<p>Thanks.</p>
","2012-09-01 11:46:48"
"9108990","refactoring 2 similar if statement in ruby","0","<p>I am quite new in Ruby so would like to know and learn how to DRY. I have 2 if statement that's very similar, is there anyway to refactor it? </p>

<pre><code>msg1,msg2 = msg.split('.')

if !msg1.nil?
   items = msg1.split(',')
   items.each do |item|
     item.strip!
   end
   somefunction(items)
end

if !msg2.nil?
   items = msg2.split(',')
   items.each do |item|
     item.strip!
   end
   somefunction(items)
end 
</code></pre>
","2012-02-02 08:10:57"
"2904451","refactoring my code. My headers (Header Guard Issues)","0","<p>I had a post similar to this awhile ago based on a error I was getting. I was able to fix it but since then I been having trouble doing things because headers keep blocking other headers from using code. Honestly, these headers are confusing me and if anyone has any resources that will address these types of issues, that will be helpful. </p>

<p>What I essentially want to do is be able to have rModel.h be included inside RenderEngine.h. every time I add rModel.h to RenderEngine.h, rModel.h is no longer able to use RenderEngine.h. (rModel.h has a #include of RenderEngine.h as well).</p>

<p>So in a nutshell, RenderEngine and rModel need to use each others functionalities. On top of all this confusion, the Main.cpp needs to use RenderEngine. </p>

<p>stdafx.h</p>

<pre><code>#include ""targetver.h""

#define WIN32_LEAN_AND_MEAN             // Exclude rarely-used stuff from Windows headers
// Windows Header Files:
#include &lt;windows.h&gt;

// C RunTime Header Files
#include &lt;stdlib.h&gt;
#include &lt;malloc.h&gt;
#include &lt;memory.h&gt;
#include &lt;tchar.h&gt;
#include ""resource.h""
</code></pre>

<p>main.cpp</p>

<pre><code>#include ""stdafx.h""
#include ""RenderEngine.h""
#include ""rModel.h""

// Global Variables:

RenderEngine go;

rModel *g_pModel;

...code...........
</code></pre>

<p>rModel.h</p>

<pre><code>#ifndef _MODEL_H
#define _MODEL_H
#include ""stdafx.h""
#include &lt;vector&gt;
#include &lt;string&gt;
#include ""rTri.h""
#include ""RenderEngine.h""

........Code
</code></pre>

<p>RenderEngine.h</p>

<pre><code>#pragma once
#include ""stdafx.h""
#include ""d3d10.h""
#include ""d3dx10.h""
#include ""dinput.h""
#include ""rModel.h""

.......Code......
</code></pre>
","2010-05-25 12:19:25"
"10158234","refactoring javascript event handlers - is this a reasonable thing to do?","0","<p>I have inherited a relatively big javascript app (~3k lines of code) and just do parttime javascript. I want to put all the jQuery event handlers into a more sane organization. I was thinking something like this:</p>

<p>before:</p>

<pre><code>$('#click-here').click(function(){
  //a bunch of dom manipulations and with 30 of them makes the app fairly convoluted
});
</code></pre>

<p>after:</p>

<pre><code>function result_click(){
  var global_id=$(this).data('global-id');
  alert('here are the results of clicking: ' + global_id);
}

$(document).ready(function(){
  $('#click-here').on('click',result_click);
});
&lt;/script&gt;
&lt;div id='click-here' data-global-id='23'&gt;click HERE!&lt;/div&gt;
</code></pre>

<p>This would be a fairly easy refactoring and would seem to structure it better. The event handling part seems to be the most out of control. Is this a reasonable way to do this? It would seem fairly easy to make this into a backbone.js app once it gets to this point.</p>

<p>thx</p>
","2012-04-14 23:30:34"
"34119077","refactor javascript to limit repetition in form calculations","0","<p>Building a <a href=""http://brinsterinc.com/ovn/lbskilos.html"" rel=""nofollow"">form</a> where values can be entered in either pounds or kilos.</p>

<p>Script is...</p>

<pre><code>    function onlyNumber(fld) {
         if(fld.value.match(/[^0-9.]/)) {
         fld.value=fld.value.replace(/[^0-9.]/g,'');
         }
    }
    function convertUnit(sense, value) {
        retValue = 0;
        if (isNaN (value)) { alert ('Non-numeric value');  return 0; }
        value = parseFloat (value);
        var factor = 0.4536;
        if (sense == 'kg2lb') {
             retValue = value/factor;
             retValue = Math.round(retValue);
        }
        else if (sense == 'lb2kg') {
             retValue = value*factor;
             retValue = Math.round(retValue);
        }
        return retValue;
    }
</code></pre>

<p>Works fine but I have to repeat this on every input:</p>

<pre><code>onblur=""this.form.kg_va.value=convertUnit('lb2kg',this.value);"" onkeyup=""onlyNumber(this);"" onfocus=""if(this.value == '0') { this.value = ''; }"" 
</code></pre>

<p>Is there some way to simplify the onblur code ? </p>

<p>For example, is there a way to have the function focus on the same var pairs? The var pair being lb_FOOBAR and kg_FOOBAR.</p>

<p>And what about the input functions that are exactly the same?</p>

<pre><code>onkeyup=""onlyNumber(this);"" onfocus=""if(this.value == '0') { this.value = ''; }""
</code></pre>

<p>Any way to avoid having to repeat them for each input? Form will have 12 fields.</p>

<p>Thanks folks... trying to learn how to write gooder code!</p>
","2015-12-06 15:25:35"
"25973785","refactor method with two foreach loops","0","<p>I run into refactoring problem. I have many similar methods, but i cannot find way to extract one line form them and make another private method.</p>

<pre><code>private function constructRules($rules, \Languages $langs) {
    foreach ($rules as $fieldType =&gt; $rule) {
        foreach ($langs-&gt;all() as $lang) {
           //line below changes
            $langRules[$fieldType . '[' . $lang-&gt;lang . ']'] = $rule; 
        }       
    }

    return $langRules;
}
</code></pre>

<p>I have these foreach loops in 4 different places. If i extact foreach loops and return array, I still need to make one foreach loop in method, to fill $langRules in this example. Maybe there are simple way to do it, but I am not able to see it...</p>
","2014-09-22 12:08:52"
"10929201","refactoring a field into a property","0","<p>I am currently learning vb.net for my new job and I have mixed feelings over public fields. I see many arguments about them hurting the encapsulation. In python, the common practice is to keep things simple and use fields when they are enough. If we want to add logic later, we just refactor them into a property without breaking anything for the client code.</p>

<p>In the codebase I am working with I see huge classes containing dozen of properties like:</p>

<pre><code>Private __GetDescriptionMode As Boolean
&lt;DefaultValue(False)&gt; _
 Public Property GetDescriptionMode() As Boolean
    Get
        GetDescriptionMode = __GetDescriptionMode
    End Get
    Set(ByVal Value As Boolean)
        __GetDescriptionMode = Value
    End Set
End Property
</code></pre>

<p>That's 10 lines of code with little value inside. I can barely see 3 of them in my visual studio window. So I have 2 questions:</p>

<ul>
<li>Is there a valid reason not to simply define fields and refactor them into properties when needed?</li>
<li>Are OOP principle so important to sacrifice so much readability? (I can look at fewer things, I have to parse the property to make sure they are'nt doing anything special, etc)</li>
</ul>

<p><strong>EDIT</strong>
To clarify my first question: Do I have a chance of breaking client code if I change a field into a trivial property?</p>
","2012-06-07 09:32:43"
"4089011","refactoring and using a counter?","0","<p>I have the following structure:</p>

<pre><code>$text_1 = $this-&gt;getValue('value_1');
$text_2 = $this-&gt;getValue('value_2');
$text_3 = $this-&gt;getValue('value_3')
</code></pre>

<p>And also the following:</p>

<pre><code>    foreach($text_1 as $t_1)
    {
        if(!$first)
        {
            $string_1 .= "","";

        }
        $first = false;
        $string_1 .= $t_1;
    }

    foreach($text_2 as $t_2)
    {
        if(!$first)
        {
            $string_2 .= "","";

        }
        $first = false;
        $string_2 .= $t_2;
    }

    foreach($text_3 as $t_3)
    {
        if(!$first)
        {
            $string_3 .= "","";

        }
        $first = false;
        $string_3 .= $t_3;
    }
</code></pre>

<p>I was wondering if this could be re-factored to use a counter, like in a for loop, to replace the _1, _2, _3 etc from my code?</p>
","2010-11-03 16:03:09"
"12449370","refactoring from controller to model","0","<p>I have this action in my Order Controller:</p>

<pre><code># POST /orders
# POST /orders.json
def create
  @order = Order.new(params[:order])

  #spostare il ciclo cart &gt; line_items come metodo del modello Order
  cart = session[:cart]

  cart.each do | id, quantity |
    item = Project.find_by_id(id)
    @line_item = LineItem.new
    @line_item.project = item
    @line_item.quantity = quantity
    @line_item.price = item.price
    @order.line_items &lt;&lt; @line_item
  end

  @order.user = current_user

  session.delete(:cart)

  respond_to do |format|
    if @order.save
      #Send an email to admin
      UserMailer.order_created_to_admin(@order).deliver

      format.html { redirect_to :dashboard, notice: ""L'ordine è stato creato correttamente."" }
      format.json { render json: @order, status: :created, location: @order }
    else
      format.html { render action: ""new"" }
      format.json { render json: @order.errors, status: :unprocessable_entity }
    end
  end
end
</code></pre>

<p>now I want to refactor it a bit, and I'm thinking moving the following lines to Order Model as a method:</p>

<pre><code>  cart.each do | id, quantity |
    item = Project.find_by_id(id)
    @line_item = LineItem.new
    @line_item.project = item
    @line_item.quantity = quantity
    @line_item.price = item.price
    @order.line_items &lt;&lt; @line_item
  end
</code></pre>

<p>like that:</p>

<pre><code>class Order &lt; ActiveRecord::Base
  attr_accessible :user_id

  belongs_to :user
  has_many :line_items, :dependent =&gt; :destroy
  accepts_nested_attributes_for :line_items, :allow_destroy =&gt; true

  def add_line_items_to_order_from_cart(cart) do
    cart.each do | id, quantity |
      item = Project.find_by_id(id)
      @line_item = LineItem.new
      @line_item.project = item
      @line_item.quantity = quantity
      @line_item.price = item.price
      line_items &lt;&lt; @line_item
    end
  end
end
</code></pre>

<p>and calling it from controller like:</p>

<pre><code>order.add_line_items_to_order_from_cart(cart)
</code></pre>

<p>Does it make sense or not in terms of ""skinny controller / fat models"" pattern?</p>

<p>thank you</p>

<p>EDIT</p>

<p>My Order model now:</p>

<pre><code>class Order &lt; ActiveRecord::Base
  attr_accessible :user_id

  belongs_to :user
  has_many :line_items, :dependent =&gt; :destroy
  accepts_nested_attributes_for :line_items, :allow_destroy =&gt; true
  validates :user, :presence =&gt; :true

  def add_line_items_to_order_from_cart(cart)
    cart.each do | id, quantity |
      item = Project.find(id)
      line_items &lt;&lt; LineItem.new(project: item,
                                 quantity: quantity,
                                 price: item.price)
    end
  end

end
</code></pre>
","2012-09-16 18:10:37"
"18966616","refactoring variables access automatically","0","<p>I have changed access to a class variables from being public to private,</p>

<p>then created getters &amp; setters (100 variables)</p>

<p>sometime later, after that is completed,</p>

<p>how can I automate, accessing any of these variables directly to set/get without going through every single one of these 100 variable. sometime a variable is accessed almost everywhere throughout a big project, so it is a bit tough to do by hand.</p>

<p>I am using Eclipse IDE, c++ project</p>
","2013-09-23 18:48:49"
"9571257","refactoring to an attached property","0","<p>I am trying to change the code below from being an event setter to an attached property (just so I can clean up the code behind). I get an error in the setter saying the value cannot be null, but I don't see why yet.</p>

<p>Forgetting for a second whether this is a good idea or not, can someone help me get the attached property right?</p>

<p>Cheers,<br>
Berryl</p>

<h1>EventSetter (works but with code behind as shown)</h1>

<pre><code>    &lt;!-- SINGLE CLICK EDITING --&gt;
    &lt;Style TargetType=""{x:Type DataGridCell}""&gt;
        &lt;EventSetter Event=""PreviewMouseLeftButtonDown"" Handler=""OnPreviewMouseLeftButtonDown""/&gt;
    &lt;/Style&gt;

private void OnPreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
{
    var cell = sender as DataGridCell;
    cell.Activate();
}
</code></pre>

<h1>Property setter (error)</h1>

<pre><code>&lt;!-- SINGLE CLICK EDITING --&gt;
&lt;Style TargetType=""{x:Type DataGridCell}""&gt;
    &lt;Setter Property=""begavior:DataGridCellProperties.SingleClickToEdit"" Value=""True""/&gt;
&lt;/Style&gt;

public class DataGridCellProperties
{
    public static readonly DependencyProperty SingleClickToEditProperty =
        DependencyProperty.RegisterAttached(""SingleClickToEditProperty"",
                                            typeof(bool), typeof(DataGridCellProperties),
                                            new PropertyMetadata(false, OnSingleClickToEditPropertyChanged));

    [AttachedPropertyBrowsableForChildren(IncludeDescendants = false)]
    [AttachedPropertyBrowsableForType(typeof(DataGridCell))]
    public static bool GetSingleClickToEdit(DataGridCell obj) { return (bool)obj.GetValue(SingleClickToEditProperty); }

    public static void SetSingleClickToEdit(DataGridCell obj, bool value) { obj.SetValue(SingleClickToEditProperty, value); }

    private static void OnSingleClickToEditPropertyChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)
    {
        var sender = obj as UIElement;
        if (sender == null) return;

        if ((bool)e.NewValue)
        {
            sender.PreviewMouseLeftButtonDown += OnPreviewMouseLeftButtonDown_EditCell;
        }
        else
        {
            sender.PreviewMouseLeftButtonDown -= OnPreviewMouseLeftButtonDown_EditCell;
        }
    }

    private static void OnPreviewMouseLeftButtonDown_EditCell(object sender, MouseButtonEventArgs e)
    {
        var cell = sender as DataGridCell;
        cell.Activate();
    }
}
</code></pre>
","2012-03-05 17:38:16"
"35312510","refactor model method multiple mount_uploader for carrierwave","0","<p>I have Rails (4) app and I'm using carrierwave to upload an image to an S3 bucket in production (and local in dev). It's all working, but I wanted to refactor my code.</p>

<p><strong>My model:</strong></p>

<pre><code>class Blogging &lt; ActiveRecord::Base

mount_uploader :picture1, Picture1Uploader  
mount_uploader :picture2, Picture1Uploader  
mount_uploader :picture3, Picture1Uploader    
mount_uploader :picture4, Picture1Uploader  
mount_uploader :picture5, Picture1Uploader  
mount_uploader :picture6, Picture1Uploader  
mount_uploader :picture7, Picture1Uploader  
mount_uploader :picture8, Picture1Uploader  
mount_uploader :picture9, Picture1Uploader  
mount_uploader :picture10, Picture1Uploader  
mount_uploader :picture11, Picture1Uploader  
validate :picture_size  


private
  def picture_size
    if picture1.size &gt; 5.megabytes
        errors.add(:picture1, ""should be less than 5 MB"")
    end
  end


end
</code></pre>

<p><strong>After some refactoring, I have this:</strong></p>

<pre><code>class Blogging &lt; ActiveRecord::Base


for i in 1..11 
 mount_uploader :""picture#{i}"", Picture1Uploader
end


validate :picture_size
validates :picture1, :news_title, :news_body, presence: true 



private

 def picture_size
    pics = Array.new(11) {|i| ""picture#{i+1}""} 
        pics.each do |p|
        if p.size &gt; 5.megabytes
        errors.add(:picture1, ""should be less than 5 MB"")
        end
     end
 end
end
</code></pre>

<p>The <code>mount_uploader</code>, while ugly work fine. But I can't find a way to make <code>picture_size</code> limit the size of each picture (from 1 to 11). </p>

<ul>
<li><p>I can make it work using 11 times a different method or with a case operator. But i am trying to refactor.  </p></li>
<li><p>I'd love to put my ""for"" loop in a method and call it but can't figure out how. if i define a method and call it all the image vanish and no file get uploaded (locally or on the S3 bucket)</p></li>
</ul>
","2016-02-10 10:23:09"
"23349464","refactoring tests that use assert_raises","0","<p>I have a test block:</p>

<pre><code>describe 'without' do

  describe 'author' do
    let(:author)  {nil}
    it('fails')   {assert_raises(ArgumentError) { excerpt }}
  end

  describe 'title' do
    # same content as above, but testing title
  end

  describe 'content' do
    # same content as above, but testing content
  end

end
</code></pre>

<p>This works fine and the tests pass - but since there's a lot of repetition here, I wanted to refactor:</p>

<pre><code>describe 'without' do

  describe 'author' do
    let(:author)  {nil}
    it('fails')   {assert_failure(excerpt} # added a method in this line
  end

  describe 'title' do
    # same content as above, but testing title
  end

  describe 'content' do
    # same content as above, but testing content
  end

  # and the method here
  def assert_failure(instance)
    assert_raises(ArgumentError) { instance }
  end

end
</code></pre>

<p>However this doesn't work - my tests fail with the following error:</p>

<pre><code>construction::without::author#test_0001_fails:
ArgumentError: Excerpt cannot be built: Author missing
</code></pre>

<p>Which is the error that I would expect to be raised with missing information - and is exactly what I'm testing.  So it seems that when this assertion is extracted, the <code>ArgumentError</code> is being raised and stopping the test before <code>assert_raises</code> can make any kind of comparison.  I looked into the <a href=""http://apidock.com/ruby/MiniTest/Assertions/assert_raises"" rel=""nofollow"">code</a> for this assertion, but I can't make out why this would happen when the code is extracted into another method, but not when it's in-line.  </p>
","2014-04-28 19:19:48"
"10880567","refactor transaction handling code in php","0","<p>I am using php 5.3.3 and developing a MVC webapp using codeigniter. The code I am trying to refactor is basically bunch of:</p>

<pre><code>$this-&gt;db-&gt;trans_start();
    // do some db updates
    $this-&gt;db-&gt;update(...);
    $this-&gt;db-&gt;update(...);
$this-&gt;db-&gt;trans_complete();

if ( $this-&gt;db-&gt;trans_status() == FALSE ) {
    $this-&gt;handle_db_error();
}
</code></pre>

<p>so I have a few of the above code scatter around in my model classes. I would like to refactor the transaction handling part out of the models and stay DRY. </p>

<p>I thought I could using closure like the following:</p>

<pre><code>// in parent CI_Model class 
class MY_Model extends CI_Model {
  public function txn_wrap($closure) {
    $this-&gt;db-&gt;trans_start();
    $closure();
    $this-&gt;db-&gt;trans_complete();
    if ( $this-&gt;db-&gt;trans_status() == FALSE ) {
        $this-&gt;handle_db_error();
    }
  }

// in child model class

 class Blog_model extends MY_Model {
   protected $_table = 'app_blog';

   public function get($id) {
     $instance = $this;
     $closure = function() use($instance, $id) { 
        // do some db updates
        $instance-&gt;db-&gt;update($instance-&gt;_table, array('title' =&gt; 'bla'), array('id' =&gt; $id));
     };
     $this-&gt;txn_wrap($closure);
   }
</code></pre>

<p>That doesn't work and gives me <code>""PHP Fatal error:  Using $this when not in object context""</code>. So I guess using of $this usage is not supported in 5.3.</p>

<p>Now failing of using closure, What else can I do?</p>

<p><strong>UPDATE:</strong>  now I am getting <code>Undefined property: App_Blog::$_table</code> where App_About is the controller which calls the get() function in Blog_model. I have tried <code>function() use($instance, , $instance-&gt;_table, $id)</code> but php complains about the syntax.. Now this closure thing doesn't appears give me as much benefits as I thought..</p>

<p>thanks!</p>
","2012-06-04 11:35:46"
"4909140","refactoring sql in php","0","<p>What is a good place to put sql commands so they do not appear in the main code, how can this be done? How can sql commands such as the following be refactorised:</p>

<pre><code>function select_Query($sql, $link)
{
    $query = mysqli_query($link, $sql);

    if (!$query)
    {
        echo ""Failure""; #   TODO: LOG THIS
    }

    $data = array();
    while ($row = mysqli_fetch_array($query) )
    {
        $data[] = $row;
    }    

    return $data;
}


$query = select_Query(""SELECT thread.title, thread.id as t_id,
                         thread.content
                         FROM thread
                         LIMIT $start, 30"", $link);
</code></pre>

<p>How would you factorise the $query var part to generalise it for other sql statements - as that is fairly simple sql, however when several joins are used sql commands take up several lines in my code, I don't want to mix them with my php code.</p>
","2011-02-05 19:29:39"
"12643912","refactoring a view (and inherited variables)","0","<p>I have this code view that is very hard to read and needs some refactoring:</p>

<pre><code>  &lt;div class=""tab-content""&gt;
    &lt;% @posts.each_with_index do |post,pi| %&gt;
      &lt;div class=""tab-pane fade &lt;%= 'active in' if pi == 0 %&gt;"" id=""&lt;%= ""post_""+ pi.to_s %&gt;""&gt;
        &lt;h2&gt;&lt;%= post.title %&gt;&lt;/h2&gt;
        &lt;ul class=""thumbnails""&gt;
          &lt;% post.assets.each_with_index do |asset, i| %&gt;
            &lt;%= link_to (image_tag (asset.photo.url(:thumb))), ""#p""+pi.to_s+""a""+i.to_s, :""data-toggle"" =&gt; ""modal"", :class =&gt; ""thumbnail span2"" %&gt;
            &lt;div class=""modal hide fade"" id=""&lt;%= ""p""+pi.to_s+""a""+i.to_s %&gt;"" &gt;
              &lt;div class=""modal-body""&gt;
                &lt;div class=""carousel slide"" id=""&lt;%= ""carousel_""+""p""+pi.to_s+""a""+i.to_s %&gt;"" &gt;
                  &lt;div class=""carousel-inner"" &gt;
                    &lt;% post.assets.each_with_index do |photo, ai| %&gt;
                      &lt;div class=""&lt;%= 'active ' if ai == i %&gt;item""&gt;
                        &lt;%= image_tag photo.photo.url(:normal) %&gt;
                        &lt;div class=""carousel-caption""&gt;
                          &lt;h4&gt;&lt;%= post.title %&gt;&lt;/h4&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                    &lt;% end %&gt;
                  &lt;/div&gt;
                  &lt;a class=""carousel-control left"" href=""&lt;%= ""#carousel_""+""p""+pi.to_s+""a""+i.to_s %&gt;"" data-slide=""prev""&gt;&amp;lsaquo;&lt;/a&gt;
                  &lt;a class=""carousel-control right"" href=""&lt;%= ""#carousel_""+""p""+pi.to_s+""a""+i.to_s %&gt;"" data-slide=""next""&gt;&amp;rsaquo;&lt;/a&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;% end %&gt;
        &lt;/ul&gt;
        &lt;div&gt;&lt;%= mdown(post.content) %&gt;&lt;/div&gt;
        &lt;p&gt;&lt;%= raw post.tags.map(&amp;:name).map { |t| link_to t, tag_path(t) }.join(', ') %&gt;&lt;/p&gt;
        &lt;p&gt;
          &lt;%= link_to 'Show', post %&gt;
          &lt;%= link_to 'Edit', edit_post_path(post) %&gt;
          &lt;%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } %&gt;
        &lt;/p&gt;
      &lt;/div&gt;
    &lt;% end %&gt;

    &lt;br /&gt;

    &lt;%= link_to 'New Post', new_post_path %&gt;
  &lt;/div&gt;
</code></pre>

<p>Basically it lists each post, and renders each image of the post. Each image is a clickable thumbnail that pops up a modal conatining a carousel. Each carousel contains again each photo for the given post.</p>

<p>My idea was to move code from line 8 to line 24 and move it into a partial. The problem is that I get this error:</p>

<pre><code>undefined local variable or method `pi' for #&lt;#&lt;Class:0x000000023b18f0&gt;:0x007f91ec67c458&gt;
</code></pre>

<p>Is there a way to make a partial inherit a variable from the parent?</p>
","2012-09-28 16:30:53"
"7106474","refactoring problem with one of my classes","0","<p>i wrote a program and i named my <code>class StatusListActivity</code> which <code>extend Activity</code>  and is the launcher and main class. I tried refactoring it by  changing the name to something else and whenever i tried to run the application, it closes please do you have an idea of what the problem was.</p>
","2011-08-18 11:12:31"
"33232685","refactoring error in maven","0","<p>I have one parent project with its 4 child (project) in maven.But when i am going to execute that one.it gives following plugin in error.How could i resolve this error??plz help me</p>

<pre><code>1.Unable to update index for central|http://repo1.maven.org/maven2 
2.plug in 'org.maven.ide.eclipse.refactoring' contributed an invalid Menu extension


Parent project pom.xml is

&lt;project xmlns=""http://maven.apache.org/POM/4.0.0"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd""&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
      &lt;groupId&gt;com.te.sss&lt;/groupId&gt;
      &lt;artifactId&gt;iin&lt;/artifactId&gt;
      &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
      &lt;packaging&gt;pom&lt;/packaging&gt;
      &lt;name&gt;iin&lt;/name&gt;
      &lt;description&gt;parent&lt;/description&gt;
      &lt;modules&gt;
      &lt;module&gt;../commons&lt;/module&gt;
      &lt;module&gt;../dao&lt;/module&gt;
      &lt;module&gt;../core&lt;/module&gt;
      &lt;module&gt;../web&lt;/module&gt;
      &lt;/modules&gt;  
    &lt;/project&gt;
</code></pre>
","2015-10-20 09:18:16"
"10835677","refactor linq expression to remove duplicate code","0","<p>I have the following piece of code and I try to refactor this to remove the duplicate code. However every time I try to refactor it I get stuck. Is there someone who can help me out with this issue.</p>

<pre><code>    public static IOrderedQueryable&lt;T&gt; ObjectSort&lt;T&gt;(this IQueryable&lt;T&gt; entities, Expression&lt;Func&lt;T, object&gt;&gt; expression, string order = ""asc"")
    {
        var sortOrder = order == ""asc"" ? SortOrder.Ascending : SortOrder.Descending;
        return entities.ObjectSort(expression, sortOrder);
    }

    public static IOrderedQueryable&lt;T&gt; ObjectThenBy&lt;T&gt;(this IOrderedQueryable&lt;T&gt; entities, Expression&lt;Func&lt;T, object&gt;&gt; expression, string order = ""asc"")
    {
        var sortOrder = order == ""asc"" ? SortOrder.Ascending : SortOrder.Descending;
        return entities.ObjectThenBy(expression, sortOrder);
    }

    public static IOrderedQueryable&lt;T&gt; ObjectSort&lt;T&gt;(this IQueryable&lt;T&gt; entities, Expression&lt;Func&lt;T, object&gt;&gt; expression, SortOrder order = SortOrder.Ascending)
    {
        var unaryExpression = expression.Body as UnaryExpression;
        if (unaryExpression != null)
        {
            var propertyExpression = (MemberExpression)unaryExpression.Operand;
            var parameters = expression.Parameters;

            if (propertyExpression.Type == typeof(DateTime))
            {
                var newExpression = Expression.Lambda&lt;Func&lt;T, DateTime&gt;&gt;(propertyExpression, parameters);
                return order == SortOrder.Ascending ? entities.OrderBy(newExpression) : entities.OrderByDescending(newExpression);
            }

            if (propertyExpression.Type == typeof(DateTime?))
            {
                var newExpression = Expression.Lambda&lt;Func&lt;T, DateTime?&gt;&gt;(propertyExpression, parameters);
                return order == SortOrder.Ascending ? entities.OrderBy(newExpression) : entities.OrderByDescending(newExpression);
            }

            if (propertyExpression.Type == typeof(int))
            {
                var newExpression = Expression.Lambda&lt;Func&lt;T, int&gt;&gt;(propertyExpression, parameters);
                return order == SortOrder.Ascending ? entities.OrderBy(newExpression) : entities.OrderByDescending(newExpression);
            }

            if (propertyExpression.Type == typeof(int?))
            {
                var newExpression = Expression.Lambda&lt;Func&lt;T, int?&gt;&gt;(propertyExpression, parameters);
                return order == SortOrder.Ascending ? entities.OrderBy(newExpression) : entities.OrderByDescending(newExpression);
            }

            if (propertyExpression.Type == typeof(bool))
            {
                var newExpression = Expression.Lambda&lt;Func&lt;T, bool&gt;&gt;(propertyExpression, parameters);
                return order == SortOrder.Ascending ? entities.OrderBy(newExpression) : entities.OrderByDescending(newExpression);
            }

            throw new NotSupportedException(""Object type resolution not implemented for this type"");
        }
        return order == SortOrder.Ascending ? entities.OrderBy(expression) : entities.OrderByDescending(expression);
    }

    public static IOrderedQueryable&lt;T&gt; ObjectThenBy&lt;T&gt;(this IOrderedQueryable&lt;T&gt; entities, Expression&lt;Func&lt;T, object&gt;&gt; expression, SortOrder order = SortOrder.Ascending)
    {
        var unaryExpression = expression.Body as UnaryExpression;
        if (unaryExpression != null)
        {
            var propertyExpression = (MemberExpression)unaryExpression.Operand;
            var parameters = expression.Parameters;

            if (propertyExpression.Type == typeof(DateTime))
            {
                var newExpression = Expression.Lambda&lt;Func&lt;T, DateTime&gt;&gt;(propertyExpression, parameters);
                return order == SortOrder.Ascending ? entities.ThenBy(newExpression) : entities.ThenByDescending(newExpression);
            }

            if (propertyExpression.Type == typeof(DateTime?))
            {
                var newExpression = Expression.Lambda&lt;Func&lt;T, DateTime?&gt;&gt;(propertyExpression, parameters);
                return order == SortOrder.Ascending ? entities.ThenBy(newExpression) : entities.ThenByDescending(newExpression);
            }

            if (propertyExpression.Type == typeof(int))
            {
                var newExpression = Expression.Lambda&lt;Func&lt;T, int&gt;&gt;(propertyExpression, parameters);
                return order == SortOrder.Ascending ? entities.ThenBy(newExpression) : entities.ThenByDescending(newExpression);
            }

            if (propertyExpression.Type == typeof(int?))
            {
                var newExpression = Expression.Lambda&lt;Func&lt;T, int?&gt;&gt;(propertyExpression, parameters);
                return order == SortOrder.Ascending ? entities.ThenBy(newExpression) : entities.ThenByDescending(newExpression);
            }

            if (propertyExpression.Type == typeof(bool))
            {
                var newExpression = Expression.Lambda&lt;Func&lt;T, bool&gt;&gt;(propertyExpression, parameters);
                return order == SortOrder.Ascending ? entities.ThenBy(newExpression) : entities.ThenByDescending(newExpression);
            }

            throw new NotSupportedException(""Object type resolution not implemented for this type"");
        }
        return order == SortOrder.Ascending ? entities.ThenBy(expression) : entities.ThenByDescending(expression);
    }
</code></pre>

<p>Please note the difference is the OrderBy and the ThenBy... The rest is exactly the same. Hopefully someone knows a way to refactor this. I was trying to create a Func parameter to pass the OrderBy or the ThenBy method. However everything I try I get stuck.</p>
","2012-05-31 14:32:42"
"42667204","refactoring - coworker interaction","0","<p>my only coworker used the following code execution to compile code to pdf</p>

<ul>
<li>compile to pdf (1st time): produce a first draft version and an .xlsx. but the only purpose is to create the .xlsx.</li>
<li>compile the same file to pdf (2d time): look up in the previously created .xlsx to produce the pdf</li>
</ul>

<p>To have the process in one pass, simplified and avoid a source of foreseeable bugs (2 pass compilation... hell), I mentioned that we could:</p>

<ul>
<li>reorganize the code</li>
<li>use 'in-line' code functionality (code in the latex area)</li>
</ul>

<p>his answer was something like</p>

<blockquote>
  <p>well it works if you follow the step I describe so no need to change
  it and it is written in the comments that you have to compile it twice.</p>
</blockquote>

<p>I had to take the time to write the step on a paper. We let non-programmer run this code to produce reports. They don't read comments.</p>

<p>if I refactor the code he will really be upset, because it is not the way he started with plus as mentionned it works if you follow his instruction.</p>

<p>did you already faced it. how did you resolved it?</p>

<p>thanks</p>
","2017-03-08 09:13:53"
"24403185","refactor code to avoid N+1 query","0","<p>I have my association like this</p>

<p><code>models/transcription.rb</code></p>

<pre><code>class Transcription &lt; ActiveRecord::Base
  belongs_to :transcription_status, :class_name =&gt; ""TranscriptionStatus"",
    :inverse_of =&gt; :transcriptions


  # Initialize to ""new"" status if a status isn't already set
  def setup_status
    if transcription_status.nil?  # this method is taking lots of execution time ( N + 1 )
      status = TranscriptionStatus.find_by_state(""new"")
      if status
        self.transcription_status = status
      end
    end
  end
end
</code></pre>

<p><code>models/transcription_status.rb</code></p>

<pre><code>class TranscriptionStatus &lt; ActiveRecord::Base
  has_many :transcriptions, :inverse_of =&gt; :transcription_status
end
</code></pre>

<p><strong>Problem</strong></p>

<p>Everytime I call <code>transcription_status</code> it is executing <code>N+1</code> query. Suggest me the way to refactor this code to prevent <code>N+1</code> query limit?</p>

<p>Thanks</p>
","2014-06-25 07:57:53"
"32590525","refactoring jquery addClass removeClass","0","<p>I have the effect I want, but I know it could be coded more efficiently.</p>

<p>Here's the effect...</p>

<p><a href=""http://brinsterinc.com/fw/dcp/steps_vert.html"" rel=""nofollow"">http://brinsterinc.com/fw/dcp/steps_vert.html</a></p>

<p>And here's the jQuery...</p>

<pre><code>$(document).ready(function() {
    setTimeout(function(){
        $( ""#1"" ).addClass( ""vstepCycle"" ).delay(1000).queue(function(){
            $(this).removeClass(""vstepCycle"").dequeue();
            });
   }, 3000);
   setTimeout(function(){
        $( ""#2"" ).addClass( ""vstepCycle"" ).delay(1000).queue(function(){
            $(this).removeClass(""vstepCycle"").dequeue();
            });
   }, 4000);
   setTimeout(function(){
        $( ""#3"" ).addClass( ""vstepCycle"" ).delay(1000).queue(function(){
            $(this).removeClass(""vstepCycle"").dequeue();
            });
   }, 5000);
   setTimeout(function(){
        $( ""#4"" ).addClass( ""vstepCycle"" ).delay(1000).queue(function(){
            $(this).removeClass(""vstepCycle"").dequeue();
            });
   }, 6000);
});
</code></pre>

<p>Trying to learn so any advice appreciated!</p>
","2015-09-15 15:55:23"
"37494997","refactoring caode with spring factory-method","0","<p>This question is the follow-up of <a href=""https://stackoverflow.com/questions/37493304/spring-value-returns-null"">this one</a>.</p>

<p>The problem is I want to inject a value in .properties file and always return null. The reason is that myClassContext is calling new myclass1() and new myclass2() so both myclass1 and myclass2 are not manage by Spring.</p>

<p>So my question now is how can I refactor the code to make the @Value(""${path}"") useful so I can get right result of myClassContext.getPath(params) based on the params.  </p>

<p>I think I should use static factory-method to do this, but I can't think of a solution.</p>

<p>In my applicationContext.xml:</p>

<pre><code>....
&lt;context:component-scan base-package=""com.mypackage""&gt;
     &lt;context:exclude-filter type=""annotation"" expression=""org.springframework.stereotype.Controller""/
&lt;/context:component-scan&gt;
&lt;context:property-placeholder location=""classpath:/config/core/abc.properties""/&gt;
....
</code></pre>

<p>in abc.properties:</p>

<pre><code>path=testpath
</code></pre>

<p>my classes:</p>

<pre><code>package com.mypackage
@Component
public class myclass1 implements Imyclass {
    @Value(""${path}"")
    private String path; //this always is null
    ...
    public String getMyPath() {
        return path+""myclass1"";
    }
}

package com.mypackage
@Component
public class myclass2 implements Imyclass {
    @Value(""${path}"")
    private String path; //this always is null
    ...
    public String getMyPath() {
        return path+""myclass2"";
    }
}
</code></pre>

<p>myClassContext :</p>

<pre><code>public class myClassContext {
    public static String getPath(params){
        return getImyclass(params).getMyPath();
    }
    private static Imyclass getImyclass(params){
        Imyclass mc=null;
        if (logic(params)) {
            mc=new myclass();
        }
        else{
            mc=new myclass2();
        }
        return mc;
    }
}
</code></pre>

<p>What's the better way to manage instances by Spring so the @value will inject correctly? </p>
","2016-05-28 03:47:21"
"37610258","refactoring code by reducing iterations and db hits","0","<p>I have a private instance user model method like below:-  </p>

<pre><code>def generate_authentication_token
  loop do
    token = Devise.friendly_token
    break token unless self.class.unscoped.where(authentication_token:   token).first
  end
end  
</code></pre>

<p>Let us assume that, no. of user record is 100 trillions. If I issue the above script and the token generated on each iteration matches with a record then, loop will iterate for 100 trillion times, same will happen with DBMS too for searching record. Is there any solution to make this problem fast, by reducing iteration and reducing db-hits (given that each iteration will give matching record). And seriously, sorry ! if the question makes no sense and let me know, I will delete ASAP. Thanks. Happy    Coding.       </p>
","2016-06-03 09:06:30"
"7488971","refactor old webapp to gain speed","0","<p>4 years ago, I've built a webapp which is still used by some friends. the problem with that app, is that now it has a huge database, and it loads very slow. I know that is just my fault, mysql queries are mixted all over the places(even in the layout generation time). </p>

<p>ATM I know some about OO. I'll like to use this knowledge in my old app, but I don't know how to do it without rewriting all the from the beginning. Using MVC for my app, is very difficult at this moment.</p>

<p>If you were in my place, or if you will had the task to improve the speed of my old app, how you will do it? Do you have any tips for me? Any working scenarios?</p>
","2011-09-20 17:09:38"
"44727384","refactoring conditional statment","0","<p>I been trying to find a better way of writing:</p>

<p>This works but there must be a cleaner way right?</p>

<pre><code>public static function checkCourierCountry($courier, $country)
{
    if (isset(self::shippingGroups()['shippingGroups']['europe']) &amp;&amp;
        in_array($country, self::shippingGroups()['shippingGroups']['europe'])) {
        return true;
    }
    if (isset(self::shippingGroups()['shippingGroups']['fedex']) &amp;&amp;
        in_array($country, self::shippingGroups()['shippingGroups']['fedex'])) {
        return true;
    }
    if (isset(self::shippingGroups()['shippingGroups']['parcelForce']) &amp;&amp;
        in_array($country, self::shippingGroups()['shippingGroups']['parcelForce'])) {
        return true;
    }
    return false;
}
</code></pre>
","2017-06-23 17:56:46"
"14450993","refactoring model to remove proxy_options for rails 3 upgrade","0","<p>I'm currently upgrading a rails app from 2.x to 3.1.</p>

<p>Wondering if anyone can help to refactor this to remove the proxy_option code (which is no longer available in rails 3):</p>

<pre><code>scope = Product.scoped({})
scope = scope.scoped( Product.allowed(options[:current_user]).proxy_options )
scope = scope.scoped( Product.for_country(options[:country_ids]).proxy_options ) if options[:country_ids]
</code></pre>

<p>Example of one of the scope methods include:</p>

<pre><code>  def allowed(user)
    where(:id =&gt; user.access_to(self.name))
  end
</code></pre>
","2013-01-22 03:15:17"
"22118922","refactor IF...ELSE into Nested foreach to LINQ","0","<p>I am having troubles on finding a way to refactor my nested foreach code into a Linq, mostly because it includes an IF-Else clause into it.</p>

<p>Below is a simplified version of my code. How do I include the IF..Else into a linq statement??</p>

<p>I appreciate your suggestions.</p>

<pre><code>List&lt;hierarchy&gt; PredomHierarchy;
List&lt;hierarchy&gt; RecesesHierarchy;

foreach x in PredomHierarchy{
foreach y in RecesesHierarchy{  

  if(x.name = y.name){      
    Dosomething(x.name, y.name);                
    } else {        
    DosomethingElse(x.name, y.name);
  }
 }
}
</code></pre>
","2014-03-01 19:02:49"
"47967828","refactoring within a shell script","0","<p>I have been given assignments to do on sed command. I was just thinking of coding a refactoring tool using the command line. Is there a way to access the variables declared in a c++ program externally from a shell script and change their name,type,global and static declarations,etc? Are their specific commands. I am using gcc and gdb in my system.
Googling it up did not give suitable results.</p>
","2017-12-25 10:38:13"
"43619317","refactoring code to keep large objects/models in memory in iPython to be reused in python scripts","0","<p>My script depends on loading lots of variables in a minute and uses them globally in many functions. Every time I call that script in iPython, it loads them again, taking time. </p>

<p>I tried to take these calls to load and populate functions out of that script, but then these global variables are not available to the functions in the script. 
It gives <code>NameError: name 'clf' is not defined</code> error message.</p>

<p>Is there a best way to refactor this code to keep these globals in memory and make the script use them? The script loads many variables like these, and uses them in other functions as globals. </p>

<p><code>vectorizer_title, vectorizer_desc, clf, 
df_instance, vocab, all_tokens, df_dist_all, 
df_soc2class_proba, dict_p2s, 
dict_f2m, token_pattern, cleanup_pattern, 
excluded_words = load_data_and_model(lang)
dict_token2idx_all, dict_token2idx_instance, 
dist_array, token_dist_to_instance_min, 
dict_bigram_by_instance, denominate, 
similar_threshold = populate_data(1)</code></p>
","2017-04-25 19:25:34"
"7819170","refactor a dal with hibernate,dao,services and unit of work : how to put all togheter","0","<p>i'm refactoring a jsf web application dal which uses hibernate and the dao pattern, at the moment each data acces class handles its own session and transaction into each method (a session per operation antipattern is it? )
for example :</p>

<pre><code>public void saveEntity(ModelEntity entity) throws Exception {
    String entityName = getCleanClassName(entity.getClass());
    Session session = null;
    Transaction tx = null;
    try {
        session = SessionFactoryUtil.getInstance().openSession();
        tx = session.beginTransaction();
        session.saveOrUpdate(entity);
        session.flush();
        tx.commit();
    } catch (Exception ex) {
        tx.rollback();
                    ...
        throw new Exception(msg, ex);
    } finally {
        session.close();
    }
}
</code></pre>

<p>Above classes can be used directly into backing bean actions or through some business logic classes methods (for example create new detached object, set some values and store them trhough DAO objects). Now i've found that some businness logic classes methods need to be executed atomically, for example :</p>

<pre><code>                       //inside some backing bean actionlistener
        DocumentoManager dm = new DocumentoManager();
        PraticaManager pm = new PraticaManager();
        Documento newDoc = new Documento();
        newDoc.setDataArrivo(new java.util.Date                           newDoc.setNote(""..."");
        Allegato newAll = new Allegato();
        newAll.setTitolo(newDoc.getNote());
                       //businness logic methods that should be executed atomically
        dm.creaDocumentoDaAllegato(newDoc,newAll,
            event.getFile().getContents(),
            event.getFile().getFileName(),
            """");
        pm.collegaDocumento(pratica, newDoc);
</code></pre>

<p>Finally i've a sessionFactoryUtil class which manages hibernate session (getcurrentSession, openSession, etc ... ).</p>

<p>How can i refactor the above architecture? i was thinking to do the following:</p>

<ol>
<li>remove the transaction from the DAO objects : i can't put
transactions management into bl classes (xxxManager) , so should i
use a class that just create,commit or rollback the transaction ,
encapsulating the sessionFactoryUtil, and to be used inside backing
beans (say jta userTransaction) ? </li>
<li>If someone try to use directly the DAO object how do i set the session ? Accessing sessionFactoryUtil into DAOs methods ?</li>
<li>Is it safe to call getCurrentSession inside DAOs?</li>
<li>if i create a class to handle businness logic transactions, how can i be sure it's thread safe ?</li>
</ol>

<p>I think sessionFactoryUtil is thread safe since it's been written following the pattern suggested on hibernate guide :</p>

<pre><code>private SessionFactoryUtil() {
}

static {
    // Annotation and XML
    // sessionFactory = new
    // AnnotationConfiguration().configure().buildSessionFactory();
    // XML only
    try {
        sessionFactory = new Configuration().configure().buildSessionFactory();
    } catch (Exception e) {
                  ...
    }

}

public static SessionFactory getInstance() {
    try{
        return sessionFactory;
    } catch (Exception ex)
    {
        return null;
    }
}
</code></pre>
","2011-10-19 09:27:25"
"21327516","refactoring xsd elements with same elements?","0","<p>I have below xsd elements.</p>

<pre><code> &lt;xsd:element name=""requestOne"" type=""tns:RequestOne""/&gt;
  &lt;xsd:complexType name=""RequestOne""&gt;
        &lt;xsd:annotation&gt;
            &lt;xsd:documentation&gt;some comment&lt;/xsd:documentation&gt;
        &lt;/xsd:annotation&gt;
        &lt;xsd:sequence&gt;
            &lt;xsd:element name=""id"" type=""xsd:string"" minOccurs=""1"" maxOccurs=""1""/&gt;
        &lt;/xsd:sequence&gt;
  &lt;/xsd:complexType&gt;

   &lt;xsd:element name=""requestTwo"" type=""tns:RequestTwo""/&gt;
  &lt;xsd:complexType name=""RequestTwo""&gt;
        &lt;xsd:annotation&gt;
            &lt;xsd:documentation&gt;other comment&lt;/xsd:documentation&gt;
        &lt;/xsd:annotation&gt;
        &lt;xsd:sequence&gt;
            &lt;xsd:element name=""id"" type=""xsd:string"" minOccurs=""1"" maxOccurs=""1""/&gt;
        &lt;/xsd:sequence&gt;
  &lt;/xsd:complexType&gt;
</code></pre>

<p>It has two complex elements but inside them there is duplicated code. How can i refactor above code?</p>

<p>Thanks!</p>
","2014-01-24 08:09:33"
"16014543","refactoring rails method","0","<p>I was wondering, how could i refactor this code, because it doesn't looks good to read and understand</p>

<pre><code>def next_payment_price
    price = self.plan_price
    price = discounted_price if self.coupon &amp;&amp; self.coupon_duration.nil? &amp;&amp; self.coupon_discount != 100
    price = discounted_price if self.coupon &amp;&amp; self.coupon_duration.present? &amp;&amp; self.coupon_discount != 100 &amp;&amp; ((self.created_at + 14.days + self.coupon_duration.month)  &gt; Time.now )
    price
end

def discounted_price
    self.plan_price - ((self.plan_price * self.coupon_discount) / 100)
end
</code></pre>
","2013-04-15 11:55:54"
"5135371","refactoring a controller query with If/else","0","<p>This is what my index action currently looks like. If the current_user is not enrolled to any courses it lists all courses. If he is enrolled to any, it only lists the other ones. Is this a good way to get the needed records or is there a nicer way? Any suggestions? Thx for your time!</p>

<pre><code>if current_user.courses.empty?
  @courses = Course.all
else
  @courses = Course.where(""id not in (?)"", current_user.courses)
end
</code></pre>
","2011-02-27 19:27:32"
"36500973","refactor a pythonic recursive filter for dict","0","<p>Now I have a piece of codes as follows:</p>

<pre><code>def checker(dict_element, dict_filter):
    global counter
    counter = 0

    def fullfill_filter(key, value):
        if key in dict_filter:
            if value in dict_filter[key]:
                return True

    def extract_dict(dict_element):
        global counter

        for key, value in dict_element.items():
            if isinstance(value, str):
                if fullfill_filter(key, value):
                    counter += 1
            elif isinstance(value, dict): 
                extract_dict(value)
            elif isinstance(value, list):
                extract_list(key, value)

    def extract_list(key, list_element):
        global counter

        for el in list_element:
            if isinstance(el, dict):
                extract_dict(el)
            if isinstance(el, list):
                extract_list(el)
            if isinstance(el, str):
                if fullfill_filter(key, el):
                    counter += 1

    extract_dict(dict_element)

    if counter == len(dict_filter.keys()):
        return True
    return False
</code></pre>

<p>It is used to filter a dictionary <code>dict_element</code> contains various types of object, and I want to find the right one according to what I have in the dict_filter.</p>

<p>For example I have a dictionary have two sub dictionary as follows:</p>

<pre><code>list = [
    {
        'services': [],
        'location': {
            'latitude': '51.026',
            'country': 'Germany',
            'longitude': '13.725'
        },
        'available': 'true',
        'technologies': ['Virtual Machines', 'Distributed Systems', 'Internet', 'Wired'],
        'type': 'node',
        'exclusive': 'false',
        'types': [{
            'disk_images': [{
                'version': 'f22',
                'os': 'Linux',
                'name': 'Fedora f22'
            }],

        }]
    }, {
        'services': [],
        'location': {
            'latitude': 'unknown',
            'country': 'Taiwan',
            'longitude': 'unknown'
        },
        'available': 'false',
        'technologies': ['Virtual Machines', 'Distributed Systems', 'Internet',],
        'type': 'node',
        'exclusive': 'false',
        'types': [{
            'disk_images': [{
                'version': 'f24',
                'os': 'Linux',
                'name': 'Fedora f24'
            }],
        }]
    }
]
</code></pre>

<p>If I do as<code>[checker(dict, dict_filter = {'avaliable': 'true', 'country':'Germany'}) for dict in list]</code> 
or <code>[checker(dict, {'version': 'f22'}) for dict in list]</code>
or <code>[checkert(dict, {technologies: 'Wired'} for dict in list]</code>
, I can filter out the second case and get the first dict, However, as you can see the codes is ugly and badly naming(not a native English speaker), is there a better and cleaner way to refactor it in pythonic way?</p>
","2016-04-08 13:33:41"
"5130592","refactoring will_paginate attributes in a controller query","0","<p>Hey. I am using the following line over and over in my controller index queries. Does it makes sense to create a new application method to re-use it? Any suggestions on how I could extract this and perhaps pass the <code>:per_page</code> attribute a variable parameter? </p>

<pre><code>paginate :page =&gt; params[:page], :per_page =&gt; 12
</code></pre>

<p>Thanks for your time!</p>
","2011-02-27 00:09:33"
"37887740","refactor duplicate code - only difference is a < sign","0","<p>Class Test is <code>abstract</code>. It contains a basic testname and a score. This score (double) is accessible through a property named TestScore. </p>

<p>Three kind of classes inherit from Test. They are as such different that each kind of test has a different way of rating a score.</p>

<p><strong>Aim</strong>: Rate a score with one of 6 ratings based on a range of values in between of which the score can be.</p>

<pre><code>class ScoreRangeAscendingTest : Test
{
    public ScoreRangeAscendingTest(double score, Enums.TestType typeName) : base(score, typeName) { }
    public double[] ranges;
    public Enums.Rating calculateScore(double[] range)
    {
        if (scoreInVeryWeakRange())
            return Enums.Rating.VeryWeak;
        else if (scoreInWeakRange())
            return Enums.Rating.Weak;
        else if (scoreInAveragelyWeakRange())
            return Enums.Rating.AveragelyWeak;
        else if (scoreInAveragelyGoodRange())
            return Enums.Rating.AveragelyGood;
        else if (scoreInGoodRange())
            return Enums.Rating.Good;
        else 
            return Enums.Rating.VeryGood;
    }

    private bool scoreInVeryWeakRange()
    {
        return this.TestScore &lt; ranges[(int)Enums.Border.P10];
    }
    private bool scoreInWeakRange()
    {
        return TestScore &gt;= ranges[(int)Enums.Border.P10] &amp;&amp; TestScore &lt; ranges[(int)Enums.Border.P25];
    }
    private bool scoreInAveragelyWeakRange()
    {
        return TestScore &gt;= ranges[(int)Enums.Border.P25] &amp;&amp; TestScore &lt; ranges[(int)Enums.Border.P50];
    }
    private bool scoreInAveragelyGoodRange()
    {
        return TestScore &gt;= ranges[(int)Enums.Border.P50] &amp;&amp; TestScore &lt; ranges[(int)Enums.Border.P75];
    }
    private bool scoreInGoodRange()
    {
        return TestScore &gt;= ranges[(int)Enums.Border.P75] &amp;&amp; TestScore &lt; ranges[(int)Enums.Border.P90];
    }
    private bool scoreInVeryGoodRange()
    {
        return TestScore &gt; ranges[(int)Enums.Border.P90];
    }

}
</code></pre>

<p>}</p>

<p><strong>The problem</strong>: I have tests whose corresponding ranges go up and tests whose corresponding ranges go down. So I need to write the exact same code for the second type of test, but this time, all the '&lt;' signs need to be '>' signs and vice versa. </p>

<p><strong>Question</strong>: how can I avoid duplicating this code? is there a possibility to add it to the base class?</p>
","2016-06-17 18:05:47"
"43897757","refactor d3 from tsv to json and replace type function","0","<p>I need to factor out the type function so I can use a json variable instead of tsv; I am already doing a data.forEach() to parse the date so that's OK.   I haven't been able to figure out what this does: </p>

<pre><code>for (var i = 1, n = columns.length; i &lt; n; ++i) d[columns[i]] = d[columns[i]] 
/ 100;
</code></pre>

<p>in</p>

<pre><code>function type(d, i, columns) {
d.date = parseDate(d.date);
for (var i = 1, n = columns.length; i &lt; n; ++i) d[columns[i]] = d[columns[i]] 
/ 100;
return d;
}
</code></pre>

<p>this is the example:
<a href=""https://bl.ocks.org/mbostock/3885211"" rel=""nofollow noreferrer"">Stacked bar</a></p>
","2017-05-10 16:10:50"
"33500027","refactoring several if else statements","0","<p>I have a method that I'm looking to refactor, and I know there is potential in refactoring it, but I'm quite uncertain on how it should be done most effectively.</p>

<pre><code>  # Collection of Users questions
  def all_questions
    current_week = Time.zone.now.strftime('%V').to_i

    # biweekly
    odd_or_even_week = current_week.odd? ? 'odd_weeks' : 'even_weeks'

    # monthly
    beginning_week_of_month =
      Time.zone.now.beginning_of_month.strftime('%V').to_i
    end_week_of_month       =
      Time.zone.now.end_of_month.strftime('%V').to_i

    # quarter
    beginning_week_of_quarter =
      Time.zone.now.beginning_of_quarter.strftime('%V').to_i
    end_week_of_quarter       =
      Time.zone.now.end_of_quarter.strftime('%V').to_i

    # User's current week questions
    group_questions.weekly + questions.weekly +
      questions.send(odd_or_even_week.to_sym) +
      group_questions.send(odd_or_even_week.to_sym) +
    if current_week == beginning_week_of_month    then questions.start_of_month   + group_questions.start_of_month        else [] end +
    if current_week == end_week_of_month          then questions.end_of_month     + group_questions.end_of_month          else [] end +
    if current_week == beginning_week_of_quarter  then questions.start_of_quarter + group_questions.start_of_quarter      else [] end +
    if current_week == end_week_of_quarter        then questions.end_of_quarter   + group_questions.end_of_quarter        else [] end
  end
</code></pre>

<p>this is my method. What I'm essentially doing is checking if the current week matches one of several criterias which have been assigned to the different variables. If current week matches then I want to add an array to the list.</p>

<p>Some smaller issues I'm having with refactoring say the if else statements are that if I don't have a fallback on false being an empty array, then in the concatenation I'll have two ++ next to each-other because it will get the previous array, and if the one is empty in the midle add the + operator for that array. Thus resulting in an array.</p>

<p>question and group_questions are associations, the method called on them are enums that looks like this on the Question model:</p>

<pre><code>  enum frequency: { weekly: 0, odd_weeks: 1, even_weeks: 2,
                    start_of_month: 3, end_of_month: 4,
                    start_of_quarter: 5, end_of_quarter: 6 }
</code></pre>

<p>Does anybody have a take on how they'd refactor this?</p>
","2015-11-03 13:11:21"
"16903978","refactoring the following code to use jQuery","0","<p>I have some code that adds event listeners that were not written with jQuery.</p>

<pre><code>pic1.addEventListener(""webkitTransitionEnd"",
    function(){
        pic1.className=""down"";
        pic1.style.zIndex=picclick;
        },true);
pic1.addEventListener(""oTransitionEnd"",
    function(){
        pic1.className=""down"";
        pic1.style.zIndex=picclick;
        },true);
pic1.addEventListener(""transitionEnd"",
    function(){
        pic1.className=""down"";
        pic1.style.zIndex=picclick;
        },true);
</code></pre>

<p>I want to now add the eventListeners with jQuery, and maintain the same functionality. Ideas on what this should look like?</p>

<p>Here's a sketch of what I'm doing...
<a href=""http://jsdo.it/dbwest/4rqo"" rel=""nofollow"">http://jsdo.it/dbwest/4rqo</a></p>
","2013-06-03 19:04:11"
"8981097","refactoring of the java code","0","<p>I have a code which was not refactored at all. I refactored it to some extent..but stuck at a point where I cannot think of anything further.</p>

<p>Tractor.java:</p>

<pre><code>   package com.farm;

public class Tractor implements MethodsInterface{

private int[] position;

private int[] field;

private String orientation;

public Tractor(){
    position  = new int[]{0,0};
    field = new int[]{5,5};
    orientation = ""N"";
}

public void move(String command) {
if(command==""F""){
moveForwards();
}else if(command==""T""){
turnClockwise();
}

}

private void moveForwards() {
if(orientation==""N""){
position = new int[]{position[0], position[1]+1}; }else if(orientation == ""E""){ position = new int[]{position[0]+1, position[1]}; }else if(orientation == ""S""){ position = new int[]{position[0], position[1]-1}; }else if(orientation == ""W""){ position = new int[]{position[0]-1, position[1]}; } if(position[0]&gt;field[0]||position[1]&gt;field[1]){

try {
    throw new TractorInDitchException();
} catch (TractorInDitchException e) {
    e.printStackTrace();
}

}

}

private void turnClockwise() {
if(orientation==""N""){
orientation = ""E"";
}else if(orientation == ""E""){
orientation = ""S"";
}else if(orientation == ""S""){
orientation = ""W"";
}else if(orientation == ""W""){
orientation = ""N"";
}
}


public int getPositionX() {
return position[0];
}

public int getPositionY() {
return position[1];
}

public String getOrientation() {
return orientation;
}
}
</code></pre>

<p>TractorInDitchException.java</p>

<pre><code>package com.farm;

public class TractorInDitchException extends Exception{

}
</code></pre>

<p>MethodsInterface.java</p>

<pre><code>package com.farm;

public interface MethodsInterface {

    public int getPositionX();
    public int getPositionY();
    public String getOrientation();
}
</code></pre>

<p>What else could be refactored...any suggestions please?</p>
","2012-01-24 01:40:57"
"5987833","refactoring a complex dynamic active relation query","0","<p>I was wondering if I could get some refactoring help to make this query more concise.</p>

<p>Basically what this query does is it searches all the help_documents by some search terms. It checks the document question, content and the category it belongs to.</p>

<pre><code>  def self.search(text)
    if text.blank?
      latest
    else
      relation = sorted.joins(:category)

      text.split(/\s/).each do |word|
        relation = relation.where(
            ""lower(help_documents.question) like ? or lower(help_documents.content) like ? or lower(help_categories.name) like ?"",
            ""%#{word.downcase}%"", ""%#{word.downcase}%"", ""%#{word.downcase}%""
        )
      end

      relation
    end
  end
</code></pre>

<p>Compared to how you would do this in java/hibernate, this actually looks pretty good. But I figured the rails people might have even sexier tricks up their sleeve to accomplish the same thing. For example, there might be some methods/objects I don't know about that already do these types of things.</p>
","2011-05-13 06:02:23"
"39543867","refactor a functionwich makes a form","0","<p>I got a working function, but i think it should become a lot smaller and better but i aint seeing it. can someone help me improve this function make it better:</p>

<p>I am making a new li-item in a unordered list. in there there is omse info in 3 divisions who get a class making them float left to eachother.</p>

<p>this is the code i used, its all listed out, it can probly be make a lot better, and i hope to learn to refactor my code more, so help is apriciated.</p>

<pre><code>// making new li item inn &lt;ul&gt;
function addproduction(){
  // getting info from form
  var startdatum_form = document.getElementById('startdatum').value;
  var uren_form  = document.getElementById('uren').value;
  var ordernummer_form  = document.getElementById('ordernummer').value;

  // new li element
  var newli = document.createElement('li');
  newli.setAttribute('class', 'ui-state-default');

  var div1 = document.createElement('div');
  div1.setAttribute('class', 'div1');
    var sortableicon = document.createElement('span');
    sortableicon.setAttribute('class', 'ui-icon ui-icon-arrowthick-2-n-s');

    // count current li elements in UL:
      var number = 0;
      var ullist = document.getElementById('sortable');
      for(i=0;i&lt; ullist.childNodes.length;i++){
          if(ullist.childNodes[i].nodeName=='LI'){
              number++;
          }
      }
  newli.setAttribute('id', 'p'+(number+1));


    // text node (item x)
    var nrText = document.createTextNode('Item ' + (number+1));
    div1.appendChild(sortableicon)
    div1.appendChild(nrText);
  var div2 = document.createElement('div');
  div2.setAttribute('class', 'div1');
        var indiv1 = document.createElement('div');
        indiv1.appendChild(document.createTextNode('Title'));
        var indiv2 = document.createElement('div');
        indiv2.appendChild(document.createTextNode('Start'));
        var indiv3 = document.createElement('div');
        indiv3.appendChild(document.createTextNode('End'));
        var indiv4 = document.createElement('div');
        indiv4.appendChild(document.createTextNode('Uren'));
            div2.appendChild(indiv1);
            div2.appendChild(indiv2);
            div2.appendChild(indiv3);
            div2.appendChild(indiv4);
  var div3 = document.createElement('div');
  div3.setAttribute('class', 'div3');
        var indiv5 = document.createElement('div');
        indiv5.appendChild(document.createTextNode(ordernummer_form));
        var indiv6 = document.createElement('div');
        indiv6.appendChild(document.createTextNode(startdatum_form));
        var indiv7 = document.createElement('div');
        indiv7.appendChild(document.createTextNode('end'));
        var indiv8 = document.createElement('div');
        indiv8.appendChild(document.createTextNode(uren_form));
            div3.appendChild(indiv5);
            div3.appendChild(indiv6);
            div3.appendChild(indiv7);
            div3.appendChild(indiv8);

    newli.appendChild(div1);
    newli.appendChild(div2);
    newli.appendChild(div3);

    // add new production to list
    document.getElementById('sortable').appendChild(newli);
    saveNewEntry( (number+1), ordernummer_form, startdatum_form, uren_form );
}
</code></pre>
","2016-09-17 07:03:24"
"40917164","refactor python script into an isolatable method","0","<p>Is it possible to refactor this script such that it exists as a completely independent method? </p>

<pre><code>import json
import requests
from collections import defaultdict
from pprint import pprint

def hasNumbers(inputString):
    return any(char.isdigit() for char in inputString)

# open up the output of 'data-processing.py'
with open('job-numbers-by-location.txt') as data_file:

    # print the output to a file
    with open('phase_ii_output.txt', 'w') as output_file_:
        for line in data_file:
            identifier, name, coords, number_of_jobs = line.split(""|"")
            coords = coords[1:-1]
            lat, lng = coords.split("","")
            # print(""lat: "" + lat, ""lng: "" + lng)
            response = requests.get(""http://api.geonames.org/countrySubdivisionJSON?lat=""+lat+""&amp;lng=""+lng+""&amp;username=s.matthew.english"").json()


            codes = response.get('codes', [])
            for code in codes:
                if code.get('type') == 'ISO3166-2':
                    country_code = '{}-{}'.format(response.get('countryCode', 'UNKNOWN'), code.get('code', 'UNKNOWN'))
                    if not hasNumbers( country_code ):
                        # print(""code: "" + country_code + "", jobs: "" + number_of_jobs)
                        output_file_.write(""code: "" + country_code + "", jobs: "" + number_of_jobs)
    output_file_.close()
</code></pre>

<p>I've been trying to make it so that I can include it as a component of a much larger process. </p>
","2016-12-01 17:47:07"
"23475777","refactor node-mysql callback for KOA and co-mysql with generators","0","<p>I am doing queries like below in existings apps and would like some advice/example on how to refactor this for KOA + co-mysql with generators avoiding or simplifying the chained functions with the sql calls. JS is fine, of course, I use a nodejs 0.11 and a CS version that supports generators. Still trying to get the hang of the 'new way'.</p>

<p>Thanks, K</p>

<pre><code>client = mysql.createPool(mysql_options)
getSql = (sql, callback) -&gt;
  client.query sql, (err, rows, fields) -&gt;
    if err  #mysql error handling
      if err.code isnt 'PROTOCOL_CONNECTION_LOST'
        console.log 'Mysql Error &lt;&gt; Conn.Lost: ',err.stack
        process.on ""uncaughtException"", (err) -&gt;
          console.log ""getSql Mysql Error Caught Exception: "", err.stack
          return
      else
        setTimeout -&gt;
          console.log 'Connection Lost; Re-connecting lost client (restart delay): ',err.stack
          client = mysql.createPool(mysql_options)
          return
        , 700
    client.release
    callback rows

    q10 = -&gt;         # and in the routes...
      sql = ""select count(*) as custCount from cust01 where sessionid = '"" +  prSid + ""' and custNum = "" + ""'"" + sessionLoginUser + ""'""
      getSql sql, (results) -&gt;
        q20(results[0].custCount)

    q20 = (custCount) -&gt;
     ....etc etc

    q10()
</code></pre>
","2014-05-05 15:05:55"
"36338222","refactory might be done unproperly","0","<p>I am a beginner trying to learn Grails 3.1. Regarding to the default, I add the following scratch on the index page:</p>

<pre><code>&lt;ul&gt;
    &lt;g:each var=""c"" in=""${grailsApplication.controllerClasses.sort { it.fullName } }""&gt;
        &lt;li class=""controller""&gt;
                        &lt;g:link controller=""${c.logicalPropertyName}""&gt;${c.fullName}&lt;/g:link&gt;
        &lt;/li&gt;
    &lt;/g:each&gt;
&lt;/ul&gt;
</code></pre>

<p>At the beginning, the index page shows <strong>no controller</strong>. Then, I create another controller, <strong>TodosController</strong> for instance. Because this controller name is not nice somehow, so I want to rename it (of course, using refactory feature in Intellij IDEA) into <strong>TodoListController</strong>. Unfortunately, the code still remains two controllers and shows them in the index page. When I click on the link of <strong>TodosController</strong>, I get the error:</p>

<pre><code>Could not resolve view with name '/todos/index' in servlet with name 'grailsDispatcherServlet'
</code></pre>

<p>Snapshot of the error is below.
<a href=""https://i.stack.imgur.com/3QiOh.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/3QiOh.png"" alt=""Could not resolve view""></a>
I spend many times to find out where it is, but no magic thing happens to me.
Anyone got such a situation?</p>
","2016-03-31 15:55:50"
"6013852","refactoring 2 closely coupled methods","0","<p>Ok so I'm making a mockup of a distributed system.
each instance of  mClass (object) is used by 1 thread. Mutable data can't be passed between mClass objects
This is a example of code analogous to what I have:</p>

<pre><code>type mClass (mID:id)=
    member this.ID=mID

    let resolve : id-&gt;mClass  =... //This function turns IDs into the objects they represnt
    ...
    let managementInfo = ref Some mutableData

    //this should only ever be called by the GiveControl method.
    private member this.TakeControl (frozenData) =
        let defrostedData = ... //a variable that works out the unfrozen version of the frozenData
        managementInfo := Some defrostedData


    ///This is a helper that ensure that when ever someone else is told to take control 
    ///that all my internal data and any functions i need to call to tell others are done
    ///And convert the data a nonmutable form 
    ///(Mutable data can not be tranfered between different instances of of mClass (objects), 
    ///as this is a mockup of a distributed system, where the instances of mClass can't
    ///@param: nID this ID of the object we are giving control to
    ///@param: callbacks: a list of functions to call to tell other objects i've given control 
    private member this.GiveControl nID (callbacks: list&lt;id-&gt;unit&gt;) =
        let updateInternalData = ... //A function to upate my internal state
        updateInternalData;
        ignore (List.map (fun f-&gt; f nID) callbacks);
        let freezeData data= ... //a function make our mutableData into nonmutable data
        let frozenData = (!managemenInfo).Value|&gt;freezeData 
        managemenInfo:=None;
        (nID|&gt;resolve).TakeControl (frozenData)

    ...
</code></pre>

<p>private member this.GiveControl was originally declared:
let giveControl
but it made the compiler complain about mis-declaring a new type, until i changed it to a private method.</p>

<p>The question is, how can I re factor this code,
to merge the two methods into one. (or atleast make GiveControl only callable from within this object (real private as it were) and TakeControl only callable from GiveControl)</p>
","2011-05-16 06:26:13"
"35801259","refactoring ruby methods in rails","-1","<p>I have the following code in my notification model in my rails app. </p>

<p>I'd like to refactor it a bit. What is wrong for sure is this ""check if object exists then do something with it"" part. I guess I could use <code>try</code> but I don't know how it exactly works. Can sby tell me how to do that (with <code>try</code> or if there is a better way then with that)?</p>

<p>Any other observations regarding the rest of the code?</p>

<pre><code>#check and decrease chat notification that happens between 2 given users (since 1v1 chat notification number max limit is 1)
def self.decreasing_chat_notification_number(current_user, user)
  if self.between_chat_recipient(current_user, user).unchecked.any?
    notification = self.between_chat_recipient(current_user, user).unchecked.first
    checking_and_decreasing_notification(notification)
  end
end

#check and decrease all the task notifications that happens between 2 given users
def self.decreasing_task_notification_number(current_user, user)
  if self.task.between_other_recipient(current_user, user).unchecked
    self.task.between_other_recipient(current_user, user).unchecked.each do |notification|
      checking_and_decreasing_notification(notification)
    end
  end
end

#check and decrease all the post notifications that happened on a given post
def self.decreeasing_post_notification_number(current_user, post)
  if self.post.this_post_comments(current_user, post).unchecked
    self.post.this_post_comments(current_user, post).unchecked.each do |notification|
      checking_and_decreasing_notification(notification)
    end
  end
end

private

def check_notification #chat notification gets checked
  if self.checked_at == nil
    update_attributes(checked_at: Time.zone.now)
  end
end

def checking_and_decreasing_notification(notification)
  notification.check_notification
  current_user.decrease_new_other_notifications
  current_user.decreased_other_number_pusher
end
</code></pre>

<p>scopes:</p>

<pre><code>scope :not_chat, -&gt; { where.not(notifiable_type: ""Message"") }
scope :chat, -&gt; { where(notifiable_type: ""Message"") }
scope :task, -&gt; { where(notifiable_type: ""Task"") }
scope :post, -&gt; { where(notifiable_type: ""Post"") }
scope :checked, -&gt; { where.not(checked_at: nil) }
scope :unchecked, -&gt; { where(checked_at: nil) }
scope :this_post_comments, -&gt; (recipient_id, post_id) do
  where(""notifications.recipient_id = ? AND notifications.notifiable_id = ?"", recipient_id, post_id)
end
scope :between_chat_recipient, -&gt; (recipient_id, sender_id) do
  where(""notifications.recipient_id = ? AND notifications.sender_id = ? AND notifications.notifiable_type = ?"", recipient_id, sender_id, ""Message"")
end
scope :between_other_recipient, -&gt; (recipient_id, sender_id) do
  where(""notifications.recipient_id = ? AND notifications.sender_id = ?"", recipient_id, sender_id)
end
</code></pre>

<p>UPDATE:</p>

<p>Everything is called on current_user as instance method instead of Notification.class_method. Btw. user table has <code>""new_chat_notification"",default: 0</code> and <code>""new_other_notification"", default: 0</code> attributes to count the number of current notifications.</p>

<p>user.rb</p>

<pre><code>  #check and decrease chat notification that happens between 2 given users (max 1)
  def decreasing_chat_notification_number(user)
    notification = self.notifications.between_chat_recipient(user).unchecked.first
    self.checking_and_decreasing_notification(notification) if notification.present?
  end

  #check and decrease task notifications that happens between 2 given users
  def decreasing_task_notification_number(user)
    self.notifications.task.between_other_recipient(user).unchecked.each do |notification|
      self.checking_and_decreasing_notification(notification)
    end
  end

  #check and decrease the post notification that belongs to a given post
  def decreasing_post_notification_number(post_id)
    self.notifications.this_post_comments(post_id).unchecked.each do |notification|
      self.checking_and_decreasing_notification(notification)
    end
  end

  def checking_and_decreasing_notification(notification)
    notification.check_notification
    if notification.notifiable_type == ""Message""
      self.decrease_new_chat_notifications
      self.decreased_chat_number_pusher
    else
      self.decrease_new_other_notifications
      self.decreased_other_number_pusher
    end
  end

  def decrease_new_chat_notifications
    decrement!(:new_chat_notification) if self.new_chat_notification &gt; 0
  end


  def decrease_new_other_notifications
    decrement!(:new_other_notification) if self.new_other_notification &gt; 0
  end

  def decreased_chat_number_pusher
    number = self.new_chat_notification
    Pusher['private-'+ self.id.to_s].trigger('new_chat_notification', {:number =&gt; number})
  end

  def decreased_other_number_pusher
    number = self.new_other_notification
    Pusher['private-'+ self.id.to_s].trigger('new_other_notification', {:number =&gt; number})
  end
</code></pre>

<p>notification.rb</p>

<pre><code>scope :not_chat, -&gt; { where.not(notifiable_type: ""Message"") }
scope :chat, -&gt; { where(notifiable_type: ""Message"") }
scope :task, -&gt; { where(notifiable_type: ""Task"") }
scope :post, -&gt; { where(notifiable_type: ""Post"") }
scope :checked, -&gt; { where.not(checked_at: nil) }
scope :unchecked, -&gt; { where(checked_at: nil) }

scope :this_post_comments, -&gt; (post_id) do
  where(""notifications.notifiable_id = ?"", post_id)
end

scope :between_chat_recipient, -&gt; (sender_id) do
  where(""notifications.sender_id = ? AND notifications.notifiable_type = ?"", sender_id, ""Message"")
end

scope :between_other_recipient, -&gt; (sender_id) do
  where(""notifications.sender_id = ? AND notifications.notifiable_type != ?"", sender_id, ""Message"")
end

def check_notification #chat notification gets checked
  update_attribute(:checked_at, Time.zone.now) if self.checked_at.nil?
end
</code></pre>
","2016-03-04 16:34:40"
"46457599","refactor method in ruby instead 3 calls to DB make it one call","-1","<pre><code>def post_stat
    @urls = CallUrl.all
    call = params[:call_url_id] ? params[:call_url_id] : CallUrl.first.id
    call_url = CallUrl.find(call)
    @Posts = callback_url.posts
end
</code></pre>

<p>I am trying to refactor this code to make only one call to database insted of 3 times in each class I am calling?</p>
","2017-09-27 21:36:22"
"23745276","refactoring switch code in a Razor view page","-1","<p>I am trying to optimize the below asp.net mvc code by reusing image tag using a variable. Could some one throw idea on optimizing this code/ refactoring code  by adding variables and reusing img tag?</p>

<pre><code>@model int

@{
    switch (Model)
    {
        case 0:
        &lt;text&gt;
            &lt;img title=""abc"" class=""Container"" src=""@Url.Content(Links.Content.Images.1_png)"" /&gt;
        &lt;/text&gt;
            break;
        case 1:
        &lt;text&gt;
            &lt;img title=""def"" class=""Container"" src=""@Url.Content(Links.Content.Images.2_png)"" /&gt;
        &lt;/text&gt;
            break;
        case 2:
        &lt;text&gt;
            &lt;img title=""ghi"" class=""Container"" src=""@Url.Content(Links.Content.Images.3_png)"" /&gt;
        &lt;/text&gt;
            break;
        case 3:
        &lt;text&gt;
            &lt;img title=""jkl"" class=""Container"" src=""@Url.Content(Links.Content.Images.4_png)"" /&gt;
        &lt;/text&gt;
            break;
    }   
}
</code></pre>
","2014-05-19 19:01:53"
"47144085","refactoring the replace method in JavaScript","-1","<pre><code>var x = ""mike^+tom&amp;+craig+^tom"";

var y = x.replace('^+', '+').replace('&amp;+', '+').replace('+^', '+');

y = mike++tom++craig++tom; // This is the output

expected mike+tom+craig+tom;
</code></pre>

<p>Instead of chaining the replacing like above, can we do it other way in JavaScript?</p>
","2017-11-06 19:11:42"
"17690492","refactoring ruby code inject issues","-1","<p>Hi can someone explain to me why my inject isn't working here?</p>

<p>Am I using inject correctly here? For some reason my code gets caught up in an endless loop once this scenario comes into play (the 5th move usually in my game)</p>

<pre><code>  def cpu_block_player
    winning_combinations = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]]
    executed = 0
    winning_combinations.each do |combination|
      result_of_combination = """"
      result_of_combination = combination.inject("""") {|result, element| result + @board[element]}
      if result_of_combination == ""XXe"" || result_of_combination == ""eXX"" || result_of_combination == ""XeX""
        executed += 1
        puts executed 
        player_move(@current_turn, result_of_combination.index(""e""))     
      end
      break if executed &gt;= 1
   end
</code></pre>
","2013-07-17 03:18:30"
"44548693","refactoring duplicate javascript click events","-1","<p>I have the following javascript click events. There is an indeterminate amount of <code>cat-#</code> classes. How can I best refactor this to avoid this code duplication as well as the ability to handle additional numbers that aren't hard coded?</p>

<pre><code>$(document).on('click', '#browse-category .cat-1', function (e) {
    $('#browse-condition li[class^=""cat""').addClass('hidden');
    $('#browse-condition .cat-1').removeClass('hidden');
});

$(document).on('click', '#browse-category .cat-2', function (e) {
    $('#browse-condition li[class^=""cat""').addClass('hidden');
    $('#browse-condition .cat-2').removeClass('hidden');
});

$(document).on('click', '#browse-category .cat-3', function (e) {
    $('#browse-condition li[class^=""cat""').addClass('hidden');
    $('#browse-condition .cat-3').removeClass('hidden');
});

$(document).on('click', '#browse-category .cat-4', function (e) {
    $('#browse-condition li[class^=""cat""').addClass('hidden');
    $('#browse-condition .cat-4').removeClass('hidden');
});

$(document).on('click', '#browse-category .cat-5', function (e) {
    $('#browse-condition li[class^=""cat""').addClass('hidden');
    $('#browse-condition .cat-5').removeClass('hidden');
});
</code></pre>
","2017-06-14 15:18:00"
"32748552","refactoring legacy spring framework 4.0.1 to support spring boot RestControllers","-1","<p>In a broader sense I'd like to be able to have the advantages of spring boot in a traditional ""do everything by hand"" spring framework project. Since the JPA repositories, services and providers are written by hand so far, a soft switch-over to the spring boot way would be perfect. I'd like to use <code>@RestController(""mymodel"")</code> type annotations.</p>

<pre><code>&lt;spring.version&gt;4.0.1.RELEASE&lt;/spring.version&gt;
&lt;org.springframework.security.version&gt;3.2.3.RELEASE&lt;/org.springframework.security.version&gt;
&lt;org.springframework.data.spring-data-jpa.version&gt;1.5.0.RELEASE&lt;/org.springframework.data.spring-data-jpa.version&gt;
</code></pre>
","2015-09-23 20:05:52"
"16506434","refactor this long but simple code - string comparing","-1","<p>Given two strings, return true if either of the strings appears at the very end of the other string, ignoring upper/lower case differences (in other words, the computation should not be ""case sensitive""). Note: str.toLowerCase() returns the lowercase version of a string.</p>

<p>endOther(""Hiabc"", ""abc"") → true</p>

<p>endOther(""AbC"", ""HiaBc"") → true</p>

<p>endOther(""abc"", ""abXabc"") → true</p>

<pre><code>public class endOtherClass{  
      public static void main(String args[]) {  
          boolean is = endOther(""yz"",""12xz"") ;  
          System.out.println(is) ;  

      }  

     public static boolean endOther(String a, String b) {  

       a = a.toLowerCase() ;  
       b = b.toLowerCase() ;  

       if( a.length() == b.length()){  
                System.out.println(""a and b have same length!"") ;  

                if(a.equals(b)){  
                     System.out.println(""wow, even better - they are exact same"") ;   
                     return true ;  
                          }  
                else {  
                          System.out.println(""but are diff!"") ;  
                           return false ;  
                          }  
       }  

            String shorter = """" ;// figure out which - a or b - is shorter   
            String longer = """" ;// and which one is longer  

            if( a.length() &gt; b.length() ){ shorter = b ; longer = a ;}   
            else { shorter = a ; longer = b ;}  

            int offset = longer.length() - shorter.length() ; // the offset is used to know where exactly to start comparing  


            //go through the shorter and compare the corresponding part of the longer string  

            for(int i = 0 ; i &lt; shorter.length() ; i++){  
                 System.out.println(""comparing subs: "" + shorter.substring(i,i+1) + "" and "" + longer.substring(offset+i, offset+i+1)) ;   


             if( !shorter.substring(i,i+1).equals( longer.substring(offset+i, offset+i+1) ) ){    //we add offset so we can start comparing the last n characters of shorter string!  

                   System.out.println(""something wrong in long: "" + longer.substring(offset+i, offset+i+1)) ;  

                   System.out.println(""something wrong in short: "" + shorter.substring(i,i+1)) ;  
                   return false ;  
                 }  
            }  
            return true ;  

      }  


    }  
</code></pre>

<p>i m 90% sure this code can be simplified, but i don't know other logic or way of thinking about this simple exercise</p>

<p>can someone help me refactor it and make it smaller?</p>
","2013-05-12 10:29:56"
"2046370","refactor dilemma","-1","<p>I want to extract the guard statement from the following method    </p>

<pre><code>private void CreateProxy()
    {
        //extract the following guard statement.
        Host selected = this.comboBox1.SelectedItem as Host;
        if (selected == null)
        {
            return;
        }


        this.SearchProxy = ServiceProxy.ProxyFactory.CreateSearchProxy(GetSelectedIP().ToString());
        this.StreamProxy = ServiceProxy.ProxyFactory.CreatePlayerProxy(GetSelectedIP().ToString());
    }

     //extracted guard method
     public bool IsHostSelected()
     {
        Host selected = this.comboBox1.SelectedItem as Host;
        if (selected == null)
        {
            return false;
        }
        return true;
     }
</code></pre>

<p>see? now i have to add return value for the extracted method, is this kinda ugly?</p>

<p>any better solution to avoid adding the return value for the extracted method?</p>
","2010-01-12 02:45:17"
"30934698","refactoring if else","-2","<p>I am refactoring a legacy code. There is a big if else statement. Is that  a pattern I can use. I have used a dictionary in the past for if-else but this has lot of (&amp;&amp;) so don't know how to refactor this.</p>

<p>for eg the code is</p>

<pre><code>    public void ChangeControlVisibiltiy()
      {
        if (name != ""I"")
        {
           //Do something
        }



        if ((name != ""A"") &amp;&amp; (name != ""B"") &amp;&amp; (name != ""C"") &amp;&amp; (name != ""D"") &amp;&amp; (name != ""F"") &amp;&amp; (name != ""G"") &amp;&amp; (name != ""H"") &amp;&amp; (name != ""I"") &amp;&amp; (name != ""J"") &amp;&amp; (name != ""H"") &amp;&amp; (name != ""I"") &amp;&amp; (name != ""J""))
        {
           //Do something
        }

        if ((name != ""A"") &amp;&amp; (name != ""B"") &amp;&amp; (name != ""D"") &amp;&amp; (name != ""F"") &amp;&amp; (name != ""G"") &amp;&amp; (name != ""H"") &amp;&amp; (name != ""I"") &amp;&amp; (name != ""J"") &amp;&amp; (name != ""H"") &amp;&amp; (name != ""I"") &amp;&amp; (name != ""J""))
        {
            //Do something

        }

        if ((name != ""A""))
        {
            //Do something
        }


        if ((name != ""A"") &amp;&amp; (name != ""K"") &amp;&amp; (name != ""L"") )
        {

           //Do something
        }


        if ((name != ""A"") &amp;&amp; (name != ""K"") &amp;&amp; (name != ""L"") &amp;&amp; (name != ""B"") &amp;&amp; (name != ""D"") &amp;&amp; (name != ""F"") &amp;&amp; (name != ""G"") &amp;&amp; (name != ""H"") &amp;&amp; (name != ""I"") &amp;&amp; (name != ""J"") &amp;&amp; (name != ""H"") &amp;&amp; (name != ""I""))
        {
                //Do something
        }


        if ((name != ""A"") &amp;&amp; (name != ""L""))
        {

           //Do something
        }

        if (name == ""M"")
        {
           //Do something
        }

        else if (name == ""C"")
        {
            //Do something
        }
        else
        {
          //Do something
        }

        }
</code></pre>
","2015-06-19 09:32:42"
"33082761","refactor an array in ruby","-2","<p>I have an array called ""dates"" that looks like this...</p>

<pre><code>@dates = [ 
    {:month =&gt; 'apr', :start_date =&gt; '2015-04-01', :end_date =&gt; '2015-05-01'}, 
    {:month =&gt; 'may', :start_date =&gt; '2015-05-01', :end_date =&gt; '2015-06-01'},
    {:month =&gt; 'jun', :start_date =&gt; '2015-06-01', :end_date =&gt; '2015-07-01'},
    {:month =&gt; 'jul', :start_date =&gt; '2015-07-01', :end_date =&gt; '2015-08-01'},
    {:month =&gt; 'aug', :start_date =&gt; '2015-08-01', :end_date =&gt; '2015-09-01'},
    {:month =&gt; 'sep', :start_date =&gt; '2015-09-01', :end_date =&gt; '2015-10-01'},
    {:month =&gt; 'oct', :start_date =&gt; '2015-10-01', :end_date =&gt; '2015-11-01'},
    {:month =&gt; 'nov', :start_date =&gt; '2015-11-01', :end_date =&gt; '2015-12-01'},
    {:month =&gt; 'dec', :start_date =&gt; '2015-12-01', :end_date =&gt; '2016-01-01'},
    {:month =&gt; 'jan', :start_date =&gt; '2016-01-01', :end_date =&gt; '2016-02-01'},
    {:month =&gt; 'feb', :start_date =&gt; '2016-02-01', :end_date =&gt; '2016-03-01'},
    {:month =&gt; 'mar', :start_date =&gt; '2016-03-01', :end_date =&gt; '2016-04-01'}
    ]
</code></pre>

<p>I'd love to refactor this but it's beyond me. I tried working towards something like this but got lost in the fact that the jan / feb / march dates would be in the next calendar year....</p>

<pre><code>@months = I18n.t(""date.abbr_month_names"").compact.rotate(3).map(&amp;:downcase)

@dates = []
@months.@months.each_with_index do |mon, x|
  @dates &lt;&lt; {:month =&gt; mon, :start_date =&gt; Date.parse(mon).beginning_of_month, :end_date =&gt; Date.parse(mon).end_of_month + 1}
end
</code></pre>

<p>this ALMOST works, but the last three months are in next year. I have a feeling I could something with the index but cannot get my head round it</p>

<p>any ideas?</p>
","2015-10-12 13:44:04"
"21719687","refactor regex ruby code","-2","<p>I want to get the resource name from a class name like:</p>

<blockquote>
  <p>""SequelAdapter::UserGraph""</p>
</blockquote>

<p>So I would want user in this case.</p>

<p>Currently I have this code which does work but is very ugly:</p>

<pre><code>klass = object.class.to_s

if start = klass =~ /[::][A-Za-z]*Graph/
  finish = klass =~ /Graph/

  klass = klass[start + 1, finish - start - 1]
end
</code></pre>

<p>Can anyone suggest a better way?</p>
","2014-02-12 05:46:48"
"6164909","refactor a php 5 application with no framework to work with zend framework","-5","<p>I have a complete web aplication with php5 my question is there an easy way to transform it so it work with zend framework?</p>

<pre><code>&lt;?php class Projet extends Modele
    {
        var $id_proj;
        var $libelle;
        var $date_Create;
        var $projet_html;
        var $html;
        var $nbr_bloc;
        var $date_modif;
        var $etat;
        var $width;
        var $height;
        var $bg_color;
        var $border;
        }
</code></pre>
","2011-05-28 23:10:14"